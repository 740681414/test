window.__require=function t(e,o,i){function n(r,c){if(!o[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var d=o[r]={exports:{}};e[r][0].call(d.exports,function(t){return n(e[r][1][t]||t)},d,d.exports,t,e,o,i)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({AIHeroNode:[function(t,e,o){"use strict";cc._RF.push(e,"2fa56RMYIFPlaReQzhlgngE","AIHeroNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderAssetNode"),c=t("../../../framework/Script/component/LoaderDragonBones"),s=t("../../../InitScene/Script/data/GunModel"),l=t("../../../InitScene/Script/data/PersonModel"),d=t("../../../Script/base/Utils"),u=t("../../Script/ui/prefabs/view/GunView"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hero=null,e.sprite=null,e.descLabel=null,e.dialog=null,e.personIdx=4,e.isAuto=!1,e.isWalk=!1,e.time=0,e}return n(e,t),e.prototype.start=function(){this.isAuto&&this.setData(this.personIdx,d.random(0,s.default.getGunTotalNum()))},e.prototype.setData=function(t,e){this.personIdx=t,this.loadPerson(t),this.changeGun(e)},e.prototype.showDialog=function(){var t=this;this.dialog&&(this.dialog.active=!0),this.dialog&&this.dialog.getComponent(cc.Animation).play(),this.dialog&&this.dialog.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){t.dialog.active=!1})},e.prototype.changeGun=function(t){this.sprite&&this.loadGun(t)},e.prototype.loadPerson=function(){var t=this,e="hero/dragon/"+l.default.getHeroDataById(this.personIdx).skeUrl;return new Promise(function(){t.scheduleOnce(function(){c.default.addLoaderDragonBones(t.hero).loadArmature(e,function(){t.scheduleOnce(function(){t.hero.armatureName="armatureName";var e=t.hero.attachUtil.generateAttachedNodes("\u67aa")[0];t.sprite.setPosition(e.getPosition()),t.sprite.parent=e,t.hero.playAnimation("\u5f85\u673a",0),t.sprite.angle=-30,t.isWalk&&(t.walk(),t.schedule(t.walk,12))})})})})},e.prototype.loadGun=function(t){var e=this;return new Promise(function(o,i){e.scheduleOnce(function(){e.sprite.removeAllChildren();var n="gun/prefabs/normal/"+t;r.default.addLoadingAssetNode(e.sprite).loadAsset(n,cc.Prefab,function(t,n){if(t)i();else{var a=cc.instantiate(n);a.getComponent(u.default).init(!0,!1),e.sprite.addChild(a),a.setPosition(cc.v2(0,20)),o()}})})})},e.prototype.walk=function(){var t=this,e=-this.node.x,o=3*Math.random()+1,i=3*Math.random()+3,n=cc.delayTime(o),a=cc.callFunc(function(){t.hero.timeScale=.5,t.hero.playAnimation("\u79fb\u52a8",0),e>0?t.node.scaleX=t.node.scaleY:e<0&&(t.node.scaleX=-t.node.scaleY)}),r=cc.moveTo(i,cc.v2(e,this.node.y)),c=cc.callFunc(function(){t.hero.timeScale=1,t.hero.playAnimation("\u5f85\u673a",0),e>0?t.node.scaleX=-t.node.scaleY:e<0&&(t.node.scaleX=t.node.scaleY)});this.node.runAction(cc.sequence(n,a,r,c)),this.time=o+ +i+1},a([f(dragonBones.ArmatureDisplay)],e.prototype,"hero",void 0),a([f(cc.Node)],e.prototype,"sprite",void 0),a([f(cc.Label)],e.prototype,"descLabel",void 0),a([f(cc.Node)],e.prototype,"dialog",void 0),a([f],e.prototype,"personIdx",void 0),a([f(cc.Boolean)],e.prototype,"isAuto",void 0),a([f(cc.Boolean)],e.prototype,"isWalk",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../InitScene/Script/data/GunModel":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../Script/base/Utils":void 0,"../../../framework/Script/component/LoaderAssetNode":void 0,"../../../framework/Script/component/LoaderDragonBones":void 0,"../../Script/ui/prefabs/view/GunView":"GunView"}],AI:[function(t,e,o){"use strict";cc._RF.push(e,"0d075K8al9MX7N3jxXVvuaJ","AI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/PlayerModel"),c=t("../../manage/GameManage"),s=t("../../joystick/JoystickCommon"),l=t("../../Player"),d=t("../../test/EditView"),u=t("../../../../InitScene/Script/data/GunModel"),p=t("../../../../InitScene/Script/data/PersonModel"),h=t("./Pet/PetNode"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delay=1,e.think=.02,e.findTime=0,e.path_idx=0,e.path=[],e.isRun=!1,e.isStart=!1,e.isDelay=!1,e.index=0,e.petPrefab=null,e}return n(e,t),e.prototype.start=function(){this.gameType=c.default.getInstance().gameType,this.loadModel(this.personIdx,this.gunIdx,this.mountIdx),this.loadSkin(this.personIdx,this.mountIdx)},e.prototype.init=function(){this.setPos(this.index,!1),this.pet.init()},e.prototype.initPet=function(t,e){var o=c.default.getInstance();this.gameView=o.gameView;var i=cc.instantiate(this.petPrefab),n=i.getComponent(h.default);n.gameView=this.gameView,cc.log("========",t,e),n.initPet(1,.2,t,e,this.model.group,this.personIdx),i.parent=this.gameView.layout,this.pet=n},e.prototype.initAI=function(t,e,o,i,n,a,r,l,h){void 0===r&&(r=!0),void 0===l&&(l=0),void 0===h&&(h=0),console.log("AI  \u521d\u59cb\u5316AI",t,e,"i:personIdx  \u4eba\u7269",o,"o:gunIdx     \u6b66\u5668",i,"\u5750\u9a91",n,"\u5750\u9a91\u7b49\u7ea7",a);var f=this;this.index=t+1,void 0===e&&(e=1),void 0===o&&(o=Math.floor(Math.random()*p.default.getHeroTotalNum())),void 0===i&&(i=Math.floor(Math.random()*u.default.getGunTotalNum())),this.personIdx=o,this.gunIdx=i,this.mountIdx=n,this.mount_level=a,this.model.group=1e5+t,this.hpBuff=l,this.atkBuff=h,this.bloodLevel=0;var m=c.default.getInstance().aiList;t<m.length&&(this.model.icon=m[t].avatarUrl,this.model.nickname=m[t].name,this.model.playerItemData=m[t]),this.model.type&&(this.think=e),this.schedule(function(){if(f.isStart&&!f.isStop){var t=f.findTargets().filter(function(t){return f.isAttack(t)});if(t.length>0)f.target=t[0],f.attack();else{if(!f.isFill&&!f.isIdle){var e=f.gameView.quadTree.retrieve(f.node.getBoundingBox()).filter(function(t){return f.gameView.nameList.indexOf(t.node.name)>-1&&t.type==d.ItemType.BOX}).filter(function(t){return f.isAttackBlock(t)});if(e.length>0)return f.moveDir=cc.v2(e[0].rect.x+e[0].rect.width/2,e[0].rect.y+e[0].rect.height/2).sub(f.node.getPosition()).normalizeSelf(),f.isDelay&&(f.isDelay=!1,f.unschedule(f.delayAttack)),f.updateDir(f.getDir()),void(f.doAttack()&&(f._speedType=s.SpeedType.NORMAL,f.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf()))}f.run()}}},this.think),this.initPet(n,a)},e.prototype.findTargets=function(){var t=this;return this.gameView.targets.filter(function(e){return t.checkTarget(e)&&e.model.group!=t.model.group}).sort(function(e,o){return e.node.position.sub(t.node.position).mag()-o.node.position.sub(t.node.position).mag()})},e.prototype.loadModel=function(e,o,i){cc.log("AIloadModel:",i,this.model.group),void 0===e&&(e=p.default.useHeroId),void 0===o&&(o=u.default.useGunId),t.prototype.loadModel.call(this,e,o,i),this.model.IDLE<=.2&&this.think>.2&&(this.think=.2)},e.prototype.isAttack=function(t){if(this.checkTarget(t)&&this.checkTarget(this)&&!this.isStop){var e=cc.v2(this.node.position),o=cc.v2(t.node.position);return(this.model.type==r.ArmType.\u72d9\u51fb||this.model.type==r.ArmType.\u5bfc\u5f39||this.model.type==r.ArmType.\u8d2f\u7a7f)&&e.sub(o).mag()<1e3?!this.gameView.quadTree.retrieve(this.node.getBoundingBox()).concat(this.gameView.quadTree.retrieve(t.node.getBoundingBox())).some(function(t){return(t.type==d.ItemType.BLOCK||t.type==d.ItemType.SHADOW||t.type==d.ItemType.MOUNTAIN)&&cc.Intersection.lineRect(e,o,t.rect)}):!(e.sub(o).mag()>this.model.RAN||this.gameView.quadTree.retrieve(this.node.getBoundingBox()).concat(this.gameView.quadTree.retrieve(t.node.getBoundingBox())).some(function(t){return(t.type==d.ItemType.BLOCK||t.type==d.ItemType.SHADOW||t.type==d.ItemType.MOUNTAIN)&&cc.Intersection.lineRect(e,o,t.rect)}))}return!1},e.prototype.isAttackBlock=function(t){if(t&&this.checkTarget(this)&&!this.isStop){var e=cc.v2(this.node.position),o=cc.v2(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/2);return(this.model.type==r.ArmType.\u72d9\u51fb||this.model.type==r.ArmType.\u5bfc\u5f39||this.model.type==r.ArmType.\u8d2f\u7a7f)&&e.sub(o).mag()<1e3||!(e.sub(o).mag()>this.model.RAN)}return!1},e.prototype.attack=function(){if(!this.isFill&&!this.isIdle)if(this.model.type==r.ArmType.\u6563\u5c04){if(this.isDelay)return;this.isDelay=!0,this.scheduleOnce(this.delayAttack,this.think+.4)}else if(this.model.type==r.ArmType.\u72d9\u51fb||this.model.type==r.ArmType.\u5bfc\u5f39||this.model.type==r.ArmType.\u8d2f\u7a7f){if(this.isDelay)return;var t=this.target.node.position.sub(this.node.position).mag()/500*this.think;this._speedType=s.SpeedType.NORMAL,this.moveDir=cc.Vec2.ZERO,this.isDelay=!0,this.scheduleOnce(this.delayAttack,t+.4)}else this.updateDir(this.getDir()),this.doAttack()&&(this._speedType=s.SpeedType.NORMAL,this.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf())},e.prototype.delayAttack=function(){this.isDelay=!1,this.isStop||(this.updateDir(this.getDir()),this.doAttack()&&(this._speedType=s.SpeedType.NORMAL,this.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf()))},e.prototype.run=function(){var t=this;this.isRun||(this.findTime+1e3*this.delay>(new Date).getTime()&&this.attacking&&this.checkTarget(this.target)?(this._speedType=s.SpeedType.NORMAL,this.moveDir=this.moveDir.rotate(Math.PI/20*(Math.random()-.5)),this.isRun=!0,this.scheduleOnce(function(){t.isRun=!1},this.delay)):this.isFind()?(this.isRun=!0,this.doRun()):(this.isRun=!0,this.scheduleOnce(function(){t.isRun=!1},this.delay)))},e.prototype.doRun=function(){var t=this;if(this.path_idx>-1&&this.path_idx<this.path.length)if(this.isStop)this.scheduleOnce(function(){t.doRun()},this.delay);else{var e=this.gameView.astar.getPos(this.path[this.path_idx]).sub(this.node.getPosition());this.moveDir=e.normalize(),this.scheduleOnce(function(){t.path_idx--,t.path_idx<0?t.isRun=!1:t.doRun()},1/Math.max(1,t.path_idx))}},e.prototype.isFind=function(){var t=this,e=this.findTargets(),o=e.filter(function(e){return e==t.gameView.curPlayer});if(o.length>0){if(this.target=o[0],this.findPath(o[0]),this.path.length>1)return this.path_idx=this.path.length-2,!0}else if(e.length>0){if(this.target=e[0],this.findPath(e[0]),this.path.length>1)return this.path_idx=this.path.length-2,!0}else if(this.checkTarget(this.target)&&Math.abs(this.target.node.x-this.node.x)<=cc.winSize.width/2+500&&Math.abs(this.target.node.y-this.node.y)<=cc.winSize.height/2+500&&(this.findPath(this.target),this.path.length>1))return this.path_idx=this.path.length-2,!0;return this.target=null,!1},e.prototype.findPath=function(t){var e=this.gameView.astar.getGird(this.node.getPosition()),o=this.gameView.astar.getGird(t.node.getPosition());this.path=this.gameView.astar.findPath(e,o),this.gameView.astar.floyd(this.path),this.findTime=(new Date).getTime()},e.prototype.findItems=function(){},e.prototype.getPersonIdx=function(t){var e=t;return e>=p.default.getHeroTotalNum()&&(e=p.default.getHeroTotalNum()-Math.floor(3*Math.random())-1),e<0&&(e=0),e},e.prototype.getGunIdx=function(t){var e=t;return e>=u.default.getGunTotalNum()&&(e=u.default.getGunTotalNum()-Math.floor(3*Math.random())-1),e<0&&(e=0),e},e.prototype.update=function(e){this.checkTarget(this)&&(t.prototype.update.call(this,e),this.isStart&&(this.isRun&&(this._speedType=s.SpeedType.NORMAL),this.updateAtkDir(this.target)),Math.abs(this.node.x-this.gameView.curPlayer.node.x)>1.5*cc.winSize.width/this.gameView.followCamera.zoomRatio||Math.abs(this.node.y-this.gameView.curPlayer.node.y)>1.5*cc.winSize.height/this.gameView.followCamera.zoomRatio?(this.dragon.node.active=!1,this.sprite&&this.sprite.node.active&&(this.sprite.node.active=!1),this.hpView.node.active&&(this.hpView.node.active=!1)):(this.dragon.node.active=!0,this.isStop||!this.sprite||this.sprite.node.active||(this.sprite.node.active=!0),this.hpView.node.active||(this.hpView.node.active=!0)))},a([y(cc.Prefab)],e.prototype,"petPrefab",void 0),a([m],e)}(l.default);o.default=g,cc._RF.pop()},{"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../InitScene/Script/data/PlayerModel":void 0,"../../Player":"Player","../../joystick/JoystickCommon":"JoystickCommon","../../manage/GameManage":"GameManage","../../test/EditView":"EditView","./Pet/PetNode":"PetNode"}],AStar:[function(t,e,o){"use strict";cc._RF.push(e,"1ce188JTy9MaIwIOtrrw8d0","AStar");var i=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.Grid=void 0;var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function t(){this._gridW=0,this._gridH=0,this.mapW=0,this.mapH=0,this.is8dir=!0,this.gridsList=[[]]}return t.prototype.init=function(t,e,o,i,n){void 0===n&&(n=!0),this._gridW=t,this._gridH=e,this.mapW=o,this.mapH=i,this.is8dir=n,this.initMap()},t.prototype.initMap=function(){this.gridsList=new Array(this.mapW+1);for(var t=0;t<this.gridsList.length;t++)this.gridsList[t]=new Array(this.mapH+1);for(t=0;t<=this.mapW;t++)for(var e=0;e<=this.mapH;e++)this.addGrid(t,e,0)},t.prototype.resetMap=function(){this.gridsList.forEach(function(t){t.forEach(function(t){t.type=0,t.f=0,t.g=0,t.h=0,t.parent=null})})},t.prototype.addGrid=function(t,e,o){var i=new c;i.x=t,i.y=e,i.type=o,this.gridsList[t][e]=i},t.prototype.addOther=function(t,e,o){var i=t.x-e/2,n=t.x+e/2,a=t.y-o/2,r=t.y+o/2,c=0,s=this.mapW;if(e>=this._gridW/4){var l=Math.floor(t.x/this._gridW),d=i%this._gridW,u=n%this._gridW;d<3*this._gridW/4?c=Math.max(Math.floor(i/this._gridW),0):(c=Math.max(Math.floor(i/this._gridW)+1,0))>l&&(c=l),u<this._gridW/4?(s=Math.min(Math.floor(n/this._gridW)-1,this.mapW))<l&&(s=l):s=Math.min(Math.floor(n/this._gridW),this.mapW)}else c=s=Math.floor(t.x/this._gridW);var p=0,h=this.mapH;if(o>=this._gridH/2){var f=Math.floor(t.y/this._gridH),m=a%this._gridH,y=r%this._gridH;m<3*this._gridH/4?p=Math.max(Math.floor(a/this._gridH),0):(p=Math.max(Math.floor(a/this._gridH)+1,0))>f&&(p=f),y<this._gridH/4?(h=Math.min(Math.floor(r/this._gridH)-1,this.mapH))<f&&(h=f):h=Math.min(Math.floor(r/this._gridH),this.mapH)}else p=h=Math.floor(t.y/this._gridH);for(var g=c;g<=s;g++)for(var v=p;v<=h;v++)0==this.gridsList[g][v].type&&(this.gridsList[g][v].type=-1)},t.prototype.getGirdX=function(t){var e=Math.round(t/this._gridW-.5)+Math.floor(this.mapW/2+.5);return e<0?0:e>this.mapW?this.mapW:e},t.prototype.getGirdY=function(t){var e=Math.round(t/this._gridH-.5)+Math.floor(this.mapH/2+.5);return e<0?0:e>this.mapH?this.mapH:e},t.prototype.getGird=function(t){return cc.v2(this.getGirdX(t.x),this.getGirdY(t.y))},t.prototype.getX=function(t){return(t-Math.floor(this.mapW/2+.5)+.5)*this._gridW},t.prototype.getY=function(t){return(t-Math.floor(this.mapH/2+.5)+.5)*this._gridH},t.prototype.getPos=function(t){return cc.v2(this.getX(t.x),this.getY(t.y))},t.prototype._sortFunc=function(t,e){return t.f-e.f},t.prototype.generatePath=function(t){var e=[];for(e.push(t);t.parent;)t=t.parent,e.push(t);return e},t.prototype.findPath=function(t,e){for(var o=[],i=[],n=[],a=new Array(this.mapW+1),r=0;r<a.length;r++)a[r]=new Array(this.mapH+1);for(r=0;r<=this.mapW;r++)for(var c=0;c<=this.mapH;c++)a[r][c]=Object.assign({},this.gridsList[r][c]);var s=a[t.x][t.y],l=a[e.x][e.y];s.type=1,l.type=2,s.h=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);var d=s;for(i.push(d);;){for(var u=-1;u<=1;u++)for(var p=-1;p<=1;p++)if((0!=u||0!=p)&&(r=d.x+u,c=d.y+p,r>=0&&c>=0&&r<=this.mapW&&c<=this.mapH&&-1!=a[r][c].type&&-1==n.indexOf(a[r][c]))){if(this.is8dir){if(-1==a[r-u][c].type||-1==a[r][c-p].type)continue}else if(0!==u&&0!==p)continue;var h=0!==u&&0!==p?d.g+14:d.g+10;(0==a[r][c].g||a[r][c].g>h)&&(a[r][c].g=h,a[r][c].parent=d),a[r][c].h=Math.abs(e.x-r)+Math.abs(e.y-c),a[r][c].f=a[r][c].g+a[r][c].h,i.indexOf(a[r][c])<0&&i.push(a[r][c])}if(n.push(i.shift()),0===i.length){var f=n.concat(i).sort(function(t,e){return t.h-e.h});return f.length>0&&1!=f[0].type&&f[0].h<s.h&&(o=this.generatePath(f[0])),o}if(i.sort(this._sortFunc),2==(d=i[0]).type)return this.generatePath(d)}},t.prototype.floyd=function(t){var e=t.slice(0),o=e.length;if(o>2)for(var i=cc.v2(e[o-1].x-e[o-2].x,e[o-1].y-e[o-2].y),n=o-3;n>=0;n--){var a=cc.v2(e[n+1].x-e[n].x,e[n+1].y-e[n].y);i.equals(a)?e.slice(n+1,1):i=a}if((o=e.length)>2)for(n=o-1;n>=0;n--)for(var r=0;r<=n-2;r++)if(!this.hasBlock(e[n],e[r])){for(var c=n-1;c>r;c--)e.splice(c,1);n=r,o=e.length;break}t=e},t.prototype.hasBlock=function(t,e){var o=this;if(t.x==e.x&&t.y==e.y)return!1;var i=Math.min(t.x,e.x),n=Math.max(t.x,e.x),a=Math.min(t.y,e.y),r=Math.max(t.y,e.y),c=[];this.gridsList.forEach(function(t){return c=c.concat(t.filter(function(t){return-1==t.type&&t.x>=i&&t.x<=n&&t.y>=a&&t.y<=r}))});var s=this.getPos(t),l=this.getPos(e),d=Math.sqrt(Math.pow(this._gridW,2)+Math.pow(this._gridH,2)),u=cc.v2(),p=cc.v2(),h=cc.v2(),f=cc.v2(),m=cc.v2();return s.x<l.x?(u=l.sub(s).rotateSelf(Math.PI/2).normalizeSelf().scaleSelf(cc.v2(d/2,d/2)),p=s.add(u),h=l.add(u),f=l.sub(u),m=s.sub(u)):(u=s.sub(l).rotateSelf(Math.PI/2).normalizeSelf().scaleSelf(cc.v2(d/2,d/2)),p=l.add(u),h=s.add(u),f=s.sub(u),m=l.sub(u)),c.some(function(t){var e=o.getPos(t);return cc.Intersection.rectPolygon(cc.rect(e.x-o._gridW/2,e.y-o._gridH/2,o._gridW,o._gridH),[p,h,f,m])})},i([a],t)}());o.default=r;var c=function(){this.x=0,this.y=0,this.f=0,this.g=0,this.h=0,this.parent=null,this.type=0,this.x=0,this.y=0,this.f=0,this.g=0,this.h=0,this.parent=null,this.type=0};o.Grid=c,cc._RF.pop()},{}],AccountAwardFarmNode:[function(t,e,o){"use strict";cc._RF.push(e,"bb3c4xkxA1BhLODlhzmIpET","AccountAwardFarmNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../../framework/Script/cemter/SceneCenter"),c=t("../../../../../../framework/Script/component/LoaderSprite"),s=t("../../../../../../InitScene/Script/data/GameData"),l=t("../../../../../../MainScene/Script/center/Game"),d=t("../../../../manage/GameManage"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoBtn=null,e.coinLabel=null,e.diamondLabel=null,e.boneLabel=null,e.seedNode=null,e.seedSprite=null,e.seedLabel=null,e.diamond=0,e.money=0,e.bone=0,e.isEffect=!1,e.isNext=!1,e}return n(e,t),e.prototype.init=function(t,e){s.default.totalDiamondNum+=this.diamond,s.default.totalCoinNum+=this.money,s.default.totalBoneNum+=this.bone;var o=e.onReward();this.updateValue(t,e,o)},e.prototype.updateValue=function(t,e,o){if(t){this.money=75,this.diamond=10,this.bone=5,this.seedLabel.string=""+o;var i=e.seedIconUrl;c.default.addLoaderSprite(this.seedSprite).loadSprite(i),6==e.seed_id||7==e.seed_id?this.seedSprite.node.scale=1.2:this.seedSprite.node.scale=2,this.seedNode.active=!0}else this.money=25,this.diamond=3,this.bone=2,this.seedNode.active=!1;this.coinLabel.string=this.money+"",this.diamondLabel.string=this.diamond+"",this.boneLabel.string=this.bone+""},e.prototype.onClickVideo=function(){this.callback()},e.prototype.onClickShare=function(){this.callback()},e.prototype.callback=function(){this.videoBtn&&(this.videoBtn.interactable=!1),s.default.totalDiamondNum+=2*this.diamond,s.default.totalCoinNum+=2*this.money,s.default.totalBoneNum+=2*this.bone,this.onClickBack()},e.prototype.onDisable=function(){d.default.getInstance().quitGame()},e.prototype.onClickBack=function(){var t;this.videoBtn.interactable?((t=new r.SceneData).matchInfo={isShowCurrency:!0,coin:this.money,diamond:this.diamond,bone:this.bone},l.default.sceneCenter.runScene("MainScene",t)):((t=new r.SceneData).matchInfo={isShowCurrency:!0,coin:3*this.money,diamond:3*this.diamond,bone:3*this.bone},l.default.sceneCenter.runScene("MainScene",t))},a([h(cc.Button)],e.prototype,"videoBtn",void 0),a([h(cc.Label)],e.prototype,"coinLabel",void 0),a([h(cc.Label)],e.prototype,"diamondLabel",void 0),a([h(cc.Label)],e.prototype,"boneLabel",void 0),a([h(cc.Node)],e.prototype,"seedNode",void 0),a([h(cc.Sprite)],e.prototype,"seedSprite",void 0),a([h(cc.Label)],e.prototype,"seedLabel",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../../../InitScene/Script/data/GameData":void 0,"../../../../../../MainScene/Script/center/Game":"Game","../../../../../../framework/Script/cemter/SceneCenter":void 0,"../../../../../../framework/Script/component/LoaderSprite":void 0,"../../../../manage/GameManage":"GameManage"}],AccountAwardNode:[function(t,e,o){"use strict";cc._RF.push(e,"58869rXG9NNarCsurgy0hRC","AccountAwardNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/cemter/SceneCenter"),c=t("../../../../../framework/Script/component/LoaderAssetNode"),s=t("../../../../../InitScene/Script/data/GameData"),l=t("../../../../../InitScene/Script/data/GuanqiaModel"),d=t("../../../../../InitScene/Script/data/GunModel"),u=t("../../../../../InitScene/Script/data/MountModel"),p=t("../../../../../InitScene/Script/data/OtherData"),h=t("../../../../../InitScene/Script/data/PersonModel"),f=t("../../../../../InitScene/Script/data/PlayerData"),m=t("../../../../../InitScene/Script/data/UFOModel"),y=t("../../../../../MainScene/Script/center/Game"),g=t("../../../../Script/ui/cultivate/GetCultivateNode"),v=t("../../../manage/GameManage"),_=cc._decorator,S=_.ccclass,b=_.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoBtn=null,e.coinLabel=null,e.diamondLabel=null,e.boneLabel=null,e.awardMountNode=null,e.mountDragon=null,e.mountSke=null,e.diamond=0,e.money=0,e.DNA=0,e.isEffect=!1,e.isNext=!1,e}return n(e,t),e.prototype.init=function(){var t=this,e=v.default.getInstance().isWin;if(this.updateValue(e),s.default.totalDiamondNum+=this.diamond,s.default.totalCoinNum+=this.money,s.default.totalBoneNum+=this.DNA,cc.log("=======\u6210\u529f\u8fd8\u662f\u5931\u8d25",e,v.default.getInstance().gameType,this.money,this.diamond,this.DNA),v.default.getInstance().gameType==v.GameType.\u666e\u901a\u5173\u5361){var o=p.default.mountMainGameOverID;if(u.default.getMountDataById(o).isUnlock)this.awardMountNode.active=!1;else{var i=u.default.getMountSkeUrl(o,0);if(c.default.addLoadingAssetNode(this.mountSke.node).loadAsset(i,sp.SkeletonData,function(e,o){t.mountSke.skeletonData=o,t.mountSke.animation="daiji"}),l.default.guanqiaData.id>=2){u.default.onUnlockMount(o);var n=y.default.uiCenter.showUi("GetCultivateNode").getComponent(g.default),a=u.default.getMountDataById(o);n.setData("mount",i,"\u5f85\u673a",a.award,!0),n.node.on("onClose",function(){t.awardMountNode.active=!1},this)}}}else this.awardMountNode.active=!1},e.prototype.updateValue=function(t){var e=v.default.getInstance();t?e.gameType==v.GameType.\u666e\u901a\u5173\u5361?(l.default.onSuccess(),s.default.gameCount++,this.money=e.getCoin*d.default.profit,this.diamond=e.getDiamond,this.DNA=e.getDNA):e.gameType==v.GameType.\u7ade\u6280\u573a?(this.money=80*d.default.profit,this.diamond=20,this.DNA=5):e.gameType==v.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&(this.money=e.getCoin*d.default.profit,this.diamond=e.getDiamond,this.DNA=e.getDNA,m.default.enterTimes++):e.gameType==v.GameType.\u666e\u901a\u5173\u5361?(l.default.onFail(),s.default.gameCount++,this.money=e.getCoin*d.default.profit,this.diamond=e.getDiamond,this.DNA=e.getDNA):e.gameType==v.GameType.\u7ade\u6280\u573a?(this.money=30*d.default.profit,this.diamond=8,this.DNA=2):e.gameType==v.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&(this.money=e.getCoin*d.default.profit,this.diamond=e.getDiamond,this.DNA=e.getDNA,m.default.enterTimes++),this.coinLabel.string=this.money+"",this.diamondLabel.string=this.diamond+"",this.boneLabel.string=this.DNA+""},e.prototype.onClickVideo=function(){this.callback()},e.prototype.onClickShare=function(){this.callback()},e.prototype.callback=function(){this.videoBtn&&(this.videoBtn.interactable=!1),s.default.totalDiamondNum+=2*this.diamond,s.default.totalCoinNum+=2*this.money,s.default.totalBoneNum+=2*this.DNA,this.onClickBack()},e.prototype.onDisable=function(){v.default.getInstance().quitGame()},e.prototype.onClickNext=function(){this.isEffect||(!f.default.isAccount&&y.default.showToast("\u606d\u559c\u83b7\u5f97"+this.money+"\u91d1\u5e01\uff0c"+this.diamond+"\u94bb\u77f3"),y.default.sceneCenter.runScene("MainScene"))},e.prototype.onClickBack=function(){var t;if(this.videoBtn.interactable)(t=new r.SceneData).matchInfo={isShowCurrency:!0,coin:this.money,diamond:this.diamond,bone:this.DNA},v.default.getInstance().gameType==v.GameType.\u5e7d\u6d6e\u7ed1\u67b6?y.default.sceneCenter.runScene("FarmScene",t):v.default.getInstance().gameType==v.GameType.\u666e\u901a\u5173\u5361?(t.matchInfo={isShowCurrency:!0,coin:this.money,diamond:this.diamond,bone:this.DNA,isOpenTurn:2==s.default.gameCount},y.default.sceneCenter.runScene("MainScene",t)):v.default.getInstance().gameType==v.GameType.\u7ade\u6280\u573a&&(t.matchInfo={isShowCurrency:!0,coin:this.money,diamond:this.diamond,bone:this.DNA},y.default.sceneCenter.runScene("MainScene",t));else if((t=new r.SceneData).matchInfo={isShowCurrency:!0,coin:3*this.money,diamond:3*this.diamond,bone:3*this.DNA},v.default.getInstance().gameType==v.GameType.\u5e7d\u6d6e\u7ed1\u67b6){var e=h.default.getHeroDataById(p.default.UFOHeroID),o=m.default.enterTimes>=p.default.UFOHeroTime&&!e.isUnlock;cc.log("isGetHero",o,m.default.enterTimes,p.default.UFOHeroTime,!e.isUnlock),t.matchInfo={isShowCurrency:!0,coin:3*this.money,diamond:3*this.diamond,bone:3*this.DNA,isGetHero:o},y.default.sceneCenter.runScene("FarmScene",t)}else v.default.getInstance().gameType==v.GameType.\u666e\u901a\u5173\u5361?(t.matchInfo={isShowCurrency:!0,coin:3*this.money,diamond:3*this.diamond,bone:3*this.DNA,isOpenTurn:2==s.default.gameCount},y.default.sceneCenter.runScene("MainScene",t)):v.default.getInstance().gameType==v.GameType.\u7ade\u6280\u573a&&(t.matchInfo={isShowCurrency:!0,coin:3*this.money,diamond:3*this.diamond,bone:3*this.DNA},y.default.sceneCenter.runScene("MainScene",t))},a([b(cc.Button)],e.prototype,"videoBtn",void 0),a([b(cc.Label)],e.prototype,"coinLabel",void 0),a([b(cc.Label)],e.prototype,"diamondLabel",void 0),a([b(cc.Label)],e.prototype,"boneLabel",void 0),a([b(cc.Node)],e.prototype,"awardMountNode",void 0),a([b(dragonBones.ArmatureDisplay)],e.prototype,"mountDragon",void 0),a([b(sp.Skeleton)],e.prototype,"mountSke",void 0),a([S],e)}(cc.Component);o.default=w,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GuanqiaModel":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/OtherData":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/PlayerData":void 0,"../../../../../InitScene/Script/data/UFOModel":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../../../framework/Script/cemter/SceneCenter":void 0,"../../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../Script/ui/cultivate/GetCultivateNode":"GetCultivateNode","../../../manage/GameManage":"GameManage"}],AccountDifficultNode:[function(t,e,o){"use strict";cc._RF.push(e,"b5261y6ShJAfJFg/XXpWJeV","AccountDifficultNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/PlayerData"),c=t("../../../../../InitScene/Script/data/DifficultModel"),s=t("../../../../../MainScene/Script/center/Game"),l=t("../../../manage/GameManage"),d=t("./DifficultAwardNode"),u=t("../../../../Script/ui/difficult/DifficultView"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cancelBtn=null,e.tipLabel=null,e.star=null,e.difficultView=null,e.accAwardPrefab=null,e.getCurrencyNode=null,e.model=null,e.count=0,e.level=0,e.isUpgrade=!1,e.isWin=!1,e.isEffect=!1,e.isNext=!1,e.isVideo=!1,e}return n(e,t),e.prototype.onLoad=function(){r.default.playcount++},e.prototype.init=function(t){this.model=t,cc.log("this.model",this.model),this.level=c.default.level,this.updateValue(this.model)},e.prototype.refreshLevel=function(t){this.difficultView&&this.difficultView.refresh(t),cc.log("\u66f4\u65b0\u6bb5\u4f4d\u7b49\u7ea7refreshLevel",c.default.level)},e.prototype.refresh=function(){this.model&&(this.refreshLevel(this.level),this.updateStar())},e.prototype.updateValue=function(t){switch(r.default.killNum+=t.kill_count,t.rank){case 0:this.count=1,this.tipLabel.string="\u51b3\u6597\u80dc\u51fa\uff01\u52a0\u4e00\u661f\uff01";break;default:this.count=0,this.tipLabel.string=""}c.default.level<0&&(c.default.level=0),c.default.level+this.count>=0&&c.default.level+this.count<=c.default.totalStar?(c.default.level+=this.count,c.default.maxLevel<c.default.getDifficultLevel(c.default.level).difficultLevel&&(c.default.maxLevel=c.default.getDifficultLevel(c.default.level).difficultLevel,this.isUpgrade=!0)):c.default.level+=this.count,cc.log("\u7ed3\u7b97-\u662f\u5426\u5347\u6bb5\u4f4d\uff1a",this.isUpgrade,c.default.level),this.isWin=this.count>0},e.prototype.updateStar=function(){this.count>0?this.addStar():this.isEffect=!1},e.prototype.addStar=function(){var t=this,e=c.default.getDifficultLevel(this.level);if(this.count>0&&this.level>=0&&e.difficultLevel!==c.default.MaxDifficultLevel){this.isEffect=!0,this.cancelBtn.interactable=!1,this.count--,this.level++;var o=this.star;o.node.setPosition(cc.v2(this.difficultView.stars.children[(this.level-1)%c.MaxStar_difficult])),o.node.active=!0,this.level%c.MaxStar_difficult==0?(cc.log("\u52a0\u661f\u52a8\u753b\u7ed3\u675f\u540e\u662f\u5426\u6709\u5347\u6bb5\u4f4d\uff1a",this.isUpgrade,c.default.level),o.once(dragonBones.EventObject.COMPLETE,function(){o.node.active=!1,t.difficultView.upgrade(function(){t.isUpgrade&&(t.isEffect=!0,t.cancelBtn.interactable=!1,t.isUpgrade=!1),t.refreshLevel(t.level),t.addStar()}),t.difficultView.refreshStar(c.MaxStar_difficult)}),this.scheduleOnce(function(){s.default.gameAudio.playAddStarClip()},.5),o.playAnimation("\u5347\u661f",1)):(o.once(dragonBones.EventObject.COMPLETE,function(){t.refreshLevel(t.level),t.addStar(),o.node.active=!1}),this.scheduleOnce(function(){s.default.gameAudio.playAddStarClip()},.5),o.playAnimation("\u5347\u661f",1))}else this.count>0&&this.level>=0?(this.isEffect=!0,t.cancelBtn.interactable=!1,this.count--,this.level++,t.refreshLevel(t.level),s.default.gameAudio.playAddStarClip(),t.addStar()):(this.isEffect=!1,this.cancelBtn.interactable=!0)},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){l.default.getInstance().quitGame()},e.prototype.onClickBack=function(){var t=this;this.isEffect||this.scheduleOnce(function(){s.default.uiCenter.showUi(t.accAwardPrefab).getComponent(d.default).init(t.isWin)},.3)},a([f(cc.Button)],e.prototype,"cancelBtn",void 0),a([f(cc.Label)],e.prototype,"tipLabel",void 0),a([f(dragonBones.ArmatureDisplay)],e.prototype,"star",void 0),a([f(u.default)],e.prototype,"difficultView",void 0),a([f(cc.Prefab)],e.prototype,"accAwardPrefab",void 0),a([f(cc.Prefab)],e.prototype,"getCurrencyNode",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../../InitScene/Script/data/DifficultModel":void 0,"../../../../../InitScene/Script/data/PlayerData":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../../Script/ui/difficult/DifficultView":"DifficultView","../../../manage/GameManage":"GameManage","./DifficultAwardNode":"DifficultAwardNode"}],AccountLevelAwardNode:[function(t,e,o){"use strict";cc._RF.push(e,"0ab11qqxDxPioVvI01fho+t","AccountLevelAwardNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.AccAwardType=void 0;var r,c=t("../../../../../framework/Script/component/LoaderAssetNode"),s=t("../../../../../InitScene/Script/data/MountModel"),l=t("../../../../../InitScene/Script/data/PersonModel"),d=t("../../../../../InitScene/Script/data/RankModel"),u=t("../../../../../MainScene/Script/center/Game"),p=t("../../../../../MainScene/Script/ui/cultivate/GetCultivateNode"),h=t("../../../../../MainScene/Script/ui/rank/AscendingNode"),f=cc._decorator,m=f.ccclass,y=f.property;(function(t){t[t.mount=0]="mount",t[t.hero=1]="hero",t[t.diamond=2]="diamond",t[t.null=3]="null"})(r=o.AccAwardType||(o.AccAwardType={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getCultivateNode=null,e.dwAwardPrefab=null,e.hero=null,e.diamondNode=null,e.nextAwardLabel=null,e.type=r.null,e.skeUrl="",e.id=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t,e,o){var i=this;if(console.log("AccountLevelAwardNode setData:"+t),t===r.diamond||t!=this.type)if(this.hero.node.active=!1,this.diamondNode.active=!1,this.type=t,this.id=e,t==r.hero){var n=l.default.getHeroDataById(e);this.skeUrl="hero/dragon/"+n.skeUrl,this.scheduleOnce(function(){c.default.addLoadingAssetNode(i.hero.node).loadAsset(i.skeUrl,sp.SkeletonData,function(t,e){i.hero.node.active=!0,i.hero.skeletonData=e,i.hero.animation="daiji-daishou"})})}else t==r.diamond&&(this.diamondNode.active=!0,this.nextAwardLabel.string=o+"",this.hero.node.active=!1)},e.prototype.onAward=function(){var t=this;if(this.type==r.hero){var e=l.default.getHeroDataById(this.id);e.onUnlock(),l.default.useHeroId=this.id;var o=u.default.uiCenter.showUi(this.getCultivateNode).getComponent(p.default);o.setData("hero",this.skeUrl,"\u5f85\u673a",e.award,!0),o.node.on("onClose",function(){u.default.uiCenter.showUi(t.dwAwardPrefab).getComponent(h.default).setData(d.default.maxLevel)},this)}else if(this.type==r.mount){s.default.onUnlockMount(this.id);var i=u.default.uiCenter.showUi(this.getCultivateNode).getComponent(p.default),n=s.default.getMountDataById(this.id);i.setData("mount",this.skeUrl,"\u5f85\u673a",n.award,!0),i.node.on("onClose",function(){u.default.uiCenter.showUi(t.dwAwardPrefab).getComponent(h.default).setData(d.default.maxLevel)},this)}else this.type==r.diamond&&u.default.uiCenter.showUi(this.dwAwardPrefab).getComponent(h.default).setData(d.default.maxLevel)},a([y(cc.Prefab)],e.prototype,"getCultivateNode",void 0),a([y(cc.Prefab)],e.prototype,"dwAwardPrefab",void 0),a([y(sp.Skeleton)],e.prototype,"hero",void 0),a([y(cc.Node)],e.prototype,"diamondNode",void 0),a([y(cc.Label)],e.prototype,"nextAwardLabel",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/RankModel":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../../../MainScene/Script/ui/cultivate/GetCultivateNode":"GetCultivateNode","../../../../../MainScene/Script/ui/rank/AscendingNode":"AscendingNode","../../../../../framework/Script/component/LoaderAssetNode":void 0}],AccountLevelNode:[function(t,e,o){"use strict";cc._RF.push(e,"77602X2AiRPILwNz0ENxQ/V","AccountLevelNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/prefab/AwardButton"),c=t("../../../../../InitScene/Script/center/GameInit"),s=t("../../../../../InitScene/Script/data/OtherData"),l=t("../../../../../InitScene/Script/data/PersonModel"),d=t("../../../../../InitScene/Script/data/PlayerData"),u=t("../../../../../InitScene/Script/data/RankModel"),p=t("../../../../../MainScene/Script/center/Game"),h=t("../../../../../MainScene/Script/ui/main/GetCurrencyNode"),f=t("../../../../../MainScene/Script/ui/prefabs/view/LevelView"),m=t("../../../manage/GameManage"),y=t("./AccountAwardNode"),g=t("./AccountLevelAwardNode"),v=cc._decorator,_=v.ccclass,S=v.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoBtn=null,e.cancelBtn=null,e.rankLabel=null,e.rankNum=null,e.addLabel=null,e.nextLabelSprite=null,e.accLevelAwardNode=null,e.star=null,e.levelView=null,e.nextStarAwardLabel=null,e.starNumLabel=null,e.maxDwNode=null,e.dwAwardPrefab=null,e.accAwardPrefab=null,e.getCurrencyNode=null,e.model=null,e.count=0,e.level=0,e.isUpgrade=!1,e.isAddStar=!1,e.isWin=!1,e.isEffect=!1,e.isNext=!1,e.isVideo=!1,e}return n(e,t),e.prototype.onLoad=function(){d.default.playcount++},e.prototype.init=function(t){this.model=t,cc.log("this.model",this.model),this.level=u.default.level,this.updateValue(this.model)},e.prototype.refreshLevel=function(t){if(this.levelView&&this.levelView.refresh(t),cc.log("\u66f4\u65b0\u6bb5\u4f4d\u7b49\u7ea7refreshLevel",u.default.level,u.default.maxLevel,u.default.MaxRankLevel),u.default.maxLevel==u.default.MaxRankLevel)this.accLevelAwardNode.node.active=!1,this.maxDwNode.active=!0,this.nextStarAwardLabel.string="10",this.starNumLabel.string="X "+u.default.maxStar;else{this.accLevelAwardNode.node.active=!0,this.maxDwNode.active=!1;var e=u.default.getRankData(u.default.maxLevel+1).award;l.default.getHeroDataById(s.default.giveDwHero).isUnlock?this.accLevelAwardNode.setData(g.AccAwardType.diamond,0,e):this.accLevelAwardNode.setData(g.AccAwardType.hero,s.default.giveDwHero,e)}},e.prototype.refresh=function(){if(this.model){var t=this.model.rank;this.rankNum.string=""+(t+1),this.rankLabel.string="\u7b2c"+(t+1)+"\u540d",this.refreshLevel(this.level),this.updateStar()}},e.prototype.updateValue=function(t){switch(d.default.killNum+=t.kill_count,t.rank){case 0:this.addLabel.string="\u52a0\u4e00\u661f",this.count=1,u.default.seasonWin+=1,u.default.win+=1;break;case 1:case 2:this.addLabel.string="\u51cf\u4e00\u661f",this.count=-1,u.default.lose+=1;break;case 3:default:this.addLabel.string="\u51cf\u4e00\u661f",this.count=-1,u.default.lose+=1}u.default.level<0&&(u.default.level=0),u.default.level+this.count>=0&&u.default.level+this.count<=u.default.totalStar?(u.default.level+=this.count,u.default.maxLevel<u.default.getRankLevel(u.default.level).rankLevel&&(u.default.maxLevel=u.default.getRankLevel(u.default.level).rankLevel,this.isUpgrade=!0)):(u.default.level+=this.count,u.default.maxStar<u.default.level&&(u.default.maxStar=u.default.level,this.isAddStar=!0)),cc.log("\u7ed3\u7b97-\u662f\u5426\u5347\u6bb5\u4f4d\uff1a",this.isUpgrade,u.default.level),this.isWin=this.count>0,m.default.getInstance().isWin=this.isWin},e.prototype.updateStar=function(){this.count>0?this.addStar():this.count<0?this.subStar():this.isEffect=!1},e.prototype.addStar=function(){var t=this,e=u.default.getRankLevel(this.level);if(this.count>0&&this.level>=0&&e.rankLevel!==u.default.MaxRankLevel){this.isEffect=!0,this.videoBtn.interactable=!1,this.cancelBtn.interactable=!1,this.count--,this.level++;var o=this.star;o.node.setPosition(cc.v2(this.levelView.stars.children[(this.level-1)%3])),o.node.active=!0,this.level%u.MaxStar==0?(cc.log("\u52a0\u661f\u52a8\u753b\u7ed3\u675f\u540e\u662f\u5426\u6709\u5347\u6bb5\u4f4d\uff1a",this.isUpgrade,u.default.level),o.once(dragonBones.EventObject.COMPLETE,function(){o.node.active=!1,t.levelView.upgrade(function(){t.isUpgrade&&(t.isEffect=!0,t.videoBtn.interactable=!1,t.cancelBtn.interactable=!1,t.accLevelAwardNode.onAward(),t.isUpgrade=!1),t.refreshLevel(t.level),t.addStar()}),t.levelView.refreshStar(u.MaxStar)}),this.scheduleOnce(function(){p.default.gameAudio.playAddStarClip()},.5),o.playAnimation("\u5347\u661f",1)):(o.once(dragonBones.EventObject.COMPLETE,function(){t.refreshLevel(t.level),t.addStar(),o.node.active=!1}),this.scheduleOnce(function(){p.default.gameAudio.playAddStarClip()},.5),o.playAnimation("\u5347\u661f",1))}else this.count>0&&this.level>=0?(this.isEffect=!0,t.videoBtn.interactable=!1,t.cancelBtn.interactable=!1,this.count--,this.level++,t.refreshLevel(t.level),p.default.gameAudio.playAddStarClip(),this.isAddStar&&(c.default.uiCenter.showUi(this.getCurrencyNode).getComponent(h.default).setData(0,10,0),this.isAddStar=!1),t.addStar()):(this.isEffect=!1,this.videoBtn.interactable=!this.isVideo,this.cancelBtn.interactable=!0)},e.prototype.subStar=function(){var t=this,e=this,o=u.default.getRankLevel(this.level);if(this.count<0&&this.level>0&&o.rankLevel!==u.default.MaxRankLevel){this.isEffect=!0,this.videoBtn.interactable=!1,this.cancelBtn.interactable=!1,cc.log("===================1"),this.count++,this.level--;var i=this.star;this.level%3==0?(i.node.setPosition(cc.v2(this.levelView.stars.children[0])),i.once(dragonBones.EventObject.COMPLETE,function(){e.refreshLevel(e.level),t.subStar(),i.node.active=!1}),this.scheduleOnce(function(){p.default.gameAudio.playReduceStar()},.5),i.node.active=!0,i.playAnimation("\u964d\u661f",1)):this.level%3==2?(i.node.setPosition(cc.v2(this.levelView.stars.children[2])),this.levelView.down(function(){e.refreshLevel(e.level),e.scheduleOnce(function(){t.scheduleOnce(function(){p.default.gameAudio.playReduceStar()},1),i.once(dragonBones.EventObject.COMPLETE,function(){e.refreshLevel(e.level),e.subStar(),i.node.active=!1}),i.node.active=!0,i.playAnimation("\u964d\u661f",1)},1)})):(i.node.setPosition(cc.v2(this.levelView.stars.children[1])),i.once(dragonBones.EventObject.COMPLETE,function(){t.refreshLevel(t.level),t.subStar(),i.node.active=!1}),this.scheduleOnce(function(){p.default.gameAudio.playReduceStar()},1),i.node.active=!0,i.playAnimation("\u964d\u661f",1))}else this.count<0&&this.level>0?(cc.log("===================2"),p.default.gameAudio.playReduceStar(),this.isEffect=!0,this.videoBtn.interactable=!1,this.cancelBtn.interactable=!1,this.count++,this.level--,e.refreshLevel(e.level),this.subStar()):(cc.log("===================3"),this.isEffect=!1,this.videoBtn.interactable=!this.isVideo,this.cancelBtn.interactable=!0)},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){m.default.getInstance().quitGame()},e.prototype.onClickVideo=function(t){this.isEffect||t.target.getComponent(r.default).onClick(t)},e.prototype.onClickShare=function(){this.callback()},e.prototype.onClickBack=function(){var t=this;this.isEffect||this.scheduleOnce(function(){p.default.uiCenter.showUi(t.accAwardPrefab).getComponent(y.default).init()},.3)},e.prototype.callback=function(){if(this.isVideo)this.videoBtn&&(this.videoBtn.interactable=!1);else if(this.isVideo=!0,this.videoBtn&&(this.videoBtn.interactable=!1),u.default.getRankLevel(this.level).rankLevel!==u.default.MaxRankLevel){this.count=1,u.default.level+=this.count;var t=u.default.getRankLevel(u.default.level).rankLevel;u.default.maxLevel<t&&(u.default.maxLevel=t,this.isUpgrade=!0),cc.log("\u52a0\u661f\u540e\u662f\u5426\u5347\u6bb5\u4f4d\uff1a",this.isUpgrade,u.default.level),this.updateStar()}else this.count=1,u.default.level+=this.count,u.default.maxStar<u.default.level&&(u.default.maxStar=u.default.level,this.isAddStar=!0),this.updateStar()},a([S(cc.Button)],e.prototype,"videoBtn",void 0),a([S(cc.Button)],e.prototype,"cancelBtn",void 0),a([S(cc.Label)],e.prototype,"rankLabel",void 0),a([S(cc.Label)],e.prototype,"rankNum",void 0),a([S(cc.Label)],e.prototype,"addLabel",void 0),a([S(cc.Sprite)],e.prototype,"nextLabelSprite",void 0),a([S(g.default)],e.prototype,"accLevelAwardNode",void 0),a([S(dragonBones.ArmatureDisplay)],e.prototype,"star",void 0),a([S(f.default)],e.prototype,"levelView",void 0),a([S(cc.Label)],e.prototype,"nextStarAwardLabel",void 0),a([S(cc.Label)],e.prototype,"starNumLabel",void 0),a([S(cc.Node)],e.prototype,"maxDwNode",void 0),a([S(cc.Prefab)],e.prototype,"dwAwardPrefab",void 0),a([S(cc.Prefab)],e.prototype,"accAwardPrefab",void 0),a([S(cc.Prefab)],e.prototype,"getCurrencyNode",void 0),a([_],e)}(cc.Component);o.default=b,cc._RF.pop()},{"../../../../../InitScene/Script/center/GameInit":void 0,"../../../../../InitScene/Script/data/OtherData":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/PlayerData":void 0,"../../../../../InitScene/Script/data/RankModel":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../../../MainScene/Script/ui/main/GetCurrencyNode":"GetCurrencyNode","../../../../../MainScene/Script/ui/prefabs/view/LevelView":"LevelView","../../../../../framework/Script/prefab/AwardButton":void 0,"../../../manage/GameManage":"GameManage","./AccountAwardNode":"AccountAwardNode","./AccountLevelAwardNode":"AccountLevelAwardNode"}],AccountView:[function(t,e,o){"use strict";cc._RF.push(e,"68833qNj4BCVaUIGYrH/9R/","AccountView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../../../InitScene/Script/data/PlayerData"),l=t("../../../../InitScene/Script/data/RankModel"),d=t("../../../../MainScene/Script/center/Game"),u=t("../../../../MainScene/Script/ui/prefabs/view/LevelView"),p=t("../../../../MainScene/Script/ui/rank/AscendingNode"),h=t("../../manage/GameManage"),f=t("../base/PrefabView"),m=cc._decorator,y=m.ccclass,g=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoBtn=null,e.rankLabel=null,e.rankNum=null,e.addLabel=null,e.labelSprite=null,e.nextAwardLabel=null,e.star=null,e.coinLabel=null,e.levelView=null,e.diamondLabel=null,e.dwAward=null,e.dwAwardPrefab=null,e.model=null,e.count=0,e.level=0,e.isUpgrade=!1,e.diamond=0,e.money=0,e.isEffect=!1,e.isNext=!1,e}return n(e,t),e.prototype.onLoad=function(){s.default.playcount++},e.prototype.onClickNext=function(){this.isEffect||(!s.default.isAccount&&d.default.showToast("\u606d\u559c\u83b7\u5f97"+this.money+"\u91d1\u5e01\uff0c"+this.diamond+"\u94bb\u77f3"),d.default.sceneCenter.runScene("MainScene"))},e.prototype.onClickBack=function(){d.default.sceneCenter.runScene("MainScene")},e.prototype.onClickRecorder=function(){},e.prototype.callback=function(){if(this.videoBtn&&(this.videoBtn.interactable=!1),l.default.level<l.default.totalStar){this.count=1,l.default.level+=this.count;var t=l.default.getRankLevel(l.default.level).rankLevel;l.default.maxLevel<t&&(l.default.maxLevel=t,this.isUpgrade=!0),this.updateStar()}},e.prototype.init=function(t){this.model=t,cc.log("this.model",this.model),this.level=l.default.level,this.updateValue(this.model),c.default.totalDiamondNum+=this.diamond,c.default.totalCoinNum+=this.money},e.prototype.refreshLevel=function(t){this.levelView&&this.levelView.refresh(t),l.default.maxLevel>=Math.floor(l.default.totalStar/l.MaxStar)?this.dwAward.active=!1:(this.nextAwardLabel.string=l.default.getRankData(l.default.maxLevel+1).award+"",r.default.addLoaderSprite(this.labelSprite).loadSprite("mainSceneRes/rank/text/"+(l.default.maxLevel+1)))},e.prototype.refresh=function(){if(this.model){var t=this.model.rank;this.rankNum.string=""+(t+1),this.rankLabel.string="\u7b2c"+(t+1)+"\u540d",this.refreshLevel(this.level),this.updateStar()}},e.prototype.updateValue=function(t){switch(s.default.killNum+=t.kill_count,t.rank){case 0:this.addLabel.string="\u52a0\u4e00\u661f",this.count=1,l.default.seasonWin+=1,s.default.winNum+=1;break;case 1:case 2:this.addLabel.string="\u51cf\u4e00\u661f",this.count=-1;break;case 3:default:this.addLabel.string="\u51cf\u4e00\u661f",this.count=-1}l.default.level>l.default.totalStar?l.default.level=l.default.totalStar:l.default.level<0&&(l.default.level=0),l.default.level+this.count>=0&&l.default.level+this.count<=l.default.totalStar&&(l.default.level+=this.count,l.default.maxLevel<l.default.getRankLevel(l.default.level).rankLevel&&(l.default.maxLevel=l.default.getRankLevel(l.default.level).rankLevel,this.isUpgrade=!0)),this.count>0?(l.default.win++,l.default.lose=0,this.money=150,this.diamond=20):(l.default.lose++,l.default.win=0,this.money=50,this.diamond=5),this.coinLabel.string=this.money+"",this.diamondLabel.string=this.diamond+"",cc.log("coinLabel",this.money,this.count)},e.prototype.updateStar=function(){this.count>0?this.addStar():this.count<0?this.subStar():this.isEffect=!1},e.prototype.addStar=function(){var t=this;if(this.count>0&&this.level>=0&&this.level<l.default.totalStar){this.isEffect=!0,this.count--,this.level++,d.default.gameAudio.playAddStarClip();var e=cc.instantiate(this.star);e.setPosition(cc.v2(this.levelView.stars.children[(this.level-1)%3].convertToWorldSpaceAR(cc.Vec2.ZERO)).add(cc.v2(0,200))),e.parent=cc.director.getScene(),e.scale=30*e.scale,e.opacity=0,e.runAction(cc.sequence(cc.spawn(cc.moveBy(.5,cc.v2(0,-200)),cc.fadeIn(.5),cc.scaleTo(.5,1.5)),cc.callFunc(function(){if(e.destroy(),t.level%3==0){var o=l.default.getRankLevel(l.default.level);r.default.addLoaderSprite(t.labelSprite).loadSprite("mainSceneRes/rank/text/"+(o.rankLevel-1),cc.SpriteFrame),t.levelView.refreshStar(3),t.isUpgrade&&(d.default.uiCenter.showUi(t.dwAwardPrefab).getComponent(p.default).setData(l.default.maxLevel),t.isUpgrade=!1),t.addStar(),t.scheduleOnce(function(){t.refreshLevel(t.level)},2)}else t.refreshLevel(t.level),t.addStar()})))}else this.isEffect=!1},e.prototype.subStar=function(){this.count<0&&this.level>0?(this.isEffect=!0,this.count++,this.level--,this.level%3==2?(d.default.gameAudio.playReduceStar(),l.default.maxLevel>=Math.floor(l.default.totalStar/l.MaxStar)?this.dwAward.active=!1:(this.nextAwardLabel.string=l.default.getRankData(l.default.maxLevel+1).award+"",r.default.addLoaderSprite(this.labelSprite).loadSprite("mainSceneRes/rank/text/"+(l.default.maxLevel+1))),this.refreshLevel(this.level),this.subStar()):(this.refreshLevel(this.level),this.subStar())):this.isEffect=!1},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){h.default.getInstance().quitGame(),t.prototype.onDisable.call(this)},e.prototype.onClickVideo=function(){this.callback()},e.prototype.onClickShare=function(){this.callback()},e.prototype.start=function(){},a([g(cc.Button)],e.prototype,"videoBtn",void 0),a([g(cc.Label)],e.prototype,"rankLabel",void 0),a([g(cc.Label)],e.prototype,"rankNum",void 0),a([g(cc.Label)],e.prototype,"addLabel",void 0),a([g(cc.Sprite)],e.prototype,"labelSprite",void 0),a([g(cc.Label)],e.prototype,"nextAwardLabel",void 0),a([g(cc.Node)],e.prototype,"star",void 0),a([g(cc.Label)],e.prototype,"coinLabel",void 0),a([g(u.default)],e.prototype,"levelView",void 0),a([g(cc.Label)],e.prototype,"diamondLabel",void 0),a([g(cc.Node)],e.prototype,"dwAward",void 0),a([g(cc.Prefab)],e.prototype,"dwAwardPrefab",void 0),a([y],e)}(f.default);o.default=v,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/PlayerData":void 0,"../../../../InitScene/Script/data/RankModel":void 0,"../../../../MainScene/Script/center/Game":"Game","../../../../MainScene/Script/ui/prefabs/view/LevelView":"LevelView","../../../../MainScene/Script/ui/rank/AscendingNode":"AscendingNode","../../../../framework/Script/component/LoaderSprite":void 0,"../../manage/GameManage":"GameManage","../base/PrefabView":"PrefabView"}],ActivityDiamondNode:[function(t,e,o){"use strict";cc._RF.push(e,"2289eu1dZ5A0LvqgAY1+dBL","ActivityDiamondNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/ActivityModel"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoLabel=null,e.tipsText=null,e}return n(e,t),e.prototype.start=function(){s.default.gameAudio.playWindow(),this.tipsText.string=this.tipsText.string.replace("X","\u94bb\u77f3"+r.default.eggGetDiamond),this.updateUI()},e.prototype.videoSuccess=function(){r.default.eggGetDiamondTime++,this.updateUI(),r.default.eggGetDiamondTime>=r.default.eggGetDiamondVideo&&(c.default.totalDiamondNum+=r.default.eggGetDiamond,s.default.showCurrency(0,r.default.eggGetDiamond),this.onClose())},e.prototype.updateUI=function(){this.videoLabel.string="("+r.default.eggGetDiamondTime+"/"+r.default.eggGetDiamondVideo+")"},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},a([u(cc.Label)],e.prototype,"videoLabel",void 0),a([u(cc.RichText)],e.prototype,"tipsText",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../center/Game":"Game"}],ActivityDwGunNode:[function(t,e,o){"use strict";cc._RF.push(e,"ce23dWGwX9Kaat1+rJ4riq2","ActivityDwGunNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/GunModel"),d=t("../../../../InitScene/Script/data/PlayerData"),u=t("../../center/Game"),p=t("../prefabs/getGun/GetGun"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.gunIcon=null,e.id=0,e}return n(e,t),e.prototype.start=function(){u.default.gameAudio.playWindow(),this.id=c.default.activityDwGunID;var t="gun/"+c.default.activityDwGunID;l.default.getGunDataById(this.id).isWeekup&&(t="gun/wakeup/"+this.id),r.default.addLoaderSprite(this.gunIcon).loadSprite(t),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){if(c.default.gunDwVideoTime++,this.updateUI(),c.default.gunDwVideoTime>=c.default.activityDwGunVideo){var t=d.default.UIManager.getPnl("start");l.default.getGunDataById(this.id).isUnlock||(l.default.getGunDataById(this.id).onUnlock(),u.default.uiCenter.showUi("getGun").getComponent(p.default).setData(this.id,!0));var e=t.boxs.filter(function(t){return null==t.item&&null==t.equip});if(e.length>0)t.appendItem(this.id,e[0]),t.updateMatrix(),u.default.gameDataCenter.saveData();else{var o=l.default.getSale(this.id);s.default.totalCoinNum+=o,u.default.showCurrency(o)}l.default.useGunId=c.default.activityDwGunID,this.onClose(),c.default.emit(c.ActivityType.GET_GUN_DW_0501)}},e.prototype.updateUI=function(){this.label.string="("+c.default.gunDwVideoTime+"/"+c.default.activityDwGunVideo+")"},a([m(cc.Label)],e.prototype,"label",void 0),a([m(cc.Sprite)],e.prototype,"gunIcon",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/PlayerData":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","../prefabs/getGun/GetGun":"GetGun"}],ActivityGunNode:[function(t,e,o){"use strict";cc._RF.push(e,"9ec7dBB2SZKbr/eEWEPICuE","ActivityGunNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/GunModel"),d=t("../../../../InitScene/Script/data/PlayerData"),u=t("../../center/Game"),p=t("../prefabs/getGun/GetGun"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.gunIcon=null,e.id=0,e}return n(e,t),e.prototype.start=function(){u.default.gameAudio.playWindow(),this.id=c.default.activityGunID;var t="gun/"+c.default.activityGunID;l.default.getGunDataById(this.id).isWeekup&&(t="gun/wakeup/"+this.id),r.default.addLoaderSprite(this.gunIcon).loadSprite(t),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){if(c.default.gunVideoTime++,this.updateUI(),c.default.gunVideoTime>=c.default.activityGunVideo){var t=d.default.UIManager.getPnl("start");l.default.getGunDataById(this.id).isUnlock||(l.default.getGunDataById(this.id).onUnlock(),u.default.uiCenter.showUi("getGun").getComponent(p.default).setData(this.id,!0));var e=t.boxs.filter(function(t){return null==t.item&&null==t.equip});if(e.length>0)t.appendItem(this.id,e[0]),t.updateMatrix();else{var o=l.default.getSale(this.id);s.default.totalCoinNum+=o,u.default.showCurrency(o)}l.default.useGunId=c.default.activityGunID,this.onClose()}},e.prototype.updateUI=function(){this.label.string="("+c.default.gunVideoTime+"/"+c.default.activityGunVideo+")"},a([m(cc.Label)],e.prototype,"label",void 0),a([m(cc.Sprite)],e.prototype,"gunIcon",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/PlayerData":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","../prefabs/getGun/GetGun":"GetGun"}],ActivityHeroMCZZNode:[function(t,e,o){"use strict";cc._RF.push(e,"5ade6oKwwJN4JWBIK2/l93T","ActivityHeroMCZZNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../InitScene/Script/data/PersonModel"),s=t("../../center/Game"),l=t("../cultivate/GetCultivateNode"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.hero=null,e.id=0,e.data=null,e}return n(e,t),e.prototype.start=function(){var t=this;this.id=5,this.data=c.default.getHeroDataById(this.id),s.default.gameAudio.playWindow();var e="hero/dragon/"+c.default.getHeroDataById(this.id).skeUrl;r.default.addLoaderDragonBones(this.hero).loadArmature(e,function(){t.hero.node.active=!0,t.hero.armatureName="armatureName",t.hero.playAnimation("\u5f85\u673a",0)}),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){this.data.videoCount++,this.updateUI(),this.data.videoCount>=this.data.video&&(this.data.onUnlock(),s.default.uiCenter.showUi("GetCultivateNode").getComponent(l.default).setData("hero","hero/dragon/"+this.data.skeUrl,"\u5f85\u673a",this.data.award),c.default.useHeroId=this.id,this.onClose())},e.prototype.updateUI=function(){this.label.string="("+this.data.videoCount+"/"+this.data.video+")"},a([p(cc.Label)],e.prototype,"label",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"hero",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"../../center/Game":"Game","../cultivate/GetCultivateNode":"GetCultivateNode"}],ActivityHeroNode:[function(t,e,o){"use strict";cc._RF.push(e,"0bc3dP2GdhMU5SgcKGdVTjh","ActivityHeroNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/PersonModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.hero=null,e.id=0,e}return n(e,t),e.prototype.start=function(){var t=this;l.default.gameAudio.playWindow(),this.id=c.default.invincibleHeroID;var e="hero/dragon/"+s.default.getHeroDataById(this.id).skeUrl;r.default.addLoaderDragonBones(this.hero).loadArmature(e,function(){t.hero.node.active=!0,t.hero.armatureName="armatureName",t.hero.playAnimation("\u5f85\u673a",0)}),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){c.default.heroVideoTime++,this.updateUI(),c.default.heroVideoTime>=c.default.invincibleHeroVideo&&(c.default.invincibleTime=c.default.invincibleHeroTime,s.default.useHeroId=this.id,c.default.heroVideoTime=0,l.default.showToast("\u606d\u559c\u83b7\u5f97\u4e0d\u6b7b\u91d1\u8eab\u4f7f\u7528\u6b21\u6570"+c.default.invincibleHeroTime+"\u6b21"),this.onClose())},e.prototype.updateUI=function(){this.label.string="("+c.default.heroVideoTime+"/"+c.default.invincibleHeroVideo+")"},a([p(cc.Label)],e.prototype,"label",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"hero",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"../../center/Game":"Game"}],ActivityHeroWakeNode:[function(t,e,o){"use strict";cc._RF.push(e,"0a195bTI0BJubIodNwbH0Ej","ActivityHeroWakeNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/PersonModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.hero=null,e.id=0,e}return n(e,t),e.prototype.start=function(){var t=this;l.default.gameAudio.playWindow(),this.id=c.default.wakeupHeroID;var e="hero/wakeup/hero"+c.default.wakeupHeroID;r.default.addLoaderDragonBones(this.hero).loadArmature(e,function(){t.hero.node.active=!0,t.hero.armatureName="Armature",t.hero.playAnimation("\u5f85\u673a",0)}),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){c.default.wakeupHeroVideoTime++,this.updateUI(),c.default.wakeupHeroVideoTime>=c.default.wakeupHeroVideo&&(s.default.useHeroId=this.id,this.onClose())},e.prototype.updateUI=function(){this.label.string="("+c.default.wakeupHeroVideoTime+"/"+c.default.wakeupHeroVideo+")"},a([p(cc.Label)],e.prototype,"label",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"hero",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"../../center/Game":"Game"}],ActivityMountJDLNode:[function(t,e,o){"use strict";cc._RF.push(e,"96f77Z7QFdA26S4GlmJ9TBs","ActivityMountJDLNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/MountModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.mount=null,e.id=0,e}return n(e,t),e.prototype.start=function(){var t=this;l.default.gameAudio.playWindow(),this.id=c.default.mountJDLwakeupID;var e=s.default.getMountSkeUrl(this.id,51);r.default.addLoaderDragonBones(this.mount).loadArmature(e,function(){t.mount.node.active=!0,t.mount.armatureName="Armature",t.mount.playAnimation("\u5f85\u673a",0)}),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){c.default.wakeupMountFarmVideoTime++,this.updateUI(),c.default.wakeupMountFarmVideoTime>=c.default.mountJDLwakeupVideo&&(s.default.getMountDataById(this.id).level=51,s.default.useMountId=this.id,this.onClose())},e.prototype.updateUI=function(){this.label.string="("+c.default.wakeupMountFarmVideoTime+"/"+c.default.mountJDLwakeupVideo+")"},a([p(cc.Label)],e.prototype,"label",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"mount",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"../../center/Game":"Game"}],ActivityMountNode:[function(t,e,o){"use strict";cc._RF.push(e,"4d51a0zxrJBIKbmgAgQkRJ1","ActivityMountNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/MountModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.mount=null,e.id=0,e}return n(e,t),e.prototype.start=function(){var t=this;l.default.gameAudio.playWindow(),this.id=c.default.mountTSLwakeupID;var e=s.default.getMountSkeUrl(this.id,51);r.default.addLoaderDragonBones(this.mount).loadArmature(e,function(){t.mount.node.active=!0,t.mount.armatureName="Armature",t.mount.playAnimation("\u5f85\u673a",0)}),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){c.default.wakeupMountVideoTime++,this.updateUI(),c.default.wakeupMountVideoTime>=c.default.mountTSLwakeupVideo&&(s.default.getMountDataById(this.id).level=51,s.default.useMountId=this.id,l.default.showToast("\u606d\u559c\u83b7\u5f97\u7ea2\u83b2T\u5636\u62c9\uff01"),this.onClose())},e.prototype.updateUI=function(){this.label.string="("+c.default.wakeupMountVideoTime+"/"+c.default.mountTSLwakeupVideo+")"},a([p(cc.Label)],e.prototype,"label",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"mount",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"../../center/Game":"Game"}],ActivityXzGunNode:[function(t,e,o){"use strict";cc._RF.push(e,"f39b8PBWXJITK67Lbix9rtb","ActivityXzGunNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/GunModel"),d=t("../../../../InitScene/Script/data/PlayerData"),u=t("../../center/Game"),p=t("../prefabs/getGun/GetGun"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.gunIcon=null,e.id=0,e}return n(e,t),e.prototype.start=function(){u.default.gameAudio.playWindow(),this.id=c.default.difficultXzGunID;var t="gun/"+this.id;l.default.getGunDataById(this.id).isWeekup&&(t="gun/wakeup/"+this.id),r.default.addLoaderSprite(this.gunIcon).loadSprite(t),this.updateUI()},e.prototype.onClose=function(){this.node.emit("onClose"),this.node.destroy()},e.prototype.videoSuccess=function(){if(c.default.gunXzVideoTime++,this.updateUI(),c.default.isGetDifficultGun){var t=d.default.UIManager.getPnl("start");l.default.getGunDataById(this.id).isUnlock||(l.default.getGunDataById(this.id).onUnlock(),u.default.uiCenter.showUi("getGun").getComponent(p.default).setData(this.id,!0));var e=t.boxs.filter(function(t){return null==t.item&&null==t.equip});if(e.length>0)t.appendItem(this.id,e[0]),t.updateMatrix(),u.default.gameDataCenter.saveData();else{var o=l.default.getSale(this.id);s.default.totalCoinNum+=o,u.default.showCurrency(o)}l.default.useGunId=this.id,this.onClose(),c.default.emit(c.ActivityType.GET_GUN_XZ)}},e.prototype.updateUI=function(){this.label.string="("+c.default.gunXzVideoTime+"/"+c.default.difficultXzGunVideo+")"},a([m(cc.Label)],e.prototype,"label",void 0),a([m(cc.Sprite)],e.prototype,"gunIcon",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/PlayerData":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","../prefabs/getGun/GetGun":"GetGun"}],AddHpCircle:[function(t,e,o){"use strict";cc._RF.push(e,"7b9fbXb8axH6Jp+whKcqeCw","AddHpCircle");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/OtherData"),c=t("../../manage/GameManage"),s=cc._decorator,l=s.ccclass,d=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameView=null,e.isGet=!1,e.circle_rect=null,e}return n(e,t),e.prototype.start=function(){this.gameView=c.default.getInstance().gameView,this.circle_rect=this.node.getBoundingBox()},e.prototype.addHp=function(t){if(t.isHpCircle){var e=Math.floor(t.model.MAX_HP*(r.default.hpCircle/100));t.addHP(e)}},e.prototype.update=function(){if(!(c.default.getInstance().state>=c.GameState.\u6218\u6597\u7ed3\u675f)){var t=this;this.gameView.targets.forEach(function(e){if(!e.model.isDead()&&e.isHpCircle){var o=e.node.getBoundingBox();o.width/=2;var i=new cc.Rect;t.circle_rect.intersection(i,o),i.width>=o.width/3&&i.height>=o.height/2&&(t.addHp(e),e.isHpCircle=!1,t.scheduleOnce(function(){e.isHpCircle=!0},1))}})}},a([l],e)}(cc.Component));o.default=d,cc._RF.pop()},{"../../../../InitScene/Script/data/OtherData":void 0,"../../manage/GameManage":"GameManage"}],AddHpView:[function(t,e,o){"use strict";cc._RF.push(e,"0d8bbVqZClAIIwKk6Fl2jkU","AddHpView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.addlabel=null,e}return n(e,t),e.prototype.init=function(t){cc.log("hp",t),this.addlabel.string="/"+t},a([s(cc.Label)],e.prototype,"addlabel",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],AirBoxNode:[function(t,e,o){"use strict";cc._RF.push(e,"3881dEOaexI5Lw50aHQTpQN","AirBoxNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.BoxType=void 0;var r,c=t("../../../../InitScene/Script/data/OtherData"),s=t("../../../../MainScene/Script/center/Game"),l=t("../../manage/GameManage"),d=cc._decorator,u=d.ccclass,p=d.property;(function(t){t[t.SKILL=0]="SKILL",t[t.HP=1]="HP"})(r=o.BoxType||(o.BoxType={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e.gameView=null,e.isGet=!1,e.isFloor=!1,e.box_rect=null,e}return n(e,t),e.prototype.start=function(){this.gameView=l.default.getInstance().gameView},e.prototype.floor=function(){this.isFloor=!0,this.node.getChildByName("box").runAction(cc.sequence(cc.scaleTo(.4,1.1,.9),cc.scaleTo(.2,1,1))),this.box_rect=this.node.getBoundingBox()},e.prototype.getBox=function(t){var e=this;if(!this.isGet&&this.isFloor){switch(this.type){case r.SKILL:t.airSkillTimes++;break;case r.HP:var o=Math.floor(t.model.MAX_HP*(c.default.hpBox/100));cc.log("\u56de\u8840"),t.addHP(o)}s.default.gameAudio.playAirBoxClip();var i=this.node.position.y,n=cc.tween(this.node);n.to(.3,{scaleX:1.15,scaleY:.85}).to(.4,{scaleX:.9,scaleY:1.1,position:cc.v3(this.node.position.x,i+30,0)}).to(.3,{scaleX:1,scaleY:1,position:cc.v3(this.node.position.x,i,0)}).call(function(){e.gameView.disappearBoxShadow()}).to(.5,{opacity:0}).call(function(){e.node.destroy()}),n.start()}},e.prototype.update=function(){if(!this.isGet&&this.isFloor){var t=this;this.gameView.targets.forEach(function(e){if(e.model.HP>0&&0==e.model.group){var o=e.node.getBoundingBox();o.width/=2;var i=new cc.Rect;if(t.box_rect.intersection(i,o),i.width>0&&i.height>0)return t.getBox(e),void(t.isGet=!0)}})}},a([p({type:cc.Enum(r)})],e.prototype,"type",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/OtherData":void 0,"../../../../MainScene/Script/center/Game":"Game","../../manage/GameManage":"GameManage"}],AirSkillView:[function(t,e,o){"use strict";cc._RF.push(e,"4d1b4g1KCRBlq/inFgNhHb7","AirSkillView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=t("../../manage/GameManage"),d=t("../../BasePlayer"),u=t("../../test/EditView"),p=t("./GameBlock"),h=t("../../../../MainScene/Script/center/Game"),f=t("../model/SkillModel"),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skill=null,e.gameView=null,e.model=new f.default,e.isDestory=!1,e.isFollow=!1,e.target=null,e}return n(e,t),e.prototype.onLoad=function(){this.gameView=l.default.getInstance().gameView},e.prototype.start=function(){},e.prototype.setModel=function(t,e){this.model.group=t.model.group,this.model.ATK=t.model.ATK,this.model.CRI=t.model.CRI,this.model.RAN=t.model.RAN,this.model.type=t.model.type,this.model.pos=t.node.getPosition(),this.model.player=t,this.model.mount=e},e.prototype.init=function(t,e){var o=this;this.reset(),this.setModel(t,e),this.skill.playAnimation("A",1),h.default.gameAudio.playAirSkill(),this.doSkill(),this.skill.once(dragonBones.EventObject.COMPLETE,function(){o.doDestory(),o.node.active=!1})},e.prototype.reset=function(){this.isFollow=!1,this.isDestory=!1,this.model.reset()},e.prototype.doSkill=function(){var t=this,e=this,o=new Map,i=this.gameView.layout.width,n=this.node.getPosition(),a=this.gameView.layout.getBoundingBox();this.scheduleOnce(function(){t.gameView.quadTree.retrieve(a).forEach(function(t){o.has(t.node.uuid)||t.type!=u.ItemType.BOX&&t.type!=u.ItemType.CN||o.set(t.node.uuid,t.node)}),Array.from(o.values()).forEach(function(t){if(t){var o=t.getComponent(p.default);e.scheduleOnce(function(){o&&o.hurt(e.model)},.5)}})},.5),this.gameView.targets.forEach(function(t){if(t&&t.checkTarget(t)&&t.model.group!=e.model.group){var o=t.node.getPosition().sub(n);o.mag()<i&&t.hurtByAirSkill(e.model),cc.log("\u9668\u77f3\u653b\u51fb",o.mag(),i)}})},e.prototype.check=function(t){var e=this,o=[],i=this.checkBlock(t),n=this.checkTargets(t);if((o=o.concat(i.map(function(t){return{type:"block",item:t}})).concat(n.map(function(t){return{type:"target",item:t}})).sort(function(t,o){return t.item.node.getPosition().sub(e.node.getPosition()).mag()-o.item.node.getPosition().sub(e.node.getPosition()).mag()})).length>0)for(var a=o.length,r=0;r<a;r++)switch(o[r].type){case"block":return this.hintBlock(o[r].item);case"target":return this.hintTarget(o[r].item)}return!1},e.prototype.checkBlock=function(t,e){return void 0===e&&(e=this.gameView.layout.getBoundingBox()),this.checkCustom(e,t)},e.prototype.checkCustom=function(t,e){var o=this;return this.gameView.quadTree.retrieve(t).filter(function(i){return o.gameView.nameList.indexOf(i.node.name)>-1&&(i.type==u.ItemType.BOX||i.type==u.ItemType.CN)&&(cc.Intersection.lineRect(o.node.getPosition(),o.node.getPosition().add(o.model.speed.mul(e)),i.rect)||cc.v2(t.x,t.y).sub(cc.v2(i.rect.x,i.rect.y)).mag()<=t.width/2+i.rect.width/2)})},e.prototype.checkTargets=function(t,e){var o=this;void 0===e&&(e=this.gameView.map.getBoundingBox());var i=cc.v2((e.xMin+e.xMax)/2,(e.yMin+e.yMax)/2);return this.gameView.targets.filter(function(n){if(n.checkTarget(n)&&n.model.group!=o.model.group){var a=n.node.getBoundingBox();return a.x+=10,a.y+=n.dragon.node.y+50,a.width+=10,a.height+=50,cc.Intersection.lineRect(i,i.add(o.model.speed.mul(t)),a)||i.sub(cc.v2(a.x,a.y)).mag()<=a.width/2+e.width/2}return!1})},e.prototype.clear=function(){this.target=null,this.node.removeAllChildren(),this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.gameView.putArm(this.node)},e.prototype.doDestory=function(){this.isDestory||(this.isDestory=!0,this.unscheduleAllCallbacks())},e.prototype.doFollow=function(){var t=this;this.schedule(function(){t.target&&t.target.node&&t.target.node.active?t.model.speed=t.target.node.getPosition().sub(t.node.getPosition()).normalizeSelf().mul(1500):t.findTarget(cc.rect(t.node.x-40,t.node.y-40,80,80))},.1)},e.prototype.lineRect=function(t,e,o){var i=t.add(e),n=e.mag(),a=cc.v2((o.x+o.xMax)/2,(o.y+o.yMax)/2);if(Math.abs(a.x-t.x)<=o.width/2+n&&Math.abs(a.y-t.y)<=o.height/2+n&&(Math.abs(a.x-t.x)>o.width/2||Math.abs(a.y-t.y)>o.height/2)){var r=cc.v2(o.x,o.y),c=cc.v2(o.x,o.yMax),s=cc.v2(o.xMax,o.yMax),l=cc.v2(o.xMax,o.y),d=[];return cc.Intersection.lineLine(t,i,r,c)&&d.push({i:0,d:r.sub(t).mag()+c.sub(t).mag()}),cc.Intersection.lineLine(t,i,c,s)&&d.push({i:1,d:c.sub(t).mag()+s.sub(t).mag()}),cc.Intersection.lineLine(t,i,s,l)&&d.push({i:2,d:s.sub(t).mag()+l.sub(t).mag()}),cc.Intersection.lineLine(t,i,l,r)&&d.push({i:3,d:l.sub(t).mag()+r.sub(t).mag()}),d.length>0?(d.sort(function(t,e){return t.d-e.d}),d[0].i):-2}return Math.abs(a.x-t.x)<o.width/2&&Math.abs(a.y-t.y)<o.height/2?-1:-2},e.prototype.findTarget=function(t){if(void 0===t&&(t=this.node.getBoundingBox()),this.model.player){var e=this.model.player;if(e.checkTarget(e)&&e.target&&e.target.node.getPosition().sub(e.node.getPosition()).mag()<e.model.RAN)return this.target=e.target,void(this.model.speed=e.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV));var o=this.gameView.targets.filter(function(t){return t.model.group!=e.model.group&&t.checkTarget(t)}).sort(function(t,o){return t.node.getPosition().sub(e.node.getPosition()).mag()-o.node.getPosition().sub(e.node.getPosition()).mag()});if(o.length>0&&o[0].node.getPosition().sub(e.node.getPosition()).mag()<e.model.RAN)return this.target=o[0],void(this.model.speed=this.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV));var i=new Map,n=this;this.gameView.quadTree.retrieve(t).forEach(function(t){i.has(t.node.uuid)||n.gameView.nameList.indexOf(t.node.name)>-1||t.type!=u.ItemType.BOX&&t.type!=u.ItemType.CN||i.set(t.node.uuid,t.node)});var a=Array.from(i.values()).sort(function(t,o){return t.getPosition().sub(e.node.getPosition()).mag()-o.getPosition().sub(e.node.getPosition()).mag()});a.length>0&&a[0].getPosition().sub(this.node.getPosition()).mag()<320&&(this.target=a[0],this.model.speed=this.target.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV))}},e.prototype.update=function(){},e.prototype.hintBlock=function(t){if(t.type==u.ItemType.BOX||t.type==u.ItemType.CN){var e=t.node.getComponent(p.default);e&&e.hurt(this.model)}},e.prototype.hintTarget=function(t){var e=t.getComponent(d.default);e&&e.checkTarget(e)&&e.hurtByAirSkill(this.model)},e.prototype.getRectByVec=function(t,e,o){var i,n,a,r,c,s,l;return o>0?(s=t.add(e.rotate(cc.misc.degreesToRadians(o))),l=t.add(e.rotate(cc.misc.degreesToRadians(-o))),i=t.add(e),c=Math.min(t.x,s.x,l.x,i.x),n=Math.min(t.y,s.y,l.y,i.y),c==(a=Math.max(t.x,s.x,l.x,i.x))&&(a+=1),n==(r=Math.max(t.y,s.y,l.y,i.y))&&(r+=1),cc.rect(c,n,a-c,r-n)):(i=t.add(e),c=Math.min(t.x,i.x),n=Math.min(t.y,i.y),c==(a=Math.max(t.x,i.x))&&(a+=1),n==(r=Math.max(t.y,i.y))&&(r+=1),cc.rect(c,n,a-c,r-n))},a([s(dragonBones.ArmatureDisplay)],e.prototype,"skill",void 0),a([c],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../MainScene/Script/center/Game":"Game","../../BasePlayer":"BasePlayer","../../manage/GameManage":"GameManage","../../test/EditView":"EditView","../model/SkillModel":"SkillModel","./GameBlock":"GameBlock"}],ArmModel:[function(t,e,o){"use strict";cc._RF.push(e,"282f1HIm6tKF7OXI6JvIT1/","ArmModel");var i=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../../../InitScene/Script/data/PlayerModel"),a=cc._decorator,r=a.ccclass,c=(a.property,function(){function t(){this.group=0,this.ATK=100,this.CRI=0,this.RAN=0,this.speed=cc.Vec2.ZERO,this.type=n.ArmType.\u6b63\u5e38,this.state=n.ArmState.\u6b63\u5e38,this.pos=cc.Vec2.ZERO,this.player=null,this.hurt_audio=0,this.mount=null}return t.prototype.reset=function(){this.speed=cc.Vec2.ZERO,this.type=n.ArmType.\u6b63\u5e38,this.state=n.ArmState.\u6b63\u5e38,this.player=null},i([r],t)}());o.default=c,cc._RF.pop()},{"../../../../InitScene/Script/data/PlayerModel":void 0}],ArmView:[function(t,e,o){"use strict";cc._RF.push(e,"0591eiCHA5DaqdBQ/sfnTpc","ArmView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../InitScene/Script/data/PlayerModel"),s=t("../../manage/GameManage"),l=t("../../BasePlayer"),d=t("../../test/EditView"),u=t("../model/ArmModel"),p=t("./GameBlock"),h=t("../../../../InitScene/Script/data/MountModel"),f=cc._decorator,m=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.hurt_ani=null,e.ani=null,e.skeleton=null,e.gameView=null,e.gametype=null,e.motionStreak=null,e.particle=null,e.model=new u.default,e.isDestory=!1,e.isFollow=!1,e.target=null,e.life=0,e.radius=240,e.bullet=null,e.bulletID=0,e.hurt=null,e.hurtID=0,e.hitArr=[],e.time=0,e.gra=null,e}return n(e,t),e.prototype.onLoad=function(){this.gameView=s.default.getInstance().gameView,this.gametype=s.default.getInstance().gameType},e.prototype.start=function(){},e.prototype.onEnable=function(){this.hitArr=[]},e.prototype.setModel=function(t){this.model.group=t.model.group,this.model.ATK=t.model.ATK,this.model.CRI=t.model.CRI,this.model.RAN=t.model.RAN,this.model.type=t.model.type,this.model.pos=t.node.getPosition(),this.model.player=t,this.model.mount=h.default.getMountDataById(t.mountIdx)},e.prototype.init=function(t,e){var o=this,i=this;switch(this.bulletID=t.model.bullet,this.hurtID=t.model.hit,this.model.hurt_audio=t.model.hurt_audio,t.model.type){case c.ArmType.\u6b63\u5e38:r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(i,n){if(o.reset(),o.setModel(t),o.model.speed=e.rotateSelf(cc.misc.degreesToRadians((Math.random()-.5)*t.model.ROT/2)).mul(t.model.MOV),o.scheduleOnce(o.doDestory,1.5*t.model.RAN/o.model.speed.mag()),o.isDestory)o.bullet&&o.bullet.destroy();else if(!i&&o.node.isValid){var a=cc.instantiate(n);o.node.addChild(a),o.bullet=a,a&&a.setPosition(cc.Vec2.ZERO)}});break;case c.ArmType.\u6563\u5c04:cc.log("player.model.MOV",t.model.MOV),this.reset(),this.setModel(t),this.model.speed=e.mul(t.model.MOV),this.doScatter(e);break;case c.ArmType.\u72d9\u51fb:case c.ArmType.\u8d2f\u7a7f:r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(n,a){if(o.reset(),o.setModel(t),!n&&o.node.isValid){var r=cc.instantiate(a);o.node.addChild(r),o.bullet=r,r&&r.setPosition(cc.Vec2.ZERO)}t.node&&t.node.active?(i.model.speed=e.rotateSelf(cc.misc.degreesToRadians((Math.random()-.5)*t.model.ROT/2)).mul(t.model.MOV),i.updateDir(e),i.scheduleOnce(i.doDestory,2)):i.isDestory||i.clear()});break;case c.ArmType.\u5bfc\u5f39:r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(i,n){if(o.reset(),o.setModel(t),o.model.speed=e.rotateSelf((Math.random()-.5)*Math.PI*t.model.ROT/360).mul(t.model.MOV),o.scheduleOnce(o.doActionDestory,1),o.isDestory)o.bullet&&o.bullet.destroy();else if(!i&&o.node.isValid){var a=cc.instantiate(n);o.node.addChild(a),o.bullet=a,a&&a.setPosition(cc.Vec2.ZERO)}});break;case c.ArmType.\u51b0\u51bb:Math.random()<.13?r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_bj",cc.Prefab,function(i,n){if(o.reset(),o.model.state=c.ArmState.\u51b0\u51bb,o.setModel(t),o.model.speed=e.rotateSelf((Math.random()-.5)*Math.PI*t.model.ROT/360).mul(t.model.MOV),o.scheduleOnce(o.doDestory,1),o.isDestory)o.bullet&&o.bullet.destroy();else if(!i&&o.node.isValid){var a=cc.instantiate(n);o.node.addChild(a),o.bullet=a,a&&a.setPosition(cc.Vec2.ZERO)}}):r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(i,n){if(o.reset(),o.setModel(t),o.model.speed=e.rotateSelf((Math.random()-.5)*Math.PI*t.model.ROT/360).mul(t.model.MOV),o.scheduleOnce(o.doDestory,1),o.isDestory)o.bullet&&o.bullet.destroy();else if(!i&&o.node.isValid){var a=cc.instantiate(n);o.node.addChild(a),o.bullet=a,a&&a.setPosition(cc.Vec2.ZERO)}});break;case c.ArmType.\u5200\u67aa:case c.ArmType.\u874e\u5b50\u653b\u51fb:this.reset(),this.setModel(t),this.model.speed=e.mul(t.model.MOV),this.doKnife(e);break;case c.ArmType.\u5c0f\u602a\u67aa\u51fb:r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(i,n){if(o.reset(),o.setModel(t),o.model.speed=e.rotateSelf(cc.misc.degreesToRadians((Math.random()-.5)*t.model.ROT/2)).mul(t.model.MOV),o.scheduleOnce(o.doDestory,t.model.RAN/o.model.speed.mag()),o.isDestory)o.bullet&&o.bullet.destroy();else if(!i&&o.node.isValid){var a=cc.instantiate(n);o.node.addChild(a),o.bullet=a,a&&a.setPosition(cc.Vec2.ZERO)}});break;default:r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(i,n){if(o.reset(),o.setModel(t),o.model.speed=e.rotateSelf((Math.random()-.5)*Math.PI*t.model.ROT/360).mul(t.model.MOV),o.scheduleOnce(o.doDestory,1.5*t.model.RAN/o.model.speed.mag()),o.isDestory)o.bullet&&o.bullet.destroy();else if(!i&&o.node.isValid&&n){var a=cc.instantiate(n);a&&o.node.addChild(a),o.bullet=a,a&&a.setPosition(cc.Vec2.ZERO)}})}this.updateDir(e)},e.prototype.reset=function(){this.isFollow=!1,this.isDestory=!1,this.radius=240,this.model.reset()},e.prototype.appendMotionStreak=function(t,e,o,i,n){void 0===e&&(e=.2),void 0===o&&(o=1),void 0===i&&(i=8),void 0===n&&(n=cc.Color.YELLOW);var a=new cc.Node;a.scale=.5,a.angle=90,this.motionStreak=a.addComponent(cc.MotionStreak),this.motionStreak.fadeTime=e,this.motionStreak.minSeg=o,this.motionStreak.stroke=i,this.motionStreak.color=n},e.prototype.check=function(t){var e=this,o=[],i=this.checkBlock(t),n=this.checkTargets(t);if((o=o.concat(i.map(function(t){return{type:"block",item:t}})).concat(n.map(function(t){return{type:"target",item:t}})).sort(function(t,o){return t.item.node.getPosition().sub(e.node.getPosition()).mag()-o.item.node.getPosition().sub(e.node.getPosition()).mag()})).length>0)switch(o[0].type){case"block":return this.hintBlock(o[0].item);case"target":var a=this.hintTarget(o[0].item),r=o[0].item.getComponent(l.default);return this.hitArr.indexOf(r.model.group)<0&&this.hitArr.push(r.model.group),a}return!1},e.prototype.checkBlock=function(t,e){return void 0===e&&(e=this.node.getBoundingBox()),this.checkCustom(e,t)},e.prototype.checkTargets=function(t,e){var o=this;void 0===e&&(e=this.node.getBoundingBox()),e.width=this.node.children[0].width,e.height=this.node.children[0].height;var i=cc.v2((e.xMin+e.xMax)/2,(e.yMin+e.yMax)/2);return this.gameView.targets.filter(function(n){if(o.model.type==c.ArmType.\u5c0f\u602a\u67aa\u51fb){if(n.checkTarget(n)&&n.model.group<1e5){var a=n.node.getBoundingBox();return-1==n.model.group?a.height=140:(a.x=a.x-(128-n.node.width)/2,a.width=128,null!=n.hero?a.height=.8*n.hero.node.height/3:a.height=.8*n.heroSke.node.height/3),cc.Intersection.lineRect(i,i.add(o.model.speed.mul(t)),a)||i.sub(cc.v2((a.xMin+a.xMax)/2,(a.yMin+a.yMax)/2)).mag()<=a.width/2+e.width/2}return!1}if(n.checkTarget(n)&&n.model.group!=o.model.group){if(o.gametype==s.GameType.\u666e\u901a\u5173\u5361&&n.model.group<1e5)return;if(o.gametype==s.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&n.model.group<1e5)return;if((a=n.node.getBoundingBox()).x=a.x-(128-n.node.width)/2,a.width=128,null!=n.hero?a.height=2*n.hero.node.height/3:a.height=2*n.heroSke.node.height/3,o.model.type==c.ArmType.\u8d2f\u7a7f){var r=o.node.children[0],l=o.node.angle/180*Math.PI,d=o.node.x,u=o.node.y,p=r.height/2,h=r.width*r.scaleX,f=cc.v2(d+Math.cos(Math.PI/2+l)*(p/2),u+Math.sin(Math.PI/2+l)*(p/2)),m=cc.v2(d+Math.cos(-Math.PI/2+l)*(p/2),u+Math.sin(-Math.PI/2+l)*(p/2)),y=cc.v2(f.x+Math.cos(l-Math.PI)*h,f.y+Math.sin(l-Math.PI)*h),g=[f,m,cc.v2(m.x+Math.cos(l-Math.PI)*h,m.y+Math.sin(l-Math.PI)*h),y],v=[cc.v2(a.xMin,a.yMin),cc.v2(a.xMax,a.yMin),cc.v2(a.xMax,a.yMax),cc.v2(a.xMin,a.yMax)];return cc.Intersection.polygonPolygon(g,v)}return cc.Intersection.lineRect(i,i.add(o.model.speed.mul(t)),a)||i.sub(cc.v2(a.x,a.y)).mag()<=a.width/2+e.width/2}return!1})},e.prototype.checkCustom=function(t,e){var o=this;return this.gameView.quadTree.retrieve(t).filter(function(i){return o.gameView.nameList.indexOf(i.node.name)>-1&&(i.type==d.ItemType.BLOCK||i.type==d.ItemType.BOX||i.type==d.ItemType.SHADOW||i.type==d.ItemType.MOUNTAIN||i.type==d.ItemType.CN)&&(cc.Intersection.lineRect(o.node.getPosition(),o.node.getPosition().add(o.model.speed.mul(e)),i.rect)||cc.v2(t.x,t.y).sub(cc.v2(i.rect.x,i.rect.y)).mag()<=t.width/2+i.rect.width/2)})},e.prototype.clear=function(){this.target=null,this.skeleton&&(this.skeleton.node.scale=1,this.gameView?this.gameView.removeSkeleton(this.skeleton):this.skeleton.node.destroy(),this.skeleton=null),this.sprite&&(this.sprite.node.scale=1,this.sprite.node.anchorX=.5,this.gameView?this.gameView.removeSprite(this.sprite):this.sprite.node.destroy(),this.sprite=null),this.ani&&(this.gameView?this.gameView.removeAni(this.ani):this.ani.node.destroy(),this.ani=null),this.motionStreak&&(this.motionStreak.node.destroy(),this.motionStreak=null),this.bullet&&(this.node.removeChild(this.bullet),this.bullet.destroy(),this.bullet=null),this.hurt&&(this.node.removeChild(this.hurt),this.hurt.destroy(),this.hurt=null),this.node.removeAllChildren(),this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.particle&&(this.particle=null),this.hurt_ani&&(this.gameView.removeAni(this.hurt_ani),this.node.removeAllChildren(),this.hurt_ani=null),this.gameView.putArm(this.node)},e.prototype.doDestory=function(){this.isDestory||(this.isDestory=!0,this.unscheduleAllCallbacks(),this.bullet&&(this.node.removeChild(this.bullet),this.bullet.destroy(),this.bullet=null),this.clear(),this.sprite&&(this.gameView?this.gameView.removeSprite(this.sprite):this.sprite.node.destroy(),this.sprite=null),this.ani&&(this.gameView?this.gameView.removeAni(this.ani):this.ani.node.destroy(),this.ani=null))},e.prototype.doActionDestory=function(){var t=this,e=this;this.isDestory||(this.isDestory=!0,this.unscheduleAllCallbacks(),this.bullet&&(this.node.removeChild(this.bullet),this.bullet.destroy(),this.bullet=null),this.model.type===c.ArmType.\u51b0\u51bb&&this.model.state==c.ArmState.\u51b0\u51bb?this.clear():0==this.hurtID?this.clear():r.default.addLoadingAssetNode(this.node).loadAsset("attack/hurt/hurt_"+this.hurtID,cc.Prefab,function(o,i){if(!o&&t.node.isValid){var n=cc.instantiate(i);t.node.addChild(n),t.hurt=n,n&&n.setPosition(cc.Vec2.ZERO),t.scheduleOnce(function(){e.clear()},.8),t.model.type===c.ArmType.\u5bfc\u5f39&&(n.angle=-e.node.angle,n.scale=e.radius/100)}}),this.sprite&&(this.gameView?this.gameView.removeSprite(this.sprite):this.sprite.node.destroy(),this.sprite=null),this.ani&&(this.gameView?this.gameView.removeAni(this.ani):this.ani.node.destroy(),this.ani=null),this.motionStreak&&(this.motionStreak.node.destroy(),this.motionStreak=null))},e.prototype.doFollow=function(){var t=this;this.schedule(function(){console.log(t.target),t.target&&t.target.node&&t.target.node.active?t.model.speed=t.target.node.getPosition().sub(t.node.getPosition()).normalizeSelf().mul(1500):t.findTarget(cc.rect(t.node.x-40,t.node.y-40,80,80))},.1)},e.prototype.doScatter=function(t){var e=this,o=this,i=new Map;this.gameView.quadTree.retrieve(this.getRectByVec(this.model.pos,t.mul(this.model.RAN),30)).forEach(function(e){if(!i.has(e.node.uuid)&&(e.type==d.ItemType.BOX||e.type==d.ItemType.CN)){var n=cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(o.model.pos);n.mag()<o.model.RAN&&cc.misc.radiansToDegrees(n.angle(t))<30&&i.set(e.node.uuid,e.node)}}),Array.from(i.values()).forEach(function(t){if(t){var e=t.getComponent(p.default);e&&e.hurt(o.model)}}),this.gameView.targets.forEach(function(e){if(e&&e.checkTarget(e)&&e.model.group!=o.model.group){if(o.gametype==s.GameType.\u666e\u901a\u5173\u5361&&e.model.group<1e5)return;if(o.gametype==s.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&e.model.group<1e5)return;var i=e.node.getPosition().sub(o.model.pos);i.mag()<o.model.RAN&&cc.misc.radiansToDegrees(i.angle(t))<30&&(cc.log("==hurt==",o.hurtID),o.hurtID>0&&r.default.addLoadingAssetNode(o.node).loadAsset("attack/hurt/hurt_"+o.hurtID,cc.Prefab,function(t,i){if(!t&&o.node.isValid){var n=cc.instantiate(i);o.node.addChild(n),n&&n.setPosition(o.node.convertToNodeSpaceAR(e.hero?e.hero.node.convertToWorldSpaceAR(cc.v2(0,0)):e.heroSke.node.convertToWorldSpaceAR(cc.v2(0,0)))),o.scheduleOnce(function(){n.destroy(),o.clear()},1)}}),e.hurt(o.model))}}),r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(t,i){if(e.isDestory)e.bullet&&e.bullet.destroy();else{if(!t&&e.node.isValid){var n=cc.instantiate(i);e.node.addChild(n),e.bullet=n,n&&n.setPosition(cc.Vec2.ZERO)}e.scheduleOnce(function(){o.isDestory||o.clear()},1)}})},e.prototype.doElectric=function(t){var e=this,o=new Map;this.gameView.quadTree.retrieve(this.getRectByVec(this.model.pos,t.mul(this.model.RAN),0)).forEach(function(i){if(!o.has(i.node.uuid)&&(i.type==d.ItemType.BOX||i.type==d.ItemType.CN)){var n=cc.v2(i.rect.x+i.rect.width/2,i.rect.y+i.rect.height/2);cc.Intersection.pointLineDistance(n,e.model.pos,e.model.pos.add(t.mul(e.model.RAN)),!0)<50&&o.set(i.node.uuid,i.node)}}),Array.from(o.values()).forEach(function(t){if(t){var o=t.getComponent(p.default);o&&o.hurt(e.model)}}),this.gameView.targets.forEach(function(o){o&&o.checkTarget(o)&&o.model.group!=e.model.group&&cc.Intersection.pointLineDistance(o.node.getPosition(),e.model.pos,e.model.pos.add(t.mul(e.model.RAN)),!0)<50&&o.hurt(e.model)}),this.gameView.appendSkeleton(this.node,"skeleton/fire4/skeleton",function(t){e.skeleton=t,e.skeleton&&(e.skeleton.node.scale=1,e.skeleton.timeScale=1,e.skeleton.node.setPosition(cc.v2(-40,0)),e.skeleton.node.active=!0,e.skeleton.setAnimation(0,"animation",!1),e.skeleton.setCompleteListener(function(){e.isDestory||e.clear()}))})},e.prototype.doBounce=function(t){for(var e=this,o=this.gameView.quadTree.retrieve(this.node.getBoundingBox()).filter(function(o){return(o.type==d.ItemType.BLOCK||o.type==d.ItemType.BOX||o.type==d.ItemType.SHADOW||o.type==d.ItemType.MOUNTAIN||t.type==d.ItemType.CN)&&Math.abs(o.node.x-e.node.x)<=o.rect.width/2+e.model.speed.mul(t).mag()&&Math.abs(o.node.y-e.node.y)<=o.rect.height/2+e.model.speed.mul(t).mag()}).sort(function(t,o){return cc.v2((t.rect.x+t.rect.xMax)/2,(t.rect.y+t.rect.yMax)/2).sub(e.node.getPosition()).mag()-cc.v2((o.rect.x+t.rect.xMax)/2,(o.rect.y+t.rect.yMax)/2).sub(e.node.getPosition()).mag()}),i=0;i<o.length;i++){if((r=this.lineRect(this.node.getPosition(),this.model.speed.mul(t),o[i].rect))>-1)return o[i].type!=d.ItemType.BOX&&t.type!=d.ItemType.CN||(n=o[i].node.getComponent(p.default))&&n.hurt(this.model),0==r||2==r?this.model.speed.x=-this.model.speed.x:1!=r&&3!=r||(this.model.speed.y=-this.model.speed.y),this.updateDir(this.model.speed.normalize()),void this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)));var n;if(-1==r)return o[i].type!=d.ItemType.BOX&&t.type!=d.ItemType.CN||(n=o[i].node.getComponent(p.default))&&n.hurt(this.model),void this.doActionDestory()}for(i=0;i<this.gameView.targets.length;i++){var a=this.gameView.targets[i];if(a&&a.checkTarget(a)&&a.model.group!=this.model.group){if(this.gametype==s.GameType.\u666e\u901a\u5173\u5361&&a.model.group<1e5)return;if(this.gametype==s.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&a.model.group<1e5)return;var r,c=a.node.getBoundingBox();if(c=cc.rect(c.x+10,c.y+a.dragon.node.y+50,c.width-10,c.height-10),(r=this.lineRect(this.node.getPosition(),this.model.speed.mul(t),c))>-1)return a.hurt(this.model),0==r||2==r?this.model.speed.x=-this.model.speed.x:1!=r&&3!=r||(this.model.speed.y=-this.model.speed.y),this.updateDir(this.model.speed.normalize()),void this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)));if(-1==r)return a.hurt(this.model),void this.doActionDestory()}}this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)))},e.prototype.doMissile=function(t,e){var o=this;void 0===e&&(e=this.model.RAN);var i=[],n=this.checkBlock(t,cc.rect(this.node.x-20,this.node.y-20,40,40)),a=this.checkTargets(t,cc.rect(this.node.x-20,this.node.y-20,40,40));if((i=i.concat(n.map(function(t){return{type:"block",item:t}})).concat(a.map(function(t){return{type:"target",item:t}})).sort(function(t,e){return t.item.node.getPosition().sub(o.node.getPosition()).mag()-e.item.node.getPosition().sub(o.node.getPosition()).mag()})).length>0){try{var r=i[0].item.node,c=cc.rect(r.x-e,r.y-e,2*e,2*e),l=new Map;(r.type==d.ItemType.BOX||r.type==d.ItemType.CN)&&l.set(r.uuid,r),this.gameView.quadTree.retrieve(c).forEach(function(t){!l.has(t.node.uuid)&&(t.type==d.ItemType.BOX||t.type==d.ItemType.CN)&&t.node.getPosition().sub(r.getPosition()).mag()<=e&&l.set(t.node.uuid,t.node)}),Array.from(l.values()).forEach(function(t){if(t){var e=t.getComponent(p.default);e&&e.hurt(o.model)}});var u=this;this.gameView.targets.forEach(function(t){if(t&&t.checkTarget(t)&&t.model.group!=o.model.group){if(u.gametype==s.GameType.\u666e\u901a\u5173\u5361&&t.model.group<1e5)return;if(u.gametype==s.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&t.model.group<1e5)return;t.node.getPosition().sub(r.getPosition()).mag()<e&&t.hurt(o.model)}})}catch(h){}return!0}return!1},e.prototype.doKnife=function(t){var e=this,o=this,i=new Map;this.gameView.quadTree.retrieve(this.getRectByVec(this.model.pos,t.mul(this.model.RAN),30)).forEach(function(e){if(!i.has(e.node.uuid)&&(e.type==d.ItemType.BOX||e.type==d.ItemType.CN)){var n=cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(o.model.pos);n.mag()<o.model.RAN&&cc.misc.radiansToDegrees(n.angle(t))<30&&i.set(e.node.uuid,e.node)}}),Array.from(i.values()).forEach(function(t){if(t){var e=t.getComponent(p.default);e&&e.hurt(o.model)}}),this.gameView.targets.forEach(function(e){if(e&&e.checkTarget(e)&&(o.gametype==s.GameType.\u666e\u901a\u5173\u5361||o.gametype==s.GameType.\u5e7d\u6d6e\u7ed1\u67b6)&&e.model.group<1e5){var i=e.node.getPosition().sub(o.model.pos);i.mag()<o.model.RAN&&cc.misc.radiansToDegrees(i.angle(t))<30&&(cc.log("==hurt==",o.hurtID),o.hurtID>0&&r.default.addLoadingAssetNode(o.node).loadAsset("attack/hurt/hurt_"+o.hurtID,cc.Prefab,function(t,i){if(!t&&o.node.isValid){var n=cc.instantiate(i);o.node.addChild(n),n&&n.setPosition(o.node.convertToNodeSpaceAR(e.hero?e.hero.node.convertToWorldSpaceAR(cc.v2(0,0)):e.heroSke.node.convertToWorldSpaceAR(cc.v2(0,0)))),o.scheduleOnce(function(){n.destroy(),o.clear()},.5)}}),e.hurt(o.model))}}),r.default.addLoadingAssetNode(this.node).loadAsset("attack/bullet/bullet_"+this.bulletID,cc.Prefab,function(t,i){if(e.isDestory)e.bullet&&e.bullet.destroy();else{if(!t&&e.node.isValid){var n=cc.instantiate(i);e.node.addChild(n),e.bullet=n,n&&n.setPosition(cc.Vec2.ZERO)}e.scheduleOnce(function(){o.isDestory||o.clear()},1)}})},e.prototype.doLaser=function(){var t=this;try{this.life+=.3;var e=new Map;this.gameView.quadTree.retrieve(this.getRectByVec(this.model.pos,this.model.speed.mul(3*this.life),0)).forEach(function(o){if(!e.has(o.node.uuid)&&o.type==d.ItemType.BLOCK||o.type==d.ItemType.SHADOW||o.type==d.ItemType.BOX||o.type==d.ItemType.MOUNTAIN||o.type==d.ItemType.CN){var i=cc.v2((o.rect.xMin+o.rect.xMax)/2,(o.rect.yMin+o.rect.yMax)/2);cc.Intersection.pointLineDistance(i,t.model.pos,t.model.pos.add(t.model.speed.mul(3*t.life)),!0)<50&&e.set(o.node.uuid,{type:o.type,node:o.node})}});for(var o=Array.from(e.values()).sort(function(e,o){return e.node.getPosition().sub(t.node.getPosition()).mag()-o.node.getPosition().sub(t.node.getPosition()).mag()}),i=this.model.speed.mul(3*this.life).mag(),n=0;n<o.length;n++){var a=o[n];if(a.type==d.ItemType.BLOCK||a.type==d.ItemType.SHADOW||a.type==d.ItemType.MOUNTAIN){i=a.node.getPosition().sub(this.node.getPosition()).mag();break}if(a.type==d.ItemType.BOX||a.type==d.ItemType.CN){var r=a.node.getComponent(p.default);if(r&&!r.hurt(this.model)){i=a.node.getPosition().sub(this.node.getPosition()).mag();break}}}t=this,this.gameView.targets.forEach(function(e){if(e&&e.checkTarget(e)&&e.model.group!=t.model.group){if(t.gametype==s.GameType.\u666e\u901a\u5173\u5361&&e.model.group<1e5)return;if(t.gametype==s.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&e.model.group<1e5)return;e.node.getPosition().sub(t.node.getPosition()).mag()<i&&cc.Intersection.pointLineDistance(e.node.getPosition(),t.model.pos,t.model.pos.add(t.model.speed.mul(3*t.life)),!0)<50&&e.hurt(t.model)}}),0==o.length?this.sprite&&(this.sprite.node.active=!0,this.sprite.node.anchorY=1,this.sprite.node.height=this.model.speed.mul(3*this.life).mag(),this.sprite.node.width=20):this.sprite&&(this.sprite.node.active=!0,this.sprite.node.anchorY=1,this.sprite.node.height=i-40,this.sprite.node.width=20)}catch(c){}},e.prototype.doIceMissible=function(t){var e=this,o=[],i=this.checkBlock(t),n=this.checkTargets(t);if((o=o.concat(i.map(function(t){return{type:"block",item:t}})).concat(n.map(function(t){return{type:"target",item:t}})).sort(function(t,o){return t.item.node.getPosition().sub(e.node.getPosition()).mag()-o.item.node.getPosition().sub(e.node.getPosition()).mag()})).length>0){if(this.model.state==c.ArmState.\u51b0\u51bb){try{var a=o[0].item.node,r=cc.rect(a.x-160,a.y-160,320,320),l=new Map;(a.type==d.ItemType.BOX||a.type==d.ItemType.CN)&&l.set(a.uuid,a),this.gameView.quadTree.retrieve(r).forEach(function(t){!l.has(t.node.uuid)&&(t.type==d.ItemType.BOX||t.type==d.ItemType.CN)&&t.node.getPosition().sub(a.getPosition()).mag()<=160&&l.set(t.node.uuid,t.node)}),Array.from(l.values()).forEach(function(t){if(t){var o=t.getComponent(p.default);o&&o.hurt(e.model)}}),this.gameView.targets.forEach(function(t){if(t&&t.checkTarget(t)&&t.model.group!=e.model.group){if(e.gametype==s.GameType.\u666e\u901a\u5173\u5361&&t.model.group<1e5)return;if(e.gametype==s.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&t.model.group<1e5)return;t.node.getPosition().sub(a.getPosition()).mag()<120&&t.hurt(e.model)}})}catch(t){}return!0}switch(o[0].type){case"block":return this.hintBlock(o[0].item);case"target":return this.hintTarget(o[0].item)}}return!1},e.prototype.lineRect=function(t,e,o){var i=t.add(e),n=e.mag(),a=cc.v2((o.x+o.xMax)/2,(o.y+o.yMax)/2);if(Math.abs(a.x-t.x)<=o.width/2+n&&Math.abs(a.y-t.y)<=o.height/2+n&&(Math.abs(a.x-t.x)>o.width/2||Math.abs(a.y-t.y)>o.height/2)){var r=cc.v2(o.x,o.y),c=cc.v2(o.x,o.yMax),s=cc.v2(o.xMax,o.yMax),l=cc.v2(o.xMax,o.y),d=[];return cc.Intersection.lineLine(t,i,r,c)&&d.push({i:0,d:r.sub(t).mag()+c.sub(t).mag()}),cc.Intersection.lineLine(t,i,c,s)&&d.push({i:1,d:c.sub(t).mag()+s.sub(t).mag()}),cc.Intersection.lineLine(t,i,s,l)&&d.push({i:2,d:s.sub(t).mag()+l.sub(t).mag()}),cc.Intersection.lineLine(t,i,l,r)&&d.push({i:3,d:l.sub(t).mag()+r.sub(t).mag()}),d.length>0?(d.sort(function(t,e){return t.d-e.d}),d[0].i):-2}return Math.abs(a.x-t.x)<o.width/2&&Math.abs(a.y-t.y)<o.height/2?-1:-2},e.prototype.changeColor=function(t){if(this.motionStreak)switch(t){case 0:this.motionStreak.color=cc.color(255,255,0);break;case 10:this.motionStreak.color=cc.color(200,255,100);break;case 1:this.motionStreak.color=cc.color(255,0,255);break;case 11:this.motionStreak.color=cc.color(255,100,200);break;case 2:this.motionStreak.color=cc.color(255,50,0);break;case 12:this.motionStreak.color=cc.color(255,200,100);break;case 3:this.motionStreak.color=cc.color(0,255,255);break;case 13:this.motionStreak.color=cc.color(100,200,255)}},e.prototype.findTarget=function(t){var e=this;if(void 0===t&&(t=this.node.getBoundingBox()),this.model.player){var o=this.model.player;if(o.checkTarget(o)&&o.target&&o.target.node.getPosition().sub(o.node.getPosition()).mag()<o.model.RAN)return this.target=o.target,void(this.model.speed=o.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(o.model.MOV));var i=this.gameView.targets.filter(function(t){return e.gametype!=s.GameType.\u666e\u901a\u5173\u5361&&e.gametype!=s.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=o.model.group?e.gametype!=s.GameType.\u666e\u901a\u5173\u5361&&e.gametype!=s.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0==o.model.group?t.model.group!=o.model.group&&t.checkTarget(t):t.model.group!=o.model.group&&t.model.group<1e5&&t.checkTarget(t):t.model.group!=o.model.group&&t.model.group>=1e5&&t.checkTarget(t)}).sort(function(t,e){return t.node.getPosition().sub(o.node.getPosition()).mag()-e.node.getPosition().sub(o.node.getPosition()).mag()});if(i.length>0&&i[0].node.getPosition().sub(o.node.getPosition()).mag()<o.model.RAN)return this.target=i[0],void(this.model.speed=this.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(o.model.MOV));var n=new Map;e=this,this.gameView.quadTree.retrieve(t).forEach(function(t){n.has(t.node.uuid)||e.gameView.nameList.indexOf(t.node.name)>-1||t.type!=d.ItemType.BOX&&t.type!=d.ItemType.CN||n.set(t.node.uuid,t.node)});var a=Array.from(n.values()).sort(function(t,e){return t.getPosition().sub(o.node.getPosition()).mag()-e.getPosition().sub(o.node.getPosition()).mag()});a.length>0&&a[0].getPosition().sub(this.node.getPosition()).mag()<320&&(this.target=a[0],this.model.speed=this.target.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(o.model.MOV))}},e.prototype.updateDir=function(t){0==t.x?t.y>0?this.node.angle=90*this.gameView.curPlayer.dragon.node.scaleX/this.gameView.curPlayer.dragon.node.scaleY:t.y<0?this.node.angle=-90*this.gameView.curPlayer.dragon.node.scaleX/this.gameView.curPlayer.dragon.node.scaleY:this.node.angle=0:this.node.angle=-(-90+cc.misc.radiansToDegrees(Math.atan2(t.x,t.y)))},e.prototype.update=function(t){if(this.time=t,this.gameView&&this.model.player&&!this.isDestory)switch(this.model.type){case c.ArmType.\u5200\u67aa:case c.ArmType.\u874e\u5b50\u653b\u51fb:case c.ArmType.\u6563\u5c04:break;case c.ArmType.\u5bfc\u5f39:this.model.speed.mulSelf(1.05),this.doMissile(t)?this.doActionDestory():this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)));break;case c.ArmType.\u51b0\u51bb:this.model.speed.mulSelf(1.05),this.doIceMissible(t)?this.doActionDestory():this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)));break;case c.ArmType.\u5c0f\u602a\u67aa\u51fb:if(this.gameView.isMoveNext)return void this.doDestory();default:this.model.speed.equals(cc.Vec2.ZERO)||this.check(t)?this.doActionDestory():this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)))}Math.abs(this.node.x-this.gameView.curPlayer.node.x)>1.5*cc.winSize.width/this.gameView.followCamera.zoomRatio||Math.abs(this.node.y-this.gameView.curPlayer.node.y)>1.5*cc.winSize.height/this.gameView.followCamera.zoomRatio?(this.sprite&&this.sprite.node.active&&(this.sprite.node.active=!1),this.motionStreak&&this.motionStreak.node.active&&(this.motionStreak.node.active=!1)):(this.sprite&&!this.sprite.node.active&&(this.sprite.node.active=!0),this.motionStreak&&!this.motionStreak.node.active&&(this.motionStreak.node.active=!0))},e.prototype.hintBlock=function(t){switch(t.type){case d.ItemType.BLOCK:case d.ItemType.MOUNTAIN:return!0;case d.ItemType.BOX:case d.ItemType.CN:if(t.type==d.ItemType.BOX||t.type==d.ItemType.CN){var e=t.node.getComponent(p.default);if(e&&!e.hurt(this.model))return!0}if(this.model.type!=c.ArmType.\u72d9\u51fb&&this.model.type!=c.ArmType.\u8d2f\u7a7f)return!0;break;case d.ItemType.SHADOW:}return!1},e.prototype.hintTarget=function(t){var e=this,o=t.getComponent(l.default),i=!0;return this.model.type==c.ArmType.\u8d2f\u7a7f&&(this.hitArr.indexOf(o.model.group)<0&&r.default.addLoadingAssetNode(this.node).loadAsset("attack/hurt/hurt_"+this.hurtID,cc.Prefab,function(t,i){if(!t&&e.node.isValid){var n=cc.instantiate(i);o.node.addChild(n),n.angle=e.node.angle,n&&n.setPosition(cc.Vec2.ZERO),e.scheduleOnce(function(){n.destroy()},.8)}}),i=!1),!(!o||!o.checkTarget(o))&&this.hitArr.indexOf(o.model.group)<0&&(o.hurt(this.model),i)},e.prototype.getRectByVec=function(t,e,o){if(o>0){var i=t.add(e.rotate(cc.misc.degreesToRadians(o))),n=t.add(e.rotate(cc.misc.degreesToRadians(-o))),a=t.add(e),r=Math.min(t.x,i.x,n.x,a.x),c=Math.min(t.y,i.y,n.y,a.y),s=Math.max(t.x,i.x,n.x,a.x),l=Math.max(t.y,i.y,n.y,a.y);return r==s&&(s+=1),c==l&&(l+=1),cc.rect(r,c,s-r,l-c)}return a=t.add(e),r=Math.min(t.x,a.x),c=Math.min(t.y,a.y),r==(s=Math.max(t.x,a.x))&&(s+=1),c==(l=Math.max(t.y,a.y))&&(l+=1),cc.rect(r,c,s-r,l-c)},a([m],e)}(cc.Component));o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PlayerModel":void 0,"../../../../framework/Script/component/LoaderAssetNode":void 0,"../../BasePlayer":"BasePlayer","../../manage/GameManage":"GameManage","../../test/EditView":"EditView","../model/ArmModel":"ArmModel","./GameBlock":"GameBlock"}],AscendingNode:[function(t,e,o){"use strict";cc._RF.push(e,"669e0GjYoVKRorWRrQYRbbP","AscendingNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=t("../../../../InitScene/Script/data/RankModel"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.diamondLabel=null,e.diamond=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){var e=c.default.getRankData(t);this.diamond=e.award,this.diamondLabel.string=this.diamondLabel.string.replace("x",e.award+"")},e.prototype.onOk=function(){r.default.totalDiamondNum+=this.diamond,s.default.uiCenter.closeUI(this.node)},a([u(cc.RichText)],e.prototype,"diamondLabel",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/RankModel":void 0,"../../center/Game":"Game"}],AttributeDiff:[function(t,e,o){"use strict";cc._RF.push(e,"3a821KhpF5PVbi1UybLjbCW","AttributeDiff");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueLabel=null,e.iconSprite=null,e.attributeUpAtlas=[],e.arrowSpriteFrame=[],e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t){this.valueLabel.node.active=!0,this.iconSprite.node.active=!0,0==t?(this.valueLabel.node.active=!1,this.iconSprite.node.active=!1):t<0&&this.valueLabel.font.name!=this.attributeUpAtlas[0].name?(this.valueLabel.font=this.attributeUpAtlas[0],this.iconSprite.spriteFrame=this.arrowSpriteFrame[0]):t>0&&this.valueLabel.font.name!=this.attributeUpAtlas[1].name&&(this.valueLabel.font=this.attributeUpAtlas[1],this.iconSprite.spriteFrame=this.arrowSpriteFrame[1]),this.valueLabel.string="/"+Math.abs(t)},a([s(cc.Label)],e.prototype,"valueLabel",void 0),a([s(cc.Sprite)],e.prototype,"iconSprite",void 0),a([s(cc.LabelAtlas)],e.prototype,"attributeUpAtlas",void 0),a([s(cc.SpriteFrame)],e.prototype,"arrowSpriteFrame",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],AttributeView:[function(t,e,o){"use strict";cc._RF.push(e,"c818cJFy9BCRIkChRHan6Jt","AttributeView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./AttributeDiff"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attributeLabel=[],e.valueDiff=[],e.combineLabel=null,e.specialLabel=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setCombineLabel=function(t){this.combineLabel.string=""+t},e.prototype.setLabel=function(t){this.specialLabel.string=""+t},e.prototype.setData=function(t,e){for(var o=0;o<this.attributeLabel.length;o++)this.attributeLabel[o].string=t[o].toString();for(o=0;o<this.valueDiff.length;o++)this.valueDiff[o].init(e[o])},a([l(cc.Label)],e.prototype,"attributeLabel",void 0),a([l(r.default)],e.prototype,"valueDiff",void 0),a([l(cc.Label)],e.prototype,"combineLabel",void 0),a([l(cc.Label)],e.prototype,"specialLabel",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./AttributeDiff":"AttributeDiff"}],AvatarItem:[function(t,e,o){"use strict";cc._RF.push(e,"a3280YWiJtEdppG07q7GiC1","AvatarItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.avatarSprite=null,e.selectedNode=null,e.avatarId=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.setState=function(t){this.selectedNode.active=this.avatarId==t},e.prototype.setData=function(t){this.avatarId=t,this.setAvatar("hero/avatar/"+this.avatarId)},e.prototype.setAvatar=function(t){r.default.addLoaderSprite(this.avatarSprite).loadSprite(t,cc.SpriteFrame)},a([l(cc.Sprite)],e.prototype,"avatarSprite",void 0),a([l(cc.Node)],e.prototype,"selectedNode",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0}],Avatar:[function(t,e,o){"use strict";cc._RF.push(e,"765c9Nt3nRPDLTqn6FHSVWP","Avatar");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.userIcon=null,e._avatarUrl="",e}return n(e,t),e.prototype.setAvatarUrl=function(t){this._avatarUrl=t,r.default.addLoadingSprite(this.userIcon).loadRemoteSprite(this._avatarUrl,{type:"png"},function(){})},a([l(cc.Sprite)],e.prototype,"userIcon",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0}],AwardItem:[function(t,e,o){"use strict";cc._RF.push(e,"da5dcPu2IBB/rLzf/CEw+2a","AwardItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.nameLabel=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t,e){this.iconSprite.spriteFrame=t,this.nameLabel.string=e.toString()},a([s(cc.Sprite)],e.prototype,"iconSprite",void 0),a([s(cc.Label)],e.prototype,"nameLabel",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BadgeButton:[function(t,e,o){"use strict";cc._RF.push(e,"5810b0d2IJEB6snqfop2SAc","BadgeButton");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/BadgeModel"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buttonBadge=r.BadgeType.None,e.markNode=null,e.pointNode=null,e.actionNode=null,e}return n(e,t),e.prototype.start=function(){r.default.on(r.BADGE_EVENT.BADGE_UPDATE,this.updateUI,this),this.setButtonBadge(this.buttonBadge)},e.prototype.updateUI=function(t){t==this.buttonBadge&&this.setButtonBadge(this.buttonBadge)},e.prototype.setButtonBadge=function(t){switch(this.markNode.active=!1,this.pointNode&&(this.pointNode.active=!1),t){case r.BadgeType.Sign:this.markNode.active=r.default.signBadge,r.default.emit(r.BADGE_EVENT.BADGE_UPDATE,r.BadgeType.Fuli);break;case r.BadgeType.TurnTable:this.markNode.active=r.default.tableBadge,r.default.emit(r.BADGE_EVENT.BADGE_UPDATE,r.BadgeType.Fuli);break;case r.BadgeType.Post:this.markNode.active=r.default.postBadge;break;case r.BadgeType.Rank:cc.log("===\u6bb5\u4f4d\u7ea2\u70b9===",r.default.rankBadge),this.markNode.active=r.default.rankBadge;break;case r.BadgeType.Hero:this.markNode.active=r.default.heroBadge;break;case r.BadgeType.Mount:this.markNode.active=r.default.mountBadge,!this.markNode.active&&(this.pointNode.active=r.default.upgradeBadge);break;case r.BadgeType.Avatar:this.markNode.active=r.default.avatarBadge;break;case r.BadgeType.TenDraw:this.markNode.active=r.default.tenDrawBadge,r.default.emit(r.BADGE_EVENT.BADGE_UPDATE,r.BadgeType.Fuli);break;case r.BadgeType.Online:this.markNode.active=r.default.onlineBadge,r.default.emit(r.BADGE_EVENT.BADGE_UPDATE,r.BadgeType.Fuli);break;case r.BadgeType.Fuli:this.markNode.active=r.default.onlineBadge}},a([l({type:cc.Enum(r.BadgeType)})],e.prototype,"buttonBadge",void 0),a([l(cc.Node)],e.prototype,"markNode",void 0),a([l(cc.Node)],e.prototype,"pointNode",void 0),a([l(cc.Node)],e.prototype,"actionNode",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../InitScene/Script/data/BadgeModel":void 0}],BarView:[function(t,e,o){"use strict";cc._RF.push(e,"e84e0W26u5JIYk8RFAYegdk","BarView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/GameData"),c=t("../../../../../InitScene/Script/data/GunModel"),s=t("../../../../../InitScene/Script/data/PlayerData"),l=t("../../../../../Script/base/Utils"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.profitLabel=null,e.coinLabel=null,e.isSpeed=!1,e}return n(e,t),e.prototype.onLoad=function(){c.default.barViews.push(this)},e.prototype.onDestroy=function(){var t=c.default.barViews.indexOf(this);t>-1&&c.default.barViews.splice(t,1)},e.prototype.onClickDiamond=function(){},e.prototype.start=function(){var t=this;this.load((new Date).getTime()),this.refresh(),this.schedule(function(){t.load((new Date).getTime())},1),this.schedule(this.refresh,5)},e.prototype.refresh=function(){c.default.profit>0&&(this.coinLabel.node.stopAllActions(),this.coinLabel.node.scale=1,this.coinLabel.node.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1)))),this.isSpeed?this.profitLabel.string=l.formatNumber(5*c.default.profit)+"/\u79d2":this.profitLabel.string=l.formatNumber(c.default.profit)+"/\u79d2"},e.prototype.speedUp=function(t){void 0===t&&(t=60),this.isSpeed||(this.isSpeed=!0,s.default.speedTime=(new Date).getTime()+1e3*t,this.unschedule(this.refresh),this.refresh(),this.schedule(this.refresh,1))},e.prototype.speedDown=function(){this.isSpeed&&(this.isSpeed=!1,this.unschedule(this.refresh),this.refresh(),this.schedule(this.refresh,5))},e.prototype.load=function(t){if(0==c.default.moneyLastTime&&(c.default.moneyLastTime=(new Date).getTime()),s.default.speedTime>t?this.speedUp():this.speedDown(),c.default.moneyLastTime<t){var e=Math.floor((t-c.default.moneyLastTime)/1e3),o=Math.min(1,e);if(s.default.speedTime>t)r.default.totalCoinNum+=o*c.default.profit*2;else if(s.default.speedTime>c.default.moneyLastTime){var i=Math.floor((s.default.speedTime-c.default.moneyLastTime)/1e3);r.default.totalCoinNum+=i*c.default.profit*2+(o-i)*c.default.profit}else r.default.totalCoinNum+=o*c.default.profit;c.default.moneyLastTime+=1e3*e}},a([p(cc.Label)],e.prototype,"profitLabel",void 0),a([p(cc.Label)],e.prototype,"coinLabel",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/PlayerData":void 0,"../../../../../Script/base/Utils":void 0}],BasePlayer:[function(t,e,o){"use strict";cc._RF.push(e,"cb0dc0D5OZCkYFny6E9GUNd","BasePlayer");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../InitScene/Script/data/OtherData"),c=t("../../InitScene/Script/data/PersonModel"),s=t("../../InitScene/Script/data/PlayerModel"),l=t("../../MainScene/Script/center/Game"),d=t("./joystick/JoystickCommon"),u=t("./manage/GameManage"),p=t("./test/EditView"),h=t("./view/game/AddHpView"),f=t("./view/game/CriView"),m=t("./view/game/HpView"),y=cc._decorator,g=y.ccclass,v=y.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.hpView=null,e.dragon=null,e.hero=null,e.heroSke=null,e.reductionMount=null,e.dodgeMount=null,e.flyMount=null,e.headMount=null,e.thunderMount=null,e.lightMount=null,e.addHPAni=null,e.invincibleNode=null,e.swimNode=null,e.fireNode=null,e.isSwiming=!1,e.breathNormalFloorNode=null,e.breathNormalNode=null,e.personIdx=0,e.gunIdx=0,e.mountIdx=0,e.mount_level=0,e.airSkillTimes=0,e.isInvincible=!1,e.isCanHurt=!1,e.skill=c.HeroSkillType.Hammer,e.combineSkill=c.HeroSkillType.Fort,e._speedType=d.SpeedType.STOP,e._moveSpeed=200,e.moveDir=cc.v2(-1,0),e.moveCan=[p.ItemType.BLOCK,p.ItemType.BOX,p.ItemType.WATER,p.ItemType.SHADOW,p.ItemType.MOUNTAIN,p.ItemType.CN],e.flymoveCan=[p.ItemType.MOUNTAIN],e.attackDir=cc.v2(-1,0),e.offect=cc.Vec2.ZERO,e.goSkillOffect=cc.Vec2.ZERO,e.target=null,e.gameView=null,e.heroNode=null,e.gunNode=null,e.slot=null,e.slotName="shouqiang",e.attachmentName="1",e.model=new s.default,e.attacking=!1,e.isStop=!1,e.isAtking=!1,e.isHurt=!1,e.isHpCircle=!0,e.isToujin=!0,e.isUseSkill=!1,e.isPlay=!1,e.animation="",e.curbloodTime=0,e.bloodTime=0,e}return n(e,t),e.prototype.init=function(){this.gameView=u.default.getInstance().gameView},e.prototype.changeAnimation=function(t){var e=this;t.flag&&(this.isPlay=!1,this.animation=""),this.heroSke&&this.heroSke.isValid&&(this.isPlay||(t.loop?this.animation!=t.animation&&(this.animation=t.animation,this.heroSke.setAnimation(0,t.animation,!0),0==this.model.group&&cc.log("this.hero",this.heroSke.node.active,t.animation),t.callback&&t.callback()):(this.heroSke.setCompleteListener(function(){e.isPlay=!1,t.callback&&t.callback(),e.heroSke.setCompleteListener(null)}),this.isPlay=!0,this.animation="",t.animation.indexOf("siwang")>-1?(this.heroSke&&this.heroSke.setAnimation(0,t.animation,!1),this.flyMount&&(this.flyMount.node.active=!1),this.swimNode&&(this.swimNode.node.active=!1),this.fireNode&&(this.fireNode.node.active=!1)):this.heroSke&&this.heroSke.setAnimation(0,"daiji",!1))))},e.prototype.addHP=function(t){var e=this,o=this;t=Math.floor(t),this.model.HP+=t,this.hpView.refresh(this.model.HP),this.addHPAni.node.active=!0,this.addHPAni.once(dragonBones.EventObject.COMPLETE,function(){e.addHPAni.node.active=!1}),this.addHPAni.playAnimation("newAnimation",1);var i=this.gameView.getAddHp().getComponent(h.default);i&&(i.node.parent=this.gameView.layout,i.node.setPosition(this.node.getPosition().add(cc.v2(50*Math.random()+50,20*Math.random()+100))),i.node.scale=0,i.init(t),i.node.runAction(cc.sequence(cc.scaleTo(.06,8),cc.scaleTo(.1,4),cc.delayTime(.4),cc.scaleTo(.2,0),cc.callFunc(function(){o.gameView.putAddHp(i.node)})))),0==this.model.group&&l.default.gameAudio.playAddHPClip()},e.prototype.hurt=function(){},e.prototype.doHurt=function(t){var e=this,o=Math.random(),i=Math.floor(t.ATK/(1+(o-.5)/10)),n=this.model.isCri(t.CRI);n&&(i*=2),i-=i*this.model.CUT_HURT,i=Math.floor(i),this.isInvincible?this.model.doHurt(0):this.model.doHurt(i);var a=this.gameView&&this.gameView.getCri().getComponent(f.default);a&&(a.node.parent=this.gameView.layout,a.node.setPosition(this.node.getPosition().add(cc.v2(50*Math.random()-50,20*Math.random()+100))),a.node.scale=0,n?(a.init(i,!0),a.node.runAction(cc.sequence(cc.scaleTo(.05,12),cc.scaleTo(.05,4),cc.delayTime(.35),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(a.node)})))):(a.init(i),a.node.runAction(cc.sequence(cc.scaleTo(.05,6),cc.scaleTo(.05,3),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(a.node)}))))),this.hpView.refresh(this.model.HP),this.updateSkillCD()},e.prototype.hurtBySkill=function(){},e.prototype.doHurtBySkill=function(t){var e=this,o=(Math.random(),t.isCombine?t.player.model.CombineSkillATK:t.player.model.SkillATK);switch(t.player.skill){case c.HeroSkillType.Hammer:break;case c.HeroSkillType.Light:o/=4}var i=this.model.isCri(t.CRI);i&&(o*=2),o-=o*this.model.CUT_HURT,o=Math.floor(o),cc.log("\u82f1\u96c4\u6280\u80fd\u6700\u7ec8\u4f24\u5bb3atk",o),this.isInvincible?this.model.doHurt(0):this.model.doHurt(o);var n=this.gameView&&this.gameView.getCri().getComponent(f.default);n&&(n.node.parent=this.gameView.layout,n.node.setPosition(this.node.getPosition().add(cc.v2(50*Math.random()-50,20*Math.random()+100))),n.node.scale=0,i?(n.init(o,!0),n.node.runAction(cc.sequence(cc.scaleTo(.05,12),cc.scaleTo(.05,4),cc.delayTime(.35),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(n.node)})))):(n.init(o),n.node.runAction(cc.sequence(cc.scaleTo(.05,6),cc.scaleTo(.05,3),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(n.node)}))))),this.hpView.refresh(this.model.HP),this.updateSkillCD()},e.prototype.hurtByCombineSkill=function(){},e.prototype.doHurtByCombineSkill=function(t){var e=this,o=Math.random(),i=100+t.mount_atk,n=Math.floor(t.ATK/(1+(o-.5)/10))*(i/100),a=this.model.isCri(t.CRI);a&&(n*=2),n-=n*this.model.CUT_HURT,n=Math.floor(n),cc.log("\u5408\u4f53\u6280\u80fd\u4f24\u5bb3atk",n),this.isInvincible?this.model.doHurt(0):this.model.doHurt(n);var r=this.gameView&&this.gameView.getCri().getComponent(f.default);r&&(r.node.parent=this.gameView.layout,r.node.setPosition(this.node.getPosition().add(cc.v2(50*Math.random()-50,20*Math.random()+100))),r.node.scale=0,a?(r.init(n,!0),r.node.runAction(cc.sequence(cc.scaleTo(.05,12),cc.scaleTo(.05,4),cc.delayTime(.35),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(r.node)})))):(r.init(n),r.node.runAction(cc.sequence(cc.scaleTo(.05,6),cc.scaleTo(.05,3),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(r.node)}))))),this.hpView.refresh(this.model.HP),this.updateSkillCD()},e.prototype.hurtByEnemySkill=function(){},e.prototype.doHurtByEnemySkill=function(t){var e=this,o=(Math.random(),t.player.model.SkillATK),i=this.model.isCri(t.CRI);i&&(o*=2),o-=o*this.model.CUT_HURT,o=Math.floor(o),cc.log("\u602a\u517dboss\u6280\u80fd\u6700\u7ec8\u4f24\u5bb3atk",o),this.isInvincible?this.model.doHurt(0):this.model.doHurt(o);var n=this.gameView&&this.gameView.getCri().getComponent(f.default);n&&(n.node.parent=this.gameView.layout,n.node.setPosition(this.node.getPosition().add(cc.v2(50*Math.random()-50,20*Math.random()+100))),n.node.scale=0,i?(n.init(o,!0),n.node.runAction(cc.sequence(cc.scaleTo(.05,12),cc.scaleTo(.05,4),cc.delayTime(.35),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(n.node)})))):(n.init(o),n.node.runAction(cc.sequence(cc.scaleTo(.05,6),cc.scaleTo(.05,3),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(n.node)}))))),this.hpView.refresh(this.model.HP),this.updateSkillCD()},e.prototype.hurtByCN=function(){},e.prototype.doHurtByCN=function(t){var e=this,o=(Math.random(),t);o-=o*this.model.CUT_HURT,o=Math.floor(o),cc.log("\u70b8\u836f\u6876\u6700\u7ec8\u4f24\u5bb3atk",o),this.isInvincible?this.model.doHurt(0):this.model.doHurt(o);var i=this.gameView&&this.gameView.getCri().getComponent(f.default);i&&(i.node.parent=this.gameView.layout,i.node.setPosition(this.node.getPosition().add(cc.v2(50*Math.random()-50,20*Math.random()+100))),i.node.scale=0,i.init(o),i.node.runAction(cc.sequence(cc.scaleTo(.05,6),cc.scaleTo(.05,3),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(i.node)})))),this.hpView.refresh(this.model.HP),this.updateSkillCD()},e.prototype.hurtByAirSkill=function(){},e.prototype.doHurtByAirSkill=function(t){var e=this,o=Math.random(),i=Math.floor((1+(o-.5)/10)*t.ATK*(r.default.airSkill/100));cc.log("\u6280\u80fd\u4f24\u5bb3atk",i,"\u7a7a\u6295\u767e\u5206\u6bd4",r.default.airSkill/100,"\u4e3b\u52a8\u6280\u80fd\u7c7b\u578b",t.mount.initiative,"\u539f\u59cb\u653b\u51fb\uff1a",t.ATK);var n=this.model.isCri(t.CRI);n&&(i*=2),i-=i*this.model.CUT_HURT,i=Math.floor(i),cc.log("\u7a7a\u6295\u4f24\u5bb3atk",i),this.isInvincible?this.model.doHurt(0):this.model.doHurt(i);var a=this.gameView&&this.gameView.getCri().getComponent(f.default);a&&(a.node.parent=this.gameView.layout,a.node.getPosition(this.node.getPosition().add(cc.v2(50*Math.random()-50,20*Math.random()+100))),a.node.scale=0,n?(a.init(i,!0),a.node.runAction(cc.sequence(cc.scaleTo(.05,12),cc.scaleTo(.05,4),cc.delayTime(.35),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(a.node)})))):(a.init(i),a.node.runAction(cc.sequence(cc.scaleTo(.05,6),cc.scaleTo(.05,3),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(a.node)}))))),this.hpView.refresh(this.model.HP),this.updateSkillCD()},e.prototype.updateSkillCD=function(){},e.prototype.updateSkillHP=function(){},e.prototype.doEle=function(){},e.prototype.doIce=function(t){var e=this;this.isStop||(l.default.gameAudio.playHurt_iceClip(),this.pauseMove(!0),this.gameView.appendSkeleton(this.node,"attack/fire/bq/skeleton_ske",function(o){e.node.zIndex=1,e.sprite&&(e.sprite.node.active=!1);var i=o;i.node.position=cc.v2(0,-30),i.node.scale=3,i.setAnimation(0,"animation2",!1),i.scheduleOnce(function(){e.resumeMove(!0),e.gameView&&e.gameView.removeSkeleton(i),t&&t()},3)}))},e.prototype.doSwim=function(t,e){var o=this;if(!this.isStop){this.pauseMove(!0),this.isSwiming=!0;var i=this.swimNode;i&&(this.hero?i.node.setPosition(this.hero.node.getPosition().add(cc.v2(0,this.hero.node.height))):i.node.setPosition(this.heroSke.node.getPosition().add(cc.v2(0,this.heroSke.node.height))),i.node.active=!0,i.playAnimation("\u6655",0),this._speedType=d.SpeedType.STOP,this.scheduleOnce(function(){o.resumeMove(!0),this.isSwiming=!1,i.node.active=!1,t&&t()},e))}},e.prototype.doStop=function(t){var e=this;if(!this.isStop){this.pauseMove(!0);var o=this.swimNode,i=this.hero?this.hero.node:this.heroSke.node;o.node.setPosition(i.getPosition().add(cc.v2(0,i.height))),o.node.active=!0,o.playAnimation("\u6655",0),this.scheduleOnce(function(){e.resumeMove(!0),o.node.active=!1,t&&t()},.5)}},e.prototype.doBlood=function(t,e){if(!this.model.isDead()){this.fireNode&&(this.fireNode.node.active=!0,this.fireNode.playAnimation("\u5f85\u673a",0));var o=e/.5,i=t/o;this.curbloodTime=0,this.bloodTime=o,this.bloodfunction=this.cutBlood.bind(this,i),this.schedule(this.bloodfunction,.5,o,0)}},e.prototype.cutBlood=function(t){void 0===t&&(t=.025),cc.log("\u51cf\u6389\u603b\u8840\u91cf\u7684\u591a\u5c11val",t),this.curbloodTime++;var e=Math.floor(t*this.model.MAX_HP);this.model.doHurt(e);var o=this,i=this.gameView&&this.gameView.getCri().getComponent(f.default);i&&(i.node.parent=this.gameView.layout,i.node.setPosition(this.node.getPosition().add(cc.v2(50*Math.random()-50,20*Math.random()+100))),i.node.scale=0,i.init(e),i.node.runAction(cc.sequence(cc.scaleTo(.05,4),cc.scaleTo(.05,2),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){o.gameView.putCri(i.node)})))),this.hpView.refresh(this.model.HP),this.model.isDead()?(this.unschedule(this.bloodfunction),this.fireNode&&(this.fireNode.node.active=!1),this.die()):this.bloodTime==this.curbloodTime&&this.fireNode&&(this.fireNode.node.active=!1),cc.log("\u6d41\u8840\u6b21\u6570",this.curbloodTime)},e.prototype.die=function(){},e.prototype.doCut=function(t){var e=this;this.gameView.appendSkeleton(this.node,"skeleton/hurt12/skeleton",function(o){e.node.zIndex=1;var i=o;i.node.position=cc.v2(0,0),i.node.scale=.3,i.scheduleOnce(function(){e.gameView&&e.gameView.removeSkeleton(i),t&&t()},3)})},e.prototype.move=function(t){var e=1/t;e=Math.max(40,e);var o=cc.v2(0,0),i=cc.v2(0,0);this.skill==c.HeroSkillType.Go&&this.isAtking?(o=this.moveDir.mul(this._moveSpeed/e).add(this.goSkillOffect.mul(1/e)),i=this.node.getPosition().add(o)):(o=this.moveDir.mul(this._moveSpeed/e).add(this.offect.mul(1/e)),i=this.node.getPosition().add(o)),i.equals(this.node.getPosition())||(this.node.setPosition(this.check(i)),this.node.zIndex=2*-Math.floor((this.node.y+this.gameView.mapSizeY/2)/this.gameView.size)-1)},e.prototype.pauseMove=function(t){void 0===t&&(t=!1),t&&!this.isStop&&(this.isStop=!0,this.offect=cc.Vec2.ZERO,this.attacking=!1),this._speedType=d.SpeedType.STOP},e.prototype.resumeMove=function(t){void 0===t&&(t=!1),t&&this.isStop&&(this.isStop=!1,this.offect=cc.Vec2.ZERO,this.attacking=!0),this._speedType=d.SpeedType.NORMAL},e.prototype.check=function(t){var e=this,o=Math.abs((this.node.width-this.gameView.mapSizeX)/2),i=Math.abs((this.node.height-this.gameView.mapSizeY)/2);t.x>o?t.x=o:t.x<-o&&(t.x=-o),t.y>i?t.y=i-this.node.height:t.y<-i&&(t.y=-i);var n=this.node.getBoundingBox();n.x+=t.sub(this.node.getPosition()).x,n.y+=t.sub(this.node.getPosition()).y,n.height+=3;var a=new Set;if(this.gameView&&this.gameView.quadTree.retrieve(n).forEach(function(o){var i=!1;if(i=e.gameView.nameList.indexOf(o.node.name)>-1&&e.moveCan.indexOf(o.type)>-1,e.isAtking&&e.skill==c.HeroSkillType.Go&&(i=e.gameView.nameList.indexOf(o.node.name)>-1&&e.moveCan.indexOf(o.type)>-1&&o.type!==p.ItemType.BOX&&o.type!==p.ItemType.CN),i){var n=0,r=cc.v2(o.node.position),s=cc.v2(t.x,e.node.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),l=cc.v2(e.node.x,t.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),d=(o.node.width+e.node.width)/2,u=(o.node.height+e.node.height)/2;(Math.abs(r.x-s.x)>=d||Math.abs(r.y-s.y)>=u||t.sub(r).mag()>e.node.getPosition().sub(r).mag()&&!cc.Intersection.lineRect(cc.v2(e.node.x,e.node.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),s,o.node.getBoundingBox()))&&n++,(Math.abs(r.x-l.x)>=d||Math.abs(r.y-l.y)>=u||t.sub(r).mag()>e.node.getPosition().sub(r).mag()&&!cc.Intersection.lineRect(cc.v2(e.node.x,e.node.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),l,o.node.getBoundingBox()))&&(n+=2),a.add(n)}}),a.size<5){var r=Array.from(a.values()),s=r.every(function(t){return 3==t}),l=r.every(function(t){return 1==t||3==t}),d=r.every(function(t){return 2==t||3==t});s||(l?t.y=this.node.y:d?t.x=this.node.x:t=this.node.getPosition())}else t=this.node.getPosition();return t},e.prototype.checkTarget=function(t){return t&&t.model&&!t.model.isDead()},e.prototype.findTargets=function(){var t=this;return this.gameView.targets.filter(function(e){return t.checkTarget(e)&&e.model.group!=t.model.group}).sort(function(e,o){return e.node.position.sub(t.node.position).mag()-o.node.position.sub(t.node.position).mag()})},e.prototype.getDir=function(t){return void 0===t&&(t=this.target),this.checkTarget(t)?cc.v2(t.node.getPosition().sub(this.node.getPosition()).normalizeSelf()):this.moveDir},e.prototype.getOffect=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.dragon?cc.v2(t,e):cc.Vec2.ZERO},e.prototype.updateDir=function(t){t=t||this.moveDir,this.dragon&&(Math.abs(t.x)>.2&&(t.x>0?this.dragon.node.scaleX=.4:this.dragon.node.scaleX=-.4),this.dragon.node.scaleY=.4,this.sprite&&(this.dragon.node.scaleX>0?this.sprite.node.angle=-(-90+cc.misc.radiansToDegrees(Math.atan2(t.x,t.y))):this.sprite.node.angle=-(-90-cc.misc.radiansToDegrees(Math.atan2(t.x,t.y)))))},a([v(cc.Sprite)],e.prototype,"sprite",void 0),a([v(m.default)],e.prototype,"hpView",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"dragon",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"hero",void 0),a([v(sp.Skeleton)],e.prototype,"heroSke",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"flyMount",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"headMount",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"addHPAni",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"swimNode",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"fireNode",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"breathNormalFloorNode",void 0),a([v(dragonBones.ArmatureDisplay)],e.prototype,"breathNormalNode",void 0),a([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../InitScene/Script/data/OtherData":void 0,"../../InitScene/Script/data/PersonModel":void 0,"../../InitScene/Script/data/PlayerModel":void 0,"../../MainScene/Script/center/Game":"Game","./joystick/JoystickCommon":"JoystickCommon","./manage/GameManage":"GameManage","./test/EditView":"EditView","./view/game/AddHpView":"AddHpView","./view/game/CriView":"CriView","./view/game/HpView":"HpView"}],BaseView:[function(t,e,o){"use strict";cc._RF.push(e,"af95alarVZBQqpCZ0mGJLT0","BaseView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/PlayerData"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text="base",e}return n(e,t),e.prototype.start=function(){},e.prototype.showPnl=function(){r.default.isChange=!0,this.node&&!this.node.active&&(this.node.active=!0)},e.prototype.hidePnl=function(){r.default.isChange=!0,this.node&&this.node.active&&(this.node.active=!1)},e.prototype.changeBtn=function(){},a([l],e.prototype,"text",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../InitScene/Script/data/PlayerData":void 0}],BgView:[function(t,e,o){"use strict";cc._RF.push(e,"dae606CCTVCI7zQIQUGRiw0","BgView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.box_sprite=null,e.width=0,e.height=0,e}return n(e,t),e.prototype.onLoad=function(){var t=cc.view.getCanvasSize();t.width/t.height<1.7?(cc.Canvas.instance.fitWidth=!0,cc.Canvas.instance.fitHeight=!1):(cc.Canvas.instance.fitWidth=!1,cc.Canvas.instance.fitHeight=!0),this.node.setContentSize(cc.winSize),this.width=this.box_sprite.node.width,this.height=this.box_sprite.node.height,this.box_sprite.node.width=(Math.ceil(cc.winSize.width/this.width)+4)*this.width,this.box_sprite.node.height=(Math.ceil(cc.winSize.height/this.height)+4)*this.height},e.prototype.start=function(){var t=this;this.box_sprite.node.runAction(cc.repeatForever(cc.sequence(cc.moveBy(12,cc.v2(this.width,this.height)),cc.callFunc(function(){t.box_sprite.node.position=cc.Vec2.ZERO}))))},a([s(cc.Sprite)],e.prototype,"box_sprite",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BoneLabel:[function(t,e,o){"use strict";cc._RF.push(e,"43d1ecIVsFI/7RcV098hddp","BoneLabel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=cc._decorator,s=c.ccclass,l=c.property,d=c.requireComponent,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._label=null,e.isMini=!0,e.bone=0,e}return n(e,t),e.prototype.onLoad=function(){this._label=this.node.getComponent(cc.Label)},e.prototype.start=function(){r.default.on(r.GameDataEvent.EVENT_TOTAL_BONE_CHANGE,this.totalBoneChange,this),this.setBone(r.default.totalBoneNum)},e.prototype.totalBoneChange=function(t){this.bone=t,this.setBone(t)},e.prototype.setBone=function(t){if(this.isMini){var e=t<1e3?t:t<1e4?Math.floor(t/1e3)+"*":Math.floor(t/1e4)+",";this._label.string=e+""}else this._label.string=t+""},e.prototype.onDestroy=function(){r.default.off(r.GameDataEvent.EVENT_TOTAL_BONE_CHANGE,this.totalBoneChange,this)},a([l({tooltip:"\u662f\u5426\u7b80\u5316\u663e\u793a\u6570\u91cf"})],e.prototype,"isMini",void 0),a([s,d(cc.Label)],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0}],BoneNode:[function(t,e,o){"use strict";cc._RF.push(e,"4b3a6rkNPlFgZZXX0VDwnBT","BoneNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.BoneEvent=void 0;var r,c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property;(function(t){t.TotalBoneChangeAnimoEvent="total_bone_change_animo_event",t.TotalBoneUseAnimoEvent="total_bone_use_animo_event"})(r=o.BoneEvent||(o.BoneEvent={}));var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._moreBoneOpenCount=0,e.boneNode=null,e.animoList=[],e}return n(e,t),e.prototype.start=function(){c.default.event.on(r.TotalBoneChangeAnimoEvent,this.playAnimo,this),c.default.event.on(r.TotalBoneUseAnimoEvent,this.playUseAnimo,this)},e.prototype.onOpenMoreBone=function(){c.default.uiCenter.showUi("FuliNode")},e.prototype.playAnimo=function(t,e){if(this.enabledInHierarchy){for(var o=[],i=0;i<5;i++){var n=cc.instantiate(this.boneNode);e.addChild(n),o.push(n)}var a,r,c=function(){var n=o[i];n.active=!0,t instanceof cc.Touch?(a=e.convertToNodeSpaceAR(t.getLocation()),n.x=a.x,n.y=a.y):(a=e.convertToNodeSpaceAR(t),n.x=a.x,n.y=a.y),n.scale=1,r=e.convertToNodeSpaceAR(s.node.convertToWorldSpaceAR(new cc.Vec2(s.boneNode.x,s.boneNode.y))),n.runAction(cc.sequence(cc.delayTime(.025*i),cc.spawn(cc.moveTo(.5,r.x,r.y),cc.scaleTo(1,1)),cc.callFunc(function(){n.destroy()},s)))},s=this;for(i=0;i<o.length;i++)c()}},e.prototype.playUseAnimo=function(t,e){if(this.enabledInHierarchy){for(var o=this.boneNode.parent,i=[],n=0;n<5;n++){var a=cc.instantiate(this.boneNode);o.addChild(a),i.push(a)}var r,c,s=function(){var t=i[n];t.active=!0,(r=o.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.Vec2.ZERO))).x+=40*Math.random()-5,r.y+=40*Math.random()-5,t.scale=2,c=l.boneNode.getPosition(),t.runAction(cc.sequence(cc.spawn(cc.moveTo(.25,c.x,c.y),cc.scaleTo(.25,2)),cc.delayTime(.1*n),cc.spawn(cc.moveTo(.8,r.x,r.y),cc.scaleTo(1,1)),cc.callFunc(function(){t.destroy()},l)))},l=this;for(n=0;n<i.length;n++)s()}},e.prototype.onDestroy=function(){c.default.event.off(r.TotalBoneChangeAnimoEvent,this.playAnimo,this),c.default.event.off(r.TotalBoneUseAnimoEvent,this.playUseAnimo,this)},a([d(cc.Node)],e.prototype,"boneNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../center/Game":"Game"}],BoxNode:[function(t,e,o){"use strict";cc._RF.push(e,"d9173hBCjZLHrgd/3T12pUo","BoxNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/prefab/AwardButton"),c=t("../../../../InitScene/Script/center/GameInit"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){l.default.gameAudio.playWindow()},e.prototype.onReceive=function(t){t.target.getComponent(r.default).onClick(t)},e.prototype.airSuccess=function(){l.default.gameAudio.playOpenBox(),s.default.emit(s.GunEvent.OpenAirdrop),this.onClose()},e.prototype.onDouble=function(t){t.target.getComponent(r.default).onClick(t)},e.prototype.doubleSuccess=function(){l.default.gameAudio.playOpenBox(),l.default.mainUI.appendEquip(s.default.getSeniorBoxGunId(),0),this.onClose()},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([u],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game"}],BoxView:[function(t,e,o){"use strict";cc._RF.push(e,"94c0crWVGFOyrM2YfTl7qbf","BoxView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rankLabel=null,e.rank=null,e.light=null,e.gun=null,e.idx=0,e.item=null,e.equip=null,e}return n(e,t),e.prototype.start=function(){this.refresh()},e.prototype.appendItem=function(t){t&&(this.item=t,this.item.init(this),this.resumeItem(),this.refresh())},e.prototype.removeItem=function(){this.hideRank(),this.item.node.destroy(),this.item=null},e.prototype.resumeItem=function(){this.item.node.parent=this.gun,this.item.node.setPosition(cc.Vec2.ZERO)},e.prototype.refresh=function(){this.item?(this.rankLabel.string=(this.item.rank+1).toString(),this.showRank()):(this.hideRank(),this.hideLight())},e.prototype.showRank=function(){this.rank.active||(this.rank.active=!0)},e.prototype.hideRank=function(){this.rank.active&&(this.rank.active=!1)},e.prototype.showLight=function(){this.light.active||(this.light.active=!0,this.light.opacity=255,this.light.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.4,100),cc.fadeIn(.8)))),this.item.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.2,1.1),cc.scaleTo(.2,1),cc.delayTime(.8)))))},e.prototype.hideLight=function(){this.light.active&&(this.light.active=!1,this.light.stopAllActions(),this.item.node.stopAllActions(),this.item.node.scale=1)},a([s(cc.Label)],e.prototype,"rankLabel",void 0),a([s(cc.Node)],e.prototype,"rank",void 0),a([s(cc.Node)],e.prototype,"light",void 0),a([s(cc.Node)],e.prototype,"gun",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BoyGuestNode:[function(t,e,o){"use strict";cc._RF.push(e,"4c13fV7vpJOgJOuKAnYOmGL","BoyGuestNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderDragonBones"),c=t("../../../InitScene/Script/data/GuessModel"),s=t("../../../InitScene/Script/data/GuessModel"),l=t("../../../InitScene/Script/data/PersonModel"),d=t("../../Script/center/Game"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.armatureDisplay=null,e.byArmatureDisplay=null,e.animation=null,e.drunkAnimation=null,e.dialogAnimation=null,e.dialogLabel=null,e.drunkAudioClip=null,e.weepAudioClip=null,e._guestInfo=null,e.drunk=0,e.isDrunk=!1,e}return n(e,t),e.prototype.start=function(){this.init(),this.dialogAnimation.node.scale=0},e.prototype.init=function(){var t=this;this._guestInfo=s.default.getCurGuest(),r.default.addLoaderDragonBones(this.armatureDisplay).loadArmature("hero/dragon/"+l.default.getHeroDataById(this._guestInfo.id).skeUrl,function(e){e||(t.armatureDisplay.armatureName="armatureName",t.armatureDisplay.playAnimation("\u8ba4\u771f",0))}),r.default.addLoaderDragonBones(this.byArmatureDisplay).loadArmature("hero/dragon/"+l.default.getHeroDataById(this._guestInfo.id).skeUrl,function(e){e||(t.byArmatureDisplay.armatureName="armatureName",t.byArmatureDisplay.playAnimation("\u80cc\u5bf9\u7ad9\u7acb",0))}),this.animation.play("boy_1").wrapMode=cc.WrapMode.Reverse},e.prototype.onRollDiceLose=function(t){this.drunkAnimation.once(cc.Animation.EventType.FINISHED,this.playSleep.bind(this,t)),this.drunkAnimation.play("drunk_1").repeatCount=2,this.isDrunk=!0,this.showDialog(c.default.getDialog(this._guestInfo.rollLoseDialogue))},e.prototype.onBoyBeer=function(t){var e=this;this.animation.play("boy_1").wrapMode=cc.WrapMode.Normal,d.default.mainAudio.playEffect(this.drunkAudioClip),this.armatureDisplay.once(dragonBones.EventObject.COMPLETE,function(){e.onDrunk(t)}),this.armatureDisplay.playAnimation("\u8ba4\u771f",2)},e.prototype.onDrunk=function(t){var e=this;this.drunk++,this.drunk>=2?this.armatureDisplay.playAnimation("\u6655\u4e4e\u4e4e",2):this.armatureDisplay.playAnimation("\u8ba4\u771f",2),this.drunkAnimation.play("drunk_1").repeatCount=2,this.armatureDisplay.once(dragonBones.EventObject.COMPLETE,function(){e.animation.play("boy_1").wrapMode=cc.WrapMode.Reverse}),this.showDialog(c.default.getDialog(this._guestInfo.rollWrongDialogue),t)},e.prototype.showDialog=function(t,e){this.dialogAnimation.node.active=!0,this.dialogLabel.string=t,this.dialogAnimation.once(cc.Animation.EventType.FINISHED,function(){e&&e()}),this.dialogAnimation.play("dialog_1")},e.prototype.onRollDiceWin=function(){this.animation.play("boy_1").wrapMode=cc.WrapMode.Normal,this.armatureDisplay.playAnimation("\u5077\u7740\u4e50",0)},e.prototype.playSleep=function(t){d.default.uiCenter.getUI("GuessNode").runAction(cc.sequence(cc.moveBy(.2,0,-50),cc.moveBy(.2,0,50))),this.byArmatureDisplay.once(dragonBones.EventObject.LOOP_COMPLETE,function(){t&&t()}),this.byArmatureDisplay.playAnimation("\u9189\u5012",0)},e.prototype.guessTrue=function(){var t=this;this.armatureDisplay.once(dragonBones.EventObject.COMPLETE,function(){t.animation.play("boy_1").wrapMode=cc.WrapMode.Reverse}),this.animation.play("boy_1").wrapMode=cc.WrapMode.Normal,this.armatureDisplay.playAnimation("\u5077\u7740\u4e50",2)},a([h(dragonBones.ArmatureDisplay)],e.prototype,"armatureDisplay",void 0),a([h(dragonBones.ArmatureDisplay)],e.prototype,"byArmatureDisplay",void 0),a([h(cc.Animation)],e.prototype,"animation",void 0),a([h(cc.Animation)],e.prototype,"drunkAnimation",void 0),a([h(cc.Animation)],e.prototype,"dialogAnimation",void 0),a([h(cc.Label)],e.prototype,"dialogLabel",void 0),a([h({type:cc.AudioClip})],e.prototype,"drunkAudioClip",void 0),a([h({type:cc.AudioClip})],e.prototype,"weepAudioClip",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../InitScene/Script/data/GuessModel":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../framework/Script/component/LoaderDragonBones":void 0,"../../Script/center/Game":"Game"}],BtnListNode:[function(t,e,o){"use strict";cc._RF.push(e,"a0fa6D+u9ZEQ75vPFXX+RAx","BtnListNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listNode=null,e.btnNode=null,e.hide_x=-100,e.show_x=80,e.isRun=!1,e}return n(e,t),e.prototype.start=function(){this.listNode.setPosition(cc.v2(-this.listNode.width,0)),this.btnNode.setPosition(cc.v2(this.show_x,0))},e.prototype.showList=function(){var t=this;this.listNode.active=!0,this.listNode.runAction(cc.sequence(cc.moveTo(.3,cc.v2(this.show_x,0)),cc.callFunc(function(){t.isRun=!1},this)))},e.prototype.hideList=function(){this.listNode.runAction(cc.sequence(cc.moveTo(.3,cc.v2(-this.listNode.width,0)),cc.callFunc(this.showPoint,this)))},e.prototype.showPoint=function(){var t=this;this.btnNode.active=!0,this.btnNode.runAction(cc.sequence(cc.moveTo(.1,cc.v2(this.show_x,0)),cc.callFunc(function(){t.isRun=!1},this)))},e.prototype.hidePoint=function(){this.btnNode.runAction(cc.sequence(cc.moveTo(.1,cc.v2(-this.btnNode.width-30,0)),cc.callFunc(this.showList,this)))},e.prototype.onClick=function(){this.isRun||(this.isRun=!0,this.hidePoint(),this.scheduleOnce(this.hideList,3))},e.prototype.onClickHide=function(){this.isRun||(this.isRun=!0,this.unschedule(this.hideList),this.hideList())},a([s(cc.Node)],e.prototype,"listNode",void 0),a([s(cc.Node)],e.prototype,"btnNode",void 0),a([s],e.prototype,"hide_x",void 0),a([s],e.prototype,"show_x",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BulletNode:[function(t,e,o){"use strict";cc._RF.push(e,"d8f36DAAmZFHolK7wmnNuQZ","BulletNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletAnimation=null,e.bulletAnimationClips=[],e}return n(e,t),e.prototype.onEnable=function(){var t=this;this.bulletAnimation.on(cc.Animation.EventType.FINISHED,function(){t.bulletAnimation.play(t.bulletAnimationClips[1].name)}),this.bulletAnimation.play(this.bulletAnimationClips[0].name)},a([s(cc.Animation)],e.prototype,"bulletAnimation",void 0),a([s([cc.AnimationClip])],e.prototype,"bulletAnimationClips",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],ButtonScaleBreathe:[function(t,e,o){"use strict";cc._RF.push(e,"d063et2mR5LUoaDOIgzvfSK","ButtonScaleBreathe");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scale1=1.05,e.scale2=1.1,e.scale3=1,e}return n(e,t),e.prototype.start=function(){var t=cc.scaleTo(.25,this.scale1),e=cc.scaleTo(.25,this.scale2),o=cc.scaleTo(.25,this.scale3);cc.tween(this.node).then(cc.repeatForever(cc.sequence(t,o,e,o,cc.delayTime(1)))).start()},a([s(cc.Float)],e.prototype,"scale1",void 0),a([s(cc.Float)],e.prototype,"scale2",void 0),a([s(cc.Float)],e.prototype,"scale3",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],BuyItem:[function(t,e,o){"use strict";cc._RF.push(e,"fa9bbyERc9NpLS+Baax6s5+","BuyItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GunModel"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.sprite=null,e.rank=0,e.price=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.refresh=function(){this.rank=this.getRank(),this.price=r.default.getPrice(this.rank),this.label.string=this.formatNumber(this.price),console.log("buyItem\u2014\u2014refresh\u786e\u8ba4\uff1a\u66f4\u65b0\u4ef7\u683c",this.price,this.rank)},e.prototype.formatNumber=function(t){if(isNaN(t))return"0";if(t<1e3)return t.toFixed();if(t<1e6)return(t/1e3).toFixed(2)+"K";if(t<1e9)return(t/1e3/1e3).toFixed(2)+"M";if(t<1e12)return(t/1e3/1e3/1e3).toFixed(2)+"B";if(t<1e15)return(t/1e3/1e3/1e3/1e3).toFixed(2)+"T";var e=Math.round(t).toString(),o=e.indexOf("e+");if(o>0){var i=e.substr(o+2);return e.substr(0,4)+"/"+i}var n=Math.round(t).toString().length-1;return(t/Math.pow(10,n)).toFixed()+"/"+n},e.prototype.getRank=function(){var t;return t=r.default.maxLevelCanBuy,console.log("buyItem\u2014\u2014getRank\u786e\u8ba4\uff1a\u66f4\u65b0\u67aa\u652f\u56fe",t),t},a([l(cc.Label)],e.prototype,"label",void 0),a([l(cc.Sprite)],e.prototype,"sprite",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../InitScene/Script/data/GunModel":void 0}],CardBuffNode:[function(t,e,o){"use strict";cc._RF.push(e,"ef850AucolBBruaJ9A5LCA5","CardBuffNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/CardModel"),c=t("../../../../../InitScene/Script/data/CombineHeroModel"),s=t("../../../../../InitScene/Script/data/GunModel"),l=t("../../../../../InitScene/Script/data/MountModel"),d=t("../../../../../InitScene/Script/data/PersonModel"),u=t("../../../../Script/center/Game"),p=t("../../../manage/GameManage"),h=cc._decorator,f=h.ccclass,m=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalCardID=[],e.clearCardID=[],e.doubleCardID=[],e.callback=null,e.gunAtkBuff=0,e.CDtimeBuff=0,e.MOVE_SPEBuff=0,e.CUT_HURTBuff=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.openCard=function(){u.default.uiCenter.showUi("CardNode")},e.prototype.addBuff=function(){this.gunAtkBuff=0,this.CDtimeBuff=0,this.MOVE_SPEBuff=0,this.CUT_HURTBuff=0;for(var t=0;t<this.normalCardID.length;t++){var e=this.normalCardID[t],o=r.default.getCardInfoById(e);this.onAward(o)}for(t=0;t<this.doubleCardID.length;t++)e=this.doubleCardID[t],o=r.default.getCardInfoById(e),this.onDouble(o)},e.prototype.onDouble=function(t){var e=p.default.getInstance().gameView.curPlayer,o=d.default.getHeroDataById(e.personIdx),i=s.default.getGunDataById(e.gunIdx),n=l.default.getUpgradeLevelValue(e.mountIdx,e.mount_level),a=""+e.personIdx+e.mountIdx+Math.min(Math.floor(e.mount_level/l.FormMaxLevel)+1,5),u=c.default.getHeroDataById(a),h=e.isCombine;switch(t.card_type){case r.CardType.ADD_ATK:this.gunAtkBuff+=2*t.val,e.model.ATK=h?Math.floor((o.ATK+i.combine_ATK+i.combine_ATK*this.gunAtkBuff+n.atk)*(u.atkBuff/100)):Math.floor(o.ATK+i.ATK+i.ATK*this.gunAtkBuff+n.atk);break;case r.CardType.CD_SPE:this.CDtimeBuff+=2*t.val,h?(e.CDtime=o.skillCD-o.skillCD*this.CDtimeBuff,e.combineCDtime=u.skillCD-u.skillCD*this.CDtimeBuff):e.CDtime=o.skillCD-o.skillCD*this.CDtimeBuff;break;case r.CardType.CUT_HURT:this.CUT_HURTBuff+=2*t.val,e.model.CUT_HURT+=this.CUT_HURTBuff;break;case r.CardType.MOVE_SPE:this.MOVE_SPEBuff+=2*t.val,e.model.SPE=h?Math.floor((o.MOVESPE+i.combine_SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff)):Math.floor((o.MOVESPE+i.SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff));break;case r.CardType.RESUME_HP:e.model.HP=e.model.MAX_HP,e.hpView.reset();break;default:cc.log("\u6682\u65e0\u7c7b\u578b\uff1a",t.card_type)}if(t.style==r.CardStyle.Random)switch(t.extra){case r.CardType.ADD_ATK:this.gunAtkBuff+=2*t.extra_val,e.model.ATK=h?Math.floor((o.ATK+i.combine_ATK+i.combine_ATK*this.gunAtkBuff+n.atk)*(u.atkBuff/100)):Math.floor(o.ATK+i.ATK+i.ATK*this.gunAtkBuff+n.atk);break;case r.CardType.CD_SPE:this.CDtimeBuff+=2*t.extra_val,e.CDtime=h?u.skillCD-u.skillCD*this.CDtimeBuff:o.skillCD-o.skillCD*this.CDtimeBuff;break;case r.CardType.CUT_HURT:this.CUT_HURTBuff+=2*t.extra_val,e.model.CUT_HURT+=this.CUT_HURTBuff;break;case r.CardType.MOVE_SPE:this.MOVE_SPEBuff+=2*t.extra_val,e.model.SPE=h?Math.floor((o.MOVESPE+i.combine_SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff)):Math.floor((o.MOVESPE+i.SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff));break;case r.CardType.RESUME_HP:e.model.HP=e.model.MAX_HP,e.hpView.reset();break;default:cc.log("\u6682\u65e0\u7c7b\u578b\uff1a",t.card_type)}},e.prototype.onClear=function(){var t=p.default.getInstance().gameView.curPlayer;t.model.HP=t.model.MAX_HP,t.hpView.reset()},e.prototype.onAward=function(t){var e=p.default.getInstance().gameView.curPlayer,o=d.default.getHeroDataById(e.personIdx),i=s.default.getGunDataById(e.gunIdx),n=l.default.getUpgradeLevelValue(e.mountIdx,e.mount_level),a=""+e.personIdx+e.mountIdx+Math.min(Math.floor(e.mount_level/l.FormMaxLevel)+1,5),u=c.default.getHeroDataById(a),h=e.isCombine;switch(t.card_type){case r.CardType.ADD_ATK:this.gunAtkBuff+=t.val,e.model.ATK=h?Math.floor((o.ATK+i.combine_ATK+i.combine_ATK*this.gunAtkBuff+n.atk)*(u.atkBuff/100)):Math.floor(o.ATK+i.ATK+i.ATK*this.gunAtkBuff+n.atk);break;case r.CardType.CD_SPE:this.CDtimeBuff+=t.val,h?(e.CDtime=o.skillCD+o.skillCD*this.CDtimeBuff,e.combineCDtime=u.skillCD+u.skillCD*this.CDtimeBuff):e.CDtime=o.skillCD+o.skillCD*this.CDtimeBuff;break;case r.CardType.CUT_HURT:this.CUT_HURTBuff+=t.val,e.model.CUT_HURT+=this.CUT_HURTBuff;break;case r.CardType.MOVE_SPE:this.MOVE_SPEBuff+=t.val,e.model.SPE=h?Math.floor((o.MOVESPE+i.combine_SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff)):Math.floor((o.MOVESPE+i.SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff));break;case r.CardType.RESUME_HP:e.model.HP=e.model.MAX_HP,e.hpView.reset();break;default:cc.log("\u6682\u65e0\u7c7b\u578b\uff1a",t.card_type)}if(t.style==r.CardStyle.Random)switch(t.extra){case r.CardType.ADD_ATK:this.gunAtkBuff+=t.extra_val,e.model.ATK=h?Math.floor((o.ATK+i.combine_ATK+i.combine_ATK*this.gunAtkBuff+n.atk)*(u.atkBuff/100)):Math.floor(o.ATK+i.ATK+i.ATK*this.gunAtkBuff+n.atk);break;case r.CardType.CD_SPE:this.CDtimeBuff+=t.extra_val,e.CDtime=h?u.skillCD-u.skillCD*this.CDtimeBuff:o.skillCD-o.skillCD*this.CDtimeBuff;break;case r.CardType.CUT_HURT:this.CUT_HURTBuff+=t.extra_val,e.model.CUT_HURT+=this.CUT_HURTBuff;break;case r.CardType.MOVE_SPE:this.MOVE_SPEBuff+=t.extra_val,e.model.SPE=h?Math.floor((o.MOVESPE+i.combine_SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff)):Math.floor((o.MOVESPE+i.SPE+n.spe)*(1+this.MOVE_SPEBuff+e.speBuff));break;case r.CardType.RESUME_HP:e.model.HP=e.model.MAX_HP,e.hpView.reset();break;default:cc.log("\u6682\u65e0\u7c7b\u578b\uff1a",t.card_type)}},e.prototype.finish=function(){this.callback&&this.callback(),this.callback=null},a([f],e)}(cc.Component));o.default=m,cc._RF.pop()},{"../../../../../InitScene/Script/data/CardModel":void 0,"../../../../../InitScene/Script/data/CombineHeroModel":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../Script/center/Game":"Game","../../../manage/GameManage":"GameManage"}],CardInfoNode:[function(t,e,o){"use strict";cc._RF.push(e,"5872a87wp1K0JPe1K1Xt3oa","CardInfoNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderSprite"),c=t("../../../../../InitScene/Script/data/CardModel"),s=t("../../../../Script/center/Game"),l=t("../../../manage/GameManage"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tipSprite=null,e.tipSpriteFrame=[],e.bgSprite=null,e.bgSpriteFrame=[],e.iconSprite=null,e.nameSprite=null,e.descLabel=null,e.cardNode=null,e.btnNode=null,e.videoDoubleNode=null,e.videoCutNode=null,e.cardData=null,e.double_video=0,e.clear_video=0,e.cardBuffNode=null,e}return n(e,t),e.prototype.start=function(){var t=this;this.btnNode.active=!1,this.cardBuffNode=l.default.getInstance().gameView.cardBuffNode,this.cardData.style==c.CardStyle.Random?this.ani():this.scheduleOnce(function(){t.btnNode.active=!0},.5)},e.prototype.ani=function(){var t=this;this.cardNode.scaleX=0,this.cardNode.runAction(cc.scaleTo(.3,1,1)),this.scheduleOnce(function(){t.btnNode.active=!0},1.3)},e.prototype.setData=function(t){this.cardData=t,this.updateUI()},e.prototype.updateUI=function(){this.bgSprite.spriteFrame=this.bgSpriteFrame[this.cardData.style],this.tipSprite.spriteFrame=this.tipSpriteFrame[this.cardData.style];var t,e,o=this.cardData.name;this.cardData.style==c.CardStyle.Normal?(t="card/name/"+o,r.default.addLoaderSprite(this.nameSprite).loadSprite(t),e="card/icon/"+o,r.default.addLoaderSprite(this.iconSprite).loadSprite(e)):(e="card/icon/"+this.cardData.icon,r.default.addLoaderSprite(this.iconSprite).loadSprite(e)),this.descLabel.string=this.cardData.desc,this.cardData.extra_desc&&(this.descLabel.string=this.cardData.extra_desc,this.cardData.video_clear>0&&(this.descLabel.node.color=cc.color(255,0,0))),this.videoDoubleNode.active=this.cardData.video>0,this.videoCutNode.active=this.cardData.video_clear>0},e.prototype.onDouble=function(){this.double_video++,this.double_video<this.cardData.video||(this.cardBuffNode.onDouble(this.cardData),this.cardBuffNode.doubleCardID.push(this.cardData.id),this.onClose())},e.prototype.onClear=function(){this.clear_video++,this.clear_video<this.cardData.video_clear||(this.cardBuffNode.onClear(this.cardData),this.cardBuffNode.clearCardID.push(this.cardData.id),this.onClose())},e.prototype.onAward=function(){this.cardBuffNode.onAward(this.cardData),this.cardBuffNode.normalCardID.push(this.cardData.id),this.onClose()},e.prototype.onClose=function(){this.cardBuffNode.finish(),s.default.uiCenter.closeUI(this.node)},a([p(cc.Sprite)],e.prototype,"tipSprite",void 0),a([p([cc.SpriteFrame])],e.prototype,"tipSpriteFrame",void 0),a([p(cc.Sprite)],e.prototype,"bgSprite",void 0),a([p([cc.SpriteFrame])],e.prototype,"bgSpriteFrame",void 0),a([p(cc.Sprite)],e.prototype,"iconSprite",void 0),a([p(cc.Sprite)],e.prototype,"nameSprite",void 0),a([p(cc.Label)],e.prototype,"descLabel",void 0),a([p(cc.Node)],e.prototype,"cardNode",void 0),a([p(cc.Node)],e.prototype,"btnNode",void 0),a([p(cc.Node)],e.prototype,"videoDoubleNode",void 0),a([p(cc.Node)],e.prototype,"videoCutNode",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../../InitScene/Script/data/CardModel":void 0,"../../../../../framework/Script/component/LoaderSprite":void 0,"../../../../Script/center/Game":"Game","../../../manage/GameManage":"GameManage"}],CardItemNode:[function(t,e,o){"use strict";cc._RF.push(e,"9ffc0z3Fq1McI1p6Q3KUf8H","CardItemNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderSprite"),c=t("../../../../../InitScene/Script/data/CardModel"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgSprite=null,e.bgSpriteFrame=[],e.iconSprite=null,e.nameSprite=null,e.descLabel=null,e.randomNode=null,e.cardData=null,e.index=0,e}return n(e,t),e.prototype.setData=function(t,e){this.cardData=t,this.index=e,this.updateUI()},e.prototype.updateUI=function(){this.bgSprite.spriteFrame=this.bgSpriteFrame[this.cardData.style],this.randomNode.active=this.cardData.style==c.CardStyle.Random;var t=this.cardData.name,e="card/name/"+t;r.default.addLoaderSprite(this.nameSprite).loadSprite(e);var o="card/icon/"+t;r.default.addLoaderSprite(this.iconSprite).loadSprite(o),this.descLabel.string=this.cardData.desc},e.prototype.onClick=function(){var t=this;this.randomNode.active=!1;var e=0,o=0;this.cardData.style==c.CardStyle.Random?(o=0,e=.3):(o=1.5,e=.1);var i=cc.instantiate(this.node);i.parent=this.node.parent.parent;var n=this.node.convertToWorldSpaceAR(cc.v2(0,0)),a=i.parent.convertToNodeSpaceAR(n);i.setPosition(a),i.runAction(cc.sequence(cc.callFunc(function(){t.node.emit("onHide",t.index)}),cc.spawn(cc.moveTo(.5,0,20),cc.scaleTo(.5,1.5,1.5)),cc.delayTime(2*e),cc.scaleTo(e,o,1.5),cc.callFunc(function(){t.node.emit("onClick",t.cardData)})))},a([d(cc.Sprite)],e.prototype,"bgSprite",void 0),a([d([cc.SpriteFrame])],e.prototype,"bgSpriteFrame",void 0),a([d(cc.Sprite)],e.prototype,"iconSprite",void 0),a([d(cc.Sprite)],e.prototype,"nameSprite",void 0),a([d(cc.Label)],e.prototype,"descLabel",void 0),a([d(cc.Node)],e.prototype,"randomNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../../InitScene/Script/data/CardModel":void 0,"../../../../../framework/Script/component/LoaderSprite":void 0}],CardNode:[function(t,e,o){"use strict";cc._RF.push(e,"f7522+e9oZAa7hLyaigQg42","CardNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/CardModel"),c=t("../../../../Script/center/Game"),s=t("./CardInfoNode"),l=t("./CardItemNode"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contendNode=null,e.itemPrefab=null,e.cardInfoPrefab=null,e.cardArr=[],e}return n(e,t),e.prototype.start=function(){this.cardArr=r.default.getRandomArr();for(var t=0;t<this.cardArr.length;t++)this.creatItem(t)},e.prototype.creatItem=function(t){var e=this.cardArr[t],o=cc.instantiate(this.itemPrefab);o.getComponent(l.default).setData(e,t),o.once("onClick",this.onSelectCard,this),o.once("onHide",this.onHide,this),o.parent=this.contendNode},e.prototype.onSelectCard=function(t){c.default.uiCenter.showUi(this.cardInfoPrefab).getComponent(s.default).setData(t),this.onClose()},e.prototype.onHide=function(t){for(var e=this.contendNode.children,o=0;o<e.length;o++)t!==o?e[o].runAction(cc.fadeOut(.2)):e[o].opacity=0},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([p(cc.Node)],e.prototype,"contendNode",void 0),a([p(cc.Prefab)],e.prototype,"itemPrefab",void 0),a([p(cc.Prefab)],e.prototype,"cardInfoPrefab",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../../InitScene/Script/data/CardModel":void 0,"../../../../Script/center/Game":"Game","./CardInfoNode":"CardInfoNode","./CardItemNode":"CardItemNode"}],ChangeAvatarNode:[function(t,e,o){"use strict";cc._RF.push(e,"647d90F+LhNoYQWlUSp1QLX","ChangeAvatarNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/PersonModel"),c=t("../../center/Game"),s=t("../list/List"),l=t("./AvatarItem"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.avatarList=null,e.changeButton=null,e.heroList=[],e.selectId=0,e}return n(e,t),e.prototype.start=function(){this.heroList=r.default.getHeroList(),this.avatarList.numItems=this.heroList.length,this.selectId=r.default.useAvatarId,this.resetState(),this.changeButton.interactable=!1},e.prototype.onGridList=function(t,e){var o=this;t.getComponent(l.default).setData(this.heroList[e].id),t.on(cc.Node.EventType.TOUCH_END,function(){o.selectId!=o.heroList[e].id&&(o.selectId=o.heroList[e].id,o.setButton(),o.resetState())},this)},e.prototype.resetState=function(){for(var t=0;t<this.avatarList.content.childrenCount;t++)this.avatarList.content.children[t].getComponent(l.default).setState(this.selectId)},e.prototype.setButton=function(){this.changeButton.interactable=this.selectId!=r.default.useAvatarId},e.prototype.onChange=function(){r.default.useAvatarId=this.selectId,this.setButton()},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([p(s.default)],e.prototype,"avatarList",void 0),a([p(cc.Button)],e.prototype,"changeButton",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/PersonModel":void 0,"../../center/Game":"Game","../list/List":"List","./AvatarItem":"AvatarItem"}],ChangeBtnNode:[function(t,e,o){"use strict";cc._RF.push(e,"b241fVgEIVJ65Ao2Gzw79G9","ChangeBtnNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GunModel"),c=t("../../../../InitScene/Script/data/OtherData"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rareGunNode=null,e.rareHeroNode=null,e}return n(e,t),e.prototype.start=function(){this.node.on("videoSuccess",this.updateBtn,this),this.updateBtn()},e.prototype.updateBtn=function(){var t=r.default.getRareGunId();this.rareGunNode.active=!!t,this.rareHeroNode.active=!t&&c.default.watchRareHeroVideo<c.default.rareHeroVideo,this.rareGunNode.active||this.rareHeroNode.active||this.node.destroy()},a([d(cc.Node)],e.prototype,"rareGunNode",void 0),a([d(cc.Node)],e.prototype,"rareHeroNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/OtherData":void 0}],CoinLabel:[function(t,e,o){"use strict";cc._RF.push(e,"fdc95umnoxAAZivmWhMwxLO","CoinLabel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=cc._decorator,s=c.ccclass,l=c.property,d=c.requireComponent,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._label=null,e.isMini=!0,e.coin=0,e}return n(e,t),e.prototype.onLoad=function(){this._label=this.node.getComponent(cc.Label)},e.prototype.start=function(){r.default.on(r.GameDataEvent.EVENT_TOTAL_COIN_CHANGE,this.totalCoinChange,this),this.setCoin(r.default.totalCoinNum)},e.prototype.totalCoinChange=function(t){this.coin=t,this.setCoin(Math.floor(t))},e.prototype.setCoin=function(t){if(this.isMini){var e=this.formatNumber(t);this._label.string=e.toString()}else this._label.string=t+""},e.prototype.formatNumber=function(t){if(isNaN(t))return"0";if(t<1e6)return t.toFixed();if(t<1e7)return(t/1e3/1e3).toFixed(3)+"M";if(t<1e8)return(t/1e3/1e3).toFixed(2)+"M";if(t<1e9)return(t/1e3/1e3).toFixed(1)+"M";if(t<1e10)return(t/1e3/1e3/1e3).toFixed(3)+"B";if(t<1e11)return(t/1e3/1e3/1e3).toFixed(2)+"B";if(t<1e12)return(t/1e3/1e3/1e3).toFixed(1)+"B";if(t<1e13)return(t/1e3/1e3/1e3/1e3).toFixed(3)+"T";if(t<1e14)return(t/1e3/1e3/1e3/1e3).toFixed(2)+"T";if(t<1e15)return(t/1e3/1e3/1e3/1e3).toFixed(1)+"T";var e=Math.round(t).toString(),o=e.indexOf("e+");if(o>0){var i=e.substr(o+2);return e.substr(0,4)+"E"+i}var n=Math.round(t).toString().length-1;return(t/Math.pow(10,n)).toFixed(2)+"E"+n},e.prototype.onDestroy=function(){r.default.off(r.GameDataEvent.EVENT_TOTAL_COIN_CHANGE,this.totalCoinChange,this)},a([l({tooltip:"\u662f\u5426\u7b80\u5316\u663e\u793a\u6570\u91cf"})],e.prototype,"isMini",void 0),a([s,d(cc.Label)],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0}],CoinNode:[function(t,e,o){"use strict";cc._RF.push(e,"e273biNdDNM8Yx7vadliqDp","CoinNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.CoinEvent=void 0;var r,c=t("../../../../InitScene/Script/data/GameData"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property;(function(t){t.TotalCoinChangeAnimoEvent="total_coin_change_animo_event"})(r=o.CoinEvent||(o.CoinEvent={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._moreCoinOpenCount=0,e.coinNode=null,e.animoList=[],e}return n(e,t),e.prototype.start=function(){s.default.event.on(r.TotalCoinChangeAnimoEvent,this.playAnimo,this),s.default.event.on(c.GameDataEvent.AWARD_RAIN,this.playRain,this)},e.prototype.onOpenMoreCoin=function(){s.default.uiCenter.showUi("FuliNode")},e.prototype.playAnimo=function(t,e){if(this.enabledInHierarchy){for(var o=[],i=0;i<5;i++){var n=cc.instantiate(this.coinNode);e.addChild(n),o.push(n)}var a,r,c=function(){var n=o[i];n.active=!0,t instanceof cc.Touch?(a=e.convertToNodeSpaceAR(t.getLocation()),n.x=a.x,n.y=a.y):(a=e.convertToNodeSpaceAR(t),n.x=a.x,n.y=a.y),n.scale=1,r=e.convertToNodeSpaceAR(s.node.convertToWorldSpaceAR(new cc.Vec2(s.coinNode.x,s.coinNode.y))),n.runAction(cc.sequence(cc.delayTime(.025*i),cc.spawn(cc.moveTo(.5,r.x,r.y),cc.scaleTo(1,1)),cc.callFunc(function(){n.destroy()},s)))},s=this;for(i=0;i<o.length;i++)c()}},e.prototype.playRain=function(){var t=cc.find("Canvas"),e=cc.v2(0,t.height);if(this.enabledInHierarchy){s.default.gameAudio.playOfflineCoin();for(var o=[],i=0;i<40;i++){var n=cc.instantiate(this.coinNode);t.addChild(n),o.push(n)}var a,r,l=function(){var n=i,l=o[i];l.opacity=0,l.active=!0,e instanceof cc.Touch?(a=t.convertToNodeSpaceAR(e.getLocation()).add(cc.v2(750*Math.random(),0)),l.x=a.x,l.y=a.y):(a=t.convertToNodeSpaceAR(e).add(cc.v2(750*Math.random(),30*Math.random()-15)),l.x=a.x,l.y=a.y),l.scale=1.5,r=cc.v3(a.x+(100*Math.random()-50),-700,0),l.runAction(cc.sequence(cc.delayTime(.03*i),cc.fadeIn(.5),cc.moveTo(1,r.x,r.y),cc.callFunc(function(){l.destroy(),n==o.length-10&&s.default.event.emit(c.GameDataEvent.AWARD_RAIN_OVER)},d)))},d=this;for(i=0;i<o.length;i++)l()}},e.prototype.onDestroy=function(){s.default.event.off(r.TotalCoinChangeAnimoEvent,this.playAnimo,this)},a([u(cc.Node)],e.prototype,"coinNode",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../center/Game":"Game"}],ColorEggNode:[function(t,e,o){"use strict";cc._RF.push(e,"7af4bvExANGZItRNVq6Tv6I","ColorEggNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../center/Game"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eggWallNode=null,e.eggWallToggle=null,e}return n(e,t),e.prototype.start=function(){this.eggWallToggle.check()},e.prototype.showEggWallNode=function(){this.eggWallNode.active=!0},e.prototype.onClose=function(){r.default.uiCenter.closeUI(this.node)},a([l(cc.Node)],e.prototype,"eggWallNode",void 0),a([l(cc.Toggle)],e.prototype,"eggWallToggle",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../center/Game":"Game"}],CombineAni:[function(t,e,o){"use strict";cc._RF.push(e,"88f19+GmflD8ZXf9muad1Gz","CombineAni");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../../InitScene/Script/data/MountModel"),s=t("../../../../../InitScene/Script/data/PersonModel"),l=t("../../../../Script/center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hero=null,e.mount=null,e.heroFlash=null,e.mountFlash=null,e.light=null,e.combineAni=null,e.heroSke=null,e.mountSke=null,e.callback=null,e}return n(e,t),e.prototype.start=function(){var t=this;l.default.gameAudio.playCombineHeroPowerClip(),this.light.playAnimation("newAnimation",1),this.combineAni.once(cc.Animation.EventType.FINISHED,function(){l.default.gameAudio.playCombineHeroClip(),t.callback&&t.callback(),t.node.destroy()},this),this.combineAni.play("combine")},e.prototype.setData=function(t,e,o,i){this.callback=i;var n=c.default.getMountSkeUrl(e,o),a=this;r.default.addLoadingAssetNode(this.mountSke.node).loadAsset(n,sp.SkeletonData,function(t,e){a.scheduleOnce(function(){a.mountSke.skeletonData=e,a.mountSke.animation="daiji"})});var l=s.default.getHeroDataById(t);r.default.addLoadingAssetNode(this.heroSke.node).loadAsset("hero/dragon/"+l.skeUrl,sp.SkeletonData,function(t,e){a.scheduleOnce(function(){a.heroSke.skeletonData=e,a.heroSke.animation="daiji-daishou"})})},a([p(dragonBones.ArmatureDisplay)],e.prototype,"hero",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"mount",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"heroFlash",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"mountFlash",void 0),a([p(dragonBones.ArmatureDisplay)],e.prototype,"light",void 0),a([p(cc.Animation)],e.prototype,"combineAni",void 0),a([p(sp.Skeleton)],e.prototype,"heroSke",void 0),a([p(sp.Skeleton)],e.prototype,"mountSke",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../Script/center/Game":"Game"}],CombineNode:[function(t,e,o){"use strict";cc._RF.push(e,"26eb7TcxyRFFbJprUZZQNUV","CombineNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/GameData"),c=t("../../../../../InitScene/Script/data/GuideModel"),s=t("../../../../Script/center/Game"),l=t("../../../manage/GameManage"),d=t("./CombineAni"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.combineButton=null,e.CDSprite=null,e.skillNode=null,e.combineSkillNode=null,e.BlockInputEvents=null,e.combineAniPrefab=null,e.CDLabel=null,e.tipNode=null,e.isCanCombine=!1,e.gameview=null,e.energy=0,e.maxTime=40,e.time=0,e.isCombining=!1,e}return n(e,t),e.prototype.start=function(){this.BlockInputEvents.active=!1,this.gameview=l.default.getInstance().gameView,this.updateUI(),s.default.event.on(r.GameDataEvent.ADD_COMBINE_ENERGY,this.addEnergy,this),s.default.event.on(r.GameDataEvent.STOP_CUT_COMBINE_TIME,this.stopTime,this),s.default.event.on(r.GameDataEvent.RESUME_CUT_COMBINE_TIME,this.resumeTime,this)},e.prototype.setTimeEnergy=function(){this.schedule(this.timeAddEnergy,.2)},e.prototype.timeAddEnergy=function(){this.isCanCombine||this.unschedule(this.timeAddEnergy),this.addEnergy(this.gameview.timeEnergy)},e.prototype.addEnergy=function(t){this.isCombining||this.energy>=100||0!=this.isCanCombine&&0!=this.node.active&&(this.energy+=t,this.energy=Math.min(100,this.energy),this.updateUI())},e.prototype.cutTimeBySceond=function(){this.time>=this.maxTime&&this.unschedule(this.cutTimeBySceond),this.addTime()},e.prototype.addTime=function(){this.time>=this.maxTime||this.isCombining&&(this.time++,this.updateUI())},e.prototype.stopTime=function(){this.isCombining&&this.unschedule(this.cutTimeBySceond)},e.prototype.resumeTime=function(){this.isCombining&&this.schedule(this.cutTimeBySceond,1)},e.prototype.updateUI=function(){this.isCombining?(this.CDSprite.fillRange=this.time/this.maxTime,this.combineButton.interactable=!0,this.CDLabel.string=this.maxTime-this.time+"\u79d2",cc.log("CDLabel111",this.CDLabel.string),this.time>=this.maxTime&&(this.isCombining=!1,this.gameview.pet.node.opacity=255,this.gameview.curPlayer.offCombine(),this.CDLabel.string="",this.setTimeEnergy(),cc.log("CDLabel222",this.CDLabel.string))):(this.CDSprite.fillRange=1-this.energy/100,this.energy<100||(this.tipNode.active=!0),this.combineButton.interactable=!0,l.default.getInstance().gameType==l.GameType.\u7ade\u6280\u573a&&this.energy>=100&&this.unschedule(this.timeAddEnergy),this.isCanCombine?(this.CDLabel.string=Math.floor((100-this.energy)/100*200)/10+"\u79d2",this.combineSkillNode.active=!0,100==this.energy&&(this.CDLabel.string="")):(this.CDLabel.string="",this.combineSkillNode.active=!1))},e.prototype.onCombine=function(){if(!this.isCanCombine)return s.default.showToast("\u672a\u6709\u5408\u4f53\u5ba0\u7269\uff01");if(this.isCanCombine&&this.energy<100)return s.default.showToast("\u5145\u80fd\u4e2d");this.time=0,this.combineButton.interactable=!1,this.energy=0,this.isCombining=!0,this.cutTimeBySceond(),this.gameview.pet.node.opacity=0;var t=this.gameview.curPlayer;this.BlockInputEvents.active=!0,this.gameview.enemys.forEach(function(t){t.isStart=!1}),this.gameview.isCombineing=!0,this.gameview.ctrlNode.stopCtrl(),this.schedule(this.biggerCamera,.05);var e=cc.instantiate(this.combineAniPrefab);e.getComponent(d.default).setData(this.gameview.curPlayer.personIdx,this.gameview.pet.mountIdx,this.gameview.pet.mount_level,this.onComplete.bind(this)),e.parent=this.gameview.layout,e.setPosition(t.node.getPosition()),t.onCombine(),t.node.active=!1,this.gameview.cardBuffNode.addBuff(),c.default.isNewbie.isNewbie&&c.default.nowStepName==c.NEWBIE_EVENT.COMBINE_HERO&&l.default.getInstance().gameType==l.GameType.\u666e\u901a\u5173\u5361&&(c.default.completeStep(),this.gameview.combineGuide.active=!1,c.default.emit(c.NEWBIE_EVENT.COMBINE_HERO_SUCCESS))},e.prototype.biggerCamera=function(){this.gameview.followCamera.zoomRatio+=.05,this.gameview.followCamera.zoomRatio>=.95&&this.unschedule(this.biggerCamera)},e.prototype.smallerCamera=function(){this.gameview.followCamera.zoomRatio-=.025,this.gameview.followCamera.zoomRatio<=.62&&this.unschedule(this.smallerCamera)},e.prototype.onComplete=function(){var t=this;this.gameview.enemys.forEach(function(t){t.isStart=!0}),this.scheduleOnce(function(){t.BlockInputEvents.active=!1,t.gameview.isCombineing=!1,t.gameview.ctrlNode.resumeCtrl(),t.schedule(t.cutTimeBySceond,1)},.5),this.gameview.curPlayer.node.active=!0,this.schedule(this.smallerCamera,.05)},e.prototype.onDisable=function(){s.default.event.off(r.GameDataEvent.ADD_COMBINE_ENERGY)},a([h(cc.Button)],e.prototype,"combineButton",void 0),a([h(cc.Sprite)],e.prototype,"CDSprite",void 0),a([h(cc.Node)],e.prototype,"skillNode",void 0),a([h(cc.Node)],e.prototype,"combineSkillNode",void 0),a([h(cc.Node)],e.prototype,"BlockInputEvents",void 0),a([h(cc.Prefab)],e.prototype,"combineAniPrefab",void 0),a([h(cc.Label)],e.prototype,"CDLabel",void 0),a([h(cc.Node)],e.prototype,"tipNode",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GuideModel":void 0,"../../../../Script/center/Game":"Game","../../../manage/GameManage":"GameManage","./CombineAni":"CombineAni"}],CriView:[function(t,e,o){"use strict";cc._RF.push(e,"775bcWBYAhMWb8vpYW3ebwv","CriView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hurtLabel=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t,e){void 0===e&&(e=!1),this.hurtLabel.string="/"+t,this.hurtLabel.node.color=e?cc.color(255,228,0):cc.Color.WHITE},e.prototype.refresh=function(t,e){var o=this;t.forEach(function(t,i){return o.refreshSprite(i,t,e)})},e.prototype.refreshSprite=function(){},a([s(cc.Label)],e.prototype,"hurtLabel",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],CtrlManage:[function(t,e,o){"use strict";cc._RF.push(e,"65ea8c9n+RPZIbHbWZfbRGQ","CtrlManage");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../manage/GameManage"),c=t("../Player"),s=t("./JoystickCommon"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e.ring=null,e.dot=null,e.joystickType=s.JoystickType.FOLLOW,e.directionType=s.DirectionType.EIGHT,e._stickPos=null,e._touchLocation=null,e._radius=null,e._up=!1,e._down=!1,e._left=!1,e._right=!1,e}return n(e,t),e.prototype.onLoad=function(){cc.sys.isMobile?(this._radius=this.ring.width/2,this._initTouchEvent(),this.joystickType==s.JoystickType.FOLLOW&&(this.node.opacity=0)):(this.node.opacity=0,this._initKeyEvent(),this._initMouseEvent())},e.prototype._initTouchEvent=function(){this.node.on(cc.Node.EventType.TOUCH_START,this._touchStartEvent,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,this),this.node.on(cc.Node.EventType.TOUCH_END,this._touchEndEvent,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,this)},e.prototype._offTouchEvent=function(){this.node.off(cc.Node.EventType.TOUCH_START,this._touchStartEvent,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,this),this.node.off(cc.Node.EventType.TOUCH_END,this._touchEndEvent,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,this)},e.prototype._touchStartEvent=function(t){var e=this.node.convertToNodeSpaceAR(t.getLocation());if(this.joystickType===s.JoystickType.FIXED){this._stickPos=this.ring.getPosition();var o=e.sub(this.ring.getPosition()).mag();this._radius>o&&this.dot.setPosition(e)}else this.joystickType===s.JoystickType.FOLLOW&&(this._stickPos=e,this.node.opacity=255,this._touchLocation=t.getLocation(),this.ring.setPosition(e),this.dot.setPosition(e))},e.prototype._touchMoveEvent=function(t){if(this.joystickType===s.JoystickType.FOLLOW&&this._touchLocation===t.getLocation())return!1;var e=cc.v2(this.ring.convertToNodeSpaceAR(t.getLocation())),o=e.mag(),i=this._stickPos.x+e.x,n=this._stickPos.y+e.y,a=cc.v2(i,n).sub(this.ring.getPosition()).normalize();if(this._radius>o)this.dot.setPosition(cc.v2(i,n)),this.player._speedType=s.SpeedType.NORMAL;else{var r=this._stickPos.x+a.x*this._radius,c=this._stickPos.y+a.y*this._radius;this.dot.setPosition(cc.v2(r,c)),this.player._speedType=s.SpeedType.FAST}this.player.moveDir=a},e.prototype._touchEndEvent=function(){this.dot.setPosition(this.ring.getPosition()),this.joystickType==s.JoystickType.FOLLOW&&(this.node.opacity=0),this.player._speedType=s.SpeedType.STOP},e.prototype.update=function(){if(!cc.sys.isMobile){var t=cc.Vec2.ZERO;this._up&&t.addSelf(cc.v2(0,1)),this._down&&t.addSelf(cc.v2(0,-1)),this._left&&t.addSelf(cc.v2(-1,0)),this._right&&t.addSelf(cc.v2(1,0)),t.equals(cc.Vec2.ZERO)?this.player._speedType=s.SpeedType.STOP:(t.normalizeSelf(),this.player.moveDir=t,this.player._speedType=s.SpeedType.FAST)}},e.prototype._initKeyEvent=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this._keyDownEvent,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this._keyUpEvent,this)},e.prototype._keyDownEvent=function(t){switch(t.keyCode){case cc.macro.KEY.w:console.log("Press w key"),this._up=!0;break;case cc.macro.KEY.a:console.log("Press a key"),this._left=!0;break;case cc.macro.KEY.s:console.log("Press s key"),this._down=!0;break;case cc.macro.KEY.d:console.log("Press d key"),this._right=!0}},e.prototype._keyUpEvent=function(t){switch(t.keyCode){case cc.macro.KEY.w:console.log("Up w key"),this._up=!1;break;case cc.macro.KEY.a:console.log("Up a key"),this._left=!1;break;case cc.macro.KEY.s:console.log("Up s key"),this._down=!1;break;case cc.macro.KEY.d:console.log("Up d key"),this._right=!1}},e.prototype._mouseMoveEvent=function(t){var e=cc.v2(this.player.sprite.node.convertToWorldSpaceAR(cc.Vec2.ZERO)).sub(cc.v2(r.default.getInstance().gameView.followCamera.node.convertToWorldSpaceAR(cc.Vec2.ZERO))).mulSelf(r.default.getInstance().gameView.followCamera.zoomRatio);this.player.atkDir=cc.v2(this.node.convertToNodeSpaceAR(t.getLocation())).sub(e).normalizeSelf()},e.prototype._initMouseEvent=function(){this.node.on(cc.Node.EventType.MOUSE_MOVE,this._mouseMoveEvent,this),this.node.on(cc.Node.EventType.MOUSE_DOWN,this._mouseDownEvent,this),this.node.on(cc.Node.EventType.MOUSE_UP,this._mouseUpEvent,this)},e.prototype._mouseDownEvent=function(){r.default.getInstance().gameView.attackView.startAttack()},e.prototype._mouseUpEvent=function(){r.default.getInstance().gameView.attackView.stopAttack()},e.prototype.stopCtrl=function(){this._touchEndEvent(),this._offTouchEvent()},e.prototype.resumeCtrl=function(){this._initTouchEvent()},a([u(c.default)],e.prototype,"player",void 0),a([u(cc.Node)],e.prototype,"ring",void 0),a([u(cc.Node)],e.prototype,"dot",void 0),a([u({displayName:"Touch Type",tooltip:"\u89e6\u6478\u7c7b\u578b"})],e.prototype,"joystickType",void 0),a([u({displayName:"Direction Type",tooltip:"\u65b9\u5411\u7c7b\u578b"})],e.prototype,"directionType",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../Player":"Player","../manage/GameManage":"GameManage","./JoystickCommon":"JoystickCommon"}],CultivateItem:[function(t,e,o){"use strict";cc._RF.push(e,"4a1b4lb+/5IuoCD31PMYmgU","CultivateItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../../../InitScene/Script/data/MountModel"),l=t("../../../../InitScene/Script/data/PersonModel"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.nameLabel=null,e.selectedNode=null,e.layoutNode=null,e.levelLabel=null,e.starNode=null,e.pointNode=null,e.markNode=null,e.itemId=0,e.itemData=null,e.type=null,e}return n(e,t),e.prototype.start=function(){s.default.on(s.MountEvent.MountFormChagne,this.updateStar,this),s.default.on(s.MountEvent.UnlockMount,this.updateStar,this),l.default.on(l.HeroEvent.ChangeHero,this.updateStar,this),c.default.on(c.GameDataEvent.EVENT_TOTAL_DIAMOND_CHANGE,this.checkHeroUnlock,this),c.default.on(c.GameDataEvent.EVENT_TOTAL_DIAMOND_CHANGE,this.checkMountUpgrade,this),c.default.on(c.GameDataEvent.EVENT_TOTAL_BONE_CHANGE,this.checkMountUnlock,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},e.prototype.onClick=function(){this.node.getComponent(cc.Button).interactable&&this.node.emit("onClick",this.itemId)},e.prototype.onSelect=function(t){this.selectedNode.active=this.itemId==t},e.prototype.checkHeroUnlock=function(){"hero"===this.type&&this.itemData.isUnlock&&(this.itemData.price>0?this.pointNode.active=c.default.totalDiamondNum>=this.itemData.price:this.pointNode.active=!1)},e.prototype.checkMountUnlock=function(){"mount"===this.type&&this.itemData.isUnlock&&this.itemData.bone>0&&(this.markNode.active=c.default.totalBoneNum>=this.itemData.bone)},e.prototype.checkMountUpgrade=function(){"mount"===this.type&&this.itemData.isUnlock&&(this.itemData.needPrice>0?this.pointNode.active=c.default.totalDiamondNum>=this.itemData.needPrice:this.pointNode.active=!1)},e.prototype.setData=function(t){if(this.itemId=t.id,this.itemData=t,this.iconSprite.spriteFrame=null,this.levelLabel.node.parent.active=!1,this.layoutNode.active=!1,this.layoutNode.parent.active=!1,this.node.getComponent(cc.Button).interactable=!0,this.iconSprite.node.color=cc.Color.WHITE,this.pointNode.active=!1,this.markNode.active=!1,this.iconSprite.node.scale=1,t instanceof l.HeroItemInfo){this.type="hero",t=t,this.nameLabel.string=t.name,this.iconSprite.node.y=20,this.iconSprite.sizeMode=cc.Sprite.SizeMode.RAW,this.iconSprite.trim=!1,this.iconSprite.node.scale=.7;var e="hero/avatar/"+t.id;this.setIcon(e),this.pointNode.active=!t.isUnlock&&t.price>0&&c.default.totalDiamondNum>=t.price}else if(t instanceof s.MountItemInfo){this.type="mount";var o="";switch((t=t).bloodLevel){case 0:break;case 1:o="\u4e00\u9636"}this.iconSprite.node.y=0,this.nameLabel.string=t.name+o,this.setStar(t.star),this.iconSprite.sizeMode=cc.Sprite.SizeMode.RAW,this.iconSprite.trim=!1;var i="mount/avatar/"+t.icon;5==t.formLevel&&(i="mount/avatar/wakeup/"+t.icon),this.setIcon(i),this.pointNode.active=t.isUnlock&&c.default.totalDiamondNum>=t.needPrice&&t.level<s.MountMaxLevel,this.markNode.active=!t.isUnlock&&t.bone>0&&c.default.totalBoneNum>=t.bone}else{this.type="gun",t=t,this.iconSprite.node.y=0,this.nameLabel.string=t.gun_name,this.levelLabel.string=""+(t.id+1);var n="gun/icon/"+this.itemId;this.setIcon(n),this.iconSprite.sizeMode=cc.Sprite.SizeMode.TRIMMED,this.iconSprite.trim=!0,this.levelLabel.node.parent.active=!0,this.iconSprite.node.color=t.isUnlock?cc.Color.WHITE:cc.Color.BLACK,this.node.getComponent(cc.Button).interactable=t.isUnlock,this.pointNode.active=!1,this.markNode.active=!1}},e.prototype.setStar=function(t){var e=cc.instantiate(this.starNode);this.layoutNode.removeAllChildren();for(var o=0;o<t;o++)this.layoutNode.addChild(cc.instantiate(e));t>4?(this.layoutNode.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CHILDREN,this.layoutNode.width=138):this.layoutNode.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CONTAINER,this.layoutNode.active=!0,this.layoutNode.parent.active=!0,e.destroy()},e.prototype.updateStar=function(t){if(this.itemId==t){var e=this.itemData;if("mount"==this.type){this.pointNode.active=e.isUnlock&&c.default.totalDiamondNum>=e.needPrice,this.markNode.active=!e.isUnlock&&e.bone>0&&c.default.totalBoneNum>=e.bone;var o=cc.instantiate(this.layoutNode.children[0]);o.scale=2,o.opacity=0,this.layoutNode.addChild(o),this.layoutNode.children.length>4?(this.layoutNode.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CHILDREN,this.layoutNode.width=138):this.layoutNode.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CONTAINER,cc.tween(o).to(1,{scale:1,opacity:255}).start()}this.pointNode.active&&"hero"==this.type&&(this.pointNode.active=!e.isUnlock&&e.price>0&&c.default.totalCoinNum>=e.price)}},e.prototype.setIcon=function(t){var e=this;this.scheduleOnce(function(){r.default.addLoaderSprite(e.iconSprite).loadSprite(t,cc.SpriteFrame)},.1)},a([p(cc.Sprite)],e.prototype,"iconSprite",void 0),a([p(cc.Label)],e.prototype,"nameLabel",void 0),a([p(cc.Node)],e.prototype,"selectedNode",void 0),a([p(cc.Node)],e.prototype,"layoutNode",void 0),a([p(cc.Label)],e.prototype,"levelLabel",void 0),a([p(cc.Node)],e.prototype,"starNode",void 0),a([p(cc.Node)],e.prototype,"pointNode",void 0),a([p(cc.Node)],e.prototype,"markNode",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0}],CultivateNode:[function(t,e,o){"use strict";cc._RF.push(e,"20a2bldOvlNLrBJuQFIJqc4","CultivateNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.CultivateType=void 0;var r,c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/center/GameInit"),l=t("../../../../InitScene/Script/data/GameData"),d=t("../../../../InitScene/Script/data/GunModel"),u=t("../../../../InitScene/Script/data/MountModel"),p=t("../../../../InitScene/Script/data/PersonModel"),h=t("../../../../Script/common/Flash"),f=t("../../center/Game"),m=t("../list/List"),y=t("../prefabs/view/PersonView"),g=t("./CultivateItem"),v=t("./GetCultivateNode"),_=t("./MountUnlockNode"),S=t("./MountView"),b=cc._decorator,w=b.ccclass,I=b.property;(function(t){t[t.Hero=0]="Hero",t[t.Mount=1]="Mount",t[t.Gun=2]="Gun"})(r=o.CultivateType||(o.CultivateType={}));var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentNode=null,e.cultivateList=null,e.heroView=null,e.curMountView=null,e.nextMountView=null,e.changeHeroBtn=null,e.battledBtn=null,e.coinBuyBtn=null,e.freeUnlockBtn=null,e.canelBtn=null,e.changeGunBtn=null,e.equippedBtn=null,e.changeMountBtn=null,e.downMountBtn=null,e.upgradeBtn=null,e.moreDiamondBtn=null,e.moreBoneBtn=null,e.unlockMountBtn=null,e.mountGameBtn=null,e.levelLabel=null,e.upgradeProgress=null,e.levelDiffLable=null,e.pageToggle=[],e.gotoNode=[],e._cultivateType=null,e.pageInfoList=[],e.selectId=0,e.pointId=0,e}return n(e,t),e.prototype.start=function(){l.default.on(l.GameDataEvent.EVENT_TOTAL_DIAMOND_CHANGE,this.setDiamondButton,this),l.default.on(l.GameDataEvent.EVENT_TOTAL_BONE_CHANGE,this.setUnlockMount,this),this.node.on("onClick",this.onClick,this),this.heroView.init(),this.setLayer()},e.prototype.setData=function(t,e){void 0===e&&(e=-1),this._cultivateType=t,t==r.Mount&&(this.pointId=e)},e.prototype.setLayer=function(){switch(this._cultivateType){case r.Hero:this.pageToggle[0].isChecked=!0,this.pageInfoList=p.default.getHeroListSort(),this.selectId=p.default.useHeroId;break;case r.Mount:this.pageToggle[1].isChecked=!0,this.pageInfoList=u.default.getMountListSort(),this.selectId=u.default.useMountId>-1?u.default.useMountId:u.default.getMountMaxId(!0);break;case r.Gun:this.pageToggle[2].isChecked=!0,this.pageInfoList=d.default.getGunListSort(),this.selectId=d.default.useGunId}this.pointId>-1&&(this.selectId=this.pointId,this.pointId=-1),this.cultivateList.getComponent(cc.ScrollView).stopAutoScroll(),this.cultivateList.content.y=0,this.cultivateList.numItems=this.pageInfoList.length,this.resetLayer()},e.prototype.onClick=function(t){this.selectId!=t&&(this.selectId=t,this.resetLayer())},e.prototype.onGridList=function(t,e){t.getComponent(g.default).setData(this.pageInfoList[e]),t.getComponent(g.default).onSelect(this.selectId),t.off("onClick"),t.on("onClick",this.onClick,this)},e.prototype.resetLayer=function(){this.resetSelectedNode(),this.setAttributeView(),this.setPageButton()},e.prototype.resetSelectedNode=function(){for(var t=0;t<this.cultivateList.content.childrenCount;t++)this.cultivateList.content.children[t].getComponent(g.default).onSelect(this.selectId)},e.prototype.setAttributeView=function(){switch(this._cultivateType){case r.Hero:this.heroView.init(this.selectId,d.default.useGunId);break;case r.Mount:break;case r.Gun:this.heroView.init(null,this.selectId)}},e.prototype.setPageButton=function(){switch(this.changeGunBtn.parent.active=!1,this.changeHeroBtn.parent.active=!1,this.changeMountBtn.parent.active=!1,this.levelLabel.node.parent.active=!1,this.gotoNode[3].active=!1,this.curMountView.node.parent.parent.active=!1,this.upgradeProgress.node.active=!1,this._cultivateType){case r.Hero:this.heroView.node.active=!0,this.setHeroPageButton();break;case r.Mount:this.heroView.node.active=!1,this.curMountView.node.parent.parent.active=!0,this.setMountPageButton();break;case r.Gun:this.heroView.node.active=!0,this.changeGunBtn.parent.active=!0,this.levelLabel.node.parent.active=!0,this.levelLabel.string=d.default.getGunMaxLevel()+1+"",d.default.getGunDataById(this.selectId).isUnlock?(this.changeGunBtn.active=this.selectId!=d.default.useGunId,this.equippedBtn.active=this.selectId==d.default.useGunId,this.changeGunBtn.getComponent(cc.Button).interactable=!0):(this.changeGunBtn.active=!0,this.changeGunBtn.getComponent(cc.Button).interactable=!1,this.equippedBtn.active=!1)}},e.prototype.hideHeroPageButton=function(){this.changeHeroBtn.parent.active=!0,this.coinBuyBtn.active=!1,this.freeUnlockBtn.active=!1,this.canelBtn.active=!1,this.changeHeroBtn.active=!1,this.battledBtn.active=!1,this.gotoNode[0].active=!1,this.gotoNode[1].active=!1,this.gotoNode[4].active=!1,this.gotoNode[5].active=!1,this.gotoNode[6].active=!1},e.prototype.setHeroPageButton=function(){var t=p.default.getHeroDataById(this.selectId);this.hideHeroPageButton(),t.isUnlock?(this.changeHeroBtn.active=this.selectId!=p.default.useHeroId,this.battledBtn.active=this.selectId==p.default.useHeroId,this.battledBtn.getComponent(cc.Button).interactable=!1):t.price>0?l.default.totalDiamondNum>=t.price?(this.coinBuyBtn.active=!0,this.setCoinButton()):(this.freeUnlockBtn.active=!0,this.canelBtn.active=!0,this.setFreeButton()):-1==t.price?this.gotoNode[0].active=!0:-2==t.price?this.gotoNode[1].active=!0:-3==t.price?this.gotoNode[4].active=!0:-4==t.price?this.gotoNode[5].active=!0:-5==t.price?this.gotoNode[6].active=!0:this.gotoNode[1].active=!0},e.prototype.setMountPageButton=function(t){void 0===t&&(t=!1);var e=u.default.getMountDataById(this.selectId);this.changeMountBtn.parent.active=!0,this.changeMountBtn.active=!1,this.upgradeBtn.active=!1,this.moreDiamondBtn.active=!1,this.moreBoneBtn.active=!1,this.unlockMountBtn.active=!1,this.mountGameBtn.active=!1,this.gotoNode[2].active=!1,this.gotoNode[3].active=!1,e.isUnlock?(this.nextMountView.node.active=!0,this.upgradeProgress.node.active=!0,this.changeMountBtn.active=this.selectId!=u.default.useMountId,this.selectId==u.default.useMountId?(this.hideHeroPageButton(),this.downMountBtn.active=!0):this.downMountBtn.active=!1,e.level<u.MountMaxLevel?(this.setDiamondButton(),this.updateProgress(t,e.attributeLevel/u.FormMaxLevel)):this.upgradeProgress.node.active=!1,cc.log("\u662f\u5426\u663e\u793a",this.selectId,e.formLevel,e.formLevel>=u.MountFormNum-1),this.curMountView.setData(this.selectId,e.formLevel,e.formLevel>=u.MountFormNum-1),e.formLevel<u.MountFormNum-1?(this.levelDiffLable.node.parent.active=!0,this.levelDiffLable.string=u.FormMaxLevel-e.attributeLevel+"",this.nextMountView.setData(this.selectId,e.formLevel+1,!0),this.upgradeProgress.node.y=-15):(this.nextMountView.node.active=!1,this.levelDiffLable.node.parent.active=!1,this.upgradeProgress.node.y=-15)):(this.setUnlockMount(),this.curMountView.setData(this.selectId,e.formLevel,!0),this.nextMountView.node.active=!1,this.downMountBtn.active=!1)},e.prototype.setUnlockMount=function(){var t=u.default.getMountDataById(this.selectId);t.bone>=0?(this.unlockMountBtn.active=l.default.totalBoneNum>=t.bone,this.moreBoneBtn.active=!this.unlockMountBtn.active):-1==t.bone?this.gotoNode[2].active=!0:-2==t.bone?this.gotoNode[3].active=!0:-3==t.bone&&(this.mountGameBtn.active=!0)},e.prototype.updateProgress=function(t,e){t?cc.tween(this.upgradeProgress).to(.5,{progress:e}).start():this.upgradeProgress.progress=e},e.prototype.setFreeButton=function(){var t=this.freeUnlockBtn.getChildByName("videoLabel").getComponent(cc.Label),e=this.freeUnlockBtn.getChildByName("totalLabel").getComponent(cc.Label),o=p.default.getHeroDataById(this.selectId);t.string=o.videoCount.toString(),e.string=o.video.toString()},e.prototype.setCoinButton=function(){var t=this.coinBuyBtn.getChildByName("coinLabel").getComponent(cc.Label),e=p.default.getHeroDataById(this.selectId);t.string=e.price.toString()},e.prototype.setDiamondButton=function(){if(this._cultivateType==r.Mount){var t=u.default.getMountDataById(this.selectId);this.upgradeBtn.active=!1,this.moreDiamondBtn.active=!1,l.default.totalDiamondNum>=t.needPrice?(this.upgradeBtn.getChildByName("diamondLabel").getComponent(cc.Label).string=t.needPrice.toString(),this.upgradeBtn.active=!0):this.moreDiamondBtn.active=!0}},e.prototype.onToggle=function(t,e){var o=parseInt(e);o!=this._cultivateType&&(this._cultivateType=o,this.setLayer())},e.prototype.onChangeHero=function(){p.default.useHeroId=this.selectId,this.setPageButton()},e.prototype.onCoinBuy=function(){var t=p.default.getHeroDataById(this.selectId);l.default.totalDiamondNum>=t.price?(l.default.totalDiamondNum-=t.price,t.onUnlock(),p.default.useHeroId=t.id,this.showNewHero(),this.setLayer()):s.default.showToast("\u91d1\u5e01\u4e0d\u8db3")},e.prototype.onNotWatch=function(){this.freeUnlockBtn.active=!1,this.canelBtn.active=!1,this.coinBuyBtn.active=!0,this.setCoinButton()},e.prototype.onFreeUnlock=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.freeUnlockSuccess=function(){var t=p.default.getHeroDataById(this.selectId);t.videoCount+=1,t.videoCount>=t.video?(t.onUnlock(),p.default.useHeroId=t.id,this.showNewHero(),this.setLayer()):this.setFreeButton()},e.prototype.showNewHero=function(){var t=p.default.getHeroDataById(this.selectId);s.default.uiCenter.showUi("GetCultivateNode").getComponent(v.default).setData("hero","hero/dragon/"+t.skeUrl,"\u5f85\u673a",t.award)},e.prototype.onChangeGun=function(){d.default.useGunId=this.selectId,this.setPageButton()},e.prototype.onUnlockMount=function(){var t=this,e=s.default.uiCenter.showUi("MountUnlockNode");e.getComponent(_.default).setData(this.selectId),e.on("onUnlock",function(){t.setPageButton()},this)},e.prototype.onChangeMount=function(){-1==u.default.useMountId?f.default.showToast("\u5750\u9a91\u5df2\u4e0a\u9635"):f.default.showToast("\u5750\u9a91\u66ff\u6362\u6210\u529f"),u.default.useMountId=this.selectId,this.setMountPageButton()},e.prototype.onDownMount=function(){u.default.useMountId=-1,this.setMountPageButton(),f.default.showToast("\u5750\u9a91\u5df2\u4e0b\u9635")},e.prototype.onUpgradeMount=function(){var t=this,e=u.default.getMountDataById(this.selectId);l.default.totalDiamondNum>=e.needPrice&&(l.default.totalDiamondNum-=e.needPrice,e.level+=1,0==e.attributeLevel&&e.level<u.MountMaxLevel?(u.default.emit(u.MountEvent.MountFormChagne,this.selectId),this.upgradeBtn.getComponent(cc.Button).interactable=!1,cc.tween(this.upgradeProgress).to(.5,{progress:1}).call(function(){f.default.gameAudio.playMount_upgrade10Clip(),t.curMountView.showLight(),t.setMountPageButton(e.level<u.MountMaxLevel),t.upgradeBtn.getComponent(cc.Button).interactable=!0}).start()):e.level==u.MountMaxLevel?(f.default.gameAudio.playMount_upgrade(),this.setMountPageButton(e.level<u.MountMaxLevel),this.curMountView.dragonNode.getComponent(sp.Skeleton).setMaterial(0,this.curMountView.flashMaterial),this.curMountView.dragonNode.addComponent(h.default).updateFlashUpgrade(),cc.log("==============50\u7ea7\u5750\u9a91")):e.level>u.MountMaxLevel?(f.default.gameAudio.playMount_upgrade(),this.setMountPageButton(e.level<u.MountMaxLevel),this.curMountView.dragonNode.getComponent(sp.Skeleton).setMaterial(0,this.curMountView.flashMaterial),this.curMountView.dragonNode.addComponent(h.default).updateFlashUpgrade(),cc.log("==============50\u7ea7\u5750\u9a91")):(f.default.gameAudio.playMount_upgrade(),this.setMountPageButton(e.level<u.MountMaxLevel),this.curMountView.dragonNode.getComponent(sp.Skeleton).setMaterial(0,this.curMountView.flashMaterial),this.curMountView.dragonNode.addComponent(h.default).updateFlashUpgrade()),cc.log("=========\u5750\u9a91\u7b49\u7ea7========\uff1a",e.level))},e.prototype.onOpenMapMountUI=function(){f.default.uiCenter.showUi("MapMountNode")},e.prototype.onSign=function(){f.default.uiCenter.showUi("SignNode")},e.prototype.onRank=function(){f.default.uiCenter.showUi("RankNode")},e.prototype.onTurnTable=function(){this.scheduleOnce(this.onClose,1),f.default.uiCenter.showUi("TurnTableNode")},e.prototype.onFarm=function(){u.default.getMountDataById(0).isUnlock||u.default.getMountDataById(2).isUnlock?f.default.sceneCenter.runScene("FarmScene"):f.default.showToast("\u83b7\u53d6\u5750\u9a91\u89e3\u9501\u7267\u573a")},e.prototype.onEgg=function(){f.default.uiCenter.showUi("ColorEggNode")},e.prototype.onMoreDiamond=function(){f.default.uiCenter.showUi("FuliNode")},e.prototype.onMoreBone=function(){f.default.uiCenter.showUi("FuliNode")},e.prototype.onClose=function(){f.default.uiCenter.closeUI(this.node),f.default.event.emit("closeCultivateNode")},a([I(cc.Node)],e.prototype,"contentNode",void 0),a([I(m.default)],e.prototype,"cultivateList",void 0),a([I(y.default)],e.prototype,"heroView",void 0),a([I(S.default)],e.prototype,"curMountView",void 0),a([I(S.default)],e.prototype,"nextMountView",void 0),a([I(cc.Node)],e.prototype,"changeHeroBtn",void 0),a([I(cc.Node)],e.prototype,"battledBtn",void 0),a([I(cc.Node)],e.prototype,"coinBuyBtn",void 0),a([I(cc.Node)],e.prototype,"freeUnlockBtn",void 0),a([I(cc.Node)],e.prototype,"canelBtn",void 0),a([I(cc.Node)],e.prototype,"changeGunBtn",void 0),a([I(cc.Node)],e.prototype,"equippedBtn",void 0),a([I(cc.Node)],e.prototype,"changeMountBtn",void 0),a([I(cc.Node)],e.prototype,"downMountBtn",void 0),a([I(cc.Node)],e.prototype,"upgradeBtn",void 0),a([I(cc.Node)],e.prototype,"moreDiamondBtn",void 0),a([I(cc.Node)],e.prototype,"moreBoneBtn",void 0),a([I(cc.Node)],e.prototype,"unlockMountBtn",void 0),a([I(cc.Node)],e.prototype,"mountGameBtn",void 0),a([I(cc.Label)],e.prototype,"levelLabel",void 0),a([I(cc.ProgressBar)],e.prototype,"upgradeProgress",void 0),a([I(cc.Label)],e.prototype,"levelDiffLable",void 0),a([I(cc.Toggle)],e.prototype,"pageToggle",void 0),a([I(cc.Node)],e.prototype,"gotoNode",void 0),a([w],e)}(cc.Component);o.default=M,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../Script/common/Flash":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../list/List":"List","../prefabs/view/PersonView":"PersonView","./CultivateItem":"CultivateItem","./GetCultivateNode":"GetCultivateNode","./MountUnlockNode":"MountUnlockNode","./MountView":"MountView"}],DiamondLabel:[function(t,e,o){"use strict";cc._RF.push(e,"35a946iCx5Gp4vt/movIadE","DiamondLabel");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=cc._decorator,s=c.ccclass,l=c.property,d=c.requireComponent,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._label=null,e.isMini=!0,e.diamond=0,e}return n(e,t),e.prototype.onLoad=function(){this._label=this.node.getComponent(cc.Label)},e.prototype.start=function(){r.default.on(r.GameDataEvent.EVENT_TOTAL_DIAMOND_CHANGE,this.totalDiamondChange,this),this.setDiamond(r.default.totalDiamondNum)},e.prototype.totalDiamondChange=function(t){this.diamond=t,this.setDiamond(t)},e.prototype.setDiamond=function(t){if(this.isMini){var e=t<1e3?t:t<1e4?Math.floor(t/1e3)+"*":Math.floor(t/1e4)+",";this._label.string=e+""}else this._label.string=t+""},e.prototype.onDestroy=function(){r.default.off(r.GameDataEvent.EVENT_TOTAL_DIAMOND_CHANGE,this.totalDiamondChange,this)},a([l({tooltip:"\u662f\u5426\u7b80\u5316\u663e\u793a\u6570\u91cf"})],e.prototype,"isMini",void 0),a([s,d(cc.Label)],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0}],DiamondNode:[function(t,e,o){"use strict";cc._RF.push(e,"3d3ccYYIsVOFYBkdsDpTmjE","DiamondNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.DiamondEvent=void 0;var r,c=t("../../../../InitScene/Script/data/GameData"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property;(function(t){t.TotalDiamondChangeAnimoEvent="total_diamond_change_animo_event"})(r=o.DiamondEvent||(o.DiamondEvent={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._moreDiamondOpenCount=0,e.diamondNode=null,e.animoList=[],e}return n(e,t),e.prototype.start=function(){s.default.event.on(r.TotalDiamondChangeAnimoEvent,this.playAnimo,this),s.default.event.on(c.GameDataEvent.AWARD_RAIN,this.playRain,this)},e.prototype.onOpenMoreDiamond=function(){s.default.uiCenter.showUi("FuliNode")},e.prototype.playAnimo=function(t,e){if(this.enabledInHierarchy){for(var o=[],i=0;i<5;i++){var n=cc.instantiate(this.diamondNode);e.addChild(n),o.push(n)}var a,r,c=function(){var n=o[i];n.active=!0,t instanceof cc.Touch?(a=e.convertToNodeSpaceAR(t.getLocation()),n.x=a.x,n.y=a.y):(a=e.convertToNodeSpaceAR(t),n.x=a.x,n.y=a.y),n.scale=1,r=e.convertToNodeSpaceAR(s.node.convertToWorldSpaceAR(new cc.Vec2(s.diamondNode.x,s.diamondNode.y))),n.runAction(cc.sequence(cc.delayTime(.025*i),cc.spawn(cc.moveTo(.5,r.x,r.y),cc.scaleTo(1,1)),cc.callFunc(function(){n.destroy()},s)))},s=this;for(i=0;i<o.length;i++)c()}},e.prototype.playRain=function(){var t=cc.find("Canvas"),e=cc.v2(0,t.height);if(this.enabledInHierarchy){for(var o=[],i=0;i<40;i++){var n=cc.instantiate(this.diamondNode);t.addChild(n),o.push(n)}var a,r,c=function(){var n=o[i];n.opacity=0,n.active=!0,e instanceof cc.Touch?(a=t.convertToNodeSpaceAR(e.getLocation()).add(cc.v2(750*Math.random(),0)),n.x=a.x,n.y=a.y):(a=t.convertToNodeSpaceAR(e).add(cc.v2(750*Math.random(),30*Math.random()-15)),n.x=a.x,n.y=a.y),n.scale=1.5,r=cc.v3(a.x+(100*Math.random()-50),-700,0),n.runAction(cc.sequence(cc.delayTime(.03*i),cc.fadeIn(.5),cc.moveTo(1,r.x,r.y),cc.callFunc(function(){n.destroy()},s)))},s=this;for(i=0;i<o.length;i++)c()}},e.prototype.onDestroy=function(){s.default.event.off(r.TotalDiamondChangeAnimoEvent,this.playAnimo,this)},a([u(cc.Node)],e.prototype,"diamondNode",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../center/Game":"Game"}],DiffcultGameView:[function(t,e,o){"use strict";cc._RF.push(e,"af9b1qTdldK5400GKfBvDAh","DiffcultGameView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../manage/GameManage"),c=t("../../../BasePlayer"),s=t("../../../Player"),l=t("../../../public/AStar"),d=t("../../../public/QuadTree"),u=t("../../../test/EditView"),p=t(".././AI"),h=t("../GameBlock"),f=t("../../../../../MainScene/Script/center/Game"),m=t("../../../../../InitScene/Script/data/GameData"),y=t("../../../../../InitScene/Script/data/OtherData"),g=t("../../../../../InitScene/Script/data/MapListModel"),v=t("../../../../../InitScene/Script/data/MountModel"),_=t("../../../../../InitScene/Script/data/GunModel"),S=t("../../../../../InitScene/Script/data/PersonModel"),b=t("../Account/AccountDifficultNode"),w=t("../../../../../InitScene/Script/data/DifficultModel"),I=t("../GameView/GameView"),M=cc._decorator,k=M.ccclass,N=(M.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){r.default.getInstance().gameView=this},e.prototype.start=function(){f.default.gameAudio.playGameBGMusic(),f.default.event.on(m.GameDataEvent.GAME_ACCOUNT,this.showAcc,this),this.boxShadowNode.active=!1;var t=this.mapPrefab,e=r.default.getInstance().maptype;switch(e){case g.MapState.\u91ce\u5916:t=this.mapPrefab;break;case g.MapState.\u79d1\u6280:t=this.map2Prefab;break;case g.MapState.\u68ee\u6797:t=this.map3Prefab;break;case g.MapState.\u5730\u72f1:t=this.map4Prefab}this.map.getComponent(cc.Sprite).spriteFrame=this.mapSF[e];var o=t.length,i=Math.floor(Math.random()*o),n=cc.instantiate(t[i]);n.parent=this.map,n.zIndex=-1,this.layout=n,this.player.parent=this.layout,this.init(this.json.json["map"+e+i])},e.prototype.init=function(t){var e=this,o=this;this.quadTree=new d.default(this.map.getBoundingBox()),t.point&&(this.points=t.point.map(function(t){return cc.v2(t)})),cc.log("==this.points==",this.points[0]),this.nameList=["box","shu_gan","shu2","xian_ren_zhang","luo_xue_de_shu","tree","pool_water","pool_up","pool_down","pool_left","pool_right","pool_right_up","pool_right_down","pool_left_up","pool_left_down","shi_bei","shi_tou_die","pu_tong_shi_tou","shi_tou_gu","dai_gu_ci_shi_tou","zhang_peng","map_left_down","map_right_down","map_left_up","map_right_up","map_down","map_up","map_left","map_right","map","mountain_1","mountain_2","mountain_3","mountain_4","shi_tou1","shi_tou2","bing_wu1","bing_wu2","pen_quan","rongyanjianci"],this.layout.children.forEach(function(t){if(e.nameList.indexOf(t.name)>=0){var i=t.getComponent(h.default),n=t.getPosition().add(cc.v2(e.map.width/2,e.map.height/2)).div(e.size);i.gird=cc.v2(Math.floor(n.x),Math.floor(n.y)),t.setPosition(i.gird.add(cc.v2(1,1)).mul(e.size).sub(cc.v2(e.map.width/2,e.map.height/2).add(cc.v2(e.size/2,e.size/2)))),i.type!=u.ItemType.WATER?(t.zIndex=2*-i.gird.y,t.name.indexOf("map")>=0&&(t.zIndex=10*-i.gird.y)):t.zIndex=2*-Math.floor(e.map.height/e.size),o.blocks.push(i),i.init()}else"grass1"==t.name||"grass2"==t.name||"guang"==t.name?t.zIndex=2*-Math.floor(e.map.height/e.size)+1:"addHpLogo"==t.name?t.zIndex=1:"addHpCircle"==t.name&&(n=t.getPosition().add(cc.v2(e.map.width/2,e.map.height/2)).div(e.size),t.setPosition(cc.v2(Math.floor(n.x),Math.floor(n.y)).add(cc.v2(1,1)).mul(e.size).sub(cc.v2(e.map.width/2,e.map.height/2).add(cc.v2(e.size/2,e.size/2)))),t.zIndex=t.zIndex=2*-Math.floor(e.map.height/e.size)-10)}),this.astar||(this.astar=new l.default),this.astar.init(this.size,this.size,Math.floor(this.map.width/this.size)-1,Math.floor(this.map.height/this.size)-1),this.astar.initMap(),this.astar.resetMap(),this.blocks.forEach(function(t){t.type!=u.ItemType.BLOCK&&t.type!=u.ItemType.WATER&&t.type!=u.ItemType.SHADOW&&t.type!=u.ItemType.MOUNTAIN||0!=o.astar.gridsList[t.gird.x][t.gird.y].type||(o.astar.gridsList[t.gird.x][t.gird.y].type=-1)}),this.doStart(),this.schedule(this.airDrop,y.default.airDropTime)},e.prototype.doStart=function(){console.log("\u731c\u6d4b\uff1adoStart",this.getLevel(),r.default.getInstance().difficult_level),this.getLevel(),this.initEnemy(r.default.getInstance().difficult_level),this.targets=this.layout.getComponentsInChildren(c.default),this.players=this.layout.getComponentsInChildren(s.default),this.curPlayer=this.players[0],r.default.getInstance().model.players=this.players.map(function(t){return t.model}),this.players.forEach(function(t){return t.init()}),console.log("=======\u731c\u6d4b\uff1a\u73a9\u5bb6=======GameManage.getInstance().model.players",r.default.getInstance().model.players),this.tipsView.gameView=this,this.tipsView.node.active=!0,this.tipsView.startGame()},e.prototype.startGame=function(){var t=this;this.attackView.node.active=!0,this.timeView.node.active=!0,this.timeView.init(120),this.timeView.startTimer(),this.timeView.node.on("finished",function(){t.doEnd(),r.default.getInstance().endGame()},this),this.mapView.node.active=!0,this.mapView.init(Math.max(this.map.width,this.map.height)),this.shadow.active=!1,this.enemys.forEach(function(t){return t.isStart=!0})},e.prototype.endGame=function(){this.isAccount||(this.isAccount=!0,this.attackView.stopAttack(),this.timeView.pauseTimer(),this.shadow.active=!0,this.tipsView.node.active=!0,this.tipsView.endGame(),this.unschedule(this.airDrop),r.default.getInstance().endGame())},e.prototype.getGird=function(t){return void 0===t&&(t=-1),this.points.length>0?this.points[t+1]:cc.v2(0,0)},e.prototype.getLevel=function(){var t=0;w.default.win>4?t=5:w.default.win>3?t=4:w.default.win>2?t=3:w.default.win>1?t=2:w.default.win>0?t=1:w.default.lose>4?t=-5:w.default.lose>3?t=-4:w.default.lose>2?t=-3:w.default.lose>1?t=-2:w.default.lose>0?t=-1:cc.log("GameManage.getInstance().difficult_level1",r.default.getInstance().difficult_level),r.default.getInstance().difficult_level=t,cc.log("GameManage.getInstance().difficult_level2",r.default.getInstance().difficult_level),console.log("============\u731c\u6d4b\uff1a\u5173\u5361level============\uff1a",t,"DifficultModel.win",w.default.win)},e.prototype.initEnemy=function(t){var e,o=_.default.getGunMaxLevel(),i=S.default.useHeroId,n=v.default.getMountDataById(v.default.useMountId).level,a=[],c=null,s=0,l=0,d=0;switch(console.log("initAI\u2014\u2014\u731c\u6d4b\uff1a\u521d\u59cb\u5316AI",t),t){case 5:for(var u=Math.max(0,o+2);u<Math.min(o+5,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(Math.max(0,o+2),Math.min(o+5,_.default.getGunTotalNum())));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++){var h=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default);e=this.rand(Math.max(0,n+2),Math.min(v.MountMaxLevel,n+4)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=300,d=300,h.initAI(u,.1,h.getPersonIdx(this.rand(i+2,i+5)),h.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(h)}break;case 4:for(u=Math.max(0,o+1);u<Math.min(o+4,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(o+1,o+4));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++){var f=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default);e=this.rand(Math.max(0,n+2),Math.min(v.MountMaxLevel,n+3)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=200,d=250,u>1?f.initAI(u,.3,f.getPersonIdx(this.rand(i+1,i+4)),f.getGunIdx(a.shift()),s,e,!0,l,d):f.initAI(u,.1,f.getPersonIdx(this.rand(i+1,i+4)),f.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(f)}break;case 3:for(u=Math.max(0,o);u<Math.min(o+3,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(o,o+3));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)f=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n+1),Math.min(v.MountMaxLevel,n+3)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=150,d=200,u>1?f.initAI(u,.7,f.getPersonIdx(this.rand(i,i+3)),f.getGunIdx(a.shift()),s,e,!0,l,d):f.initAI(u,.3,f.getPersonIdx(this.rand(i,i+3)),f.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(f);break;case 2:for(u=Math.max(0,o-0);u<Math.min(o+3,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(o-0,o+3));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)f=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n+1),Math.min(v.MountMaxLevel,n+2)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=150,d=200,u>1?f.initAI(u,1.5,f.getPersonIdx(this.rand(i-0,i+3)),f.getGunIdx(a.shift()),s,e,!0,l,d):u>0?f.initAI(u,.7,f.getPersonIdx(this.rand(i-0,i+3)),f.getGunIdx(a.shift()),s,e,!0,l,d):f.initAI(u,.3,f.getPersonIdx(this.rand(i-0,i+3)),f.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(f);break;case 1:for(u=Math.max(0,o-1);u<Math.min(o+2,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(o-1,o+2));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)f=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n+0),Math.min(v.MountMaxLevel,n+2)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=100,d=150,u>0?f.initAI(u,1.5,f.getPersonIdx(this.rand(i-1,i+2)),f.getGunIdx(a.shift()),s,e,!0,l,d):f.initAI(u,.7,f.getPersonIdx(this.rand(i-1,i+2)),f.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(f);break;case-1:for(u=Math.max(0,o-2);u<Math.min(o+1,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(Math.max(0,o-2),Math.min(o+1,_.default.getGunTotalNum())));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)h=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n-1),Math.min(v.MountMaxLevel,n+1)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=100,d=150,h.initAI(u,.1,h.getPersonIdx(this.rand(Math.max(i-2,0),i+1)),h.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(h);break;case-2:for(u=Math.max(0,o-3);u<Math.min(o+0,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(Math.max(0,o-3),Math.min(o+0,_.default.getGunTotalNum())));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)h=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n-2),Math.min(v.MountMaxLevel,n+0)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=70,d=100,h.initAI(u,.1,h.getPersonIdx(this.rand(Math.max(i-3,0),i+0)),h.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(h);break;case-3:for(u=Math.max(0,o-4);u<Math.min(o-1,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(Math.max(0,o-4),Math.min(o-1,_.default.getGunTotalNum())));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)h=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n-2),Math.min(v.MountMaxLevel,n-1)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=70,d=100,h.initAI(u,.1,h.getPersonIdx(this.rand(Math.max(i-4,0),i-1)),h.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(h);break;case-4:for(u=Math.max(0,o-5);u<Math.min(o-2,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(Math.max(0,o-5),Math.min(o-2,_.default.getGunTotalNum())));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)h=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n-3),Math.min(v.MountMaxLevel,n-2)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=70,d=100,h.initAI(u,.1,h.getPersonIdx(this.rand(Math.max(i-5,0),i-2)),h.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(h);break;case-5:for(u=Math.max(0,o-6);u<Math.min(o-3,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(Math.max(0,o-6),Math.min(o-3,_.default.getGunTotalNum())));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)h=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n-4),Math.min(v.MountMaxLevel,n-3)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=70,d=100,h.initAI(u,.1,h.getPersonIdx(this.rand(Math.max(i-6,0),i-3)),h.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(h);break;default:for(u=Math.max(0,o-1);u<Math.min(o+2,_.default.getGunTotalNum());u++)a.push(u);for(;a.length<r.default.getInstance().aicount;)a.push(this.rand(Math.min(o-1,0),o+2));for(a.sort(function(){return Math.random()-.5}),u=0;u<r.default.getInstance().aicount;u++)h=(c=cc.instantiate(this.aiPrefab)).getComponent(p.default),e=this.rand(Math.max(0,n-1),Math.min(v.MountMaxLevel,n+1)),s=this.rand(Math.max(v.default.useMountId-3,0),Math.min(v.default.useMountId+3,v.default.getMountMaxId())),l=100,d=150,h.initAI(u,.1,h.getPersonIdx(this.rand(Math.max(i-1,0),i+2)),h.getGunIdx(a.shift()),s,e,!0,l,d),c.parent=this.layout,this.enemys.push(h),cc.log("MountModel.useMountId",v.default.useMountId,s,o,e)}},e.prototype.showAcc=function(t){cc.log("player",t);var e=f.default.uiCenter.showUi(this.accountPrefab).getComponent(b.default);e.init(t),e.refresh()},e.prototype.update=function(){var t=this.players.filter(function(t){return t&&t.node.active&&t.model&&!t.model.isDead()});this.updateMap(t)},a([k],e)}(I.default));o.default=N,cc._RF.pop()},{"../../../../../InitScene/Script/data/DifficultModel":void 0,"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MapListModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/OtherData":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../BasePlayer":"BasePlayer","../../../Player":"Player","../../../manage/GameManage":"GameManage","../../../public/AStar":"AStar","../../../public/QuadTree":"QuadTree","../../../test/EditView":"EditView",".././AI":"AI","../Account/AccountDifficultNode":"AccountDifficultNode","../GameBlock":"GameBlock","../GameView/GameView":"GameView"}],DifficultAwardNode:[function(t,e,o){"use strict";cc._RF.push(e,"2990dsHFhpNEoZXXRZF0ER5","DifficultAwardNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/cemter/SceneCenter"),c=t("../../../../../InitScene/Script/data/GameData"),s=t("../../../../../InitScene/Script/data/PlayerData"),l=t("../../../../../InitScene/Script/data/DifficultModel"),d=t("../../../../../MainScene/Script/center/Game"),u=t("../../../manage/GameManage"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoBtn=null,e.coinLabel=null,e.diamondLabel=null,e.boneLabel=null,e.diamond=0,e.money=0,e.bone=0,e.isEffect=!1,e.isNext=!1,e}return n(e,t),e.prototype.init=function(t){this.updateValue(t),c.default.totalDiamondNum+=this.diamond,c.default.totalCoinNum+=this.money,c.default.totalBoneNum+=this.bone},e.prototype.updateValue=function(t){t?(l.default.win++,l.default.lose=0,this.money=75,this.diamond=10,this.bone=5):(l.default.lose++,l.default.win=0,this.money=25,this.diamond=3,this.bone=2),this.coinLabel.string=this.money+"",this.diamondLabel.string=this.diamond+"",this.boneLabel.string=this.bone+""},e.prototype.onClickVideo=function(){this.callback()},e.prototype.onClickShare=function(){this.callback()},e.prototype.callback=function(){this.videoBtn&&(this.videoBtn.interactable=!1),c.default.totalDiamondNum+=2*this.diamond,c.default.totalCoinNum+=2*this.money,c.default.totalBoneNum+=2*this.bone,this.onClickBack()},e.prototype.onDisable=function(){u.default.getInstance().quitGame()},e.prototype.onClickNext=function(){this.isEffect||(!s.default.isAccount&&d.default.showToast("\u606d\u559c\u83b7\u5f97"+this.money+"\u91d1\u5e01\uff0c"+this.diamond+"\u94bb\u77f3"),d.default.sceneCenter.runScene("MainScene"))},e.prototype.onClickBack=function(){var t;this.videoBtn.interactable?((t=new r.SceneData).matchInfo={isShowCurrency:!0,coin:this.money,diamond:this.diamond,bone:this.bone},d.default.sceneCenter.runScene("MainScene",t)):((t=new r.SceneData).matchInfo={isShowCurrency:!0,coin:3*this.money,diamond:3*this.diamond,bone:3*this.bone},d.default.sceneCenter.runScene("MainScene",t))},a([f(cc.Button)],e.prototype,"videoBtn",void 0),a([f(cc.Label)],e.prototype,"coinLabel",void 0),a([f(cc.Label)],e.prototype,"diamondLabel",void 0),a([f(cc.Label)],e.prototype,"boneLabel",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../../InitScene/Script/data/DifficultModel":void 0,"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/PlayerData":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../../../framework/Script/cemter/SceneCenter":void 0,"../../../manage/GameManage":"GameManage"}],DifficultGameNode:[function(t,e,o){"use strict";cc._RF.push(e,"cfe4cvBZlVHaYqxs00PyTYB","DifficultGameNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/BadgeModel"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnNode=null,e.unlockNode=null,e}return n(e,t),e.prototype.onLoad=function(){c.default.isGameDifficultUnlock()?(this.btnNode.active=!0,this.unlockNode.active=!1,r.default.updateGameDifficultBadge(2)):(this.btnNode.active=!1,this.unlockNode.active=!0)},e.prototype.enterGame=function(){s.default.event.emit(c.GameDataEvent.MAP_DIFFICULT)},e.prototype.onClose=function(){this.node.emit("onClose"),s.default.uiCenter.closeUI(this.node)},e.prototype.onClick=function(){s.default.uiCenter.showUi("DifficultShowNode")},a([u(cc.Node)],e.prototype,"btnNode",void 0),a([u(cc.Node)],e.prototype,"unlockNode",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../center/Game":"Game"}],DifficultNode:[function(t,e,o){"use strict";cc._RF.push(e,"af4ad0qelpOiITimh7dTwCa","DifficultNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/DifficultModel"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.nameLabel=null,e.starNode=null,e.starSpriteFrame=[],e.numLabel=null,e}return n(e,t),e.prototype.start=function(){this.setRank()},e.prototype.setRank=function(){var t=c.default.getDifficultLevel(c.default.level);cc.log("\u6bb5\u4f4d",t),t.difficultLevel==c.default.MaxDifficultLevel?(this.starNode.active=!1,this.numLabel.string="X"+t.difficultStar):(this.numLabel.node.parent.active=!1,this.setStar(t.difficultStar)),this.setSprite("mainSceneRes/difficult/icon/"+t.difficultLevel,this.iconSprite),this.nameLabel.string=c.default.getDifficultData(t.difficultLevel).name},e.prototype.setStar=function(t){for(var e=0,o=0;e<c.MaxStar_difficult;e++){var i=(new cc.Node).addComponent(cc.Sprite);o<t?(i.spriteFrame=this.starSpriteFrame[1],o++):i.spriteFrame=this.starSpriteFrame[0],this.starNode.addChild(i.node)}},e.prototype.setSprite=function(t,e){this.scheduleOnce(function(){r.default.addLoaderSprite(e).loadSprite(t,cc.SpriteFrame)},.1)},a([d(cc.Sprite)],e.prototype,"iconSprite",void 0),a([d(cc.Label)],e.prototype,"nameLabel",void 0),a([d(cc.Node)],e.prototype,"starNode",void 0),a([d(cc.SpriteFrame)],e.prototype,"starSpriteFrame",void 0),a([d(cc.Label)],e.prototype,"numLabel",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/DifficultModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0}],DifficultShowItem:[function(t,e,o){"use strict";cc._RF.push(e,"edb5fp6hWJIQq/X4R6UsEfq","DifficultShowItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/DifficultModel"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.sprite=null,e.tip=null,e.data=null,e}return n(e,t),e.prototype.setData=function(t){this.data=t;var e="mainSceneRes/difficult/icon/"+t.id;r.default.addLoaderSprite(this.sprite).loadSprite(e),this.label.string=t.name,this.setIsUnlock()},e.prototype.setIsUnlock=function(){var t=c.default.getDifficultLevel(c.default.level).difficultLevel;t>=this.data.id?this.sprite.node.color=cc.Color.WHITE:this.sprite.node.color=cc.color(60,60,60),t==this.data.id?this.tip.active=!0:this.tip.active=!1},a([d(cc.Label)],e.prototype,"label",void 0),a([d(cc.Sprite)],e.prototype,"sprite",void 0),a([d(cc.Node)],e.prototype,"tip",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/DifficultModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0}],DifficultShowNode:[function(t,e,o){"use strict";cc._RF.push(e,"83e5e3UvsJA8rPZTMGiV3rF","DifficultShowNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/DifficultModel"),c=t("../../center/Game"),s=t("./DifficultShowItem"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemPrefab=null,e.content=null,e}return n(e,t),e.prototype.start=function(){this.list=r.default.getList(),this.showUI()},e.prototype.showUI=function(){for(var t=this.list.length,e=0;e<t;e++){var o=cc.instantiate(this.itemPrefab);o.getComponent(s.default).setData(this.list[e]),o.parent=this.content}},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([u(cc.Prefab)],e.prototype,"itemPrefab",void 0),a([u(cc.Node)],e.prototype,"content",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/DifficultModel":void 0,"../../center/Game":"Game","./DifficultShowItem":"DifficultShowItem"}],DifficultView:[function(t,e,o){"use strict";cc._RF.push(e,"ee10ffRWgZBTJuuo0nrnw5s","DifficultView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/DifficultModel"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelSprite=null,e.stars=null,e.maxLevel=null,e.starCount=null,e.starShow=null,e.starHide=null,e.upgradeLight1=null,e.upgradeLight2=null,e.starNum=0,e}return n(e,t),e.prototype.onEnable=function(){},e.prototype.start=function(){},e.prototype.refresh=function(t){var e=c.default.getDifficultLevel(t);r.default.addLoaderSprite(this.levelSprite).loadSprite("mainSceneRes/difficult/icon/"+e.difficultLevel),e.difficultLevel==c.default.MaxDifficultLevel?(this.stars.active=!1,this.maxLevel.active=!0,this.starCount.string="X"+e.difficultStar):(this.stars.active=!0,this.maxLevel.active=!1,this.refreshStar(e.difficultStar))},e.prototype.refreshStar=function(t){var e=this;this.starNum=t,this.stars.children.forEach(function(o,i){return i<t?e.showStar(o):e.hideStar(o)})},e.prototype.showStar=function(t){t.getComponent(cc.Sprite).spriteFrame=this.starShow},e.prototype.hideStar=function(t){t.getComponent(cc.Sprite).spriteFrame=this.starHide},e.prototype.showLevel=function(){this.levelSprite.node.active=!0},e.prototype.hideLevel=function(){this.levelSprite.node.active=!1},e.prototype.upgrade=function(t){var e=this;s.default.gameAudio.playUpgradeDwPowerClip(),this.levelSprite.node.runAction(cc.sequence(cc.scaleTo(.3,0,1),cc.scaleTo(.3,1,1),cc.scaleTo(.25,0,1),cc.scaleTo(.25,1,1),cc.scaleTo(.2,0,1),cc.scaleTo(.2,1,1),cc.scaleTo(.15,0,1),cc.scaleTo(.15,1,1),cc.scaleTo(.1,0,1),cc.callFunc(function(){e.upgradeLight1.node.active=!0,e.upgradeLight1.once(dragonBones.EventObject.COMPLETE,function(){e.upgradeLight1.node.active=!1}),e.upgradeLight1.playAnimation("newAnimation",1)}),cc.scaleTo(.1,1,1),cc.scaleTo(.05,0,1),cc.scaleTo(.05,1,1),cc.repeat(cc.sequence(cc.scaleTo(.02,0,1),cc.scaleTo(.02,1,1)),15),cc.callFunc(function(){s.default.gameAudio.playUpgradeDwClip(),t&&t(),e.upgradeLight2.node.active=!0,e.upgradeLight2.once(dragonBones.EventObject.COMPLETE,function(){e.upgradeLight2.node.active=!1}),e.upgradeLight2.playAnimation("newAnimation",1)}),cc.scaleTo(.1,1.2,1.2),cc.delayTime(.2),cc.scaleTo(.1,1,1)))},a([u(cc.Sprite)],e.prototype,"levelSprite",void 0),a([u(cc.Node)],e.prototype,"stars",void 0),a([u(cc.Node)],e.prototype,"maxLevel",void 0),a([u(cc.Label)],e.prototype,"starCount",void 0),a([u(cc.SpriteFrame)],e.prototype,"starShow",void 0),a([u(cc.SpriteFrame)],e.prototype,"starHide",void 0),a([u(dragonBones.ArmatureDisplay)],e.prototype,"upgradeLight1",void 0),a([u(dragonBones.ArmatureDisplay)],e.prototype,"upgradeLight2",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/DifficultModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],DoorCircle:[function(t,e,o){"use strict";cc._RF.push(e,"c3797azFKFPmL6kSdUYSxEu","DoorCircle");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/GameData"),c=t("../../../../Script/center/Game"),s=t("../../../manage/GameManage"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.doorNode=null,e.doorBlue=null,e.doorGrey=null,e.gameView=null,e.gameManage=null,e.isGet=!0,e.circle_rect=null,e}return n(e,t),e.prototype.start=function(){var t=this;this.gameManage=s.default.getInstance(),this.gameView=this.gameManage.gameView,this.circle_rect=this.node.getBoundingBox(),this.scheduleOnce(function(){t.isGet=!1},5),this.schedule(this.updateUI,1)},e.prototype.goToNextMap=function(){this.isGet||this.gameView.isMoveNext||(this.gameManage.isCanGoToNext?(this.unschedule(this.updateUI),this.isGet=!0,this.gameView.nextLevel(),this.gameManage.isCanGoToNext=!1,this.node.destroy()):c.default.showToast("\u6b7c\u706d\u5168\u90e8\u654c\u4eba\uff0c\u65b9\u80fd\u5f00\u542f\u4f20\u9001\u95e8"))},e.prototype.updateUI=function(){if(!(this.isGet||this.gameManage.state>=s.GameState.\u6218\u6597\u7ed3\u675f)){this.gameManage.isCanGoToNext&&this.doorNode.spriteFrame==this.doorGrey?(this.doorNode.spriteFrame=this.doorBlue,c.default.showToast("\u654c\u4eba\u5df2\u5168\u90e8\u6b7c\u706d\uff0c\u8bf7\u524d\u5f80\u4e0a\u65b9\u4f20\u9001\u95e8\uff01"),c.default.event.emit(r.GameDataEvent.STOP_CUT_COMBINE_TIME)):this.gameManage.isCanGoToNext||(this.doorNode.spriteFrame=this.doorGrey);var t=this.gameView.curPlayer.node.getBoundingBox();t.width/=2;var e=new cc.Rect;this.circle_rect.intersection(e,t),e.width>=t.width/3&&e.height>=t.height/2&&this.goToNextMap()}},e.prototype.update=function(){},a([u(cc.Sprite)],e.prototype,"doorNode",void 0),a([u(cc.SpriteFrame)],e.prototype,"doorBlue",void 0),a([u(cc.SpriteFrame)],e.prototype,"doorGrey",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../Script/center/Game":"Game","../../../manage/GameManage":"GameManage"}],ETNode:[function(t,e,o){"use strict";cc._RF.push(e,"68e90ePgd9ODbVPyGp9Vtrt","ETNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../Script/center/Game"),s=t("../../../manage/GameManage"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragon=null,e.descLabel=null,e.dialog=null,e.gameView=null,e.gameManage=null,e.isGet=!1,e.circle_rect=null,e}return n(e,t),e.prototype.onEnable=function(){this.schedule(this.updateUI,1)},e.prototype.onDisable=function(){this.unschedule(this.updateUI)},e.prototype.start=function(){this.dialog&&(this.dialog.active=!1),this.gameManage=s.default.getInstance(),this.gameView=this.gameManage.gameView,this.circle_rect=this.node.getBoundingBox(),this.circle_rect.x=this.circle_rect.x-(256-this.circle_rect.width)/2,this.circle_rect.y=this.circle_rect.y-(256-this.circle_rect.height)/2,this.circle_rect.width=256,this.circle_rect.height=256},e.prototype.setPos=function(t){return this.gameManage=s.default.getInstance(),this.gameView=this.gameManage.gameView,this.node.setPosition(t.scale(cc.v2(this.gameView.size,this.gameView.size)).add(cc.v2((this.gameView.size-this.gameView.mapSizeX)/2,(this.gameView.size-this.gameView.mapSizeY)/2))),this.node.zIndex=2*-Math.floor((this.node.y+this.gameView.mapSizeY/2)/this.gameView.size)-1,console.log("setPos========\u592a\u7a7a\u4eba\u4f4d\u7f6e",t.x,t.y,this.node.zIndex),t},e.prototype.init=function(t){var e=this;r.default.addLoaderDragonBones(this.dragon).loadArmature(t,function(){e.dragon.armatureName="armatureName"})},e.prototype.playAni=function(t){this.node.active=!0,this.dragon.playAnimation(t,0)},e.prototype.say=function(t){this.unschedule(this.callback),this.setDescLabel(t),this.callback=this.showDialog.bind(this,null),this.schedule(this.callback,8)},e.prototype.showDialog=function(t){var e=this;this.dialog&&(this.dialog.active=!0),this.dialog&&this.dialog.getComponent(cc.Animation).play(),this.dialog&&this.dialog.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){e.dialog.active=!1,t&&t()})},e.prototype.setDescLabel=function(t){this.descLabel&&(this.descLabel.string=t)},e.prototype.hideDescBg=function(){this.descLabel&&(this.descLabel.node.parent.active=!1)},e.prototype.saveET=function(){var t=this;if(!this.isGet)if(this.gameManage.isCanGoToNext){this.unschedule(this.updateUI),this.unschedule(this.callback),this.dialog&&(this.dialog.active=!1),this.isGet=!0,this.gameManage.isCanGoToNext=!1;var e=this.gameView.curPlayer;e.isStop=!0,this.dragon.once(dragonBones.EventObject.COMPLETE,function(){t.playAni("\u8ba4\u771f"),t.dialog&&(t.dialog.active=!0);var o=t.dialog.getPosition();t.dialog.parent=e.node,t.dialog.setPosition(o),t.setDescLabel("\u8d77\u6765\u4f19\u8ba1\uff0c\u6211\u4eec\u8be5\u56de\u5bb6\u4e86\uff01"),t.showDialog(t.accout.bind(t))}),this.dragon.playAnimation("\u89e3\u6346",1)}else c.default.showToast("\u6b7c\u706dBOSS\uff0c\u65b9\u80fd\u8425\u6551\u592a\u7a7a\u4eba")},e.prototype.accout=function(){var t=this;this.scheduleOnce(function(){t.gameManage.isSave=!0,t.gameManage.checkGame()},1)},e.prototype.updateUI=function(){if(!(this.isGet||this.gameManage.state>=s.GameState.\u6218\u6597\u7ed3\u675f)){this.gameManage.isCanGoToNext&&"\u8fc7\u6765\u5e2e\u6211\u89e3\u5f00\u7ef3\u5b50"!==this.descLabel.string?(this.setDescLabel("\u8fc7\u6765\u5e2e\u6211\u89e3\u5f00\u7ef3\u5b50"),c.default.showToast("\u9760\u8fd1\u592a\u7a7a\u4eba\uff0c\u89e3\u6551\u4ed6\uff01")):this.gameManage.isCanGoToNext;var t=this.gameView.curPlayer.node.getBoundingBox();t.width/=2;var e=new cc.Rect;this.circle_rect.intersection(e,t),e.width>=t.width/4&&e.height>=t.height/4&&this.saveET()}},a([u(dragonBones.ArmatureDisplay)],e.prototype,"dragon",void 0),a([u(cc.Label)],e.prototype,"descLabel",void 0),a([u(cc.Node)],e.prototype,"dialog",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../../framework/Script/component/LoaderDragonBones":void 0,"../../../../Script/center/Game":"Game","../../../manage/GameManage":"GameManage"}],EditView:[function(t,e,o){"use strict";cc._RF.push(e,"87a184Z7z5MM4mDf9vL9chr","EditView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.ItemType=o.o=void 0;var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return n(e,t),e.prototype.start=function(){},a([s(cc.Label)],e.prototype,"label",void 0),a([s],e.prototype,"text",void 0),a([c],e)}(cc.Component);o.default=l,function(t){t[t.MOVE=0]="MOVE",t[t.EDIT=1]="EDIT"}(o.o||(o.o={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.BLOCK=1]="BLOCK",t[t.BOX=2]="BOX",t[t.SHADOW=3]="SHADOW",t[t.DRESS=4]="DRESS",t[t.WATER=5]="WATER",t[t.POINT=6]="POINT",t[t.MOUNTAIN=7]="MOUNTAIN",t[t.CN=8]="CN",t[t.FORT=9]="FORT"}(o.ItemType||(o.ItemType={})),cc._RF.pop()},{}],EggItemNode:[function(t,e,o){"use strict";cc._RF.push(e,"bdb4bQnwixN0LHyxsV1/LcG","EggItemNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.iconSprite=null,e.nameSprite=null,e.data=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){this.data=t,this.nameLabel.string=t.title,r.default.addLoaderSprite(this.iconSprite).loadSprite("egg/"+t.id),r.default.addLoaderSprite(this.nameSprite).loadSprite("egg/"+t.title)},e.prototype.onClick=function(){this.node.emit("onClick",this.data.desc)},a([l(cc.Label)],e.prototype,"nameLabel",void 0),a([l(cc.Sprite)],e.prototype,"iconSprite",void 0),a([l(cc.Sprite)],e.prototype,"nameSprite",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0}],EggTipNode:[function(t,e,o){"use strict";cc._RF.push(e,"dd9c5HFr1NBZL0VxMROnWYL","EggTipNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.descLabel=null,e}return n(e,t),e.prototype.setData=function(t){this.descLabel.string=t},e.prototype.onClick=function(){this.node.destroy()},a([s(cc.Label)],e.prototype,"descLabel",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],EggWallNode:[function(t,e,o){"use strict";cc._RF.push(e,"267fb2UYZpAkZ6s6E44JoJh","EggWallNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/EggModel"),c=t("../../center/Game"),s=t("./EggItemNode"),l=t("./EggTipNode"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentNode=null,e.itemPrefab=null,e.jqqdNode=null,e.eggTipPrefab=null,e.data=[],e}return n(e,t),e.prototype.start=function(){this.data=r.default.getArr();for(var t=0;t<this.data.length;t++){var e=this.data[t],o=cc.instantiate(this.itemPrefab);o.getComponent(s.default).setData(e),o.on("onClick",this.openTip,this),this.contentNode.addChild(o)}this.data.length>0&&(this.jqqdNode.zIndex=100)},e.prototype.openTip=function(t){var e=cc.instantiate(this.eggTipPrefab);e.getComponent(l.default).setData(t),e.parent=this.node.parent.parent},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([p(cc.Node)],e.prototype,"contentNode",void 0),a([p(cc.Prefab)],e.prototype,"itemPrefab",void 0),a([p(cc.Node)],e.prototype,"jqqdNode",void 0),a([p(cc.Prefab)],e.prototype,"eggTipPrefab",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/EggModel":void 0,"../../center/Game":"Game","./EggItemNode":"EggItemNode","./EggTipNode":"EggTipNode"}],EnemyCountView:[function(t,e,o){"use strict";cc._RF.push(e,"412c8JtlMRG94mFWmxy4tVL","EnemyCountView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progress=null,e.countMax=0,e.nowCount=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t){this.countMax=t,1!=this.countMax?this.node.opacity=255:this.node.opacity=0},e.prototype.updateUI=function(t){this.progress.fillRange=t},a([s(cc.Sprite)],e.prototype,"progress",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],EnemyNode:[function(t,e,o){"use strict";cc._RF.push(e,"11e61vxBgJGMbg1ggXlNKep","EnemyNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../../InitScene/Script/data/EnemyModel"),s=t("../../../../../InitScene/Script/data/GameData"),l=t("../../../../../InitScene/Script/data/GuanqiaModel"),d=t("../../../../../InitScene/Script/data/GunModel"),u=t("../../../../../InitScene/Script/data/PersonModel"),p=t("../../../../../InitScene/Script/data/PlayerModel"),h=t("../../../../../Script/common/Flash"),f=t("../../../../Script/center/Game"),m=t("../../../joystick/JoystickCommon"),y=t("../../../manage/GameManage"),g=t("../../../Player"),v=t("../../../test/EditView"),_=t("../ArmView"),S=t("./EnemySkillView"),b=cc._decorator,w=b.ccclass,I=(b.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delay=1,e.think=.02,e.findTime=0,e.path_idx=0,e.path=[],e.isRun=!1,e.isStart=!1,e.isDelay=!1,e.enemy=null,e.isBoss=!1,e.skillAtking=!1,e.enemySkill=c.EnemySkill.\u7ad9\u7acb\u6254\u77f3\u5934,e.enemyBuff=c.EnemyBuff.\u65e0,e.bossState=0,e.changeTime=(new Date).getTime(),e}return n(e,t),e.prototype.start=function(){this.gameType=y.default.getInstance().gameType,this.loadSkin(this.personIdx),this.loadModel(this.personIdx)},e.prototype.loadSkin=function(t){t||0===t||(t=0),this.loadHero(t)},e.prototype.loadHero=function(t){var e=this,o="enemy/"+c.default.getEnemyDataByID(t).skeUrl;r.default.addLoaderDragonBones(e.hero).loadArmature(o,function(){e.scheduleOnce(function(){e.hero.armatureName="Armature";var t=e.hero.attachUtil.generateAttachedNodes("\u67aa");if(t.length){var o=t[0];o&&(e.sprite.node.setPosition(o.getPosition()),e.gunNode=o),e.sprite.node.parent=o}e.hero.playAnimation("\u5f85\u673a",0),e.isCanHurt=!0,e.gameView.targets.push(e)})})},e.prototype.changeAnimation=function(t){var e=this;t.flag&&(this.isPlay=!1,this.animation=""),this.hero&&this.hero.isValid&&(this.isPlay||(t.loop?this.animation!=t.animation&&(this.animation=t.animation,this.hero.playAnimation(t.animation,0),t.callback&&t.callback(),t.animation.indexOf("\u6b7b\u4ea1")>-1&&(this.isPlayDie=!0)):(this.hero.once(dragonBones.EventObject.COMPLETE,function(){e.isPlay=!1,t.callback&&t.callback()}),this.isPlay=!0,this.animation="",this.hero.playAnimation(t.animation,1),t.animation.indexOf("\u6b7b\u4ea1")>-1&&(this.swimNode.node.active=!1,this.fireNode.node.active=!1,this.isPlayDie=!0))))},e.prototype.init=function(){var t=y.default.getInstance();this.gameView=t.gameView,this.setPos(this.index,this.isBoss)},e.prototype.xieziSkillAtk=function(t){this.skilltime=(new Date).getTime();var e=this;cc.log("\u5c3e\u5df4\u653b\u51fb\u6280\u80fd1"),this.changeAnimation({animation:"\u5c3e\u5df4\u6280\u80fd",loop:!1,flag:!0,callback:function(){e.doXieziSkillAtk(t)}})},e.prototype.doXieziSkillAtk=function(){var t=this;cc.log("\u5c3e\u5df4\u653b\u51fb\u6280\u80fd2");var e=this.gameView.getEnemySkill().getComponent(S.default);if(e){var o=this.sprite.node.convertToWorldSpaceAR(cc.v2(0,0)),i=this.gameView.layout.convertToNodeSpaceAR(o);e.node.setParent(this.gameView.layout),e.node.setPosition(i),e.init(this,this.getDir())}this.scheduleOnce(function(){t.changeAnimation({animation:"\u94bb\u51fa\u5730\u9762",loop:!1,flag:!0,callback:function(){this.skillAtking=!1,this.model.SPE=this.enemy.MOVESPE,this.model.CUT_HURT=0,this.bossState=0,this.isDelay=!1}.bind(t)})},this.model.IDLE)},e.prototype.doEnemySkillAtk=function(){var t=this;this.skilltime=(new Date).getTime();var e=this.gameView.getEnemySkill().getComponent(S.default);if(e){var o=this.sprite.node.convertToWorldSpaceAR(cc.v2(0,0)),i=this.gameView.layout.convertToNodeSpaceAR(o);e.node.setParent(this.gameView.layout),e.node.setPosition(i),e.init(this,this.getDir())}this.scheduleOnce(function(){t.skillAtking=!1,t.skilltime=(new Date).getTime()},this.model.IDLE)},e.prototype.initEnemy=function(t,e,o,i,n,a,r,c){void 0===i&&(i=!0),void 0===n&&(n=!1),void 0===a&&(a=0),void 0===r&&(r=0),void 0===c&&(c=0);var s=this;n&&(this.breathNormalNode.node.scale=2,this.breathNormalFloorNode.node.scale=2,this.fireNode.node.scale=2),this.breathNormalFloorNode.node.active=!0,this.breathNormalFloorNode.once(dragonBones.EventObject.COMPLETE,function(){s.breathNormalNode.node.active=!0}),s.breathNormalNode.once(dragonBones.EventObject.COMPLETE,function(){s.breathNormalNode.node.active=!1,s.breathNormalFloorNode.node.active=!1,s.enemy.atkType!==p.ArmType.\u5200\u67aa&&s.enemy.atkType!==p.ArmType.\u65e0\u653b\u51fb&&s.enemy.atkType!==p.ArmType.\u874e\u5b50\u653b\u51fb?s.changeGun(s.gunIdx,s.setAI.bind(s)):s.setAI()}),s.breathNormalNode.playAnimation("newAnimation",1),this.breathNormalFloorNode.playAnimation("newAnimation",1),this.index=t,this.count=a,void 0===e&&(e=1),this.personIdx=o,this.mountIdx=-1,this.mount_level=0,this.model.group=1e5+100*t+a,this.hpBuff=r,this.atkBuff=c,this.bloodLevel=0,this.isBoss=n,this.hpView.node.active=!1,this.model.type&&(this.think=e)},e.prototype.setAI=function(){this.schedule(function(){var t=this;if(t.isStart&&!t.isStop){var e=t.findTargets().filter(function(e){return t.isAttack(e)});if(e.length>0)t.target=e[0],t.attack();else{if(!t.isFill&&!t.isIdle){var o=t.gameView.quadTree.retrieve(t.node.getBoundingBox()).filter(function(e){return t.gameView.nameList.indexOf(e.node.name)>-1&&e.type==v.ItemType.BOX}).filter(function(e){return t.isAttackBlock(e)});if(o.length>0)return t.moveDir=cc.v2(o[0].rect.x+o[0].rect.width/2,o[0].rect.y+o[0].rect.height/2).sub(t.node.getPosition()).normalizeSelf(),t.isDelay&&(t.isDelay=!1,t.unschedule(t.delayAttack)),t.updateDir(t.getDir()),void(t.doAttack()&&(t._speedType=m.SpeedType.NORMAL,t.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf()))}t.run()}}},this.think)},e.prototype.doAttack=function(){var t=this;if(!this.checkTarget(this))return!1;var e=(new Date).getTime(),o=this;if(cc.log("====\u874e\u5b50====doAttack",this.personIdx),102==this.personIdx){if(0==this.bossState)if(cc.log("\u874e\u5b50\u53d8\u8eab",e-this.changeTime>=1e3*(3*Math.random()+6),e-this.changeTime,1e3*(3*Math.random()+6),this.changeTime),e-this.changeTime>=1e3*(3*Math.random()+11))this.changeTime=e,this.changeAnimation({animation:"\u94bb\u5165\u5730\u5e95",loop:!1,callback:function(){this.model.SPE=.8*this.enemy.MOVESPE,this.model.CUT_HURT=.5,this.isDelay=!1,this.skilltime=e,this.bossState=1}.bind(this)});else{if(this.isFill)return!0;this.isDelay=!1,cc.log("\u874e\u5b50\u653b\u51fb"),this.model.SPE=0,this.changeAnimation({animation:"\u653b\u51fb"+(1+Math.floor(2*Math.random())),loop:!1,flag:!0,callback:function(){o.scheduleOnce(function(){o.model.SPE=o.enemy.MOVESPE},.5)}});for(var i=this.model.getCount(),n=0;n<i;n++)if(c=this.gameView.getArm().getComponent(_.default)){s=this.sprite.node.getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)).add(cc.v2(100,0));var a=this.gameView.layout.convertToNodeSpaceAR(s);c.node.setParent(this.gameView.layout),c.node.setPosition(a),c.init(this,this.getDir()),this.offect=this.getDir().mul(2*-this.model.pow)}this.addFire(),this.model.IDLE>0&&(this.isIdle||(this.isIdle=!0,this.scheduleOnce(function(){t.isIdle=!1},this.model.IDLE)))}else if(1==this.bossState)if(e-this.skilltime>=1e3*this.CDtime&&this.enemySkill>-1){this.skillAtking=!0,this.model.SPE=0;var r=this.getDir();this.changeAnimation({animation:"\u5c3e\u5df4\u84c4\u529b",loop:!1,callback:function(){this.xieziSkillAtk(r)}.bind(this)})}else{if(this.isFill)return!0;for(this.model.SPE=0,this.changeAnimation({animation:"\u5c3e\u5df4\u653b\u51fb",loop:!1,flag:!0,callback:function(){o.scheduleOnce(function(){o.model.SPE=.8*o.enemy.MOVESPE,o.isDelay=!1},.5)}}),i=this.model.getCount(),n=0;n<i;n++)(c=this.gameView.getArm().getComponent(_.default))&&(s=this.sprite.node.getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)).add(cc.v2(100,0)),a=this.gameView.layout.convertToNodeSpaceAR(s),c.node.setParent(this.gameView.layout),c.node.setPosition(a),c.init(this,this.getDir()),this.offect=this.getDir().mul(2*-this.model.pow));this.addFire(),this.model.IDLE>0&&(this.isIdle||(this.isIdle=!0,this.scheduleOnce(function(){t.isIdle=!1},this.model.IDLE)))}}else if(e-this.skilltime>=2e3*this.CDtime&&this.enemySkill>-1)101==this.personIdx&&(this.skillAtking=!0,this.model.SPE=0,r=this.getDir(),this.changeAnimation({animation:"\u6280\u80fd",loop:!1,callback:function(){this.model.SPE=this.enemy.MOVESPE,this.doEnemySkillAtk(r),this.isDelay=!1}.bind(this)}));else{if(this.isFill)return!0;if(this.isDelay=!1,cc.log("isdelay",this.isDelay,101==this.personIdx),f.default.gameAudio.playGunFireClip(this.model.audio),this.model.type==p.ArmType.\u5200\u67aa)this.model.SPE=0,this.changeAnimation({animation:"\u653b\u51fb",loop:!1,flag:!0,callback:function(){o.scheduleOnce(function(){o.model.SPE=o.enemy.MOVESPE},.5)}});else{if(this.model.type==p.ArmType.\u65e0\u653b\u51fb)return;this.model.SPE=0,this.changeAnimation({animation:"\u5f85\u673a",loop:!1,flag:!0,callback:function(){o.model.SPE=o.enemy.MOVESPE}})}for(i=this.model.getCount(),n=0;n<i;n++){var c,s;if(c=this.gameView.getArm().getComponent(_.default))s=this.model.type!==p.ArmType.\u5200\u67aa?this.sprite.node.getChildByName(""+this.gunIdx).getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)):this.sprite.node.getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)).add(cc.v2(100,0)),a=this.gameView.layout.convertToNodeSpaceAR(s),c.node.setParent(this.gameView.layout),c.node.setPosition(a),c.init(this,this.getDir()),this.offect=this.getDir().mul(2*-this.model.pow)}this.addFire(),this.model.IDLE>0&&(this.isIdle||(this.isIdle=!0,this.scheduleOnce(function(){t.isIdle=!1},this.model.IDLE))),this.model.time>0&&this.model.addCount(i)&&(this.isFill=!0,this.scheduleOnce(function(){t.isFill=!1,t.model.clearCount()},this.model.time))}return!0},e.prototype.findTargets=function(){var t=this;return this.gameView.targets.filter(function(e){return!!(t.checkTarget(e)&&e.model.group<1e5&&e.model.group>0)||t.checkTarget(e)&&e.model.group<1e5}).sort(function(e,o){return e.node.position.sub(t.node.position).mag()-o.node.position.sub(t.node.position).mag()})},e.prototype.loadModel=function(t){var e;e=c.default.getEnemyDataByID(t),this.enemy=e,this.gameView.curPlayer,this.isInvincible=!1;var o=y.default.getInstance();if(this.model.IDLE=1.5,e.MOVESPE?this.model.SPE=e.MOVESPE+(10*Math.random()-5):this.model.SPE=e.MOVESPE,this.isBoss){if(1==l.default.getGuanqiaByData(o.guanqia.id).guanqia_type){var i=l.default.normalCount,n=l.default.normalData,a=l.default.guanqiaData.id;this.model.MAX_HP=this.model.HP=o.guanqia.bossHP*(a-i)+n.bossHP,this.model.ATK=o.guanqia.bossATK*(a-i)+n.bossATK,this.model.CRI=o.guanqia.bossCRI}else this.model.MAX_HP=this.model.HP=o.guanqia.bossHP,this.model.ATK=o.guanqia.bossATK,this.model.CRI=o.guanqia.bossCRI;this.node.width*=1.5,this.node.height*=1.5,this.sprite.node.setPosition(cc.v2(100,150))}else 1==l.default.getGuanqiaByData(o.guanqia.id).guanqia_type?(i=l.default.normalCount,n=l.default.normalData,a=l.default.guanqiaData.id,this.model.MAX_HP=this.model.HP=o.guanqia.enemyHP*(a-i)+n.enemyHP,cc.log(".g v",i,n,this.model.MAX_HP),this.model.ATK=o.guanqia.enemyATK*(a-i)+n.enemyATK,this.model.CRI=o.guanqia.enemyCRI):(this.model.MAX_HP=this.model.HP=o.guanqia.enemyHP,this.model.ATK=o.guanqia.enemyATK,this.model.CRI=o.guanqia.enemyCRI),this.sprite.node.setPosition(cc.v2(100,50));cc.log("modehp",this.model.MAX_HP,this.model.HP,Math.floor(this.model.MAX_HP*Math.pow(.9,l.default.guanqiaData.rowLose)),l.default.guanqiaData.rowLose),this.model.ATK=Math.floor(this.model.ATK*Math.pow(.9,l.default.guanqiaData.rowLose)),this.model.MAX_HP=this.model.HP=Math.floor(this.model.MAX_HP*Math.pow(.9,l.default.guanqiaData.rowLose)),this.model.CRI=Math.floor(Math.max(this.model.CRI-1*l.default.guanqiaData.rowLose,0)),this.gameType==y.GameType.\u5e7d\u6d6e\u7ed1\u67b6&&(this.model.ATK=2*this.model.ATK,this.model.MAX_HP=this.model.HP=2*this.model.MAX_HP,this.model.CRI=2*this.model.CRI),this.model.RAN=e.DIST,this.model.ROT=0,this.model.MOV=e.ATKSPE,this.model.bullet=e.bullet,this.model.fire=e.fire,this.model.type=e.atkType,this.model.audio=e.audio,this.model.num=e.atkType==p.ArmType.\u65e0\u653b\u51fb?0:1,this.model.total=e.atkType==p.ArmType.\u65e0\u653b\u51fb?0:999,this.model.time=0,this.model.pow=10,this.model.die_audio=e.die_audio,this.model.hurt_audio=e.hurt_audio,this.model.hit=e.hit,this.enemySkill=e.skill?e.skill[0].skillID:-1,this.enemyBuff=e.skill?e.skill[0].buff:-1,this.CDtime=e.skill?e.skill[0].cd:0,this.hpView.init(this.model.MAX_HP,this.isInvincible),this.gunIdx=e.gun,this.model.IDLE<=.2&&this.think>.2&&(this.think=.2),this.enemySkill>-1&&(this.model.SkillATK=this.model.ATK*(e.skill[0].skillATK/100))},e.prototype.isAttack=function(t){if(this.checkTarget(t)&&this.checkTarget(this)&&!this.isStop){var e=cc.v2(this.node.position),o=cc.v2(t.node.position);return(this.model.type==p.ArmType.\u72d9\u51fb||this.model.type==p.ArmType.\u5bfc\u5f39||this.model.type==p.ArmType.\u8d2f\u7a7f)&&e.sub(o).mag()<1e3?!this.gameView.quadTree.retrieve(this.node.getBoundingBox()).concat(this.gameView.quadTree.retrieve(t.node.getBoundingBox())).some(function(t){return(t.type==v.ItemType.BLOCK||t.type==v.ItemType.SHADOW||t.type==v.ItemType.MOUNTAIN)&&cc.Intersection.lineRect(e,o,t.rect)}):!(e.sub(o).mag()>this.model.RAN||this.gameView.quadTree.retrieve(this.node.getBoundingBox()).concat(this.gameView.quadTree.retrieve(t.node.getBoundingBox())).some(function(t){return(t.type==v.ItemType.BLOCK||t.type==v.ItemType.SHADOW||t.type==v.ItemType.MOUNTAIN)&&cc.Intersection.lineRect(e,o,t.rect)}))}return!1},e.prototype.isAttackBlock=function(t){if(t&&this.checkTarget(this)&&!this.isStop){var e=cc.v2(this.node.position),o=cc.v2(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/2);return(this.model.type==p.ArmType.\u72d9\u51fb||this.model.type==p.ArmType.\u5bfc\u5f39||this.model.type==p.ArmType.\u8d2f\u7a7f)&&e.sub(o).mag()<1e3||!(e.sub(o).mag()>this.model.RAN)}return!1},e.prototype.attack=function(){if(!(this.isFill||this.isIdle||this.isDelay))if(this.model.type==p.ArmType.\u6563\u5c04){if(this.isDelay)return;this.isDelay=!0,this.scheduleOnce(this.delayAttack,this.think+.4)}else if(this.model.type==p.ArmType.\u72d9\u51fb||this.model.type==p.ArmType.\u5bfc\u5f39||this.model.type==p.ArmType.\u8d2f\u7a7f){if(this.isDelay)return;var t=this.target.node.position.sub(this.node.position).mag()/500*this.think;this._speedType=m.SpeedType.STOP,this.moveDir=cc.Vec2.ZERO,this.isDelay=!0,this.scheduleOnce(this.delayAttack,t+.4)}else if(this.isBoss){if(this.isDelay)return;t=this.target.node.position.sub(this.node.position).mag()/500*this.think,this._speedType=m.SpeedType.STOP,this.moveDir=cc.Vec2.ZERO,this.isDelay=!0,console.log("AIdelayAttack1111111",this.isDelay,this.isStop),this.scheduleOnce(this.delayAttack,1)}else this.updateDir(this.getDir()),this.doAttack()&&(this._speedType=m.SpeedType.STOP,this.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf())},e.prototype.delayAttack=function(){console.log("AIdelayAttack22222",this.isDelay,this.isStop),this.isStop?this.isDelay=!1:(this.updateDir(this.getDir()),this.doAttack()&&(this._speedType=m.SpeedType.STOP,this.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf()))},e.prototype.run=function(){var t=this;this.isRun||(this.findTime+1e3*this.delay>(new Date).getTime()&&this.attacking&&this.checkTarget(this.target)?(this._speedType=m.SpeedType.NORMAL,this.moveDir=this.moveDir.rotate(Math.PI/20*(Math.random()-.5)),this.isRun=!0,this.scheduleOnce(function(){t.isRun=!1},this.delay)):this.isFind()?(this.isRun=!0,this.doRun()):(this.isRun=!0,this.scheduleOnce(function(){t.isRun=!1},this.delay)))},e.prototype.doRun=function(){var t=this;if(this.path_idx>-1&&this.path_idx<this.path.length)if(this.isStop)this.scheduleOnce(function(){t.doRun()},this.delay);else{var e=this.gameView.astar.getPos(this.path[this.path_idx]).sub(this.node.getPosition());this.moveDir=e.normalize(),this.scheduleOnce(function(){t.path_idx--,t.path_idx<0?t.isRun=!1:t.doRun()},1/Math.max(1,t.path_idx))}},e.prototype.isFind=function(){var t=this,e=this.findTargets(),o=e.filter(function(e){return e==t.gameView.curPlayer});if(o.length>0){if(this.target=o[0],this.findPath(o[0]),this.path.length>1)return this.path_idx=this.path.length-2,!0}else if(e.length>0){if(this.target=e[0],this.findPath(e[0]),this.path.length>1)return this.path_idx=this.path.length-2,!0}else if(this.checkTarget(this.target)&&Math.abs(this.target.node.x-this.node.x)<=cc.winSize.width/2+500&&Math.abs(this.target.node.y-this.node.y)<=cc.winSize.height/2+500&&(this.findPath(this.target),this.path.length>1))return this.path_idx=this.path.length-2,!0;return this.target=null,!1},e.prototype.findPath=function(t){var e=this.gameView.astar.getGird(this.node.getPosition()),o=this.gameView.astar.getGird(t.node.getPosition());this.path=this.gameView.astar.findPath(e,o),this.gameView.astar.floyd(this.path),this.findTime=(new Date).getTime()},e.prototype.findItems=function(){},e.prototype.getPersonIdx=function(t){var e=t;return e>=u.default.getHeroTotalNum()&&(e=u.default.getHeroTotalNum()-Math.floor(3*Math.random())-1),e<0&&(e=0),e},e.prototype.getGunIdx=function(t){var e=t;return e>=d.default.getGunTotalNum()&&(e=d.default.getGunTotalNum()-Math.floor(3*Math.random())-1),e<0&&(e=0),e},e.prototype.update=function(t){if(this.isSwiming)return this._moveSpeed=0,void(102==this.personIdx?0==this.bossState?!this.isAtking&&this.changeAnimation({animation:"\u5f85\u673a",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u5c3e\u5df4\u5f85\u673a",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u5f85\u673a",loop:!0}));if(this.checkTarget(this)){if(!this.isStop&&this.checkTarget(this)){if(this.model.SPE)switch(this._speedType){case m.SpeedType.STOP:this._moveSpeed=0,102==this.personIdx?0==this.bossState?!this.isAtking&&this.changeAnimation({animation:"\u5f85\u673a",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u5c3e\u5df4\u5f85\u673a",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u5f85\u673a",loop:!0});break;case m.SpeedType.NORMAL:case m.SpeedType.FAST:this._moveSpeed=this.model.SPE,102==this.personIdx?0==this.bossState?!this.isAtking&&this.changeAnimation({animation:"\u79fb\u52a81",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u5c3e\u5df4\u79fb\u52a8",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u79fb\u52a8",loop:!0})}else this._speedType=m.SpeedType.STOP,this._moveSpeed=0,102==this.personIdx?0==this.bossState?!this.isAtking&&this.changeAnimation({animation:"\u5f85\u673a",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u5c3e\u5df4\u5f85\u673a",loop:!0}):!this.isAtking&&this.changeAnimation({animation:"\u5f85\u673a",loop:!0});if(this.fire&&this.updateFire(),this.offect.mag()>1?this.offect=this.offect.mul(.9):this.offect=cc.Vec2.ZERO,this.sprite&&this.hero&&this.gunNode&&this.sprite.node.setPosition(cc.v2(0,0)),this.isStart&&!this.gameView.isCombineing&&this.target){var e=this.target.node.getPosition().sub(this.node.getPosition());if(e.mag()>this.model.RAN&&this.model.HP>=this.model.MAX_HP)if(this.isBoss)this.move(t);else{if(!(e.mag()<1200))return void(this._speedType=m.SpeedType.STOP);this.move(t)}else this.move(t)}else!this.gameView.isCombineing&&this.isStart&&this.move(t)}else this.isPlayDie&&(this.hero.node.active=!1,this.isPlayDie=!1,cc.log("model",this.model.group));this.isStart&&!this.gameView.isCombineing&&(this.isRun&&(this._speedType=m.SpeedType.NORMAL),this.updateAtkDir(this.target))}},e.prototype.updateDir=function(t){t=t||this.moveDir,this.dragon&&(t.x>0?this.dragon.node.scaleX=1:this.dragon.node.scaleX=-1,this.sprite&&(this.dragon.node.scaleX>0?this.sprite.node.angle=-(-90+cc.misc.radiansToDegrees(Math.atan2(t.x,t.y))):this.sprite.node.angle=-(-90-cc.misc.radiansToDegrees(Math.atan2(t.x,t.y)))))},e.prototype.updateAtkDir=function(t){if(t){var e=t.node.getPosition().sub(this.node.getPosition());(this.model.type==p.ArmType.\u72d9\u51fb||this.model.type==p.ArmType.\u5bfc\u5f39||this.model.type==p.ArmType.\u8d2f\u7a7f)&&e.mag()<1e3?(this.attacking=!0,this.updateDir(e.normalize())):e.mag()>this.model.RAN?(this.attacking=!1,0==this.moveDir.x&&0==this.moveDir.y&&(this.moveDir=this.dragon.node.scaleX>0?cc.v2(-1,0):cc.v2(1,0)),this.updateDir(this.atkDir?this.atkDir:this.moveDir)):(this.attacking=!0,this.updateDir(e.normalize()))}else this.attacking=!1,0==this.moveDir.x&&0==this.moveDir.y&&(this.moveDir=this.dragon.node.scaleX>0?cc.v2(-1,0):cc.v2(1,0)),this.updateDir(this.atkDir?this.atkDir:this.moveDir)},e.prototype.getDir=function(t){return t=t||this.target,this.checkTarget(t)?cc.v2(t.node.getPosition().sub(this.node.getPosition()).normalizeSelf()):this.atkDir?this.atkDir:this.moveDir},e.prototype.dropCoin=function(){if(0==this.enemy.coin)return null;y.default.getInstance().getCoin+=this.enemy.coin,this.gameView.initAward(this.node.getPosition(),"coin")},e.prototype.dropDiamond=function(){if(0==this.enemy.diamond)return null;y.default.getInstance().getDiamond+=this.enemy.diamond,this.gameView.initAward(this.node.getPosition(),"diamond")},e.prototype.dropDNA=function(){if(0==this.enemy.DNA)return null;y.default.getInstance().getDNA+=this.enemy.DNA,this.gameView.initAward(this.node.getPosition(),"DNA")},e.prototype.hurt=function(t){if(this.isCanHurt){var e=this;if(!t.player.isPlayDie){if(this.checkTarget(this))if(this.doHurt(t),f.default.gameAudio.playHurtClip(t.hurt_audio),this.model.isDead()){var o=t.player;o&&(o.model.kill_count++,0==o.model.group&&f.default.event.emit(s.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.gameType!=y.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=y.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=o.model.group?this.gameType==y.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,o.model):this.gameView.showKill(this.model,o.model)),this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(h.default).updateFlashHurt(function(){e.isHurt=!1})),this.isStop||this.model.SPE>0&&(this.offect=t.speed.normalize().mul(20*t.player.model.pow)),this.die()}else this.isStop||this.model.SPE>0&&(this.offect=t.speed.normalize().mul(40*t.player.model.pow)),this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(h.default).updateFlashHurt(function(){e.isHurt=!1})),this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(h.default).updateFlash()),t.type==p.ArmType.\u51b0\u51bb&&t.state==p.ArmState.\u51b0\u51bb&&this.doIce(function(){e.sprite&&(e.sprite.node.active=!0)});this.isBoss&&(this.isStop||(this.offect=t.speed.normalize().mul(15*t.player.model.pow))),this.isBuff()}}},e.prototype.hurtBySkill=function(t){if(this.isCanHurt){var e=this;if(this.checkTarget(this)){var o;if(this.doHurtBySkill(t),this.model.isDead())(o=t.player)instanceof g.default&&o.model.kill_count++,this.gameType!=y.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=y.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=o.model.group?this.gameType==y.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,o.model):this.gameView.showKill(this.model,o.model),0==o.model.group&&f.default.event.emit(s.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.die();else t.isCombine||((o=t.player).skill==u.HeroSkillType.Hammer?this.doSwim(null,1):o.skill==u.HeroSkillType.Camera?this.doSwim(null,3):o.skill==u.HeroSkillType.Fire&&this.doBlood(.15,3)),this.isStop||this.model.SPE>0&&(this.offect=t.dir.normalize().mul(2e3)),cc.log("=========",this.isStop,t.dir.x,t.dir.y);this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(h.default).updateFlashHurt(function(){e.isHurt=!1}))}this.isBuff()}},e.prototype.hurtByAirSkillCallBack=function(t){var e=this;if(this.model.isDead()){var o=t.player;o instanceof g.default&&o.model.kill_count++,this.gameType!=y.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=y.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=o.model.group?this.gameType==y.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,o.model):this.gameView.showKill(this.model,o.model),0==o.model.group&&f.default.event.emit(s.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.die()}else this.isStop||(this.offect=t.speed.normalize().mul(400));this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(h.default).updateFlashHurt(function(){e.isHurt=!1})),this.isBuff()},e.prototype.isBuff=function(){if(!(this.enemyBuff<0)){var t=this.enemy.skill[0];switch(this.enemyBuff){case c.EnemyBuff.\u534a\u8840\u540e\u653b\u901f\u79fb\u901f\u52a0\u5feb:if(this.isUseSkill)break;this.isUseSkill=!0,this.model.HP<this.model.MAX_HP*(t.buffValue1/100)&&(this.model.MOV=this.model.MOV*(1+t.buffValue2/100),this.model.SPE=this.model.SPE*(1+t.buffValue2/100),this.model.IDLE=this.model.IDLE/2)}}},e.prototype.hurtByCN=function(t,e){if(this.isCanHurt){var o=this;if(this.checkTarget(this)){if(this.doHurtByCN(e),this.model.isDead()){var i=t.player;i instanceof g.default&&i.model.kill_count++,this.gameType!=y.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=y.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=i.model.group?this.gameType==y.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,i.model):this.gameView.showKill(this.model,i.model),0==i.model.group&&f.default.event.emit(s.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.die()}this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(h.default).updateFlashHurt(function(){o.isHurt=!1}))}}},e.prototype.die=function(){this.unschedule(this.updateSkillHP),f.default.gameAudio.playDieClip(this.model.die_audio),this.isAtking=!1;var t=this;this.offect=cc.Vec2.ZERO,this.goSkillOffect=cc.Vec2.ZERO,this.target=null,this.removeFire(),this.hpView.node.active=!1,this.sprite.node.active=!1,this.model.rank=y.default.getInstance().model.players.filter(function(t){return!t.isDead()}).length,this.hero&&this.hero.node.active?this.isStop?(this.isStop=!1,t.hero&&(t.changeAnimation({animation:"\u6b7b\u4ea1",loop:!1,flag:!0,callback:function(){t.model.group>=1e5&&t.node&&t.node.runAction(cc.sequence(cc.callFunc(function(){t.dropCoin(),t.dropDiamond(),t.dropDNA()}),cc.fadeOut(1),cc.callFunc(function(){t.node.active=!1,t.hero.node.active=!1}))),t.pet&&t.pet.node.runAction(cc.fadeOut(1))}}),this.pet&&this.pet.die(),this.isPlayDie=!0)):(this.hero&&this.changeAnimation({animation:"\u6b7b\u4ea1",loop:!1,flag:!0,callback:function(){t.model.group>=1e5&&t.node&&t.node.runAction(cc.sequence(cc.callFunc(function(){t.dropCoin(),t.dropDiamond(),t.dropDNA()}),cc.fadeOut(1),cc.callFunc(function(){t.node.active=!1,t.hero.node.active=!1}))),t.pet&&t.pet.node.runAction(cc.fadeOut(1))}}),this.pet&&this.pet.die(),this.isPlayDie=!0):(this.isStop,this.node&&(this.node.active=!1)),cc.log("\u91cd\u65b0\u5f00\u59cb\u6e38\u620f\u7684\u6b21\u6570",y.default.getInstance().restartcount,this.gameType),this.gameType==y.GameType.\u7ade\u6280\u573a?0==this.model.group?y.default.getInstance().restartcount<1?y.default.getInstance().loseGame():y.default.getInstance().endGame():y.default.getInstance().checkGame():this.gameType!=y.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=y.GameType.\u5e7d\u6d6e\u7ed1\u67b6||y.default.getInstance().checkGame()},a([w],e)}(g.default));o.default=I,cc._RF.pop()},{"../../../../../InitScene/Script/data/EnemyModel":void 0,"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GuanqiaModel":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/PlayerModel":void 0,"../../../../../Script/common/Flash":void 0,"../../../../../framework/Script/component/LoaderDragonBones":void 0,"../../../../Script/center/Game":"Game","../../../Player":"Player","../../../joystick/JoystickCommon":"JoystickCommon","../../../manage/GameManage":"GameManage","../../../test/EditView":"EditView","../ArmView":"ArmView","./EnemySkillView":"EnemySkillView"}],EnemySkillView:[function(t,e,o){"use strict";cc._RF.push(e,"4aa99gQjJ1HBoSuGbw6yPWo","EnemySkillView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../../InitScene/Script/data/EnemyModel"),s=t("../../../../Script/center/Game"),l=t("../../../BasePlayer"),d=t("../../../FollowCamare"),u=t("../../../manage/GameManage"),p=t("../../../test/EditView"),h=t("../../model/SkillModel"),f=t("../GameBlock"),m=cc._decorator,y=m.ccclass,g=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skill=[],e.skillNode=null,e.hurt_ani=null,e.ani=null,e.gameView=null,e.particle=null,e.model=new h.default,e.isDestory=!1,e.isFollow=!1,e.target=null,e.life=0,e.radius=200,e.CD=.2,e.atkTime=(new Date).getTime(),e.isAtk0=!0,e.isAtkTargets=!0,e.hurt=null,e.hurtID=0,e.dir=null,e.enemyNode=null,e.curSkill=null,e}return n(e,t),e.prototype.onLoad=function(){this.gameView=u.default.getInstance().gameView},e.prototype.start=function(){},e.prototype.setModel=function(t){this.model.mount_atk=0,this.model.mount=null,this.model.group=t.model.group,this.model.ATK=t.model.ATK,this.model.CRI=t.model.CRI,this.model.RAN=t.model.RAN,this.model.type=t.model.type,this.model.pos=t.node.getPosition(),this.model.player=t},e.prototype.init=function(t,e){this.enemyNode=t;var o=this;this.hurtID=t.model.hit,this.dir=e;var i=this.skill[t.enemySkill];switch(cc.log("player.enemySkill",t.enemySkill),i&&(i.timeScale=1),this.skillNode.width=0,t.enemySkill){case c.EnemySkill.\u7ad9\u7acb\u6254\u77f3\u5934:return this.reset(),this.setModel(t),this.model.speed=e.mul(500),this.scheduleOnce(this.doDestory,3),i&&(i.node.active=!0),i&&i.playAnimation("newAnimation",0),t.isAtking=!0,t.pauseMove(!0),t.scheduleOnce(function(){t.isAtking=!1,t.resumeMove(!0)},1),i&&(this.curSkill=i),void this.updateDir(e);case c.EnemySkill.\u94bb\u5730:return this.reset(),this.setModel(t),this.model.speed=e.mul(0),this.updateDir(e),this.skillNode.angle+=12.5,this.warnLight(),this.schedule(this.showLight,.02,cc.macro.REPEAT_FOREVER,1),i=null,this.model.player.skillLight=!0,s.default.gameAudio.playCombineSkill(t.combineSkill),this.scheduleOnce(this.doDestory,1.5),void(t.isAtking=!0)}i&&i.once(dragonBones.EventObject.COMPLETE,function(){i.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE),i.removeEventListener(dragonBones.EventObject.START),i.node.active=!1,t.changeAnimation({animation:"\u5f85\u673a",loop:!0}),cc.log(">>>>>>>>>>>\u64ad\u653e\u5b8c\u6210\u5f53\u524d\u6280\u80fd"),o.model.speed=e.mul(t.model.MOV),o.updateDir(e),t.isAtking=!1,o.doDestory()}),i&&(i.node.active=!0),i&&i.playAnimation("newAnimation",1),t.isAtking=!0,t.changeAnimation({animation:"\u5f85\u673a",loop:!1}),i&&(this.curSkill=i),this.updateDir(e)},e.prototype.warnLight=function(){var t=(new cc.Node).addComponent(cc.Graphics);t.node.parent=this.gameView.layout;var e=512*this.node.scale,o=this.skillNode.angle*Math.PI/180,i=o-25*Math.PI/180;cc.log("angle",o,i);var n=this.node.x,a=this.node.y;t.strokeColor=cc.color(0,0,0),t.lineWidth=10,t.moveTo(n,a),t.lineTo(n+e*Math.cos(this.skillNode.angle/180*Math.PI),a+e*Math.sin(this.skillNode.angle/180*Math.PI)),t.arc(n,a,e,o,i),t.lineTo(n+e*Math.cos((this.skillNode.angle-25)/180*Math.PI),a+e*Math.sin((this.skillNode.angle-25)/180*Math.PI)),t.lineTo(n,a),t.close(),t.fillColor=cc.color(200,0,0,100),t.fill(),this.scheduleOnce(function(){t.clear(),t.destroy()},1)},e.prototype.showLight=function(){this.doSkill4(),this.skillNode.width+=350,this.skillNode.width>=640&&(this.skillNode.width=640),this.skillNode.width>512&&(this.skillNode.angle-=2)},e.prototype.showFire=function(){this.dir=this.model.player.getDir(),this.model.speed=this.dir.mul(0),this.updateDir(this.dir),this.doSkill5(this.dir)},e.prototype.reset=function(){this.isFollow=!1,this.isDestory=!1,this.radius=240,this.model.reset()},e.prototype.check=function(t){var e=this,o=this,i=[],n=this.checkBlock(t),a=[];if(a=this.checkTargets(t),this.isAtkTargets?(this.isAtkTargets=!1,this.scheduleOnce(function(){e.isAtkTargets=!0},.1)):a=[],(i=i.concat(n.map(function(t){return{type:"block",item:t}})).concat(a.map(function(t){return{type:"target",item:t}})).sort(function(t,e){return t.item.node.getPosition().sub(o.node.getPosition()).mag()-e.item.node.getPosition().sub(o.node.getPosition()).mag()})).length>0)switch(i[0].type){case"block":return this.hintBlock(i[0].item);case"target":return cc.log("\u6253\u4e2d\u73a9\u5bb6target"),this.hintTarget(i[0].item)}return!1},e.prototype.checkTargets=function(t,e){var o=this;void 0===e&&(e=this.node.getBoundingBox()),e.x=e.x-(128-e.width)/2,e.y=e.y-(128-e.height)/2,e.width=128,e.height=128;var i=cc.v2((e.xMin+e.xMax)/2,(e.yMin+e.yMax)/2);return this.gameView.targets.filter(function(n){if(n.checkTarget(n)&&n.model.group<1e5){var a=n.node.getBoundingBox();return a.x=a.x-(128-n.node.width)/2,a.width=128,a.height=n.hero?2*n.hero.node.height/3:2*n.heroSke.node.height/3,cc.Intersection.lineRect(i,i.add(o.model.speed.mul(t)),a)||i.sub(cc.v2(a.x,a.y)).mag()<=a.width/2+e.width/2}return!1})},e.prototype.checkBlock=function(t,e){return void 0===e&&(e=this.node.getBoundingBox()),this.checkCustom(e,t)},e.prototype.checkCustom=function(t,e){var o=this;return this.gameView.quadTree.retrieve(t).filter(function(i){return o.gameView.nameList.indexOf(i.node.name)>-1&&(i.type==p.ItemType.BLOCK||i.type==p.ItemType.BOX||i.type==p.ItemType.CN||i.type==p.ItemType.SHADOW||i.type==p.ItemType.MOUNTAIN)&&(cc.Intersection.lineRect(o.node.getPosition(),o.node.getPosition().add(o.model.speed.mul(e)),i.rect)||cc.v2(t.x,t.y).sub(cc.v2(i.rect.x,i.rect.y)).mag()<=t.width/2+i.rect.width/2)})},e.prototype.clear=function(){this.target=null,this.hurt&&(this.node.removeChild(this.hurt),this.hurt.destroy(),this.hurt=null),this.node.removeAllChildren(),this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.particle&&(this.particle=null),this.hurt_ani&&(this.gameView.removeAni(this.hurt_ani),this.node.removeAllChildren(),this.hurt_ani=null),this.gameView.putArm(this.node)},e.prototype.doDestory=function(){var t=this,e=this;this.isDestory||(cc.log("\u9500\u6bc1\u64ad\u653e\u5b8c\u7684\u6280\u80fd"),this.isDestory=!0,this.unscheduleAllCallbacks(),this.curSkill&&(this.curSkill.timeScale=100),this.enemyNode.enemySkill==c.EnemySkill.\u7ad9\u7acb\u6254\u77f3\u5934?(s.default.gameAudio.playEnemySkill(this.enemyNode.enemySkill),r.default.addLoadingAssetNode(e.node).loadAsset("attack/hurt/hurt_100",cc.Prefab,function(o,i){if(!o&&e.node.isValid){e.curSkill.node.active=!1,cc.log("\u77f3\u5934\u788e\u88c2\u52a8\u753b");var n=cc.instantiate(i);e.node.addChild(n),n&&n.setPosition(cc.v2(0,0)),n.rotation=-t.node.rotation,e.scheduleOnce(function(){n.destroy()},.5)}})):this.enemyNode.enemySkill==c.EnemySkill.\u94bb\u5730&&this.schedule(this.hideSkillNode,0),this.curSkill&&(this.curSkill.node.active=!1),this.model.player.isStop=!1)},e.prototype.hideSkillNode=function(){this.skillNode.width-=100,this.skillNode.width<=0&&(this.skillNode.width=0,this.model.player.skillLight=!1,this.model.player.isAtking=!1,this.unschedule(this.hideSkillNode))},e.prototype.doFollow=function(){var t=this;this.schedule(function(){t.target&&t.target.node&&t.target.node.active?t.model.speed=t.target.node.getPosition().sub(t.node.getPosition()).normalizeSelf().mul(1500):t.findTarget(cc.rect(t.node.x-40,t.node.y-40,80,80))},.1)},e.prototype.doSkill0=function(t){var e=this,o=[],i=this.checkBlock(t,cc.rect(this.node.x-20,this.node.y-20,40,40)),n=this.checkTargets(t,cc.rect(this.node.x-20,this.node.y-20,40,40));if((o=o.concat(i.map(function(t){return{type:"block",item:t}})).concat(n.map(function(t){return{type:"target",item:t}})).sort(function(t,o){return t.item.node.getPosition().sub(e.node.getPosition()).mag()-o.item.node.getPosition().sub(e.node.getPosition()).mag()})).length>0)try{var a=o[0].item.node,r=cc.rect(a.x-256,a.y-256,512,512),c=new Map;(a.type==p.ItemType.BOX||a.type==p.ItemType.CN)&&c.set(a.uuid,a),this.gameView.quadTree.retrieve(r).forEach(function(t){!c.has(t.node.uuid)&&(t.type==p.ItemType.BOX||t.type==p.ItemType.CN)&&t.node.getPosition().sub(a.getPosition()).mag()<=256&&c.set(t.node.uuid,t.node)}),Array.from(c.values()).forEach(function(t){if(t){var o=t.getComponent(f.default);o&&o.hurt(e.model)}});var s=!1;return this.gameView.targets.forEach(function(t){t&&t.checkTarget(t)&&t.model.group<1e5&&t.node.getPosition().sub(a.getPosition()).mag()<256&&(t.hurtByEnemySkill(e.model),s=!0,cc.log("isatk0",s))}),cc.log("isatk1",s),s}catch(l){return!1}return!1},e.prototype.doSkill1=function(t){var e=this,o=new Map,i=580*this.node.scaleY/2,n=this.node.getPosition();this.gameView.quadTree.retrieve(this.getRectByVec(n,t.mul(i),80)).forEach(function(e){if(!o.has(e.node.uuid)&&(e.type==p.ItemType.BOX||e.type==p.ItemType.CN)){var a=cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(n);a.mag()<i&&cc.misc.radiansToDegrees(a.angle(t))<80&&o.set(e.node.uuid,e.node)}}),Array.from(o.values()).forEach(function(t){if(t){var o=t.getComponent(f.default);o&&o.hurt(e.model)}}),this.gameView.targets.forEach(function(o){if(o&&o.checkTarget(o)&&o.model.group!=e.model.group){var a=o.node.getPosition().sub(n);a.mag()<i+30&&cc.misc.radiansToDegrees(a.angle(t))<90&&o.hurtBySkill(e.model),cc.log("\u9f99\u606f\u51b2\u51fb",a.mag(),i+30,"\u89d2\u5ea6",cc.misc.radiansToDegrees(a.angle(t)))}})},e.prototype.doSkill3=function(t,e){var o=this;void 0===e&&(e=500);var i=[],n=this.checkBlock(t,cc.rect(this.node.x-20,this.node.y-20,40,40)),a=this.checkTargets(t,cc.rect(this.node.x-20,this.node.y-20,40,40));if((i=i.concat(n.map(function(t){return{type:"block",item:t}})).concat(a.map(function(t){return{type:"target",item:t}})).sort(function(t,e){return t.item.node.getPosition().sub(o.node.getPosition()).mag()-e.item.node.getPosition().sub(o.node.getPosition()).mag()})).length>0){try{var r=i[0].item.node,c=cc.rect(r.x-e,r.y-e,2*e,2*e),s=new Map;(r.type==p.ItemType.BOX||r.type==p.ItemType.CN)&&s.set(r.uuid,r),this.gameView.quadTree.retrieve(c).forEach(function(t){!s.has(t.node.uuid)&&(t.type==p.ItemType.BOX||t.type==p.ItemType.CN)&&t.node.getPosition().sub(r.getPosition()).mag()<=e&&s.set(t.node.uuid,t.node)}),Array.from(s.values()).forEach(function(t){if(t){var e=t.getComponent(f.default);e&&e.hurt(o.model)}}),this.gameView.targets.forEach(function(t){t&&t.checkTarget(t)&&t.model.group!=o.model.group&&t.node.getPosition().sub(r.getPosition()).mag()<e&&t.hurtBySkill(o.model)})}catch(l){}return this.gameView.followCamera.node.parent.getComponent(d.default).shark(60),!0}return!1},e.prototype.doSkill4=function(){var t=this,e=new Map,o=(this.node.getPosition(),this.node.getBoundingBox());this.gameView.quadTree.retrieve(o).forEach(function(o){if(!e.has(o.node.uuid)&&(o.type==p.ItemType.BOX||o.type==p.ItemType.CN)){var i=t.node.angle/180*Math.PI,n=t.node.x,a=t.node.y,r=t.node.height/2,c=t.node.width*t.node.scaleX,s=cc.v2(n+Math.cos(Math.PI/2+i)*(r/2),a+Math.sin(Math.PI/2+i)*(r/2)),l=cc.v2(n+Math.cos(-Math.PI/2+i)*(r/2),a+Math.sin(-Math.PI/2+i)*(r/2)),d=cc.v2(s.x+Math.cos(i)*c,s.y+Math.sin(i)*c),u=[s,l,cc.v2(l.x+Math.cos(i)*c,l.y+Math.sin(i)*c),d],h=o.node.getBoundingBox(),f=[cc.v2(h.xMin,h.yMin),cc.v2(h.xMax,h.yMin),cc.v2(h.xMax,h.yMax),cc.v2(h.xMin,h.yMax)];cc.Intersection.polygonPolygon(u,f)&&e.set(o.node.uuid,o.node)}}),Array.from(e.values()).forEach(function(e){if(e){var o=e.getComponent(f.default);o&&o.hurt(t.model)}}),this.gameView.targets.forEach(function(e){if(e&&e.checkTarget(e)&&e.model.group!=t.model.group){var o=t.node.angle/180*Math.PI,i=t.node.x,n=t.node.y,a=t.node.height/2,r=t.node.width*t.node.scaleX,c=cc.v2(i+Math.cos(Math.PI/2+o)*(a/2),n+Math.sin(Math.PI/2+o)*(a/2)),s=cc.v2(i+Math.cos(-Math.PI/2+o)*(a/2),n+Math.sin(-Math.PI/2+o)*(a/2)),l=cc.v2(c.x+Math.cos(o)*r,c.y+Math.sin(o)*r),d=[c,s,cc.v2(s.x+Math.cos(o)*r,s.y+Math.sin(o)*r),l],u=e.node.getBoundingBox(),p=[cc.v2(u.xMin,u.yMin),cc.v2(u.xMax,u.yMin),cc.v2(u.xMax,u.yMax),cc.v2(u.xMin,u.yMax)];cc.Intersection.polygonPolygon(d,p)&&e.hurtByEnemySkill(t.model),cc.log("\u874e\u5b50\u6fc0\u5149")}})},e.prototype.doSkill5=function(t){var e=this,o=new Map,i=this.node.getPosition();this.gameView.quadTree.retrieve(this.getRectByVec(i,t.mul(660),70)).forEach(function(e){if(!o.has(e.node.uuid)&&(e.type==p.ItemType.BOX||e.type==p.ItemType.CN)){var n=cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(i);n.mag()<660&&cc.misc.radiansToDegrees(n.angle(t))<60&&o.set(e.node.uuid,e.node),n.mag()<125&&o.set(e.node.uuid,e.node)}}),Array.from(o.values()).forEach(function(t){if(t){var o=t.getComponent(f.default);o&&o.hurt(e.model)}}),this.gameView.targets.forEach(function(o){if(o&&o.checkTarget(o)&&o.model.group!=e.model.group){var n=o.node.getPosition().sub(i);n.mag()<660&&cc.misc.radiansToDegrees(n.angle(t))<60&&o.hurtBySkill(e.model)}})},e.prototype.doSkill6=function(t,e){var o=this;void 0===e&&(e=400);var i=this.model.player.node.getPosition().add(t.mul(e)),n=cc.rect(i.x-e,i.y-e,2*e,2*e),a=new Map;return this.gameView.quadTree.retrieve(n).forEach(function(t){!a.has(t.node.uuid)&&(t.type==p.ItemType.BOX||t.type==p.ItemType.CN)&&t.node.getPosition().sub(i).mag()<=e&&a.set(t.node.uuid,t.node)}),Array.from(a.values()).forEach(function(t){if(t){var e=t.getComponent(f.default);e&&e.hurt(o.model)}}),this.gameView.targets.forEach(function(t){t&&t.checkTarget(t)&&0!=t.model.group&&t.node.getPosition().sub(i).mag()<e&&t.hurtBySkill(o.model)}),this.gameView.followCamera.node.parent.getComponent(d.default).shark(60),i},e.prototype.doSkill7=function(){if(cc.log("isAtk7",this.isAtk0),this.isAtk0){this.isAtk0=!1;var t=this,e=new Map,o=this.node.getPosition(),i=cc.rect(o.x-375,o.y-375,750,562.5);this.gameView.quadTree.retrieve(i).forEach(function(t){e.has(t.node.uuid)||t.type!=p.ItemType.BOX&&t.type!=p.ItemType.CN||cc.v2(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/2).sub(o).mag()<375&&e.set(t.node.uuid,t.node)}),Array.from(e.values()).forEach(function(e){if(e){var o=e.getComponent(f.default);o&&o.hurt(t.model)}}),this.gameView.targets.forEach(function(e){if(e&&e.checkTarget(e)&&e.model.group!=t.model.group){var i=e.node.getPosition().sub(o);i.mag()<375&&e.hurtBySkill(t.model),cc.log("\u6218\u4e89\u8df5\u8e0f",i.mag(),375)}}),this.model.player.changeAnimation({animation:"\u5f85\u673a",loop:!1,flag:!0}),this.model.player.isAtking=!0,this.gameView.followCamera.node.parent.getComponent(d.default).shark()}},e.prototype.lineRect=function(t,e,o){var i=t.add(e),n=e.mag(),a=cc.v2((o.x+o.xMax)/2,(o.y+o.yMax)/2);if(Math.abs(a.x-t.x)<=o.width/2+n&&Math.abs(a.y-t.y)<=o.height/2+n&&(Math.abs(a.x-t.x)>o.width/2||Math.abs(a.y-t.y)>o.height/2)){var r=cc.v2(o.x,o.y),c=cc.v2(o.x,o.yMax),s=cc.v2(o.xMax,o.yMax),l=cc.v2(o.xMax,o.y),d=[];return cc.Intersection.lineLine(t,i,r,c)&&d.push({i:0,d:r.sub(t).mag()+c.sub(t).mag()}),cc.Intersection.lineLine(t,i,c,s)&&d.push({i:1,d:c.sub(t).mag()+s.sub(t).mag()}),cc.Intersection.lineLine(t,i,s,l)&&d.push({i:2,d:s.sub(t).mag()+l.sub(t).mag()}),cc.Intersection.lineLine(t,i,l,r)&&d.push({i:3,d:l.sub(t).mag()+r.sub(t).mag()}),d.length>0?(d.sort(function(t,e){return t.d-e.d}),d[0].i):-2}return Math.abs(a.x-t.x)<o.width/2&&Math.abs(a.y-t.y)<o.height/2?-1:-2},e.prototype.findTarget=function(t){if(void 0===t&&(t=this.node.getBoundingBox()),this.model.player){var e=this.model.player;if(e.checkTarget(e)&&e.target&&e.target.node.getPosition().sub(e.node.getPosition()).mag()<e.model.RAN)return this.target=e.target,void(this.model.speed=e.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV));var o=this.gameView.targets.filter(function(t){return t.model.group!=e.model.group&&t.checkTarget(t)}).sort(function(t,o){return t.node.getPosition().sub(e.node.getPosition()).mag()-o.node.getPosition().sub(e.node.getPosition()).mag()});if(o.length>0&&o[0].node.getPosition().sub(e.node.getPosition()).mag()<e.model.RAN)return this.target=o[0],void(this.model.speed=this.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV));var i=new Map,n=this;this.gameView.quadTree.retrieve(t).forEach(function(t){i.has(t.node.uuid)||n.gameView.nameList.indexOf(t.node.name)>-1||t.type!=p.ItemType.BOX&&t.type!=p.ItemType.CN||i.set(t.node.uuid,t.node)});var a=Array.from(i.values()).sort(function(t,o){return t.getPosition().sub(e.node.getPosition()).mag()-o.getPosition().sub(e.node.getPosition()).mag()});a.length>0&&a[0].getPosition().sub(this.node.getPosition()).mag()<320&&(this.target=a[0],this.model.speed=this.target.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV))}},e.prototype.updateDir=function(t){0==t.x?t.y>0?this.node.angle=-90*this.gameView.curPlayer.dragon.node.scaleX/this.gameView.curPlayer.dragon.node.scaleY:t.y<0?this.node.angle=90*this.gameView.curPlayer.dragon.node.scaleX/this.gameView.curPlayer.dragon.node.scaleY:this.node.angle=0:this.node.angle=-(-90+cc.misc.radiansToDegrees(Math.atan2(t.x,t.y)))},e.prototype.update=function(t){if(this.gameView&&this.model.player&&!this.isDestory){if(this.model.player.model.isDead())return this.doDestory();switch(this.enemyNode.enemySkill){case c.EnemySkill.\u7ad9\u7acb\u6254\u77f3\u5934:this.doSkill0(t)?this.doDestory():this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)))}}},e.prototype.hintBlock=function(t){switch(t.type){case p.ItemType.MOUNTAIN:return!1;case p.ItemType.BLOCK:case p.ItemType.BOX:case p.ItemType.CN:if(t.type==p.ItemType.BOX||t.type==p.ItemType.CN){var e=t.node.getComponent(f.default);if(e&&!e.hurt(this.model))return!0}}return!1},e.prototype.hintTarget=function(t){var e=t.getComponent(l.default);return!(!e||!e.checkTarget(e)||(e.hurtByEnemySkill(this.model),0))},e.prototype.getRectByVec=function(t,e,o){var i,n,a,r,c,s,l;return o>0?(s=t.add(e.rotate(cc.misc.degreesToRadians(o))),l=t.add(e.rotate(cc.misc.degreesToRadians(-o))),i=t.add(e),c=Math.min(t.x,s.x,l.x,i.x),n=Math.min(t.y,s.y,l.y,i.y),c==(a=Math.max(t.x,s.x,l.x,i.x))&&(a+=1),n==(r=Math.max(t.y,s.y,l.y,i.y))&&(r+=1),cc.rect(c,n,a-c,r-n)):(i=t.add(e),c=Math.min(t.x,i.x),n=Math.min(t.y,i.y),c==(a=Math.max(t.x,i.x))&&(a+=1),n==(r=Math.max(t.y,i.y))&&(r+=1),cc.rect(c,n,a-c,r-n))},a([g([dragonBones.ArmatureDisplay])],e.prototype,"skill",void 0),a([g(cc.Node)],e.prototype,"skillNode",void 0),a([y],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../../../../InitScene/Script/data/EnemyModel":void 0,"../../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../Script/center/Game":"Game","../../../BasePlayer":"BasePlayer","../../../FollowCamare":"FollowCamare","../../../manage/GameManage":"GameManage","../../../test/EditView":"EditView","../../model/SkillModel":"SkillModel","../GameBlock":"GameBlock"}],EquipBoxView:[function(t,e,o){"use strict";cc._RF.push(e,"2e0b20svAZGHbNnUP8XBKxb","EquipBoxView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../center/Game"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.lowSpriteFrame=null,e.heightSpriteFrame=null,e.rank=0,e.box=null,e.type=0,e.isEffect=!0,e.isDestory=!1,e.isOpen=!1,e.start=function(){},e.init=function(t){var e=this;switch(t.type&&(this.type=t.type),this.type){case 0:this.sprite.spriteFrame=this.lowSpriteFrame;break;case 1:this.sprite.spriteFrame=this.heightSpriteFrame}t.rank&&(this.rank=t.rank),t.box&&(this.box=t.box,this.box.equip=this,this.node.position=cc.v2(0,800),this.node.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,-800)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.1,cc.v2(0,-20)),cc.callFunc(function(){e.isEffect=!1}))),this.node.parent=this.box.node),this.isOpen=!0},e.doOpen=function(){var t=this;this.isDestory=!0;var e=r.default.mainUI,o=e.getCombine().getComponent(sp.Skeleton);o.node.parent=this.node,o.node.active=!0,o.setAnimation(0,"animation",!1),o.setCompleteListener(function(){r.default.gameAudio.playCombineGunClip(),t.box.equip=null,e.appendItem(t.rank,t.box),o.clearTracks(),o.node.active=!1,e.combinePool.put(o.node),t.node.destroy()})},e}return n(e,t),e.prototype.onClickBox=function(){var t=this;if(!this.isEffect&&!this.isDestory){this.unschedule(this.doOpen),this.isDestory=!0;var e,o=r.default.mainUI,i=o.getCombine();(e=i.getComponent(sp.Skeleton)).clearTracks(),e.node.parent=this.node,e.node.setPosition(cc.Vec2.ZERO),e.node.active=!0,e.setAnimation(0,"animation",!1),e.setCompleteListener(function(){switch(r.default.gameAudio.playOpenBox(),t.type){case 0:t.box&&!isNaN(t.rank)&&(t.box.equip=null,o.appendItem(t.rank,t.box));break;case 1:t.box&&!isNaN(t.rank)&&(t.box.equip=null,o.appendItem(t.rank,t.box)),r.default.uiCenter.showUi("SeniorBoxNode"),o.updateMatrix()}e.clearTracks(),e.node.active=!1,o.combinePool.put(e.node),t.node.destroy()})}},a([l(cc.Sprite)],e.prototype,"sprite",void 0),a([l(cc.SpriteFrame)],e.prototype,"lowSpriteFrame",void 0),a([l(cc.SpriteFrame)],e.prototype,"heightSpriteFrame",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../center/Game":"Game"}],FarmDragon:[function(t,e,o){"use strict";cc._RF.push(e,"54c820gxJVI4Yn2zP7mEIzd","FarmDragon");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/ActivityModel"),c=t("../../../InitScene/Script/data/MountModel"),s=t("../../Script/center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragon=null,e.wakeupJDLPrefab=null,e.isDie=!1,e}return n(e,t),e.prototype.start=function(){this.node.zIndex=-180,r.default.isWakeupMountJDL&&this.node.destroy()},e.prototype.onKill=function(){var t=this;if(this.isDie)s.default.uiCenter.showUi(this.wakeupJDLPrefab).on("onClose",function(){r.default.isWakeupMountJDL&&(t.isDie=!1,t.node.runAction(cc.sequence(cc.fadeOut(1.2),cc.callFunc(function(){t.node.destroy()},t))))});else{if(c.default.getMountDataById(r.default.mountJDLwakeupID).level<c.MountMaxLevel)return void s.default.showToast("\u5c06\u9e21\u591a\u62c9\u5347\u6ee1\u624d\u6709\u8db3\u591f\u5b9e\u529b\u4e3a\u7267\u573a\u9664\u5bb3!",1);this.dragon.on(dragonBones.EventObject.COMPLETE,function(){t.isDie=!0},this),this.dragon.playAnimation("\u6b7b\u4ea1",1),s.default.gameAudio.playMountClip(r.default.mountJDLwakeupID)}},a([u(dragonBones.ArmatureDisplay)],e.prototype,"dragon",void 0),a([u(cc.Prefab)],e.prototype,"wakeupJDLPrefab",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../InitScene/Script/data/ActivityModel":void 0,"../../../InitScene/Script/data/MountModel":void 0,"../../Script/center/Game":"Game"}],FarmGameItemNode:[function(t,e,o){"use strict";cc._RF.push(e,"9b9fbNQXRRHr5HE4ILiEbhk","FarmGameItemNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=t("../../../../framework/Script/component/LoaderSprite"),d=t("../../../../InitScene/Script/data/GameData"),u=t("../../center/Game"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bg=null,e.icon=null,e.nameLabel=null,e.difficultLabel=null,e.descLabel=null,e.data=null,e}return n(e,t),e.prototype.setData=function(t){this.data=t,this.nameLabel.string=t.map_name,this.difficultLabel.string="\u96be\u5ea6\uff1a"+t.difficult,this.descLabel.string=t.desc;var e="farm/bg/"+t.bg_url;l.default.addLoaderSprite(this.bg).loadSprite(e),l.default.addLoaderSprite(this.icon).loadSprite(t.seedIconUrl)},e.prototype.onClick=function(){this.enterGame()},e.prototype.enterGame=function(){u.default.event.emit(d.GameDataEvent.MAP_FARM,this.data)},a([s(cc.Sprite)],e.prototype,"bg",void 0),a([s(cc.Sprite)],e.prototype,"icon",void 0),a([s(cc.Label)],e.prototype,"nameLabel",void 0),a([s(cc.Label)],e.prototype,"difficultLabel",void 0),a([s(cc.Label)],e.prototype,"descLabel",void 0),a([c],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],FarmGameNode:[function(t,e,o){"use strict";cc._RF.push(e,"3b2beE3uqpOSoA0Nvgq4BAu","FarmGameNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/center/GameInit"),c=t("../../../../InitScene/Script/data/FarmGameModel"),s=t("../../center/Game"),l=t("../list/List"),d=t("./FarmGameItemNode"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapList=null,e.mapInfoList=[],e.index=0,e}return n(e,t),e.prototype.start=function(){this.mapInfoList=c.default.getFarmGameList(),cc.log("this.mapInfoList",this.mapInfoList),this.mapInfoList.length>0&&(this.index=this.mapInfoList.length-1,this.mapList.numItems=this.mapInfoList.length)},e.prototype.onVerricalList=function(t,e){var o=this;t.getComponent(d.default).setData(this.mapInfoList[e]),t.on(cc.Node.EventType.TOUCH_END,function(){o.index!=e&&(o.index=e,s.default.gameAudio.playButtonClick())},this)},e.prototype.onClose=function(){r.default.uiCenter.closeUI(this.node)},a([h(l.default)],e.prototype,"mapList",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/FarmGameModel":void 0,"../../center/Game":"Game","../list/List":"List","./FarmGameItemNode":"FarmGameItemNode"}],FarmGameView:[function(t,e,o){"use strict";cc._RF.push(e,"39a04v8ZT9KzLGndZm79shc","FarmGameView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../manage/GameManage"),c=t("../../../BasePlayer"),s=t("../../../Player"),l=t("../../../public/AStar"),d=t("../../../public/QuadTree"),u=t("../../../test/EditView"),p=t(".././AI"),h=t("../GameBlock"),f=t("../../../../../MainScene/Script/center/Game"),m=t("../../../../../InitScene/Script/data/GameData"),y=t("../../../../../InitScene/Script/data/OtherData"),g=t("../../../../../InitScene/Script/data/GunModel"),v=t("../../../../../InitScene/Script/data/PersonModel"),_=t("../../../../../InitScene/Script/data/MountModel"),S=t("../../../../../InitScene/Script/data/MapListModel"),b=t("../Account/farm/AccountAwardFarmNode"),w=t("../GameView/GameView"),I=cc._decorator,M=I.ccclass,k=(I.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=null,e}return n(e,t),e.prototype.onLoad=function(){r.default.getInstance().gameView=this},e.prototype.start=function(){f.default.gameAudio.playGameBGMusic(),f.default.event.on(m.GameDataEvent.GAME_ACCOUNT,this.showAcc,this),this.boxShadowNode.active=!1;var t=f.default.sceneCenter.getCustomData();t&&t.matchInfo.isFarm&&(this.data=t.matchInfo.map_data);var e=this.mapPrefab,o=r.default.getInstance().maptype;switch(o){case S.MapState.\u91ce\u5916:e=this.mapPrefab;break;case S.MapState.\u79d1\u6280:e=this.map2Prefab;break;case S.MapState.\u68ee\u6797:e=this.map3Prefab}this.map.getComponent(cc.Sprite).spriteFrame=this.mapSF[o];var i=e.length,n=Math.floor(Math.random()*i),a=cc.instantiate(e[n]);a.parent=this.map,a.zIndex=-1,this.layout=a,this.player.parent=this.layout,cc.log("=====MapItemInfo======",this.data,this.json,this.json.json,o,n),this.init(this.json.json["map"+o+n])},e.prototype.init=function(t){var e=this,o=this;this.quadTree=new d.default(this.map.getBoundingBox()),t.point&&(this.points=t.point.map(function(t){return cc.v2(t)}).sort(function(){return Math.random()-.5})),cc.log("==this.points==",this.points[0]),this.nameList=["box","shu_gan","shu2","xian_ren_zhang","luo_xue_de_shu","tree","pool_water","pool_up","pool_down","pool_left","pool_right","pool_right_up","pool_right_down","pool_left_up","pool_left_down","shi_bei","shi_tou_die","pu_tong_shi_tou","shi_tou_gu","dai_gu_ci_shi_tou","zhang_peng","map_left_down","map_right_down","map_left_up","map_right_up","map_down","map_up","map_left","map_right","map","mountain_1","mountain_2","mountain_3","mountain_4","shi_tou1","shi_tou2","bing_wu1","bing_wu2","pen_quan","rongyanjianci"],this.layout.children.forEach(function(t){if(e.nameList.indexOf(t.name)>=0){var i=t.getComponent(h.default),n=t.getPosition().add(cc.v2(e.map.width/2,e.map.height/2)).div(e.size);i.gird=cc.v2(Math.floor(n.x),Math.floor(n.y)),t.setPosition(i.gird.add(cc.v2(1,1)).mul(e.size).sub(cc.v2(e.map.width/2,e.map.height/2).add(cc.v2(e.size/2,e.size/2)))),i.type!=u.ItemType.WATER?(t.zIndex=2*-i.gird.y,t.name.indexOf("map")>=0&&(t.zIndex=10*-i.gird.y)):t.zIndex=2*-Math.floor(e.map.height/e.size),o.blocks.push(i),i.init()}else"grass1"==t.name||"grass2"==t.name||"guang"==t.name?t.zIndex=2*-Math.floor(e.map.height/e.size)+1:"addHpLogo"==t.name?t.zIndex=1:"addHpCircle"==t.name&&(n=t.getPosition().add(cc.v2(e.map.width/2,e.map.height/2)).div(e.size),t.setPosition(cc.v2(Math.floor(n.x),Math.floor(n.y)).add(cc.v2(1,1)).mul(e.size).sub(cc.v2(e.map.width/2,e.map.height/2).add(cc.v2(e.size/2,e.size/2)))),t.zIndex=t.zIndex=2*-Math.floor(e.map.height/e.size)-10)}),this.astar||(this.astar=new l.default),this.astar.init(this.size,this.size,Math.floor(this.map.width/this.size)-1,Math.floor(this.map.height/this.size)-1),this.astar.initMap(),this.astar.resetMap(),this.blocks.forEach(function(t){t.type!=u.ItemType.BLOCK&&t.type!=u.ItemType.WATER&&t.type!=u.ItemType.SHADOW&&t.type!=u.ItemType.MOUNTAIN||0!=o.astar.gridsList[t.gird.x][t.gird.y].type||(o.astar.gridsList[t.gird.x][t.gird.y].type=-1)}),this.doStart(),this.schedule(this.airDrop,y.default.airDropTime)},e.prototype.doStart=function(){this.initEnemy(),this.targets=this.layout.getComponentsInChildren(c.default),this.players=this.layout.getComponentsInChildren(s.default),this.curPlayer=this.players[0],r.default.getInstance().model.players=this.players.map(function(t){return t.model}),this.players.forEach(function(t){return t.init()}),console.log("=======\u731c\u6d4b\uff1a\u73a9\u5bb6=======GameManage.getInstance().model.players",r.default.getInstance().model.players),this.tipsView.gameView=this,this.tipsView.node.active=!0,this.tipsView.startGame()},e.prototype.startGame=function(){var t=this;this.attackView.node.active=!0,this.timeView.node.active=!0,this.timeView.init(120),this.timeView.startTimer(),this.timeView.node.on("finished",function(){t.doEnd(),r.default.getInstance().endGame()},this),this.mapView.node.active=!0,this.mapView.init(Math.max(this.map.width,this.map.height)),this.shadow.active=!1,this.enemys.forEach(function(t){return t.isStart=!0})},e.prototype.endGame=function(){this.isAccount||(this.isAccount=!0,this.attackView.stopAttack(),this.timeView.pauseTimer(),this.shadow.active=!0,this.tipsView.node.active=!0,this.tipsView.endGame(),this.unschedule(this.airDrop),r.default.getInstance().endGame())},e.prototype.initEnemy=function(){for(var t=g.default.getGunMaxLevel(),e=v.default.useHeroId,o=_.default.getMountDataById(_.default.useMountId).level,i=null,n=0;n<r.default.getInstance().aicount;n++){var a=Math.min(_.MountMaxLevel,o+2),c=this.rand(Math.max(_.default.useMountId-3,0),Math.min(_.default.useMountId+3,_.default.getMountMaxId())),s=Math.min(t+2,g.default.getGunTotalNum()-1),l=(i=cc.instantiate(this.aiPrefab)).getComponent(p.default);l.initAI(n,.1,l.getPersonIdx(e+2),s,c,a,!0,this.data.hpBuff,this.data.atkBuff),i.parent=this.layout,this.enemys.push(l)}},e.prototype.showAcc=function(t){var e;cc.log("player",t),e=0==t.rank,f.default.uiCenter.showUi(this.accountPrefab).getComponent(b.default).init(e,this.data)},e.prototype.update=function(){var t=this.players.filter(function(t){return t&&t.node.active&&t.model&&!t.model.isDead()});this.updateMap(t)},a([M],e)}(w.default));o.default=k,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MapListModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/OtherData":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../BasePlayer":"BasePlayer","../../../Player":"Player","../../../manage/GameManage":"GameManage","../../../public/AStar":"AStar","../../../public/QuadTree":"QuadTree","../../../test/EditView":"EditView",".././AI":"AI","../Account/farm/AccountAwardFarmNode":"AccountAwardFarmNode","../GameBlock":"GameBlock","../GameView/GameView":"GameView"}],FarmHeroNode:[function(t,e,o){"use strict";cc._RF.push(e,"9340cmas4pKl428fSl5oGHC","FarmHeroNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderDragonBones"),c=t("../../../InitScene/Script/center/GameInit"),s=t("../../../InitScene/Script/data/GameData"),l=t("../../../InitScene/Script/data/PersonModel"),d=t("../../GameScene/manage/GameManage"),u=t("../../Script/center/Game"),p=["\u522b\u7ad9\u5728\u6697\u5904\uff0c\u51fa\u6765\u770b\u7740\u6211","\u8fd9\u624d\u662f\u6211\u60f3\u8981\u7684\u751f\u6d3b","\u6211\u597d\u50cf\u6709\u70b9\u60f3\u5ff5\u4f60\u7684\u76ae\u6bdb\u4e86"],h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroNode=null,e.heroDragon=null,e.dialogNode=null,e.dialogLabel=null,e.heroPrefab=null,e.farmNode=null,e.parentNode=null,e.pos=null,e.scale=null,e.isMove=!0,e.data=null,e.index=0,e}return n(e,t),e.prototype.start=function(){var t=this;this.dialogNode.scale=0,this.farmNode=d.default.getInstance().farmView,this.node.zIndex=2*-Math.floor((this.node.y+this.farmNode.map.height/2)/this.farmNode.size),this.parentNode=this.heroNode.parent,this.pos=this.heroNode.getPosition(),this.scale=this.heroNode.scale,this.data=l.default.getHeroDataById(5),this.index=Math.floor(3*Math.random()),r.default.addLoaderDragonBones(this.heroDragon).loadArmature("hero/dragon/"+this.data.skeUrl,function(){t.heroDragon.armatureName="armatureName",t.heroDragon.playAnimation("\u5f85\u673a",0)}),this.data.isUnlock?this.showMangager():(this.heroNode.parent=this.farmNode.HomeNode.node.parent,this.heroNode.setPosition(this.farmNode.HomeNode.node.getPosition().add(cc.v2(0,this.heroNode.height*this.heroNode.scale/2))),this.heroNode.active=!1,this.heroNode.scale=.7,u.default.event.on(s.GameDataEvent.SHOW_FARM_HERO,this.onShow,this),u.default.event.on(s.GameDataEvent.HIDE_FARM_HERO,this.onHide,this))},e.prototype.onShow=function(){this.heroNode.active=!0},e.prototype.onHide=function(){this.heroNode.active=!1},e.prototype.onClick=function(){this.data.isUnlock?this.changeDialog():(this.dialogNode.scale=0,c.default.uiCenter.showUi(this.heroPrefab).on("onClose",this.showMangager,this))},e.prototype.changeDialog=function(){this.dialogNode.stopAllActions(),this.dialogNode.scale=0,this.dialogNode.runAction(cc.sequence(cc.scaleTo(.3,1),cc.delayTime(3),cc.scaleTo(.2,0))),this.index=(this.index+1)%p.length,this.dialogLabel.string=p[this.index]},e.prototype.showMangager=function(){this.data.isUnlock&&(u.default.event.off(s.GameDataEvent.SHOW_FARM_HERO),u.default.event.off(s.GameDataEvent.HIDE_FARM_HERO),this.heroNode.parent=this.parentNode,this.heroNode.setPosition(this.pos),this.heroNode.scale=this.scale,this.onShow(),this.changeDialog(),this.schedule(this.changeDialog,10))},a([m(cc.Node)],e.prototype,"heroNode",void 0),a([m(dragonBones.ArmatureDisplay)],e.prototype,"heroDragon",void 0),a([m(cc.Node)],e.prototype,"dialogNode",void 0),a([m(cc.Label)],e.prototype,"dialogLabel",void 0),a([m(cc.Prefab)],e.prototype,"heroPrefab",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../InitScene/Script/center/GameInit":void 0,"../../../InitScene/Script/data/GameData":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../framework/Script/component/LoaderDragonBones":void 0,"../../GameScene/manage/GameManage":"GameManage","../../Script/center/Game":"Game"}],FarmView:[function(t,e,o){"use strict";cc._RF.push(e,"66fcccKJetBCYDcA4MP5XJw","FarmView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../InitScene/Script/data/GameData"),c=t("../../InitScene/Script/data/OtherData"),s=t("../../InitScene/Script/data/PersonModel"),l=t("../../InitScene/Script/data/UFOModel"),d=t("../GameScene/manage/GameManage"),u=t("../Script/center/Game"),p=t("../Script/ui/cultivate/GetCultivateNode"),h=t("./AIHeroNode/AIHeroNode"),f=t("./mount/MountAINode"),m=t("./UFONode/UFONode"),y=cc._decorator,g=y.ccclass,v=y.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=83,e.map=null,e.layout=null,e.guess=null,e.back=null,e.UFONode=null,e.seedBoxs=[],e.players=[],e.ais=[],e}return n(e,t),Object.defineProperty(e.prototype,"maxGirdX",{get:function(){return Math.floor(this.map.width/this.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxGirdY",{get:function(){return Math.floor(this.map.height/this.size)},enumerable:!1,configurable:!0}),e.prototype.rand=function(t,e){var o=Math.floor(t+Math.random()*(e-t+1));return o=Math.min(o,e),Math.max(o,t)},e.prototype.onLoad=function(){d.default.getInstance().farmView=this},e.prototype.start=function(){this.init(),u.default.event.once(r.GameDataEvent.HIDE_FARM_HERO,this.hideAI,this),u.default.event.once(r.GameDataEvent.GO_UFO,this.goUFO,this);var t=s.default.getHeroDataById(c.default.UFOHeroID),e=l.default.enterTimes>=c.default.UFOHeroTime&&!t.isUnlock,o=u.default.sceneCenter.getCustomData();if(cc.log(o,"MainUI"),o&&o.matchInfo.isShowUFO)return cc.log("MainUI,data.matchInfo",o.matchInfo),this.UFONode.node.zIndex=1,void this.UFONode.showUFO();(o&&o.matchInfo.isGetHero||e)&&((t=s.default.getHeroDataById(c.default.UFOHeroID)).onUnlock(),u.default.uiCenter.showUi("GetCultivateNode").getComponent(p.default).setData("hero","hero/dragon/"+t.skeUrl,"\u5f85\u673a",t.award),s.default.useHeroId=t.id),u.default.gameAudio.playMainBGMusic()},e.prototype.init=function(){this.doStart()},e.prototype.doStart=function(){this.players=this.layout.getComponentsInChildren(f.default),this.players.forEach(function(t){return t&&t.init()}),this.startGame()},e.prototype.startGame=function(){this.ais.forEach(function(t){return t&&(t.isStart=!0)})},e.prototype.getEmptyGird=function(){var t=Math.floor(this.layout.width*Math.random()-this.layout.width/2),e=this.map.y+Math.floor(this.map.height/3*Math.random()-this.map.height/6);return cc.v2(t,e)},e.prototype.hideAI=function(){for(var t=this.node.getComponentsInChildren(h.default),e=0;e<t.length;e++)t[e].node.active=!1;cc.log(t.length)},e.prototype.goUFO=function(){this.hideAI(),this.guess.active=!1,this.back.active=!1,this.UFONode.showSaveETAni()},e.prototype.backMainScene=function(){u.default.sceneCenter.runScene("MainScene")},e.prototype.onClickGuest=function(){u.default.uiCenter.showUi("GoGuessNode")},a([v(cc.Node)],e.prototype,"map",void 0),a([v(cc.Node)],e.prototype,"layout",void 0),a([v(cc.Node)],e.prototype,"guess",void 0),a([v(cc.Node)],e.prototype,"back",void 0),a([v(m.default)],e.prototype,"UFONode",void 0),a([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../InitScene/Script/data/GameData":void 0,"../../InitScene/Script/data/OtherData":void 0,"../../InitScene/Script/data/PersonModel":void 0,"../../InitScene/Script/data/UFOModel":void 0,"../GameScene/manage/GameManage":"GameManage","../Script/center/Game":"Game","../Script/ui/cultivate/GetCultivateNode":"GetCultivateNode","./AIHeroNode/AIHeroNode":"AIHeroNode","./UFONode/UFONode":"UFONode","./mount/MountAINode":"MountAINode"}],FillView:[function(t,e,o){"use strict";cc._RF.push(e,"aefc9LFb4dMeIt7O1Af4M7Z","FillView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.time=0,e.start=function(){},e.init=function(t){this.time=t,this.node.active=!0,this.refresh()},e.refresh=function(){this.label.string=this.time.toFixed(1)+"s"},e.update=function(t){this.time>0?(this.time-=t,this.refresh()):this.node.active=!1},e}return n(e,t),a([s(cc.Label)],e.prototype,"label",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],FireView:[function(t,e,o){"use strict";cc._RF.push(e,"f6a6eoZ+I9LwbulQssNAP/X","FireView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragon=null,e.model=null,e.isEffect=!1,e.isDestory=!1,e.callback=null,e.fire=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t,e){this.model=t,e&&(this.callback=e,this.isDestory=!0,this.schedule(this.doCallback,2))},e.prototype.doFire=function(){var t=this;switch(this.model.fire){case 0:break;case 1:case 2:case 3:case 4:case 5:this.dragon?this.startFire():r.default.addLoadingAssetNode(this.node).loadAsset("attack/fire/fire_"+this.model.fire,cc.Prefab,function(e,o){if(!e&&t.node.isValid){var i=cc.instantiate(o);t.node.addChild(i),t.fire=i,t.dragon=i.children[0].getComponent(dragonBones.ArmatureDisplay),console.log("FireView\u2014\u2014\u52a0\u8f7d",t.isEffect,!!t.fire,!!t.dragon)}})}},e.prototype.startFire=function(t){void 0===t&&(t="animation");var e=this;this.dragon&&(this.isEffect||(this.isEffect=!0,this.dragon.node.active=!0,this.dragon.playAnimation("newAnimation",1),this.dragon.once(dragonBones.EventObject.COMPLETE,function(){e.isEffect=!1,e.dragon.node.active=!1}))),this.callback&&this.isDestory&&(this.isDestory=!1)},e.prototype.stopFire=function(){this.fire&&this.fire.destroy(),this.fire=null,this.unschedule(this.doCallback),this.callback=null,this.isEffect=!1,this.dragon=null},e.prototype.doCallback=function(){this.isDestory?(this.unschedule(this.doCallback),this.callback&&this.callback()):this.isDestory=!0},a([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{"../../../../framework/Script/component/LoaderAssetNode":void 0}],FollowCamare:[function(t,e,o){"use strict";cc._RF.push(e,"905c6QCDENIOpp3IdOQblZf","FollowCamare");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./manage/GameManage"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camera=null,e.bg=null,e.player=null,e.isAuto=!0,e.gameView=null,e}return n(e,t),e.prototype.onLoad=function(){this.gameView=r.default.getInstance().gameView},e.prototype.updatePos=function(t,e,o){void 0===t&&(t=.62),void 0===e&&(e=0),void 0===o&&(o=0),void 0===t&&(t=this.camera.zoomRatio);var i=this.player.convertToWorldSpaceAR(cc.v2(0,0));i=this.node.parent.convertToNodeSpaceAR(i);var n=Math.abs((cc.winSize.width/t-this.bg.width*this.bg.scale)/2),a=Math.abs((cc.winSize.height/t-this.bg.height*this.bg.scale)/2);n=Math.abs((cc.winSize.width/t-this.gameView.mapSizeX*this.bg.scale)/2),a=Math.abs((cc.winSize.height/t-this.gameView.mapSizeY*this.bg.scale)/2);var r=this.gameView.mapIndex*this.gameView.mapSizeY-this.gameView.map.height/2+this.gameView.mapSizeY/2,c=r-a,s=r+a,l=this.gameView.layout.x-n,d=this.gameView.layout.x+n;i.x>d?i.x=d:i.x<l&&(i.x=l),i.y>s?i.y=s:i.y<c&&(i.y=c),this.node.setPosition(i.add(cc.v2(e,o)))},e.prototype.shark=function(t){void 0===t&&(t=30),this.camera.node.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.1,0,t),cc.moveBy(.1,0,-t),cc.moveBy(.05,0,t/2),cc.moveBy(.05,0,-t/2)))},e.prototype.update=function(){var t=.65;r.default.getInstance().gameType,r.GameType.\u7ade\u6280\u573a,t=.62,this.isAuto&&this.updatePos(t)},a([l(cc.Camera)],e.prototype,"camera",void 0),a([l(cc.Node)],e.prototype,"bg",void 0),a([l(cc.Node)],e.prototype,"player",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./manage/GameManage":"GameManage"}],FreeGetMountItemNode:[function(t,e,o){"use strict";cc._RF.push(e,"55549ooLxxAapitXBssbfvy","FreeGetMountItemNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.videoLabel=null,e.data=null,e}return n(e,t),e.prototype.start=function(){c.default.gameAudio.playWindow()},e.prototype.setData=function(t){r.default.addLoaderSprite(this.iconSprite).loadSprite(t.icon_url),this.data=t,this.updateUI()},e.prototype.updateUI=function(){this.videoLabel.string="("+this.data.watchVideo_isVideo+"/"+this.data.isVideo+")"},e.prototype.videoSuccess=function(){this.data.watchVideo_isVideo++,this.updateUI(),this.data.watchVideo_isVideo>=this.data.isVideo&&(this.data.onUnlockVideo(),this.data.onVideo(),this.data.success(),this.data.onReward(),this.onClose())},e.prototype.onClose=function(){this.node.emit("onClose"),c.default.uiCenter.closeUI(this.node)},a([d(cc.Sprite)],e.prototype,"iconSprite",void 0),a([d(cc.Label)],e.prototype,"videoLabel",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],FruitItemNode:[function(t,e,o){"use strict";cc._RF.push(e,"6af8dk4VvxD4JF2UZdkC3ig","FruitItemNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderSprite"),c=t("../../../InitScene/Script/data/ActivityModel"),s=t("../../GameScene/manage/GameManage"),l=t("../../Script/center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.move_icon=null,e.fruitNum=null,e.fruitData=null,e.id=0,e.farmNode=null,e.parentNode=null,e.pos=null,e.isCanMove=!0,e}return n(e,t),e.prototype.setData=function(t){this.fruitData=t,cc.log("fruitData",this.fruitData),this.id=this.fruitData.id;var e="farm/fruit/"+this.id;r.default.addLoaderSprite(this.move_icon).loadSprite(e),r.default.addLoaderSprite(this.icon).loadSprite(e),this.setIsMove()},e.prototype.onEnable=function(){this.showFruitList()},e.prototype.start=function(){this.farmNode=s.default.getInstance().farmView,this.parentNode=this.move_icon.node.parent,this.pos=this.move_icon.node.getPosition()},e.prototype.setIsMove=function(){this.fruitNum.string=""+this.fruitData.fruitCount,this.fruitData.fruitCount>0?(this.isCanMove=!0,this.move_icon.node.color=cc.color(255,255,255)):(this.isCanMove=!1,this.move_icon.node.color=cc.color(100,100,100))},e.prototype.eat=function(){var t=this;this.move_icon.node.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.resumeItem(),t.fruitData.fruitCount--,t.setIsMove()},this)))},e.prototype.resumeItem=function(){this.move_icon.node.opacity=255,this.move_icon.node.parent=this.parentNode,this.move_icon.node.runAction(cc.moveTo(0,this.pos))},e.prototype.showFruitList=function(){this.move_icon.node.on(cc.Node.EventType.TOUCH_START,this.touchStartFruit,this),this.move_icon.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveFruit,this),this.move_icon.node.on(cc.Node.EventType.TOUCH_END,this.touchEndFruit,this),this.move_icon.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndFruit,this)},e.prototype.hideFruitList=function(){this.move_icon.node.off(cc.Node.EventType.TOUCH_START,this.touchStartFruit,this),this.move_icon.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveFruit,this),this.move_icon.node.off(cc.Node.EventType.TOUCH_END,this.touchEndFruit,this),this.move_icon.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEndFruit,this)},e.prototype.touchStartFruit=function(t){var e=cc.v2(t.getLocation());this.isCanMove&&(this.move_icon.node.parent=this.farmNode.node,this.move_icon.node.setPosition(this.farmNode.node.convertToNodeSpaceAR(e)))},e.prototype.touchMoveFruit=function(t){if(this.isCanMove){var e=t.getLocation();this.move_icon.node.setPosition(this.farmNode.node.convertToNodeSpaceAR(e))}},e.prototype.touchEndFruit=function(t){var e=this;if(this.isCanMove){var o=cc.v2(t.getLocation());if(6==this.id&&!c.default.isWakeupHeroEatCount){var i=this.farmNode.seaView.node.getBoundingBoxToWorld();if(o.x>i.x&&o.x<i.x+i.width&&o.y>i.y&&o.y<i.y+i.height)return c.default.wakeupHeroEatCount++,this.farmNode.water.node.active=!0,this.farmNode.water.node.setPosition(this.farmNode.layout.convertToNodeSpaceAR(o)),this.farmNode.water.on(dragonBones.EventObject.COMPLETE,function(){e.farmNode.water.node.active=!1,e.farmNode.seaView.onEat(o)},this.farmNode),this.farmNode.water.playAnimation("newAnimation",1),l.default.gameAudio.playWaterClip(),void this.eat()}var n=this.farmNode.players.filter(function(t){var e=t.node.getBoundingBoxToWorld();return o.x>e.x&&o.x<e.x+e.width&&o.y>e.y&&o.y<e.y+e.height});if(n.length>0){n.sort(function(t,e){return-(t.node.zIndex-e.node.zIndex)});var a=this.fruitData.exp;n[0].onEat(a)?this.eat():(l.default.showToast("\u5df2\u8fbe\u6700\u5f3a\u8840\u8109\uff0c\u65e0\u9700\u5582\u517b"),this.resumeItem())}else this.resumeItem()}this.setIsMove()},e.prototype.onDisable=function(){this.hideFruitList()},a([p(cc.Sprite)],e.prototype,"icon",void 0),a([p(cc.Sprite)],e.prototype,"move_icon",void 0),a([p(cc.Label)],e.prototype,"fruitNum",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../InitScene/Script/data/ActivityModel":void 0,"../../../framework/Script/component/LoaderSprite":void 0,"../../GameScene/manage/GameManage":"GameManage","../../Script/center/Game":"Game"}],FruitNode:[function(t,e,o){"use strict";cc._RF.push(e,"48b80mD4nlBGY3ZOBeZSMhM","FruitNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/TreeModel"),c=t("../../GameScene/manage/GameManage"),s=t("./FruitItemNode"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fruitlayout=null,e.fruitPrefab=null,e.farmView=null,e}return n(e,t),e.prototype.start=function(){this.farmView=c.default.getInstance().farmView,this.setFruitList()},e.prototype.setFruitList=function(){for(var t=r.default.fruitArr,e=t.length,o=0;o<e;o++){var i=cc.instantiate(this.fruitPrefab);i.getComponent(s.default).setData(t[o]),i.parent=this.fruitlayout}},a([u(cc.Node)],e.prototype,"fruitlayout",void 0),a([u(cc.Prefab)],e.prototype,"fruitPrefab",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../InitScene/Script/data/TreeModel":void 0,"../../GameScene/manage/GameManage":"GameManage","./FruitItemNode":"FruitItemNode"}],FuliNode:[function(t,e,o){"use strict";cc._RF.push(e,"c257bSyS7hF2aQV1RXAc278","FuliNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/OtherData"),s=t("../../../../InitScene/Script/data/TimeModel"),l=t("../../../../InitScene/Script/data/TurnTableModel"),d=t("../../../../Script/base/Utils"),u=t("../../center/Game"),p=t("../sign/SignNode"),h=t("../turnTable/TurnTableNode"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.signLabel=null,e.signTipRichText=null,e.signButton=null,e.turn10Button=null,e.turnSprite=null,e.countLabel=null,e.scrollView=null,e.tipNode=null,e}return n(e,t),e.prototype.start=function(){var t=u.default.gameConfig.signConfig[s.default.dayRound].round;this.signTipRichText.string=t[s.default.day].desc,this.setSignTime(),this.setCountLabel(),this.schedule(this.setSignTime,1),this.scheduleOnce(this.setTip)},e.prototype.setCountLabel=function(){l.default.drawCount<c.default.drawMax?this.countLabel.string=this.countLabel.string.replace("X",l.default.drawCount+""):this.countLabel.node.parent.active=!1;var t="mount/avatar/"+(5*c.default.mountTurnAward+4);r.default.addLoaderSprite(this.turnSprite).loadSprite(t)},e.prototype.setSignTime=function(){if(d.isDateUpdata(s.default.lastSignTime))return this.signLabel.string="\u5f53\u524d\u53ef\u9886\u53d6",void(this.signButton.interactable=!0);var t,e=(new Date).getTime();(t=new Date).setHours(24),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);var o=t.getTime();this.signLabel.string="\u4e0b\u6b21\u9886\u53d6 "+this.timeFtt(o-e),this.signButton.interactable=!1},e.prototype.onSignUI=function(){u.default.uiCenter.showUi("SignNode")},e.prototype.onSignButton=function(){var t=u.default.gameConfig.signConfig[s.default.dayRound].round;u.default.uiCenter.showUi("SignNode").getComponent(p.default).setData("hero"==t[s.default.day].type||"gun"==t[s.default.day].type)},e.prototype.onTurnTableUI=function(){u.default.uiCenter.showUi("TurnTableNode")},e.prototype.onTurn10=function(){if(cc.log(l.default.todayDrawCount,"\u8f6c\u76d8"),l.default.todayDrawCount>=l.default.draw10Time_max)return u.default.showToast("\u4eca\u5929\u7684\u6b21\u6570\u7528\u5b8c\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427");u.default.uiCenter.showUi("TurnTableNode").getComponent(h.default).setData(!0)},e.prototype.onClose=function(){u.default.uiCenter.closeUI(this.node),this.node.emit("onClose")},e.prototype.timeFtt=function(t){var e=Math.floor(t/1e3/60/60),o=e>9?e:"0"+e,i=Math.floor(t/1e3/60)-60*e,n=i>9?i:"0"+i,a=Math.floor(t/1e3)-60*i-3600*e;return o+":"+n+":"+(a>9?a:"0"+a)},e.prototype.update=function(){},e.prototype.setTip=function(){this.scrollView.getContentPosition().y>=this.scrollView.content.height-this.scrollView.node.height-100?this.tipNode.active=!1:this.tipNode.active=!0},a([y(cc.Label)],e.prototype,"signLabel",void 0),a([y(cc.RichText)],e.prototype,"signTipRichText",void 0),a([y(cc.Button)],e.prototype,"signButton",void 0),a([y(cc.Node)],e.prototype,"turn10Button",void 0),a([y(cc.Sprite)],e.prototype,"turnSprite",void 0),a([y(cc.RichText)],e.prototype,"countLabel",void 0),a([y(cc.ScrollView)],e.prototype,"scrollView",void 0),a([y(cc.Node)],e.prototype,"tipNode",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../../InitScene/Script/data/OtherData":void 0,"../../../../InitScene/Script/data/TimeModel":void 0,"../../../../InitScene/Script/data/TurnTableModel":void 0,"../../../../Script/base/Utils":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","../sign/SignNode":"SignNode","../turnTable/TurnTableNode":"TurnTableNode"}],GameAttack:[function(t,e,o){"use strict";cc._RF.push(e,"8dc44QYp81I757oLxKNUumI","GameAttack");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/MountModel"),c=t("../../../../InitScene/Script/data/PlayerModel"),s=t("../../Player"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numLabel=null,e.player=null,e.airSkillButton=null,e.skillButton=null,e.CDSprite=null,e.CDLabel=null,e.SkillSprite=[],e.SkillCombineSprite=[],e.combineSkillButton=null,e.combineCDSprite=null,e.combineCDLabel=null,e.combineNode=null,e.descNode=null,e.descLabel=null,e.shootCDSprite=null,e.isAction=!1,e.isActionMount=!1,e.isSkill=!1,e.isLine=!1,e.isShow=!1,e.shootCDtime=0,e.canAttackState=!1,e.canAttack=!1,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.skillButton.interactable=!0},e.prototype.showTip=function(){this.player.model.type==c.ArmType.\u72d9\u51fb||this.player.model.type==c.ArmType.\u8d2f\u7a7f||this.player.model.type==c.ArmType.\u5bfc\u5f39?this.descLabel.string="\u957f\u6309\u53ef\u7784\u51c6":this.descLabel.string="\u957f\u6309\u53ef\u8fde\u5c04",this.descNode.active=!0},e.prototype.onEnable=function(){cc.sys.isMobile},e.prototype.onDisable=function(){},e.prototype.addClickAttackListener=function(){cc.sys.isMobile&&(this.node.on(cc.Node.EventType.TOUCH_START,this.startAttack,this),this.node.on(cc.Node.EventType.TOUCH_END,this.stopAttack,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.stopAttack,this))},e.prototype.removeClickAttackListener=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.startAttack,this),this.node.off(cc.Node.EventType.TOUCH_END,this.stopAttack,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.stopAttack,this)},e.prototype.addSkillBtnListener=function(){this.skillButton.node.on(cc.Node.EventType.TOUCH_START,this.onClickSkill,this),this.skillButton.node.on(cc.Node.EventType.TOUCH_END,this.onStopSkill,this),this.skillButton.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onStopSkill,this)},e.prototype.startAttack=function(){if(this.player.isStop)return this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),void this.player.hideLine();this.player.model.type==c.ArmType.\u72d9\u51fb||this.player.model.type==c.ArmType.\u8d2f\u7a7f||this.player.model.type==c.ArmType.\u5bfc\u5f39?this.isLine=!0:(this.player.showCircle(),this.player.isIdle?this.scheduleOnce(this.startAttack,this.player.model.IDLE):(this.doAttack(),this.schedule(this.doAttack,this.player.model.IDLE)))},e.prototype.stopAttack=function(){if(this.unschedule(this.startAttack),this.player.model.type==c.ArmType.\u72d9\u51fb||this.player.model.type==c.ArmType.\u8d2f\u7a7f||this.player.model.type==c.ArmType.\u5bfc\u5f39){if(this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.player.hideLine(),this.player.isIdle)return;this.doAttack()}else this.player.hideCircle(),this.unschedule(this.doAttack)},e.prototype.checkAttack=function(t,e){this.player.gameView.isCombineing?this.canAttackState&&(this.canAttackState=!1,this.player.hideCircle(),this.unschedule(this.doAttack)):e?this.onClickCombineSkill():t?this.onClickSkill():this.canAttack?this.canAttackState||(this.canAttackState=!0,this.player.isStop&&(this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.player.hideLine()),this.player.showCircle(),this.player.isIdle?(this.canAttackState=!1,this.scheduleOnce(this.checkAttack,this.player.model.IDLE)):(this.doAttack(),this.schedule(this.doAttack,this.player.model.IDLE))):this.canAttackState&&(this.canAttackState=!1,this.player.hideCircle(),this.unschedule(this.doAttack))},e.prototype.doAttack=function(){if(this.player.isStop)return this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),void this.player.hideLine();this.player.doAttack()},e.prototype.showLine=function(){},e.prototype.refreshLabel=function(){if(this.player.model.time>0){var t=this.player.model.total-this.player.model.count;this.numLabel.node.color=0==t?cc.Color.RED:cc.Color.WHITE,this.numLabel.string=t.toString()}else this.numLabel.fontSize=40,this.numLabel.string="\u221e"},e.prototype.onClickSkill=function(){this.skillButton.interactable&&(cc.log("this.player.isStop",this.player.isStop),this.isSkill=!0,this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.doSkill())},e.prototype.onStopSkill=function(){this.skillButton.interactable&&(this.isSkill=!1,r.default.getMountDataById(this.player.mountIdx).initiative!=r.SkillType.Wind&&r.default.getMountDataById(this.player.mountIdx).initiative!=r.SkillType.Thunder||(this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.player.hideLine(),this.doSkill()))},e.prototype.doSkill=function(){this.skillButton.interactable&&(this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.player.hideLine(),this.player.doSkillAtk())},e.prototype.onClickCombineSkill=function(){this.combineSkillButton.interactable&&this.player.isCombine&&(this.isSkill=!0,this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.doCombineSkill())},e.prototype.onStopCombineSkill=function(){this.combineSkillButton.interactable&&this.player.isCombine&&(this.isSkill=!1,r.default.getMountDataById(this.player.mountIdx).initiative!=r.SkillType.Wind&&r.default.getMountDataById(this.player.mountIdx).initiative!=r.SkillType.Thunder||(this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.player.hideLine(),this.doCombineSkill()))},e.prototype.doCombineSkill=function(){this.combineSkillButton.interactable&&this.player.isCombine&&(this.isLine=!1,this.isShow=!1,this.unschedule(this.showLine),this.player.hideLine(),this.player.doCombineSkillAtk())},e.prototype.onClickAirSkill=function(){this.player.doAirSkillAtk()},e.prototype.update=function(t){var e=this;if(this.player.isLoadGunFinsh){if(this.canAttack=!1,this.player&&this.player.checkTarget(this.player)){this.player.target=null;var o=null,i=!1,n=this.combineSkillButton.interactable&&this.player.isCombine;if(n||this.skillButton.interactable){if((c=this.player.findTargets(!0,n)).length>0)for(var a in c){var r=c[a];if(r&&r.model&&!r.model.isDead()&&!this.player.isStop){this.player.target=r,i=!0;break}}null==this.player.target&&(s=this.player.findBlocks(!0,n)).length>0&&(o=s[0],i=!0)}if(null==this.player.target&&null==o){var c,s;if((c=this.player.findTargets()).length>0)for(var l in c)if(this.player.isAttack(c[l])){this.player.target=c[l],this.canAttack=!0;break}null==this.player.target&&(s=this.player.findBlocks()).length>0&&(o=s[0],this.canAttack=!0)}null==o?this.player.gunNode&&this.player.updateAtkDir(this.player.target,!1):this.player.gunNode&&this.player.updateAtkDir(o,!0);var d=this.player.skill;this.skillButton.node.getComponent(cc.Sprite).spriteFrame=this.SkillSprite[d],this.CDSprite.spriteFrame=this.SkillSprite[d],this.player.combineSkill>0&&(d=this.player.combineSkill-100,this.combineSkillButton.node.getComponent(cc.Sprite).spriteFrame=this.SkillCombineSprite[d],this.combineCDSprite.spriteFrame=this.SkillCombineSprite[d]),this.checkAttack(i,n)}!this.isLine||this.isShow||this.player.isIdle||(this.isShow=!0,this.scheduleOnce(this.showLine,.1)),this.isSkill&&(!this.isLine||this.isShow||(this.isShow=!0,this.scheduleOnce(this.showLine,.1))),this.refreshLabel();var u=(new Date).getTime();u-this.player.skilltime>=1e3*this.player.CDtime?this.skillButton.node.active&&(this.skillButton.interactable=!0,this.CDSprite.fillRange=0,this.CDLabel.string=""):this.skillButton.node.active&&(this.skillButton.interactable=!1,this.CDSprite.fillRange=1-(u-this.player.skilltime)/(1e3*this.player.CDtime),this.CDLabel.string=Math.floor((1e3*this.player.CDtime-(u-this.player.skilltime))/100)/10+"\u79d2"),u-this.player.combine_skilltime>=1e3*this.player.combineCDtime?this.player.isCombine?(this.combineSkillButton.node.opacity=255,this.combineSkillButton.interactable=!0,this.combineCDSprite.fillRange=0,this.combineCDLabel.string=""):(this.combineSkillButton.node.opacity=0,this.combineCDSprite.fillRange=1,this.combineSkillButton.interactable=!1,this.combineCDLabel.string=""):this.combineSkillButton.node.active&&this.player.isCombine?(this.combineSkillButton.interactable=!1,this.combineCDSprite.fillRange=1-(u-this.player.combine_skilltime)/(1e3*this.player.combineCDtime),this.combineCDLabel.string=Math.floor((1e3*this.player.combineCDtime-(u-this.player.combine_skilltime))/100)/10+"\u79d2"):this.player.isCombine||(this.combineSkillButton.node.opacity=0,this.combineCDSprite.fillRange=1,this.combineSkillButton.interactable=!1,this.combineCDLabel.string=""),this.player.isFill?(this.shootCDtime+=t,this.shootCDSprite.fillRange=1-Math.min(1,this.shootCDtime/this.player.model.time)):this.player.isIdle?(this.shootCDtime+=t,this.shootCDSprite.fillRange=1-Math.min(1,this.shootCDtime/this.player.model.IDLE)):(this.shootCDtime=0,this.shootCDSprite.fillRange=0),this.player.airSkillTimes<=0?(this.airSkillButton.interactable=!1,this.airSkillButton.node.color=cc.color(0,0,0)):(0==this.airSkillButton.interactable?(this.isAction=!0,this.airSkillButton.node.runAction(cc.sequence(cc.tintTo(.2,255,255,255),cc.repeat(cc.sequence(cc.tintTo(.2,0,0,0),cc.tintTo(.2,255,255,255)),3),cc.callFunc(function(){e.isAction=!1})))):this.isAction||(this.airSkillButton.node.color=cc.color(255,255,255)),this.airSkillButton.interactable=!0)}},e.prototype.touchMoveEvent=function(t){var e=cc.v2(this.node.convertToNodeSpaceAR(t.getLocation())).sub(this.node.getPosition()).normalize();this.player.moveDir=e},a([u(cc.Label)],e.prototype,"numLabel",void 0),a([u(s.default)],e.prototype,"player",void 0),a([u(cc.Button)],e.prototype,"airSkillButton",void 0),a([u(cc.Button)],e.prototype,"skillButton",void 0),a([u(cc.Sprite)],e.prototype,"CDSprite",void 0),a([u(cc.Label)],e.prototype,"CDLabel",void 0),a([u([cc.SpriteFrame])],e.prototype,"SkillSprite",void 0),a([u([cc.SpriteFrame])],e.prototype,"SkillCombineSprite",void 0),a([u(cc.Button)],e.prototype,"combineSkillButton",void 0),a([u(cc.Sprite)],e.prototype,"combineCDSprite",void 0),a([u(cc.Label)],e.prototype,"combineCDLabel",void 0),a([u(cc.Node)],e.prototype,"combineNode",void 0),a([u(cc.Node)],e.prototype,"descNode",void 0),a([u(cc.Label)],e.prototype,"descLabel",void 0),a([u(cc.Sprite)],e.prototype,"shootCDSprite",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PlayerModel":void 0,"../../Player":"Player"}],GameBlock:[function(t,e,o){"use strict";cc._RF.push(e,"2c63cDrn0JNFaY4BIcLUbvj","GameBlock");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../framework/Script/component/LoaderSprite"),s=t("../../../../Script/base/Utils"),l=t("../../../Script/center/Game"),d=t("../../manage/GameManage"),u=t("../../Player"),p=t("../../public/QuadTree"),h=t("../../test/EditView"),f=t("./CriView"),m=cc._decorator,y=m.ccclass,g=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.type=h.ItemType.BLOCK,e.gird=null,e.HP=30,e.atk=300,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.init=function(){if(d.default.getInstance().gameView&&(this.type==h.ItemType.BLOCK||this.type==h.ItemType.BOX||this.type==h.ItemType.WATER||this.type==h.ItemType.SHADOW||this.type==h.ItemType.MOUNTAIN||this.type==h.ItemType.CN)){var t=new p.QuadTreeNode;t.node=this.node,t.type=this.type,t.rect=this.node.getBoundingBox(),t.gird=this.gird,d.default.getInstance().gameView.quadTree.insert(t)}this.type==h.ItemType.CN&&(this.HP=100)},e.prototype.hurt=function(t){var e=t.player,o=Math.random(),i=Math.floor((1+(o-.5)/10)*t.ATK),n=e.model.isCri(t.CRI),a=e.gameView.getCri().getComponent(f.default);return a&&(a.node.parent=e.gameView.layout,a.node.position=this.node&&this.node.position.add(cc.v3(50*Math.random()-50,20*Math.random()+100,0))||cc.v3(4e3,4e3,0),a.node.scale=0,n?(a.init(2*i,!0),a.node.runAction(cc.sequence(cc.scaleTo(.05,6),cc.scaleTo(.08,2.5),cc.delayTime(.35),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(a.node)})))):(a.init(i),a.node.runAction(cc.sequence(cc.scaleTo(.05,3),cc.scaleTo(.08,2),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){e.gameView.putCri(a.node)}))))),!(n?!this.doHurt(2*i,t):!this.doHurt(i,t))&&(this.doDestroy(t),!0)},e.prototype.doHurt=function(t,e){if(this.HP>t)return this.HP-=t,!1;if(this.HP=0,this.node&&this.isValid){var o=this.node.position,i=this.node.zIndex;return this.type==h.ItemType.BOX?d.default.getInstance().gameView.appendSkeleton(this.node.parent,"attack/game/box/skeleton_ske",function(t){if(t){t.node.scale=1.5,t.node.position=o,t.node.zIndex=i,t.node.active=!0;var e="animation"+s.choice([1,2,3,4]);t.timeScale=.5,t.setAnimation(0,e,!1),t.setCompleteListener(function(){d.default.getInstance().gameView.removeSkeleton(t)})}}):this.boom(i,o,e),!0}},e.prototype.boom=function(t,e,o){var i=new cc.Node,n=i.addComponent(dragonBones.ArmatureDisplay);i.parent=this.node.parent,i.zIndex=t,i.position=e,i.y+=50,i.scale=1.5;var a=this;r.default.addLoaderDragonBones(i).loadArmature("attack/game/CN/\u53d7\u51fb02",function(t){t||a.scheduleOnce(function(){n.armatureName="Armature",n.playAnimation("newAnimation",1),a.boomHurt(o,e),n.once(dragonBones.EventObject.COMPLETE,function(){i.destroy()})})})},e.prototype.boomHurt=function(t,e){var i=this,n=new Map,a=cc.rect(e.x-192,e.y-192,384,384);d.default.getInstance().gameView.quadTree.retrieve(a).forEach(function(t){n.has(t.node.uuid)||t.type!=h.ItemType.BOX&&t.type!=h.ItemType.CN||cc.v2(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/2).sub(e).mag()<192&&n.set(t.node.uuid,t.node)}),Array.from(n.values()).forEach(function(e){if(e){var n=e.getComponent(o);n&&n.hurtByCN(t,i.atk)}}),d.default.getInstance().gameView.targets.forEach(function(o){o&&o.checkTarget(o)&&o.node.getPosition().sub(e).mag()<192&&o.hurtByCN(t,i.atk)}),l.default.gameAudio.playHurtClip(1)},e.prototype.hurtByCN=function(t,e){var o=d.default.getInstance().gameView,i=o.getCri().getComponent(f.default);return i&&(i.node.parent=o.layout,i.node.position=this.node&&this.node.position.add(cc.v3(50*Math.random()-50,20*Math.random()+100,0))||cc.v3(4e3,4e3,0),i.node.scale=0,i.init(e),i.node.runAction(cc.sequence(cc.scaleTo(.05,3),cc.scaleTo(.08,2),cc.delayTime(.2),cc.scaleTo(.1,0),cc.callFunc(function(){o.putCri(i.node)})))),this.doHurt(e,t)&&(this.doDestroy(null),!0)},e.prototype.update=function(){},e.prototype.doDestroy=function(){var t=d.default.getInstance().gameView;t&&(t.quadTree.remove(this.node.uuid)-1==t.astar.gridsList[this.gird.x][this.gird.y].type&&(t.astar.gridsList[this.gird.x][this.gird.y].type=0),t.blocks.splice(t.blocks.indexOf(this),1),this.node.destroy(),t.player.getComponent(u.default).targetBlock=null)},e.prototype.loadRes=function(t){c.default.addLoaderSprite(this.sprite).loadSprite(t,cc.SpriteFrame,function(){})},a([g(cc.Sprite)],e.prototype,"sprite",void 0),a([g({type:cc.Enum(h.ItemType)})],e.prototype,"type",void 0),o=a([y],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../../../Script/base/Utils":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../../Script/center/Game":"Game","../../Player":"Player","../../manage/GameManage":"GameManage","../../public/QuadTree":"QuadTree","../../test/EditView":"EditView","./CriView":"CriView"}],GameIOView:[function(t,e,o){"use strict";cc._RF.push(e,"f64886geMtJJoJXnfitpQ6H","GameIOView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/GameData"),c=t("../../../../../InitScene/Script/data/GunModel"),s=t("../../../../../InitScene/Script/data/MapModel"),l=t("../../../../../InitScene/Script/data/MountModel"),d=t("../../../../../InitScene/Script/data/OtherData"),u=t("../../../../../InitScene/Script/data/PersonModel"),p=t("../../../../../InitScene/Script/data/RankModel"),h=t("../../../../../Script/base/Utils"),f=t("../../../../Script/center/Game"),m=t("../../../BasePlayer"),y=t("../../../manage/GameManage"),g=t("../../../Player"),v=t("../../../public/AStar"),_=t("../../../public/QuadTree"),S=t("../../../test/EditView"),b=t("../Account/AccountLevelNode"),w=t("../AI"),I=t("../AirBoxNode"),M=t("../GameBlock"),k=t("../LoseView"),N=t("./GameView"),T=cc._decorator,O=T.ccclass,C=(T.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=128,e.mapSizeX=3840,e.mapSizeY=3840,e.isFirstKill=!0,e.points=[],e.killEnergy=0,e.timeEnergy=1,e.aiConfig=[],e}return n(e,t),e.prototype.onLoad=function(){this.followCamera=this.followCameraNode.camera,y.default.getInstance().gameView=this},e.prototype.showAcc=function(t){cc.log("player",t);var e=f.default.uiCenter.showUi(this.accountPrefab).getComponent(b.default);e.init(t),e.refresh()},e.prototype.start=function(){f.default.gameAudio.playGameBGMusic(),f.default.event.on(r.GameDataEvent.GAME_ACCOUNT,this.showAcc,this),this.boxShadowNode.active=!1;var t=this.mapPrefab,e=y.default.getInstance().maptype;switch(cc.log("=============\u7ade\u6280\u573a\u7c7b\u578b",e),e){case s.MapState.\u91ce\u5916:t=this.mapPrefab;break;case s.MapState.\u79d1\u6280:t=this.map2Prefab;break;case s.MapState.\u68ee\u6797:t=this.map3Prefab}this.map.getComponent(cc.Sprite).spriteFrame=this.mapSF[e];var o=t.length,i=Math.floor(Math.random()*o),n=cc.instantiate(t[i]);n.parent=this.map,n.zIndex=-1,this.layout=n,this.player.parent=this.layout,this.IOmapData=s.default.getMapIOList(e+"_"+i),this.aiConfig=this.IOmapData.pos,h.randomSort(this.aiConfig),this.init(null)},e.prototype.init=function(){var t=this,e=this;this.quadTree=new _.default(this.map.getBoundingBox()),cc.log("==this.points==",this.points[0]),this.nameList=["box","CN","shi_kuai1","shi_kuai2","shi_kuai3","shi_kuai4","shui_jing","shui_jing2","tree1","tree2","bigtree_left","bigtree_right","house_left","house_right","shui_jing2","car_left","car_right","block1_1","block1_2","block1_3","block1_4","block1_5","block1_6","block2_1","block2_2","block2_3","block2_4","block2_5","block2_6","block3_1","block3_2","block3_3","block3_4","block4_1","block4_2","block4_3","block4_4","block5_1","block5_2","block5_3","block5_4","block6_1","block6_2","block6_3","block7_1","block8_1","block9_1","block10_1","block10_2","block10_3","block10_4","block10_5","block10_6","block11_1","block11_2","block11_3","block11_4","block11_5","block11_6","map_left_down","map_right_down","map_left_up","map_right_up","map_down","map_up","map_left","map_right","map_empty","map"],this.layout.children.forEach(function(o){if(t.nameList.indexOf(o.name)>=0){var i=o.getComponent(M.default),n=o.getPosition().add(cc.v2(t.mapSizeX/2,t.mapSizeY/2)).div(t.size);i.gird=cc.v2(Math.floor(n.x),Math.floor(n.y)),o.setPosition(i.gird.add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.mapSizeX/2,t.mapSizeY/2).add(cc.v2(t.size/2,t.size/2)))),i.type!=S.ItemType.WATER?(o.zIndex=2*-i.gird.y,o.name.indexOf("map")>=0&&(o.zIndex=10*-i.gird.y)):o.zIndex=2*-Math.floor(t.mapSizeY/t.size),e.blocks.push(i),i.init()}else"grass_right"==o.name||"grass_left"==o.name||"guang"==o.name||"grass_1"==o.name||"grass_2"==o.name||"grass_3"==o.name||"xiaoshitou_1"==o.name||"xiaoshitou_2"==o.name?(o.zIndex=50*-Math.floor(t.mapSizeY/t.size)+1,n=o.getPosition().add(cc.v2(t.mapSizeX/2,t.mapSizeY/2)).div(t.size),"grass_right"==o.name&&o.setPosition(cc.v2(Math.floor(n.x),Math.floor(n.y)).add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.mapSizeX/2,t.mapSizeY/2).add(cc.v2(t.size/2,t.size/2))))):"addHpLogo"==o.name?o.zIndex=1:"addHpCircle"==o.name&&(n=o.getPosition().add(cc.v2(t.mapSizeX/2,t.mapSizeY/2)).div(t.size),o.setPosition(cc.v2(Math.floor(n.x),Math.floor(n.y)).add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.mapSizeX/2,t.mapSizeY/2).add(cc.v2(t.size/2,t.size/2)))),o.zIndex=o.zIndex=2*-Math.floor(t.mapSizeY/t.size)-10)}),this.astar||(this.astar=new v.default),this.astar.init(this.size,this.size,Math.floor(this.map.width/this.size)-1,Math.floor(this.map.height/this.size)-1),this.astar.initMap(),this.astar.resetMap(),this.blocks.forEach(function(t){t.type!=S.ItemType.BLOCK&&t.type!=S.ItemType.WATER&&t.type!=S.ItemType.SHADOW&&t.type!=S.ItemType.MOUNTAIN||0!=e.astar.gridsList[t.gird.x][t.gird.y].type||(e.astar.gridsList[t.gird.x][t.gird.y].type=-1)}),this.doStart(),this.schedule(this.airDrop,d.default.airDropTime)},e.prototype.airDrop=function(){var t;Math.floor(2*Math.random()),t=cc.instantiate(this.HPBox);var e=this.boxShadow();this.boxDrop(t,e.pos,e.gird),this.boxShadowNode.active=!0,this.boxShadowNode.opacity=0,this.boxShadowNode.runAction(cc.fadeIn(1))},e.prototype.boxShadow=function(){for(var t=this.curPlayer.node.getPosition(),e=t.add(cc.v2(this.map.width/2,this.map.height/2)).div(this.size),o=cc.v2(Math.floor(e.x),Math.floor(e.y)),i=(this.size,[]),n=Math.max(-o.x,-Math.floor(4));n<5;n++){var a=o.x+n;if(a>this.maxGirdX)break;for(var r=Math.max(-o.y,-Math.floor(8));r<9;r++){var c=o.y+r;if(c>this.maxGirdY)break;var s=cc.v2(a,c);i.push(s)}}var l=[];this.blocks.forEach(function(t){t.gird.x<=o.x+4&&t.gird.x>=o.x-4&&t.gird.y<=o.y+8&&t.gird.y>=o.y-8&&l.push(t.gird)});var d=i.filter(function(t){return!l.some(function(e){return t.equals(e)})}),u=[],p=function(t){var e=d[t].x,o=d[t].y,i=cc.v2(e+1,o);d.some(function(t){return t.equals(i)})&&u.push(d[t])};for(n=0;n<d.length;n++)p(n);0==u.length&&u.push(t);var f=h.choice(u),m=f.mul(this.size).sub(cc.v2(this.map.width/2,this.map.height/2)).add(cc.v2(this.size/2,this.size/2));return this.boxShadowNode.setPosition(m),this.boxShadowNode.parent=this.layout,this.boxShadowNode.zIndex=2*-f.y,cc.log("=====\u5730\u56fe\u6700\u5927\u9650\u5236\uff1agirdthis.maxGirdX,this.maxGirdY====",this.maxGirdX,this.maxGirdY),cc.log("=====\u73a9\u5bb6\u4f4d\u7f6egird\uff1aplayerGird====",o.x,o.y),cc.log("=====\u9634\u5f71\u4f4d\u7f6e\uff1ashadowGide====",f.x,f.y),cc.log("=====\u9634\u5f71\u4f4d\u7f6e\uff1ashadowPos====",m.x,m.y),{pos:m,gird:f}},e.prototype.boxDrop=function(t,e,o){var i=this;t.parent=this.map,t.active=!0,t.opacity=0,t.setPosition(cc.v2(e.x,e.y+13*this.size)),t.runAction(cc.sequence(cc.spawn(cc.fadeIn(2),cc.moveTo(4,e)),cc.callFunc(function(){t.getChildByName("umbrella").runAction(cc.spawn(cc.fadeOut(1),cc.scaleTo(1,2,0),cc.moveBy(1,cc.v2(0,-100)))),t.parent=i.layout,t.zIndex=2*-o.y,t.getComponent(I.default).floor()})))},e.prototype.disappearBoxShadow=function(){var t=this;this.boxShadowNode.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.boxShadowNode.active=!1})))},e.prototype.doStart=function(){this.targets=[],this.enemys=[],this.players=[],console.log("\u731c\u6d4b\uff1adoStart",this.getLevel(),y.default.getInstance().level),this.getLevel(),this.initAI(y.default.getInstance().level),this.targets=this.layout.getComponentsInChildren(m.default),this.players=this.layout.getComponentsInChildren(g.default),this.curPlayer=this.players[0];var t=f.default.uiCenter.showUi("LoseView").getComponent(k.default);t.player=this.curPlayer,f.default.uiCenter.hideUI("LoseView"),f.default.uiCenter.hideBlockInput(),this.loseView=t,y.default.getInstance().model.players=this.players.map(function(t){return t.model}),this.players.forEach(function(t){return t.init()}),console.log("=======\u731c\u6d4b\uff1a\u73a9\u5bb6=======GameManage.getInstance().model.players",y.default.getInstance().model.players),this.tipsView.gameView=this,this.tipsView.node.active=!0,f.default.loading.node.active?f.default.loading.node.once("beginIOGame",this.tipsView.startGame,this.tipsView):this.tipsView.startGame()},e.prototype.doEnd=function(){this.ais.forEach(function(t){return t.isStart=!1})},e.prototype.startGame=function(){var t=this;this.attackView.node.active=!0,this.timeView.node.active=!0,this.timeView.init(120),this.timeView.startTimer(),this.timeView.node.on("finished",function(){t.doEnd(),y.default.getInstance().endGame()},this),this.mapView.node.active=!0,this.mapView.init(Math.max(this.map.width,this.map.height)),this.shadow.active=!1,this.ais.forEach(function(t){return t.pet&&(t.pet.isStart=!0),t.isStart=!0}),this.pet&&(this.pet.isStart=!0)},e.prototype.loseGame=function(){this.loseView.node.active=!0,this.loseView.doStart()},e.prototype.endGame=function(){this.isAccount||(this.isAccount=!0,this.attackView.stopAttack(),this.timeView.pauseTimer(),this.shadow.active=!0,this.tipsView.node.active=!0,this.tipsView.endGame(),this.unschedule(this.airDrop),y.default.getInstance().endGame())},e.prototype.accountGame=function(){this.shadow.active=!1},e.prototype.showKill=function(t,e){this.isFirstKill?f.default.gameAudio.playFirstKillClip():f.default.gameAudio.playKillClip(),this.isFirstKill=!1,this.killView.setData(t.playerItemData,e.playerItemData),this.unschedule(this.hideKill),this.scheduleOnce(this.hideKill,2)},e.prototype.hideKill=function(){this.unschedule(this.hideKill),this.killView.node.active=!1},e.prototype.getEmptyGird=function(){var t=this,e=Math.floor(this.map.width/this.size)-1,o=Math.floor(this.map.height/this.size)-1,i=[],n=this.blocks.map(function(t){return t.gird});n=n.concat(this.players.map(function(e){var o=cc.v2(e.node.x+(t.map.width-this.size)/2,e.node.y+(t.map.height-this.size)/2);return cc.v2(Math.floor(o.x/this.size),Math.floor(o.y/this.size))}));for(var a=[],r=function(t){var e=[],a=n.filter(function(e){return e.x==t});if(a.length>0)for(var r=function(t){a.every(function(e){return e.y!=t})&&e.push(t)},c=0;c<o+1;c++)r(c);else for(var s=0;s<o+1;s++)e.push(s);i.push(e)},c=0;c<e+1;c++)r(c);i.forEach(function(t,e){t.length>0&&a.push(e)});var s=a[Math.floor(Math.random()*a.length)],l=i[s][Math.floor(Math.random()*i[s].length)];return cc.v2(s,l)},e.prototype.getGird=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=cc.v2(0,0);if(y.default.getInstance().gameType==y.GameType.\u7ade\u6280\u573a){var i=this.aiConfig;-1==t&&(t=i.length-1);var n=i[t];o=cc.v2(n.posX,n.posY),cc.log("\u51fa\u751f\u4f4d\u7f6e\u91cd\u5199",n,i,t)}return o},e.prototype.getLevel=function(){y.default.getInstance().level=0,cc.log("GameManage.getInstance().level2",y.default.getInstance().level),console.log("============\u731c\u6d4b\uff1a\u5173\u5361level============\uff1a",0,"RankModel.win",p.default.win)},e.prototype.initAI=function(t){var e,o=c.default.getGunMaxLevel(),i=u.default.useHeroId,n=p.default.level;e=n<2?Math.floor(y.default.getInstance().aicount/2):n<3?Math.floor(2*y.default.getInstance().aicount/3):y.default.getInstance().aicount;var a,r=[],s=null,d=0;switch(console.log("initAI\u2014\u2014\u731c\u6d4b\uff1a\u521d\u59cb\u5316AI",t,y.default.getInstance().aicount),t){case 5:for(var h=Math.max(0,o+2);h<Math.min(o+5,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(Math.max(0,o+2),Math.min(o+5,c.default.getGunTotalNum())));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++){var f=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default);a=this.rand(Math.max(0,2),Math.min(l.MountMaxLevel,4)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),f.initAI(h,.1,f.getPersonIdx(this.rand(i+2,i+5)),f.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(f)}break;case 4:for(h=Math.max(0,o+1);h<Math.min(o+4,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(o+1,o+4));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++){var m=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default);a=this.rand(Math.max(0,2),Math.min(l.MountMaxLevel,3)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),h>1?m.initAI(h,.3,m.getPersonIdx(this.rand(i+1,i+4)),m.getGunIdx(r.shift()),d,a):m.initAI(h,.1,m.getPersonIdx(this.rand(i+1,i+4)),m.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(m)}break;case 3:for(h=Math.max(0,o);h<Math.min(o+3,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(o,o+3));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)m=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,1),Math.min(l.MountMaxLevel,3)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),h>1?m.initAI(h,.7,m.getPersonIdx(this.rand(i,i+3)),m.getGunIdx(r.shift()),d,a):m.initAI(h,.3,m.getPersonIdx(this.rand(i,i+3)),m.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(m);break;case 2:for(h=Math.max(0,o-0);h<Math.min(o+3,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(o-0,o+3));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)m=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,1),Math.min(l.MountMaxLevel,2)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),h>1?m.initAI(h,1.5,m.getPersonIdx(this.rand(i-0,i+3)),m.getGunIdx(r.shift()),d,a):h>0?m.initAI(h,.7,m.getPersonIdx(this.rand(i-0,i+3)),m.getGunIdx(r.shift()),d,a):m.initAI(h,.3,m.getPersonIdx(this.rand(i-0,i+3)),m.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(m);break;case 1:for(h=Math.max(0,o-1);h<Math.min(o+2,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(o-1,o+2));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)m=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,0),Math.min(l.MountMaxLevel,2)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),h>0?m.initAI(h,1.5,m.getPersonIdx(this.rand(i-1,i+2)),m.getGunIdx(r.shift()),d,a):m.initAI(h,.7,m.getPersonIdx(this.rand(i-1,i+2)),m.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(m);break;case-1:for(h=Math.max(0,o-2);h<Math.min(o+1,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(Math.max(0,o-2),Math.min(o+1,c.default.getGunTotalNum())));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)f=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,-1),Math.min(l.MountMaxLevel,1)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),f.initAI(h,.1,f.getPersonIdx(this.rand(Math.max(i-2,0),i+1)),f.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(f);break;case-2:for(h=Math.max(0,o-3);h<Math.min(o+0,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(Math.max(0,o-3),Math.min(o+0,c.default.getGunTotalNum())));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)f=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,-2),Math.min(l.MountMaxLevel,0)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),f.initAI(h,.1,f.getPersonIdx(this.rand(Math.max(i-3,0),i+0)),f.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(f);break;case-3:for(h=Math.max(0,o-4);h<Math.min(o-1,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(Math.max(0,o-4),Math.min(o-1,c.default.getGunTotalNum())));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)f=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,-2),Math.min(l.MountMaxLevel,-1)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),f.initAI(h,.1,f.getPersonIdx(this.rand(Math.max(i-4,0),i-1)),f.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(f);break;case-4:for(h=Math.max(0,o-5);h<Math.min(o-2,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(Math.max(0,o-5),Math.min(o-2,c.default.getGunTotalNum())));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)f=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,-3),Math.min(l.MountMaxLevel,-2)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),f.initAI(h,.1,f.getPersonIdx(this.rand(Math.max(i-5,0),i-2)),f.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(f);break;case-5:for(h=Math.max(0,o-6);h<Math.min(o-3,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(Math.max(0,o-6),Math.min(o-3,c.default.getGunTotalNum())));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)f=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,-4),Math.min(l.MountMaxLevel,-3)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),f.initAI(h,.1,f.getPersonIdx(this.rand(Math.max(i-6,0),i-3)),f.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(f);break;default:for(h=Math.max(0,o-1);h<Math.min(o+2,c.default.getGunTotalNum());h++)r.push(h);for(;r.length<y.default.getInstance().aicount;)r.push(this.rand(Math.min(o-1,0),o+2));for(r.sort(function(){return Math.random()-.5}),h=0;h<y.default.getInstance().aicount;h++)f=(s=cc.instantiate(this.aiPrefab)).getComponent(w.default),a=this.rand(Math.max(0,-1),Math.min(l.MountMaxLevel,1)),d=this.rand(Math.max(l.default.useMountId-3,0),Math.min(l.default.useMountId+3,l.default.getMountMaxId())),h>e&&(a=0,d=-1),f.initAI(h,.1,f.getPersonIdx(this.rand(Math.max(i-1,0),i+2)),f.getGunIdx(r.shift()),d,a),s.parent=this.layout,this.ais.push(f),cc.log("MountModel.useMountId",l.default.useMountId,d,o,a)}},e.prototype.refreshMap=function(){var t=Math.abs((cc.winSize.width-this.map.width*this.map.scale*this.followCamera.zoomRatio)/2),e=Math.abs((cc.winSize.height-this.map.height*this.map.scale*this.followCamera.zoomRatio)/2);this.map.x>t?this.map.x=t:this.map.x<-t&&(this.map.x=-t),this.map.y>e?this.map.y=e:this.map.y<-e&&(this.map.y=-e)},e.prototype.updateRank=function(){},e.prototype.update=function(){var t=this.players.filter(function(t){return t&&t.node.active&&t.model&&!t.model.isDead()});this.updateMap(t)},a([O],e)}(N.default));o.default=C,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MapModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/OtherData":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/RankModel":void 0,"../../../../../Script/base/Utils":void 0,"../../../../Script/center/Game":"Game","../../../BasePlayer":"BasePlayer","../../../Player":"Player","../../../manage/GameManage":"GameManage","../../../public/AStar":"AStar","../../../public/QuadTree":"QuadTree","../../../test/EditView":"EditView","../AI":"AI","../Account/AccountLevelNode":"AccountLevelNode","../AirBoxNode":"AirBoxNode","../GameBlock":"GameBlock","../LoseView":"LoseView","./GameView":"GameView"}],GameItem:[function(t,e,o){"use strict";cc._RF.push(e,"b6147GgRVFFC6HAzNzXTMPe","GameItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=t("../../../../InitScene/Script/data/GunModel"),s=t("../../../../InitScene/Script/data/PlayerData"),l=t("../../manage/GameManage"),d=cc._decorator,u=d.ccclass,p=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeleton=null,e.type=0,e.num=1,e.idx=0,e.root=null,e.isFollow=!1,e.rate=[30,1],e}return n(e,t),e.prototype.onDestory=function(){l.default.getInstance().gameView.removeSkeleton(this.skeleton)},e.prototype.start=function(){},e.prototype.getType=function(){var t=0;this.rate.forEach(function(e){t+=e});var e=Math.random()*t,o=0;return console.log("GameItem",e),this.rate.forEach(function(t,i){e>t?e-=t:o=i}),o},e.prototype.init=function(t,e){var o=this;switch(this.idx=t,this.root=e,this.type=this.getType(),this.type){case 0:l.default.getInstance().gameView.appendSkeleton(this.node,"skeleton/item0/skeleton",function(t){o.skeleton=t,o.skeleton&&(o.skeleton.node.position=cc.Vec2.ZERO,o.skeleton.node.active=!0,o.skeleton.node.scale=.4,o.skeleton.setAnimation(0,"animation",!0))});break;case 1:l.default.getInstance().gameView.appendSkeleton(this.node,"skeleton/item1/skeleton",function(t){o.skeleton=t,o.skeleton&&(o.skeleton.node.position=cc.Vec2.ZERO,o.skeleton.node.active=!0,o.skeleton.node.scale=.4,o.skeleton.setAnimation(0,"animation",!0))})}this.root&&this.node.runAction(cc.sequence(cc.delayTime(.3+.1*this.idx),cc.callFunc(function(){o.node.zIndex+=100,o.isFollow=!0})))},e.prototype.update=function(){if(this.root){var t=this.root.position.sub(this.node.position);if(t.mag()<40)this.type,this.node.stopAllActions(),this.node.destroy();else if(this.isFollow)if(this.node)this.node.position=this.node.position.add(t.normalize().mul(15));else{if(this.root==l.default.getInstance().gameView.curPlayer.node)switch(this.type){case 0:r.default.totalCoinNum+=Math.floor(.01*s.default.getPrice(Math.max(c.default.getGunMaxLevel()-1,0)));break;case 1:r.default.totalDiamondNum+=1}this.node.stopAllActions(),this.node.destroy()}}},a([u],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/PlayerData":void 0,"../../manage/GameManage":"GameManage"}],GameListNode:[function(t,e,o){"use strict";cc._RF.push(e,"8d86e4UCJREn7lvFcUQjTEd","GameListNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../center/Game"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.difficultNode=null,e.difficultToggle=null,e.spacialNode=null,e.spacialToggle=null,e.farmGameNode=null,e.farmGameToggle=null,e}return n(e,t),e.prototype.start=function(){this.difficultNode.on("onClose",this.onClose,this),this.difficultToggle.check(),this.showDifficultNode()},e.prototype.showDifficultNode=function(){this.farmGameNode.active=!1,this.spacialNode.active=!1,this.difficultNode.active=!0},e.prototype.showSpacialNode=function(){this.farmGameNode.active=!1,this.difficultNode.active=!1,this.spacialNode.active=!0},e.prototype.showFarmGameNode=function(){this.difficultNode.active=!1,this.spacialNode.active=!1,this.farmGameNode.active=!0},e.prototype.onClose=function(){r.default.uiCenter.closeUI(this.node)},a([l(cc.Node)],e.prototype,"difficultNode",void 0),a([l(cc.Toggle)],e.prototype,"difficultToggle",void 0),a([l(cc.Node)],e.prototype,"spacialNode",void 0),a([l(cc.Toggle)],e.prototype,"spacialToggle",void 0),a([l(cc.Node)],e.prototype,"farmGameNode",void 0),a([l(cc.Toggle)],e.prototype,"farmGameToggle",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../center/Game":"Game"}],GameManage:[function(t,e,o){"use strict";cc._RF.push(e,"b6cc2N9rERLh6lFWPv5XE+G","GameManage");var i=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GameType=o.GameState=void 0;var n,a,r=t("../../../InitScene/Script/center/GameInit"),c=t("../../../InitScene/Script/data/GameData"),s=t("../../../InitScene/Script/data/GameModel"),l=t("../../../InitScene/Script/data/GuanqiaModel"),d=t("../../../InitScene/Script/data/MapModel"),u=t("../../../InitScene/Script/data/PersonModel"),p=t("../../../InitScene/Script/data/PlayerData"),h=t("../../../InitScene/Script/data/PlayerModel"),f=t("../../../InitScene/Script/data/RankModel"),m=t("../../../InitScene/Script/data/UFOModel"),y=t("../../../MainScene/Script/center/Game"),g=t("../../../Script/base/Utils"),v=t("../view/base/BaseView"),_=cc._decorator,S=_.ccclass,b=(_.property,function(){function t(){this.maptype=d.MapState.\u91ce\u5916,this.maptypes=[d.MapState.\u91ce\u5916,d.MapState.\u79d1\u6280],this.mapSpacialtypes=[d.MapState.\u91ce\u5916,d.MapState.\u68ee\u6797,d.MapState.\u79d1\u6280,d.MapState.\u5730\u72f1],this.state=n.\u5176\u4ed6,this.model=new s.default,this.level=0,this.difficult_level=0,this.json=null,this.gameView=null,this.farmView=null,this.wincount=20,this.aicount=1,this.petcount=1,this.petscale=.5,this.petlevel=[],this.nums=[5,4],this.restartcount=0,this.isGide=!1,this.playerList=[],this.aiList=[],this.player=null,this.gameType=a.\u666e\u901a\u5173\u5361,this.challenge_mountID=0,this.mapIndex=0,this.mapMax=0,this.enemy_num=0,this.getCoin=0,this.getDiamond=0,this.getDNA=0,this.isCanGoToNext=!1,this.isSave=!1,this.mapDataArr=[],this.isWin=!1,this.mapUFODataArr=[],this.guanqia=null}var e;return e=t,t.getInstance=function(){return this._manager||(this._manager=new e,r.default.GameManage=this._manager),this._manager},t.prototype.matchGame=function(){if(this.state==n.\u5176\u4ed6){this.state=n.\u5339\u914d,this.aicount=0,this.playerList=[];var t=new h.PlayerItemData;this.playerList.push(t),this.player=t,t.name="\u6211",cc.log("\u5339\u914d\u4fe1\u606f",this.playerList)}if(this.restartcount=0,this.guanqia=l.default.getNowGuanqia(),this.guanqia.id>=l.default.normalCount)this.mapDataArr=d.default.getRandomArrByType(this.guanqia.mapType);else{var e=this.guanqia.mapIDArr;this.mapDataArr=d.default.getArrByIDs(e)}cc.log("guanqia",this.guanqia,this.mapDataArr),this.mapMax=this.guanqia.map.length-1,this.maptype=this.guanqia.mapType,this.gameType=a.\u666e\u901a\u5173\u5361,this.getCoin=0,this.getDiamond=0,this.getDNA=0,this.mapIndex=0,this.isCanGoToNext=!1},t.prototype.getNowEnemy=function(){return this.guanqia.map[this.mapIndex]},t.prototype.matchGameIO=function(){if(this.state==n.\u5176\u4ed6){this.state=n.\u5339\u914d,this.aicount=f.default.getMatchAiNum(),this.playerList=[],this.aiList=[];var t=r.default.gameConfig.aiConfig.concat(),e=new h.PlayerItemData;u.default.getHeroTotalNum(),e.id=this.playerList.length+1,e.name=y.default.userInfo&&y.default.userInfo.nickName||"\u6211",e.avatarUrl="",this.playerList.push(e),this.player=e,e.name="\u6211";for(var o=0;o<this.aicount;o++){var i=new h.PlayerItemData;i.isAuthorize=g.random(0,100)>25,i.id=this.playerList.length+1;var c=g.random(0,t.length),s=t[c];t.splice(c,1),i.name=s.nickName,i.avatarUrl="avatar/"+s.avatarUrl,this.playerList.push(i),this.aiList.push(i)}cc.log("\u5339\u914d\u4fe1\u606f",this.playerList,this.aicount)}this.choiceMap(),this.gameType=a.\u7ade\u6280\u573a},t.prototype.matchGameUFO=function(){if(this.state==n.\u5176\u4ed6){this.state=n.\u5339\u914d,this.aicount=0,this.playerList=[];var t=new h.PlayerItemData;this.playerList.push(t),this.player=t,t.name="\u6211",cc.log("\u5339\u914d\u4fe1\u606f",this.playerList)}this.restartcount=0,this.guanqia=l.default.getNowGuanqia(),this.mapUFODataArr=m.default.getRandomArrByType(),cc.log("mapUFODataArr",this.guanqia,this.mapUFODataArr),this.mapMax=2,this.maptype=d.MapState.\u79d1\u6280,this.gameType=a.\u5e7d\u6d6e\u7ed1\u67b6,this.getCoin=0,this.getDiamond=0,this.getDNA=0,this.mapIndex=0,this.isCanGoToNext=!1},t.prototype.matchDifficultGame=function(){if(this.state==n.\u5176\u4ed6){this.state=n.\u5339\u914d,this.aicount=1,this.playerList=[],this.aiList=[];var t=r.default.gameConfig.aiConfig.concat(),e=new h.PlayerItemData,o=u.default.getHeroTotalNum()-1;e.id=this.playerList.length+1,e.name=y.default.userInfo&&y.default.userInfo.nickName||"\u6211",e.avatarUrl="hero/avatar/"+u.default.useAvatarId,this.playerList.push(e),this.player=e,e.name="\u6211";for(var i=0;i<this.aicount;i++){var c=new h.PlayerItemData;if(c.isAuthorize=g.random(0,100)>25,c.id=this.playerList.length+1,c.isAuthorize){var s=g.random(0,t.length),l=t[s];t.splice(s,1),c.name=l.nickName,c.avatarUrl="avatar/"+l.avatarUrl}else c.name="\u672a\u6388\u6743\u73a9\u5bb6",c.avatarUrl="hero/avatar/"+g.random(0,o);this.playerList.push(c),this.aiList.push(c)}cc.log("\u5339\u914d\u4fe1\u606f",this.playerList)}this.choiceDifficultMap(),this.gameType=a.\u56f0\u96be\u6a21\u5f0f},t.prototype.matchGameFarm=function(t){if(this.state==n.\u5176\u4ed6){this.state=n.\u5339\u914d,this.aicount=5,this.playerList=[],this.aiList=[];var e=r.default.gameConfig.aiConfig.concat(),o=u.default.getHeroTotalNum()-1,i=new h.PlayerItemData;i.id=this.playerList.length+1,i.name=y.default.userInfo&&y.default.userInfo.nickName||"\u6211",i.avatarUrl="hero/avatar/"+u.default.useAvatarId,this.playerList.push(i),this.player=i,i.name="\u6211";for(var c=0;c<this.aicount;c++){var s=new h.PlayerItemData;if(s.isAuthorize=g.random(0,100)>25,s.id=this.playerList.length+1,s.isAuthorize){var l=g.random(0,e.length),d=e[l];e.splice(l,1),s.name=d.nickName,s.avatarUrl="avatar/"+d.avatarUrl}else s.name="\u672a\u6388\u6743\u73a9\u5bb6",s.avatarUrl="hero/avatar/"+g.random(0,o);this.playerList.push(s),this.aiList.push(s)}cc.log("\u4e30\u9976\u4e4b\u5730\u5730\u56fe\u5339\u914d\u4fe1\u606f",this.playerList)}this.gameType=a.\u4e30\u9976\u4e4b\u5730,this.maptype=t.map_type},t.prototype.matchMountGame=function(){if(this.state==n.\u5176\u4ed6){this.state=n.\u5339\u914d,this.aicount=0,this.playerList=[],this.aiList=[];var t=r.default.gameConfig.aiConfig.concat(),e=u.default.getHeroTotalNum()-1,o=new h.PlayerItemData;o.id=this.playerList.length+1,o.name=y.default.userInfo&&y.default.userInfo.nickName||"\u6211",o.avatarUrl="hero/avatar/"+u.default.useAvatarId,this.playerList.push(o),this.player=o,o.name="\u6211";for(var i=0;i<this.aicount;i++){var c=new h.PlayerItemData;if(c.isAuthorize=g.random(0,100)>25,c.id=this.playerList.length+1,c.isAuthorize){var s=g.random(0,t.length),l=t[s];t.splice(s,1),c.name=l.nickName,c.avatarUrl="avatar/"+l.avatarUrl}else c.name="\u672a\u6388\u6743\u73a9\u5bb6",c.avatarUrl="hero/avatar/"+g.random(0,e);this.playerList.push(c),this.aiList.push(c)}cc.log("\u5339\u914d\u4fe1\u606f",this.playerList)}this.choiceMap(),this.gameType=a.\u5e7d\u6d6e\u7ed1\u67b6},t.prototype.choiceMap=function(){var t=g.choice(this.maptypes);cc.log("map",t),t!==this.maptype?this.maptype=t:this.choiceMap()},t.prototype.choiceDifficultMap=function(){var t=g.choice(this.mapSpacialtypes);t!==this.maptype?this.maptype=t:this.choiceDifficultMap(),cc.log("\u56f0\u96be\u6a21\u5f0f\u5339\u914d\u5730\u56fe",this.maptype)},t.prototype.doStart=function(){var t=this;this.state==n.\u5339\u914d&&(this.state=n.\u6218\u6597\u5f00\u59cb,e.getInstance().restartcount=0,p.default.UIManager.loadPnl("game",null,function(){p.default.UIManager.hideAllPnl()}).then(function(e){e instanceof v.default&&(t.gameView=e,p.default.isFrist&&(p.default.isFrist=!1))}))},t.prototype.startGame=function(){(this.state=n.\u6218\u6597\u5f00\u59cb)&&(this.state=n.\u6218\u6597\u4e2d,this.gameView&&this.gameView.startGame())},t.prototype.loseGame=function(){this.gameView&&this.gameView.loseGame()},t.prototype.endGame=function(){console.log("GameManager endGame..."+this.state),this.state==n.\u6218\u6597\u4e2d&&(this.state=n.\u6218\u6597\u7ed3\u675f,this.gameView&&this.gameView.endGame(),this.pause(),e.getInstance().restartcount=0)},t.prototype.checkGame=function(){if(this.gameView){if(cc.log("checkGame\uff1a",this.gameType),this.gameType==a.\u666e\u901a\u5173\u5361||this.gameType==a.\u5e7d\u6d6e\u7ed1\u67b6){if(this.model.players.filter(function(t){return 0==t.group})[0].isDead())return console.log("=====\u4e3b\u89d2\u6b7b\u4ea1========",this.restartcount),void(this.restartcount<1?(console.log("=====\u4e3b\u89d2\u6b7b\u4ea1========\u8fdb\u5165\u590d\u6d3b"),this.loseGame()):(console.log("=====\u4e3b\u89d2\u6b7b\u4ea1========\u8fdb\u5165\u7ed3\u7b97"),this.isWin=!1,this.gameView.doEnd(),this.endGame()));var t=this.model.enemys.filter(function(t){return t&&!t.isDead()});return cc.log("\u5269\u4f59\u654c\u4eba\u6570\uff1a",t.length,"\u573a\u4e0a\u751f\u6210\u654c\u4eba\u6570\uff1a",this.model.enemys.length,"\u654c\u4eba\u603b\u6570\uff1a",this.enemy_num,"this.isCanGoToNext",this.isCanGoToNext),this.gameView.updateEnemyCount((this.enemy_num-t.length)/this.enemy_num),void(0==t.length&&this.enemy_num==this.model.enemys.length&&(cc.log("\u602a\u517d\u5168\u706d \u8fdb\u5165\u4e0b\u4e00\u5173\u6216\u7ed3\u7b97",this.mapIndex,this.mapMax),this.mapIndex==this.mapMax?(this.gameView.doEnd(),this.isWin=!0,this.isCanGoToNext=!0,this.gameType==a.\u5e7d\u6d6e\u7ed1\u67b6?this.isSave&&this.endGame():this.gameType==a.\u666e\u901a\u5173\u5361&&this.endGame()):(this.mapIndex++,this.isCanGoToNext=!0)))}if(this.gameType==a.\u7ade\u6280\u573a){var e=this.model.players.filter(function(t){return!t.isDead()});cc.log("this.model.players",this.model.players),1==e.length&&(e[0].rank=0,this.gameView.doEnd(),this.endGame())}}},t.prototype.accountGame=function(){if(this.state==n.\u6218\u6597\u7ed3\u675f){this.state=n.\u7ed3\u7b97,this.gameView&&this.gameView.accountGame();var t=this.model.players.filter(function(t){return 0==t.group})[0];this.gameType==a.\u7ade\u6280\u573a&&(t.isDead()?t.rank=this.model.players.filter(function(t){return!t.isDead()}).length:t.rank=0,cc.log("====2",t.rank),this.gameView.doEnd(),this.endGame()),y.default.event.emit(c.GameDataEvent.GAME_ACCOUNT,t)}},t.prototype.quitGame=function(){this.state==n.\u7ed3\u7b97&&(this.state=n.\u5176\u4ed6)},t.prototype.pause=function(){this.gameView&&(this.gameView.loseView.isPause=!0,this.gameView.enemys.forEach(function(t){return t.isStart=!1}))},t.prototype.resume=function(){this.gameView&&(this.gameView.loseView.isPause=!1,this.gameView.enemys.forEach(function(t){return t.isStart=!0}))},t.prototype.gideGame=function(){this.state==n.\u5176\u4ed6&&(this.state=n.\u5339\u914d,this.aicount=3,this.isGide=!0)},e=i([S],t)}());o.default=b,function(t){t[t["\u5339\u914d"]=0]="\u5339\u914d",t[t["\u6218\u6597\u5f00\u59cb"]=1]="\u6218\u6597\u5f00\u59cb",t[t["\u6218\u6597\u4e2d"]=2]="\u6218\u6597\u4e2d",t[t["\u6218\u6597\u7ed3\u675f"]=3]="\u6218\u6597\u7ed3\u675f",t[t["\u7ed3\u7b97"]=4]="\u7ed3\u7b97",t[t["\u5176\u4ed6"]=5]="\u5176\u4ed6"}(n=o.GameState||(o.GameState={})),function(t){t[t["\u666e\u901a\u5173\u5361"]=0]="\u666e\u901a\u5173\u5361",t[t["\u7ade\u6280\u573a"]=1]="\u7ade\u6280\u573a",t[t["\u81ea\u521b\u5730\u56fe"]=2]="\u81ea\u521b\u5730\u56fe",t[t["\u5e7d\u6d6e\u7ed1\u67b6"]=3]="\u5e7d\u6d6e\u7ed1\u67b6",t[t["\u56f0\u96be\u6a21\u5f0f"]=4]="\u56f0\u96be\u6a21\u5f0f",t[t["\u4e30\u9976\u4e4b\u5730"]=5]="\u4e30\u9976\u4e4b\u5730"}(a=o.GameType||(o.GameType={})),cc._RF.pop()},{"../../../InitScene/Script/center/GameInit":void 0,"../../../InitScene/Script/data/GameData":void 0,"../../../InitScene/Script/data/GameModel":void 0,"../../../InitScene/Script/data/GuanqiaModel":void 0,"../../../InitScene/Script/data/MapModel":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../InitScene/Script/data/PlayerData":void 0,"../../../InitScene/Script/data/PlayerModel":void 0,"../../../InitScene/Script/data/RankModel":void 0,"../../../InitScene/Script/data/UFOModel":void 0,"../../../MainScene/Script/center/Game":"Game","../../../Script/base/Utils":void 0,"../view/base/BaseView":"BaseView"}],GameMap:[function(t,e,o){"use strict";cc._RF.push(e,"be7caN15ENNLoxzO85drxdD","GameMap");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../manage/GameManage"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.self=null,e.other=null,e.door=null,e.others=[],e.otherPool=new cc.NodePool,e.scale=5/64,e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t){this.scale=200/t,this.otherPool.put(this.other)},e.prototype.initDoor=function(t){t?this.door.setPosition(t.position.mul(this.scale)):this.door.active=!1},e.prototype.refresh=function(t){var e=this;this.others.forEach(function(t){return e.otherPool.put(t)}),this.others=[],t.forEach(function(t){if(0==t.model.group)e.refreshNode(e.self,t);else if(t.model.group>=1e4){var o=e.getOther();o.active=!0,o.parent=e.node,e.refreshNode(o,t),e.others.push(o)}}),r.default.getInstance().isCanGoToNext?this.door.getComponent(cc.Animation).play():(this.door.getComponent(cc.Animation).stop(),this.door.scale=1)},e.prototype.refreshNode=function(t,e){t.position=e.node.position.mul(this.scale);var o=e.getDir();t.angle=-(90+cc.misc.radiansToDegrees(Math.atan2(o.x,o.y)))},e.prototype.getOther=function(){return this.otherPool.size()>0?this.otherPool.get():cc.instantiate(this.other)},a([l(cc.Node)],e.prototype,"self",void 0),a([l(cc.Node)],e.prototype,"other",void 0),a([l(cc.Node)],e.prototype,"door",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../manage/GameManage":"GameManage"}],GameRankItem:[function(t,e,o){"use strict";cc._RF.push(e,"4feccbd+s5NNoHCQ15mZATe","GameRankItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.headView=null,e.sprite=null,e.rankLabel=null,e.player=null,e}return n(e,t),e.prototype.start=function(){},a([s(cc.Label)],e.prototype,"label",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],GameRank:[function(t,e,o){"use strict";cc._RF.push(e,"e5c6ekVE81EF4ZsNYnEKey9","GameRank");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./GameRankItem"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imageList=[],e.bg=null,e.layout=null,e.item=null,e.pet=null,e.items=[],e}return n(e,t),e.prototype.init=function(t){var e=this;console.log("rank init"),this.items=[],this.items.push(this.item),t.forEach(function(t,o){if(o>0){var i=cc.instantiate(e.item.node),n=i.getComponent(r.default);i.parent=e.layout,e.items.push(n)}}),this.bg.setContentSize(260,39*t.length+25),this.pet.node.y=35-this.bg.height,this.item.rankLabel.node.color=cc.Color.ORANGE,this.item.headView.label.node.color=cc.Color.ORANGE,this.items.forEach(function(t,e){t.rankLabel.node.active=!0,t.rankLabel.string=(e+1).toString()})},e.prototype.showRestart=function(){},e.prototype.refresh=function(t,e){var o=this;this.items.forEach(function(i){if(i.player==t)switch(e){case 0:i.showSprite(o.imageList[0]);break;case 1:o.showRestart(t),i.showSprite(o.imageList[1],2)}})},a([l([cc.SpriteFrame])],e.prototype,"imageList",void 0),a([l(cc.Node)],e.prototype,"bg",void 0),a([l(cc.Node)],e.prototype,"layout",void 0),a([l(r.default)],e.prototype,"item",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./GameRankItem":"GameRankItem"}],GameUFOView:[function(t,e,o){"use strict";cc._RF.push(e,"4b2a2xPXBtGNaSAe0k5HTXw","GameUFOView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/EnemyModel"),c=t("../../../../../InitScene/Script/data/GameData"),s=t("../../../../../InitScene/Script/data/MapModel"),l=t("../../../../../InitScene/Script/data/PersonModel"),d=t("../../../../../InitScene/Script/data/UFOModel"),u=t("../../../../Script/center/Game"),p=t("../../../manage/GameManage"),h=t("../../../Player"),f=t("../Enemy/EnemyNode"),m=t("../ETNode/ETNode"),y=t("../LoseView"),g=t("./GameView"),v=cc._decorator,_=v.ccclass,S=v.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ETNode=null,e.timeEnergy=2,e.mapUFOData=null,e}return n(e,t),e.prototype.movePlayer=function(t){this.lastLayout&&this.lastLayout.destroy(),this.lastLayout=this.layout,this.lastLayout.active=!1,this.layout=t,this.player.parent=this.layout,this.ETNode.node.parent=this.layout,this.curPlayer.setPos(),this.pet&&(this.pet.node.parent=this.layout,this.pet.node.setPosition(this.player.getPosition())),this.followCameraNode.isAuto=!0,this.init(null),this.progressLabel.string="\u7b2c"+(this.mapIndex+1)+"/"+(p.default.getInstance().mapMax+1)+"\u6ce2",cc.log("\u79fb\u52a8\u73a9\u5bb6")},e.prototype.loadNextMap=function(){this.ctrlNode.stopCtrl(),this.followCameraNode.isAuto=!1,this.mapIndex++,this.mapUFOData=p.default.getInstance().mapUFODataArr[this.mapIndex],cc.log("\u52a0\u8f7d\u4e0b\u4e00\u5173\u5730\u56fe",this.mapUFOData,this.mapIndex);var t=this.mapPrefab,e=p.default.getInstance().maptype;switch(cc.log("\u666e\u901a\u5173\u5361\u5730\u56fe\u7c7b\u578b=======",e),e){case s.MapState.\u91ce\u5916:t=this.mapPrefab;break;case s.MapState.\u79d1\u6280:t=this.map2Prefab;break;case s.MapState.\u68ee\u6797:t=this.map3Prefab}var o=d.default.getMapByID(this.mapUFOData.id).index,i=cc.instantiate(t[o]);return console.log("\u7b2c\u51e0\u5e45\u5730\u56fe",o),i.parent=this.map,i.setPosition(cc.v2(0,this.mapIndex*this.mapSizeY-this.map.height/2+this.mapSizeY/2)),i.zIndex=-1,i},e.prototype.start=function(){this.ETNode.node.active=!1,this.bossHpView.node.active=!1,u.default.gameAudio.playGameBGMusic(),u.default.event.on(c.GameDataEvent.GAME_ACCOUNT,this.showAcc,this),this.boxShadowNode.active=!1,cc.log("=====MapItemInfo======",this.mapUFOData),this.loadMap(),this.progressLabel.string="\u7b2c"+(this.mapIndex+1)+"/"+(p.default.getInstance().mapMax+1)+"\u6ce2"},e.prototype.loadMap=function(){this.mapUFOData=p.default.getInstance().mapUFODataArr[this.mapIndex];var t=this.mapPrefab,e=this.mapUFOData.map_type;switch(cc.log("\u666e\u901a\u5173\u5361\u5730\u56fe\u7c7b\u578b=======",e,this.mapUFOData),e){case s.MapState.\u91ce\u5916:t=this.mapPrefab;break;case s.MapState.\u79d1\u6280:t=this.map2Prefab;break;case s.MapState.\u68ee\u6797:t=this.map3Prefab}this.map.getComponent(cc.Sprite).spriteFrame=this.mapSF[e];var o=d.default.getMapByID(this.mapUFOData.id).index,i=cc.instantiate(t[o]);console.log("\u7b2c\u51e0\u5e45\u5730\u56fe",o),i.parent=this.map,i.setPosition(cc.v2(0,this.mapIndex*this.mapSizeY-this.map.height/2+this.mapSizeY/2)),i.zIndex=-1,this.layout=i,this.player.parent=this.layout;var n="hero/dragon/"+l.default.getHeroDataById(this.mapUFOData.ET[0].heroID).skeUrl;this.ETNode.init(n),this.ETNode.node.parent=this.layout,this.init(null),this.doStart()},e.prototype.doStart=function(){u.default.event.emit(c.GameDataEvent.RESUME_CUT_COMBINE_TIME),this.targets=[],this.enemys=[],this.players=[],this.getLevel(),this.curPlayer=this.player.getComponent(h.default),this.targets.push(this.curPlayer),this.players.push(this.curPlayer),p.default.getInstance().model.players=this.players.map(function(t){return t.model}),this.curPlayer.init();var t=u.default.uiCenter.showUi("LoseView").getComponent(y.default);if(t.player=this.curPlayer,u.default.uiCenter.hideUI("LoseView"),u.default.uiCenter.hideBlockInput(),this.loseView=t,console.log("=======\u731c\u6d4b\uff1a\u73a9\u5bb6=======GameManage.getInstance().model.players",p.default.getInstance().model.players),this.tipsView.gameView=this,this.tipsView.node.active=!0,0==this.mapIndex)this.tipsView.startGame();else{if(this.mapIndex==p.default.getInstance().mapMax){this.ETNode.node.active=!0;var e=cc.v2(this.mapUFOData.ET[0].posX,this.mapUFOData.ET[0].posY);return this.ETNode.setPos(e),this.ETNode.playAni("\u6346\u7ed1"),this.ETNode.say("\u8c01\u6765\u6551\u6551\u6211\uff01"),this.initEnemy(),void this.tipsView.bossWarn(function(){this.enemys.forEach(function(t){t.isStart=!0}),this.ctrlNode.resumeCtrl()}.bind(this))}this.initEnemy()}this.isMoveNext=!1},e.prototype.initEnemy=function(){var t=this.mapUFOData.enemyList;cc.log("enemyConfig",t);var e=t.length,o=null,i=0,n=!1,a=p.default.getInstance(),c=this.mapIndex==p.default.getInstance().mapMax,s=0;if(c){var l=this.mapUFOData.bossList[0].enemy_type;i=r.default.getEnemyIDByType(l,a.guanqia.enemyLevel);var d=(o=cc.instantiate(this.enemyPrefab)).getComponent(f.default);d.initEnemy(0,.1,i,n,c,0),d.hpView=this.bossHpView,o.parent=this.layout,d.init(),this.enemys.push(d),a.model.enemys=this.enemys.map(function(t){return t.model}),this.bossNameLabel.string=r.default.getEnemyDataByID(i).name,d.hpView.node.active=!0,a.enemy_num=1,this.enemyCountNode.node.active=!1}else{for(var u=0;u<e;u++){var h=t[u];n=h.isAttack,l=h.enemy_type;var m=h.enemy_num;0!=m&&(i=r.default.getEnemyIDByType(l,a.guanqia.enemyLevel),this.creatEnemy(u,i,n,c,h.brath_times,m),s+=m)}a.enemy_num=s,this.updateEnemyCount(0),this.enemyCountNode.countMax=s}cc.log("\u672c\u6ce2\u602a\u517d\u603b\u6570",a.enemy_num)},e.prototype.creatEnemy=function(t,e,o,i,n,a){var r=this,c=0;this.schedule(function(){var n=cc.instantiate(r.enemyPrefab),a=n.getComponent(f.default);a.initEnemy(t,.1*Math.random()+.05,e,o,i,c),n.parent=r.layout,a.init(),r.enemys.push(a),p.default.getInstance().model.enemys=r.enemys.map(function(t){return t.model}),(p.default.getInstance().state=p.GameState.\u6218\u6597\u4e2d)&&(a.isStart=!0),c++},n,a-1,0)},e.prototype.loseGame=function(){this.loseView.node.active=!0,this.loseView.doStart()},e.prototype.endGame=function(){this.isAccount||(this.isAccount=!0,this.attackView.stopAttack(),this.shadow.active=!0,this.tipsView.node.active=!0,this.tipsView.endGame())},e.prototype.getGird=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=cc.v2(0,0);if(p.default.getInstance().gameType==p.GameType.\u5e7d\u6d6e\u7ed1\u67b6){if(e){var i=this.mapUFOData.bossList[0];return cc.v2(i.posX,i.posY)}t>=0?(i=this.mapUFOData.enemyList[t],o=cc.v2(i.posX,i.posY)):o=cc.v2(this.mapUFOData.posX,this.mapUFOData.posY)}return o},e.prototype.initET=function(){},a([S(m.default)],e.prototype,"ETNode",void 0),a([_],e)}(g.default);o.default=b,cc._RF.pop()},{"../../../../../InitScene/Script/data/EnemyModel":void 0,"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/MapModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/UFOModel":void 0,"../../../../Script/center/Game":"Game","../../../Player":"Player","../../../manage/GameManage":"GameManage","../ETNode/ETNode":"ETNode","../Enemy/EnemyNode":"EnemyNode","../LoseView":"LoseView","./GameView":"GameView"}],GameView:[function(t,e,o){"use strict";cc._RF.push(e,"d0a78mOHExKcLtzU+wYlYuz","GameView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../../framework/Script/component/LoaderSprite"),s=t("../../../../../framework/Script/sdk/statistics"),l=t("../../../../../InitScene/Script/data/CombineHeroModel"),d=t("../../../../../InitScene/Script/data/EnemyModel"),u=t("../../../../../InitScene/Script/data/GameData"),p=t("../../../../../InitScene/Script/data/GuanqiaModel"),h=t("../../../../../InitScene/Script/data/GuideModel"),f=t("../../../../../InitScene/Script/data/MapModel"),m=t("../../../../../InitScene/Script/data/MountModel"),y=t("../../../../../Script/base/Utils"),g=t("../../../../Script/center/Game"),v=t("../../../FollowCamare"),_=t("../../../joystick/CtrlManage"),S=t("../../../manage/GameManage"),b=t("../../../Player"),w=t("../../../public/AStar"),I=t("../../../public/QuadTree"),M=t("../../../test/EditView"),k=t("../Account/AccountAwardNode"),N=t("../AirBoxNode"),T=t("../AirSkillView"),O=t("../CardNode/CardBuffNode"),C=t("../combine/CombineNode"),P=t("../Enemy/EnemyNode"),A=t("../GameAttack"),D=t("../GameBlock"),L=t("../GameMap"),G=t("../HpView"),x=t("../KillView"),R=t("../LoseView"),B=t("../Pet/PetNode"),E=t("../TimeView"),V=t("../TipsView"),j=t("../UI/EnemyCountView"),F=cc._decorator,U=F.ccclass,H=F.property,z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.size=128,e.mapSizeX=2304,e.mapSizeY=3200,e.map=null,e.mapSF=[],e.layout=null,e.shadow=null,e.arm=null,e.skill=null,e.enemySkill=null,e.fire=null,e.cri=null,e.addHp=null,e.skeleton=null,e.sprite=null,e.ani=null,e.mapPrefab=[],e.map2Prefab=[],e.map3Prefab=[],e.map4Prefab=[],e.aiPrefab=null,e.enemyPrefab=null,e.petPrefab=null,e.player=null,e.followCameraNode=null,e.followCamera=null,e.tipsView=null,e.killView=null,e.mapView=null,e.json=null,e.json_new5=null,e.i=0,e.loseView=null,e.accountPrefab=null,e.attackView=null,e.timeView=null,e.airSkill=null,e.airBox=null,e.HPBox=null,e.boxShadowNode=null,e.coinNode=null,e.diamondNode=null,e.DNANode=null,e.progressLabel=null,e.bossHpView=null,e.bossNameLabel=null,e.ctrlNode=null,e.cardBuffNode=null,e.enemyCountNode=null,e.combineGuide=null,e.isFirstKill=!0,e.blocks=[],e.armPool=new cc.NodePool,e.skillPool=new cc.NodePool,e.enemySkillPool=new cc.NodePool,e.firePool=new cc.NodePool,e.criPool=new cc.NodePool,e.addHpPool=new cc.NodePool,e.skeletonPool=new cc.NodePool,e.spritePool=new cc.NodePool,e.aniPool=new cc.NodePool,e.quadTree=null,e.astar=null,e.curPlayer=null,e.players=[],e.targets=[],e.enemys=[],e.ais=[],e.isAccount=!1,e.nameList=[],e.pet=null,e.isCombineing=!1,e.isMoveNext=!1,e.mapData=null,e.IOmapData=null,e.lastLayout=null,e.mapIndex=0,e.killEnergy=0,e.timeEnergy=1,e}return n(e,t),Object.defineProperty(e.prototype,"maxGirdX",{get:function(){return Math.floor(this.mapSizeX/this.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxGirdY",{get:function(){return Math.floor(this.mapSizeY/this.size)},enumerable:!1,configurable:!0}),e.prototype.rand=function(t,e){var o=Math.floor(t+Math.random()*(e-t+1));return o=Math.min(o,e),Math.max(o,t)},e.prototype.onLoad=function(){this.followCamera=this.followCameraNode.camera,S.default.getInstance().gameView=this},e.prototype.showCard=function(){this.cardBuffNode.callback=this.curPlayer.getNextLevel.bind(this.curPlayer,this.doStart.bind(this,null)),this.cardBuffNode.openCard(),this.ctrlNode.resumeCtrl()},e.prototype.nextLevel=function(){this.isMoveNext=!0,cc.log("\u8fdb\u5165\u4e0b\u4e00\u5173\u5730\u56fe");var t=this.loadNextMap();this.curPlayer.toNextLevel(this.movePlayer.bind(this,t)),this.changeAni()},e.prototype.loadNextMap=function(){this.ctrlNode.stopCtrl(),this.followCameraNode.isAuto=!1,this.mapIndex++,this.mapData=S.default.getInstance().mapDataArr[this.mapIndex],cc.log("\u52a0\u8f7d\u4e0b\u4e00\u5173\u5730\u56fe",this.mapData,this.mapIndex);var t=this.mapPrefab,e=this.mapData.map_type;switch(cc.log("\u666e\u901a\u5173\u5361\u5730\u56fe\u7c7b\u578b=======",e),e){case f.MapState.\u91ce\u5916:t=this.mapPrefab;break;case f.MapState.\u79d1\u6280:t=this.map2Prefab;break;case f.MapState.\u68ee\u6797:t=this.map3Prefab}var o=f.default.getMapByID(this.mapData.id).index,i=cc.instantiate(t[o]);return console.log("\u7b2c\u51e0\u5e45\u5730\u56fe",o),i.parent=this.map,i.setPosition(cc.v2(0,this.mapIndex*this.mapSizeY-this.map.height/2+this.mapSizeY/2)),i.zIndex=-1,i},e.prototype.changeAni=function(){this.tipsView.nextLevel(this.showCard.bind(this))},e.prototype.movePlayer=function(t){this.lastLayout&&this.lastLayout.destroy(),this.lastLayout=this.layout,this.lastLayout.active=!1,this.layout=t,this.player.parent=this.layout,this.curPlayer.setPos(),this.pet&&(this.pet.node.parent=this.layout,this.pet.node.setPosition(this.player.getPosition()),this.player.getComponent(b.default).pet=this.pet),this.followCameraNode.isAuto=!0,this.init(null),this.progressLabel.string="\u7b2c"+(this.mapIndex+1)+"/"+(S.default.getInstance().mapMax+1)+"\u6ce2",cc.log("\u79fb\u52a8\u73a9\u5bb6")},e.prototype.initAward=function(t,e){var o;"coin"==e?o=cc.instantiate(this.coinNode):"diamond"==e?o=cc.instantiate(this.diamondNode):"DNA"==e&&(o=cc.instantiate(this.DNANode)),o.parent=this.layout,o.setPosition(t),this.curPlayer.getAward(o)},e.prototype.showAcc=function(){g.default.uiCenter.showUi(this.accountPrefab).getComponent(k.default).init()},e.prototype.start=function(){h.default.isNewbie.isNewbie&&h.default.nowStepName==h.NEWBIE_EVENT.BEGIN_GAME_SUCCESS&&h.default.completeStep(),this.bossHpView.node.active=!1,!y.isDateUpdata(u.default.firstTime)&&p.default.guanqiaData.id<5&&s.default.setSceneEvent("EnterGame_"+p.default.guanqiaData.id,"\u8fdb\u5165\u6e38\u620f","EnterGame_"+p.default.guanqiaData.id),g.default.gameAudio.playGameBGMusic(),g.default.event.on(u.GameDataEvent.GAME_ACCOUNT,this.showAcc,this),this.boxShadowNode.active=!1,cc.log("=====MapItemInfo======",this.mapData),this.loadMap(),this.progressLabel.string="\u7b2c"+(this.mapIndex+1)+"/"+(S.default.getInstance().mapMax+1)+"\u6ce2"},e.prototype.loadMap=function(){this.mapData=S.default.getInstance().mapDataArr[this.mapIndex];var t=this.mapPrefab,e=this.mapData.map_type;switch(cc.log("\u666e\u901a\u5173\u5361\u5730\u56fe\u7c7b\u578b=======",e),e){case f.MapState.\u91ce\u5916:t=this.mapPrefab;break;case f.MapState.\u79d1\u6280:t=this.map2Prefab;break;case f.MapState.\u68ee\u6797:t=this.map3Prefab}this.map.getComponent(cc.Sprite).spriteFrame=this.mapSF[e],t.length;var o=f.default.getMapByID(this.mapData.id).index,i=cc.instantiate(t[o]);console.log("\u7b2c\u51e0\u5e45\u5730\u56fe",o),i.parent=this.map,i.setPosition(cc.v2(0,this.mapIndex*this.mapSizeY-this.map.height/2+this.mapSizeY/2)),i.zIndex=-1,this.layout=i,this.player.parent=this.layout,this.init(null),this.doStart()},e.prototype.init=function(){var t=this,e=this;this.quadTree=new I.default(this.map.getBoundingBox()),this.blocks=[],this.nameList=["box","CN","shi_kuai1","shi_kuai2","shi_kuai3","shi_kuai4","shui_jing","shui_jing2","tree1","tree2","bigtree_left","bigtree_right","house_left","house_right","shui_jing2","car_left","car_right","block1_1","block1_2","block1_3","block1_4","block1_5","block1_6","block2_1","block2_2","block2_3","block2_4","block2_5","block2_6","block3_1","block3_2","block3_3","block3_4","block4_1","block4_2","block4_3","block4_4","block5_1","block5_2","block5_3","block5_4","block6_1","block6_2","block6_3","block7_1","block8_1","block9_1","block10_1","block10_2","block10_3","block10_4","block10_5","block10_6","block11_1","block11_2","block11_3","block11_4","block11_5","block11_6","map_left_down","map_right_down","map_left_up","map_right_up","map_down","map_up","map_left","map_right","map_empty","map"];var o=this.layout.children,i=null;o.forEach(function(o){if(t.nameList.indexOf(o.name)>=0){var n=o.getComponent(D.default),a=o.getPosition().add(cc.v2(t.mapSizeX/2,t.mapSizeY/2)).div(t.size);n.gird=cc.v2(Math.floor(a.x),Math.floor(a.y)),o.setPosition(n.gird.add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.mapSizeX/2,t.mapSizeY/2).add(cc.v2(t.size/2,t.size/2)))),n.type!=M.ItemType.WATER?(o.zIndex=2*-n.gird.y,o.name.indexOf("map")>=0&&(o.zIndex=10*-n.gird.y)):o.zIndex=2*-Math.floor(t.mapSizeY/t.size),e.blocks.push(n),n.init()}else"grass_right"==o.name||"grass_left"==o.name||"guang"==o.name||"grass_1"==o.name||"grass_2"==o.name||"grass_3"==o.name||"xiaoshitou_1"==o.name||"xiaoshitou_2"==o.name?(o.zIndex=50*-Math.floor(t.mapSizeY/t.size)+1,a=o.getPosition().add(cc.v2(t.mapSizeX/2,t.mapSizeY/2)).div(t.size),"grass_right"==o.name&&o.setPosition(cc.v2(Math.floor(a.x),Math.floor(a.y)).add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.mapSizeX/2,t.mapSizeY/2).add(cc.v2(t.size/2,t.size/2))))):"addHpLogo"==o.name?o.zIndex=1:"addHpCircle"==o.name?(a=o.getPosition().add(cc.v2(t.mapSizeX/2,t.mapSizeY/2)).div(t.size),o.setPosition(cc.v2(Math.floor(a.x),Math.floor(a.y)).add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.mapSizeX/2,t.mapSizeY/2).add(cc.v2(t.size/2,t.size/2)))),o.zIndex=o.zIndex=2*-Math.floor(t.mapSizeY/t.size)-10):"doorCircle"==o.name&&(t.mapIndex==S.default.getInstance().mapMax?o.active=!1:(i=o,a=o.getPosition().add(cc.v2(t.mapSizeX/2,t.mapSizeY/2)).div(t.size),o.setPosition(cc.v2(Math.floor(a.x),Math.floor(a.y)).add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.mapSizeX/2,t.mapSizeY/2).add(cc.v2(t.size/2,t.size/2)))),o.zIndex=2*-Math.floor(a.y)-1))}),this.astar||(this.astar=new w.default),this.astar.init(this.size,this.size,Math.floor(this.mapSizeX/this.size)-1,Math.floor(this.mapSizeY/this.size)-1),this.astar.initMap(),this.astar.resetMap(),this.blocks.forEach(function(t){t.type!=M.ItemType.BLOCK&&t.type!=M.ItemType.WATER&&t.type!=M.ItemType.SHADOW&&t.type!=M.ItemType.MOUNTAIN&&t.type!=M.ItemType.CN||0!=e.astar.gridsList[t.gird.x][t.gird.y].type||(e.astar.gridsList[t.gird.x][t.gird.y].type=-1)}),this.mapView.initDoor(i)},e.prototype.airDrop=function(){var t;t=0==Math.floor(2*Math.random())?cc.instantiate(this.HPBox):cc.instantiate(this.airBox);var e=this.boxShadow();this.boxDrop(t,e.pos,e.gird),this.boxShadowNode.active=!0,this.boxShadowNode.opacity=0,this.boxShadowNode.runAction(cc.fadeIn(1))},e.prototype.boxShadow=function(){for(var t=this.curPlayer.node.getPosition(),e=t.add(cc.v2(this.mapSizeX/2,this.mapSizeY/2)).div(this.size),o=cc.v2(Math.floor(e.x),Math.floor(e.y)),i=(this.size,[]),n=Math.max(2-o.x,-Math.floor(4));n<5;n++){var a=o.x+n;if(a>this.maxGirdX-2)break;for(var r=Math.max(2-o.y,-Math.floor(8));r<9;r++){var c=o.y+r;if(c>this.maxGirdY-2)break;var s=cc.v2(a,c);i.push(s)}}var l=[];this.blocks.forEach(function(t){t.gird.x<=o.x+4&&t.gird.x>=o.x-4&&t.gird.y<=o.y+8&&t.gird.y>=o.y-8&&l.push(t.gird)});var d=i.filter(function(t){return!l.some(function(e){return t.equals(e)})}),u=[],p=function(t){var e=d[t].x,o=d[t].y,i=cc.v2(e+1,o);d.some(function(t){return t.equals(i)})&&u.push(d[t])};for(n=0;n<d.length;n++)p(n);0==u.length&&u.push(t);var h=y.choice(u),f=h.mul(this.size).sub(cc.v2(this.mapSizeX/2,this.mapSizeY/2)).add(cc.v2(this.size/2,this.size/2));return this.boxShadowNode.setPosition(f),this.boxShadowNode.parent=this.layout,this.boxShadowNode.zIndex=2*-h.y,cc.log("=====\u5730\u56fe\u6700\u5927\u9650\u5236\uff1agirdthis.maxGirdX,this.maxGirdY====",this.maxGirdX,this.maxGirdY),cc.log("=====\u73a9\u5bb6\u4f4d\u7f6egird\uff1aplayerGird====",o.x,o.y),cc.log("=====\u9634\u5f71\u4f4d\u7f6e\uff1ashadowGide====",h.x,h.y),cc.log("=====\u9634\u5f71\u4f4d\u7f6e\uff1ashadowPos====",f.x,f.y),{pos:f,gird:h}},e.prototype.boxDrop=function(t,e,o){var i=this;t.parent=this.layout,t.active=!0,t.opacity=0,t.setPosition(cc.v2(e.x,e.y+13*this.size)),t.runAction(cc.sequence(cc.spawn(cc.fadeIn(2),cc.moveTo(4,e)),cc.callFunc(function(){t.getChildByName("umbrella").runAction(cc.spawn(cc.fadeOut(1),cc.scaleTo(1,2,0),cc.moveBy(1,cc.v2(0,-100)))),t.parent=i.layout,t.zIndex=2*-o.y,t.getComponent(N.default).floor()})))},e.prototype.disappearBoxShadow=function(){var t=this;this.boxShadowNode.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.boxShadowNode.active=!1})))},e.prototype.doStart=function(){g.default.event.emit(u.GameDataEvent.RESUME_CUT_COMBINE_TIME),this.targets=[],this.enemys=[],this.players=[],this.getLevel(),this.curPlayer=this.player.getComponent(b.default);var t=g.default.uiCenter.showUi("LoseView").getComponent(R.default);if(t.player=this.curPlayer,g.default.uiCenter.hideUI("LoseView"),g.default.uiCenter.hideBlockInput(),this.loseView=t,this.targets.push(this.curPlayer),this.players.push(this.curPlayer),S.default.getInstance().model.players=this.players.map(function(t){return t.model}),this.curPlayer.init(),console.log("=======\u731c\u6d4b\uff1a\u73a9\u5bb6=======GameManage.getInstance().model.players",S.default.getInstance().model.players),this.tipsView.gameView=this,this.tipsView.node.active=!0,0==this.mapIndex)this.tipsView.startGame();else{if(this.mapIndex==S.default.getInstance().mapMax){this.initEnemy();var e=this.attackView.combineNode.getComponent(C.default).energy;return void this.tipsView.bossWarn(function(){var t=this;console.log("NewbieData.isNewbie.isNewbie",h.default.isNewbie.isNewbie,h.default.nowStepName,this.curPlayer.mountIdx,e),h.default.isNewbie.isNewbie&&h.default.nowStepName==h.NEWBIE_EVENT.COMBINE_HERO&&this.curPlayer.mountIdx>-1&&e>0?(this.combineGuide.active=!0,g.default.event.emit(u.GameDataEvent.ADD_COMBINE_ENERGY,100),h.default.once(h.NEWBIE_EVENT.COMBINE_HERO_SUCCESS,function(){t.enemys.forEach(function(t){t.isStart=!0}),t.ctrlNode.resumeCtrl()})):(this.enemys.forEach(function(t){t.isStart=!0}),this.ctrlNode.resumeCtrl())}.bind(this))}this.initEnemy()}this.isMoveNext=!1},e.prototype.initPet=function(t,e){if(-1!=t){this.curPlayer.mountIdx=t;var o=cc.instantiate(this.petPrefab),i=o.getComponent(B.default);i.gameView=this,i.initPet(1,.2,t,e),o.parent=this.layout,this.pet=i,l.default.getHeroDataById(this.curPlayer.personIdx+""+t+(Math.floor(e/m.MountMaxLevel)+1))?(this.attackView.combineNode.getComponent(C.default).isCanCombine=!0,this.attackView.combineNode.getComponent(C.default).energy=100,h.default.isNewbie.isNewbie&&h.default.nowStepName==h.NEWBIE_EVENT.COMBINE_HERO&&this.curPlayer.mountIdx>-1&&(this.attackView.combineNode.getComponent(C.default).energy=0),this.attackView.combineNode.getComponent(C.default).setTimeEnergy()):this.attackView.combineNode.getComponent(C.default).isCanCombine=!1}else this.attackView.combineNode.getComponent(C.default).isCanCombine=!1},e.prototype.doEnd=function(){this.enemys.forEach(function(t){return t.isStart=!1}),this.pet&&(this.pet.isStart=!1)},e.prototype.startGame=function(){this.attackView.node.active=!0,this.mapView.node.active=!0,this.mapView.init(Math.max(this.mapSizeX,this.mapSizeY)),this.shadow.active=!1,this.initEnemy(),this.pet&&(this.pet.isStart=!0)},e.prototype.loseGame=function(){this.loseView.node.active=!0,this.loseView.doStart()},e.prototype.endGame=function(){console.log("GameView endGame..."+this.isAccount),this.isAccount||(this.isAccount=!0,this.attackView.stopAttack(),this.shadow.active=!0,this.tipsView.node.active=!0,this.tipsView.endGame(),this.unschedule(this.airDrop),S.default.getInstance().endGame(),console.log("end..."))},e.prototype.accountGame=function(){this.shadow.active=!1},e.prototype.showKill=function(){g.default.gameAudio.playKillClip()},e.prototype.hideKill=function(){this.unschedule(this.hideKill),this.killView.node.active=!1},e.prototype.getEmptyGird=function(){var t=this,e=Math.floor(this.mapSizeX/this.size)-1,o=Math.floor(this.mapSizeY/this.size)-1,i=[],n=this.blocks.map(function(t){return t.gird});n=n.concat(this.players.map(function(e){var o=cc.v2(e.node.x+(t.mapSizeX-this.size)/2,e.node.y+(t.mapSizeY-this.size)/2);return cc.v2(Math.floor(o.x/this.size),Math.floor(o.y/this.size))}));for(var a=[],r=function(t){var e=[],a=n.filter(function(e){return e.x==t});if(a.length>0)for(var r=function(t){a.every(function(e){return e.y!=t})&&e.push(t)},c=0;c<o+1;c++)r(c);else for(var s=0;s<o+1;s++)e.push(s);i.push(e)},c=0;c<e+1;c++)r(c);i.forEach(function(t,e){t.length>0&&a.push(e)});var s=a[Math.floor(Math.random()*a.length)],l=i[s][Math.floor(Math.random()*i[s].length)];return cc.v2(s,l)},e.prototype.getGird=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1);var o=cc.v2(0,0);if(S.default.getInstance().gameType==S.GameType.\u666e\u901a\u5173\u5361){if(e){var i=this.mapData.BossConfig[0];return cc.v2(i.posX,i.posY)}t>=0?(i=this.mapData.EnemyConfig[t],o=cc.v2(i.posX,i.posY)):o=cc.v2(this.mapData.posX,this.mapData.posY)}return o},e.prototype.getArm=function(){var t=this.armPool.size()>0?this.armPool.get():cc.instantiate(this.arm);return t.active=!0,t},e.prototype.putArm=function(t){t.active=!1,this.armPool.put(t)},e.prototype.getSkill=function(){var t=this.skillPool.size()>0?this.skillPool.get():cc.instantiate(this.skill);return t.active=!0,t},e.prototype.putSkill=function(t){t.active=!1,this.skillPool.put(t)},e.prototype.getEnemySkill=function(){var t=this.enemySkillPool.size()>0?this.enemySkillPool.get():cc.instantiate(this.enemySkill);return t.active=!0,t},e.prototype.putEnemySkill=function(t){t.active=!1,this.enemySkillPool.put(t)},e.prototype.getFire=function(){var t=this.firePool.size()>0?this.firePool.get():cc.instantiate(this.fire);return t.active=!0,t},e.prototype.putFire=function(t){t.active=!1,this.firePool.put(t)},e.prototype.getCri=function(){var t=this.criPool.size()>0?this.criPool.get():cc.instantiate(this.cri);return t.active=!0,t},e.prototype.putCri=function(t){t.active=!1,this.criPool.put(t)},e.prototype.getAddHp=function(){var t=this.addHpPool.size()>0?this.addHpPool.get():cc.instantiate(this.addHp);return t.active=!0,t},e.prototype.putAddHp=function(t){t.active=!1,this.addHpPool.put(t)},e.prototype.getSkeleton=function(){var t=this.skeletonPool.size()>0?this.skeletonPool.get():cc.instantiate(this.skeleton);return t.active=!0,t},e.prototype.putSkeleton=function(t){t.active=!1,this.skeletonPool.put(t)},e.prototype.appendSkeleton=function(t,e,o){var i=this.getSkeleton().getComponent(sp.Skeleton);i&&(i.node.parent=t,r.default.addLoadingAssetNode(i.node).loadAsset(e,sp.SkeletonData,function(e,n){t&&i&&!e&&n&&(i.skeletonData=n,o&&o(i))}))},e.prototype.removeSkeleton=function(t){t&&(t.clearTracks(),t.setCompleteListener(null),t.node&&(t.node.color=cc.Color.WHITE,t.node.angle=-0,t.node.scale=1,t.node.zIndex=0,t.timeScale=1,this.putSkeleton(t.node)))},e.prototype.getSprite=function(){var t=this.spritePool.size()>0?this.spritePool.get():cc.instantiate(this.sprite);return t.active=!0,t},e.prototype.putSprite=function(t){t.active=!1,this.spritePool.put(t)},e.prototype.appendSprite=function(t,e,o){var i=this.getSprite().getComponent(cc.Sprite);i&&(i.node.parent=t,c.default.addLoaderSprite(i).loadSprite(e,cc.SpriteFrame,function(){t&&i&&o&&o(i)}))},e.prototype.removeSprite=function(t){t&&(t.spriteFrame=null,t.node&&(t.node.stopAllActions(),t.node.opacity=255,t.node.color=cc.Color.WHITE,t.node.anchorX=.5,t.node.anchorY=.5,t.node.scale=1,this.putSprite(t.node)))},e.prototype.getAni=function(){var t=this.aniPool.size()>0?this.aniPool.get():cc.instantiate(this.ani);return t.active=!0,t},e.prototype.putAni=function(t){t.active=!1,this.aniPool.put(t)},e.prototype.appendAnimation=function(t,e,o){for(var i=this.getAni().getComponent(cc.Animation),n=i.getClips(),a=0;a<n.length;a++)i.removeClip(n[a],!0);i&&(i.node.parent=t,r.default.addLoadingAssetNode(i.node).loadAsset(e,cc.AnimationClip,function(e,n){t&&i&&(i.addClip(n),i.play(n.name),o&&o(i))}))},e.prototype.removeAni=function(t){if(t){for(var e=t.getClips(),o=0;o<e.length;o++)t.removeClip(e[o],!0);t.defaultClip=null,t.node.getComponent(cc.Sprite).spriteFrame=null,t.node&&(t.node.stopAllActions(),t.node.opacity=255,t.node.color=cc.Color.WHITE,t.node.anchorX=.5,t.node.anchorY=.5,t.node.scale=1,this.putAni(t.node))}},e.prototype.getParticle=function(t){void 0===t&&(t=0)},e.prototype.getLevel=function(){S.default.getInstance().level=0,cc.log("GameManage.getInstance().level2",S.default.getInstance().level)},e.prototype.initEnemy=function(){var t=this.mapData.EnemyConfig,e=t.length,o=null,i=0,n=!1,a=S.default.getInstance(),r=a.getNowEnemy().isBoss,c=0;if(r){var s=this.mapData.BossConfig[0].enemy_type;i=d.default.getEnemyIDByType(s,a.guanqia.enemyLevel);var l=(o=cc.instantiate(this.enemyPrefab)).getComponent(P.default);l.initEnemy(0,.1,i,n,r,0),l.hpView=this.bossHpView,o.parent=this.layout,l.init(),this.enemys.push(l),a.model.enemys=this.enemys.map(function(t){return t.model}),this.bossNameLabel.string=d.default.getEnemyDataByID(i).name,l.hpView.node.active=!0,a.enemy_num=1,this.enemyCountNode.node.active=!1}else{for(var u=0;u<e;u++){var h=t[u];n=h.isAttack,s=h.enemy_type;var f=h.enemy_num;p.default.getNowGuanqia().id<p.default.normalCount&&(f=h.newbie_enemy_num),0!=f&&(i=d.default.getEnemyIDByType(s,a.guanqia.enemyLevel),this.creatEnemy(u,i,n,r,h.brath_times,f),c+=f)}a.enemy_num=c,this.updateEnemyCount(0),this.enemyCountNode.countMax=c}cc.log("\u672c\u6ce2\u602a\u517d\u603b\u6570",a.enemy_num)},e.prototype.creatEnemy=function(t,e,o,i,n,a){var r=this,c=0;this.schedule(function(){var n=cc.instantiate(r.enemyPrefab),a=n.getComponent(P.default);a.initEnemy(t,.1*Math.random()+.05,e,o,i,c),n.parent=r.layout,a.init(),r.enemys.push(a),S.default.getInstance().model.enemys=r.enemys.map(function(t){return t.model}),(S.default.getInstance().state=S.GameState.\u6218\u6597\u4e2d)&&(a.isStart=!0),c++},n,a-1,0)},e.prototype.updateRank=function(){},e.prototype.updateMap=function(t){this.mapView.refresh(t)},e.prototype.updateEnemyCount=function(t){this.enemyCountNode.updateUI(t)},e.prototype.checkShadow=function(){this.checkPlayerShadow(),this.checkAIShadow()},e.prototype.checkPlayerShadow=function(){var t=this;if(this.curPlayer){var e=cc.rect();e.x=this.curPlayer.node.x-150,e.y=this.curPlayer.node.y-150,e.width=300,e.height=300;var o=this.quadTree.retrieve(e).filter(function(e){return!!(this.nameList.indexOf(e.node.name)&&e.type==M.ItemType.SHADOW&&cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(cc.v2(t.curPlayer.node.position)).mag()<=150)});if(o.filter(function(e){return cc.Intersection.rectRect(e.rect,t.curPlayer.node.getBoundingBox())}).length>0){this.curPlayer.isShadow=!0;var i=o.map(function(t){return t.node});this.blocks.forEach(function(t){t.type==M.ItemType.SHADOW&&(i.indexOf(t.node)>-1?t.node.opacity=100:t.node.opacity=255)}),this.curPlayer.dragon.node.opacity=100}else this.blocks.forEach(function(t){t.type==M.ItemType.SHADOW&&(t.node.opacity=255)});this.curPlayer.isShadow=!1,this.curPlayer.dragon.node.opacity=255}},e.prototype.checkAIShadow=function(){var t=this;this.curPlayer&&this.enemys.forEach(function(e){t.quadTree.retrieve(e.node.getBoundingBox()).length>0?(e.isShadow=!0,e.node.position.sub(t.curPlayer.node.position).mag()<150?e.node.opacity=0:e.node.opacity=100):(e.isShadow=!1,e.node.opacity=255)})},e.prototype.update=function(){var t=this.targets.filter(function(t){return t&&t.node.active&&t.model&&!t.model.isDead()});this.updateMap(t)},a([H(cc.Node)],e.prototype,"map",void 0),a([H([cc.SpriteFrame])],e.prototype,"mapSF",void 0),a([H(cc.Node)],e.prototype,"shadow",void 0),a([H(cc.Node)],e.prototype,"arm",void 0),a([H(cc.Node)],e.prototype,"skill",void 0),a([H(cc.Node)],e.prototype,"enemySkill",void 0),a([H(cc.Node)],e.prototype,"fire",void 0),a([H(cc.Node)],e.prototype,"cri",void 0),a([H(cc.Node)],e.prototype,"addHp",void 0),a([H(cc.Node)],e.prototype,"skeleton",void 0),a([H(cc.Node)],e.prototype,"sprite",void 0),a([H(cc.Node)],e.prototype,"ani",void 0),a([H([cc.Prefab])],e.prototype,"mapPrefab",void 0),a([H([cc.Prefab])],e.prototype,"map2Prefab",void 0),a([H([cc.Prefab])],e.prototype,"map3Prefab",void 0),a([H([cc.Prefab])],e.prototype,"map4Prefab",void 0),a([H(cc.Prefab)],e.prototype,"aiPrefab",void 0),a([H(cc.Prefab)],e.prototype,"enemyPrefab",void 0),a([H(cc.Prefab)],e.prototype,"petPrefab",void 0),a([H(cc.Node)],e.prototype,"player",void 0),a([H(v.default)],e.prototype,"followCameraNode",void 0),a([H(V.default)],e.prototype,"tipsView",void 0),a([H(x.default)],e.prototype,"killView",void 0),a([H(L.default)],e.prototype,"mapView",void 0),a([H(cc.JsonAsset)],e.prototype,"json",void 0),a([H(cc.JsonAsset)],e.prototype,"json_new5",void 0),a([H(cc.Prefab)],e.prototype,"accountPrefab",void 0),a([H(A.default)],e.prototype,"attackView",void 0),a([H(E.default)],e.prototype,"timeView",void 0),a([H(T.default)],e.prototype,"airSkill",void 0),a([H(cc.Prefab)],e.prototype,"airBox",void 0),a([H(cc.Prefab)],e.prototype,"HPBox",void 0),a([H(cc.Node)],e.prototype,"boxShadowNode",void 0),a([H(cc.Prefab)],e.prototype,"coinNode",void 0),a([H(cc.Prefab)],e.prototype,"diamondNode",void 0),a([H(cc.Prefab)],e.prototype,"DNANode",void 0),a([H(cc.Label)],e.prototype,"progressLabel",void 0),a([H(G.default)],e.prototype,"bossHpView",void 0),a([H(cc.Label)],e.prototype,"bossNameLabel",void 0),a([H(_.default)],e.prototype,"ctrlNode",void 0),a([H(O.default)],e.prototype,"cardBuffNode",void 0),a([H(j.default)],e.prototype,"enemyCountNode",void 0),a([H(cc.Node)],e.prototype,"combineGuide",void 0),a([U],e)}(cc.Component);o.default=z,cc._RF.pop()},{"../../../../../InitScene/Script/data/CombineHeroModel":void 0,"../../../../../InitScene/Script/data/EnemyModel":void 0,"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GuanqiaModel":void 0,"../../../../../InitScene/Script/data/GuideModel":void 0,"../../../../../InitScene/Script/data/MapModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../Script/base/Utils":void 0,"../../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../../framework/Script/component/LoaderSprite":void 0,"../../../../../framework/Script/sdk/statistics":void 0,"../../../../Script/center/Game":"Game","../../../FollowCamare":"FollowCamare","../../../Player":"Player","../../../joystick/CtrlManage":"CtrlManage","../../../manage/GameManage":"GameManage","../../../public/AStar":"AStar","../../../public/QuadTree":"QuadTree","../../../test/EditView":"EditView","../Account/AccountAwardNode":"AccountAwardNode","../AirBoxNode":"AirBoxNode","../AirSkillView":"AirSkillView","../CardNode/CardBuffNode":"CardBuffNode","../Enemy/EnemyNode":"EnemyNode","../GameAttack":"GameAttack","../GameBlock":"GameBlock","../GameMap":"GameMap","../HpView":"HpView","../KillView":"KillView","../LoseView":"LoseView","../Pet/PetNode":"PetNode","../TimeView":"TimeView","../TipsView":"TipsView","../UI/EnemyCountView":"EnemyCountView","../combine/CombineNode":"CombineNode"}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"7f8ceCtQ9xDBJiWJ23ucX9/","Game");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/center/GameInit"),c=cc._decorator.ccclass,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),a([c],e)}(r.default);o.default=s,cc._RF.pop()},{"../../../InitScene/Script/center/GameInit":void 0}],GetCultivateNode:[function(t,e,o){"use strict";cc._RF.push(e,"661f63J5WdK2KvSKq+0mqEF","GetCultivateNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/center/GameInit"),l=t("../../../../InitScene/Script/data/GameData"),d=t("../../../../InitScene/Script/data/GunModel"),u=t("../../center/Game"),p=t("../prefabs/view/GunView"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleSprite=null,e.gainSpriteFrame=null,e.diamondLabel=null,e.skeNode=null,e.diamond=0,e}return n(e,t),e.prototype.start=function(){u.default.gameAudio.playWindow()},e.prototype.setSke=function(t,e,o){var i=this;void 0===o&&(o="armatureName");var n=this.skeNode.addComponent(sp.Skeleton);this.skeNode.addComponent(r.default).loadAsset(t,sp.SkeletonData,function(t,e){i.skeNode.isValid&&(n.skeletonData=e,n.animation="daiji",1.3==i.skeNode.scale&&i.drapedtoujin())})},e.prototype.setData=function(t,e,o,i,n){var a=this;void 0===n&&(n=!1),n&&(this.titleSprite.spriteFrame=this.gainSpriteFrame);var r="Armature";"hero"==t?(r="armatureName",this.skeNode.setScale(1.3)):r="Armature",this.diamond=i,this.diamondLabel.string=i+"",this.scheduleOnce(function(){a.setSke(e,o,r)},0)},e.prototype.drapedtoujin=function(){var t=this.skeNode.getComponent(sp.Skeleton).attachUtil;t.generateAllAttachedNodes();var e=t.getAttachedNodes("qiangguadian")[0];e&&r.default.addLoadingAssetNode(this.node).loadAsset("gun/prefabs/normal/"+(d.default.tryGunId>-1?d.default.tryGunId:d.default.useGunId),cc.Prefab,function(t,o){var i=cc.instantiate(o);i.getComponent(p.default).init(!0,!0),i.setPosition(e.getPosition()),i.parent=e})},e.prototype.onClick=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.diamondSuccess=function(){l.default.totalDiamondNum+=this.diamond,s.default.showToast("\u606d\u559c\u83b7\u5f97\u94bb\u77f3x"+this.diamond),this.onClose()},e.prototype.onClose=function(){s.default.uiCenter.closeUI(this.node),this.node.emit("onClose")},a([m(cc.Sprite)],e.prototype,"titleSprite",void 0),a([m(cc.SpriteFrame)],e.prototype,"gainSpriteFrame",void 0),a([m(cc.Label)],e.prototype,"diamondLabel",void 0),a([m(cc.Node)],e.prototype,"skeNode",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../prefabs/view/GunView":"GunView"}],GetCurrencyNode:[function(t,e,o){"use strict";cc._RF.push(e,"d3677hR4xpGd4Ysn7gSqGK2","GetCurrencyNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numLabel=[],e.iconNode=[],e}return n(e,t),e.prototype.start=function(){c.default.gameAudio.playWindow()},e.prototype.setData=function(t,e,o){var i=0;t>0?(r.default.totalCoinNum+=t,this.numLabel[0].string=this.numLabel[0].string.replace("x",t+""),i++):this.iconNode[0].parent.active=!1,e>0?(r.default.totalDiamondNum+=e,this.numLabel[1].string=this.numLabel[1].string.replace("x",e+""),i++):this.iconNode[1].parent.active=!1,o>0?(r.default.totalBoneNum+=o,this.numLabel[2].string=this.numLabel[2].string.replace("x",o+""),i++):this.iconNode[2].parent.active=!1,i>=3?(this.iconNode[0].setScale(.6),this.iconNode[1].setScale(.6),this.iconNode[2].setScale(.6)):i>=2&&(this.iconNode[0].setScale(.9),this.iconNode[1].setScale(.9),this.iconNode[2].setScale(.9))},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([d(cc.RichText)],e.prototype,"numLabel",void 0),a([d(cc.Node)],e.prototype,"iconNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../center/Game":"Game"}],GetGun:[function(t,e,o){"use strict";cc._RF.push(e,"a74bdEObTlK6o2VFfMtAezd","GetGun");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderSprite"),c=t("../../../../../InitScene/Script/center/GameInit"),s=t("../../../../../InitScene/Script/data/GameData"),l=t("../../../../../InitScene/Script/data/GuideModel"),d=t("../../../../../InitScene/Script/data/GunModel"),u=t("../../../center/Game"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.sprite=null,e.awardLabel=null,e.levelLabel=null,e.titleSprite=null,e.gainSpriteFrame=null,e.award=0,e.data=null,e}return n(e,t),e.prototype.setData=function(t,e){void 0===e&&(e=!1),this.data=d.default.getGunDataById(t),e&&(this.titleSprite.spriteFrame=this.gainSpriteFrame),this.updateUI(t),this.levelLabel.string=this.data.id+1+""},e.prototype.updateUI=function(t){var e=this;this.scheduleOnce(function(){var o="gun/"+t;r.default.addLoaderSprite(e.sprite).loadSprite(o)},0),this.awardLabel.string=this.data.award+"",this.nameLabel.string=this.data.gun_name},e.prototype.start=function(){u.default.gameAudio.playWindow()},e.prototype.onClose=function(){u.default.event.emit(s.GameDataEvent.SHOW_FINGER),this.node.destroy(),l.default.isNewbie.isNewbie&&l.default.nowStepName==l.NEWBIE_EVENT.COMBINE_GUN_SUCCESS&&l.default.completeStep()},e.prototype.onAward=function(){s.default.totalDiamondNum+=this.data.award,this.onClose(),c.default.showToast("\u606d\u559c\u83b7\u5f97"+this.data.award+"\u94bb\u77f3")},a([f(cc.Label)],e.prototype,"nameLabel",void 0),a([f(cc.Sprite)],e.prototype,"sprite",void 0),a([f(cc.Label)],e.prototype,"awardLabel",void 0),a([f(cc.Label)],e.prototype,"levelLabel",void 0),a([f(cc.Sprite)],e.prototype,"titleSprite",void 0),a([f(cc.SpriteFrame)],e.prototype,"gainSpriteFrame",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../../InitScene/Script/center/GameInit":void 0,"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GuideModel":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../framework/Script/component/LoaderSprite":void 0,"../../../center/Game":"Game"}],GetMapMountNode:[function(t,e,o){"use strict";cc._RF.push(e,"f0551QZfupBfbR6hhwL6Ztz","GetMapMountNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e}return n(e,t),e.prototype.start=function(){c.default.gameAudio.playWindow()},e.prototype.setData=function(t){r.default.addLoaderSprite(this.iconSprite).loadSprite(t)},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([d(cc.Sprite)],e.prototype,"iconSprite",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],GoGuestNode:[function(t,e,o){"use strict";cc._RF.push(e,"2b633D4O0RMfJldqym1wcgN","GoGuestNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderDragonBones"),c=t("../../../InitScene/Script/data/GuessModel"),s=t("../../../InitScene/Script/data/PersonModel"),l=t("../../Script/center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroDragon=null,e.numLabel=null,e}return n(e,t),e.prototype.start=function(){var t=this,e="hero/dragon/"+s.default.getHeroDataById(c.default.heroID).skeUrl;r.default.addLoaderDragonBones(this.heroDragon).loadArmature(e,function(e){e||(t.heroDragon.armatureName="armatureName",t.heroDragon.playAnimation("\u9ad8\u5174",0))}),this.numLabel.string=c.default.guessTimes+""},e.prototype.onClickGo=function(){l.default.uiCenter.showUi("GuessNode"),this.onClose()},e.prototype.onClose=function(){l.default.uiCenter.closeUI(this.node)},a([p(dragonBones.ArmatureDisplay)],e.prototype,"heroDragon",void 0),a([p(cc.Label)],e.prototype,"numLabel",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../InitScene/Script/data/GuessModel":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../framework/Script/component/LoaderDragonBones":void 0,"../../Script/center/Game":"Game"}],GoUFONode:[function(t,e,o){"use strict";cc._RF.push(e,"e9c8bSm73ZMpoyWIkMWfVLd","GoUFONode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/GameData"),c=t("../../../InitScene/Script/data/UFOModel"),s=t("../../Script/center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numLabel=null,e}return n(e,t),e.prototype.start=function(){this.numLabel.string=c.default.enterTimes+""},e.prototype.onClickGo=function(){s.default.event.emit(r.GameDataEvent.GO_UFO),this.onClose()},e.prototype.onClose=function(){s.default.uiCenter.closeUI(this.node)},a([u(cc.Label)],e.prototype,"numLabel",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../InitScene/Script/data/GameData":void 0,"../../../InitScene/Script/data/UFOModel":void 0,"../../Script/center/Game":"Game"}],GrilGuestNode:[function(t,e,o){"use strict";cc._RF.push(e,"bf46c6+cBVCoKelybtjH4La","GrilGuestNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderDragonBones"),c=t("../../../InitScene/Script/data/GuessModel"),s=t("../../../InitScene/Script/data/GuessModel"),l=t("../../../InitScene/Script/data/PersonModel"),d=t("../../Script/center/Game"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.window=null,e.dialogAnimation=null,e.dialogLabel=null,e.heroDragon=null,e.drunkProgressBar=null,e.drunkAudioClip=null,e.drunkAnimation=null,e.count=0,e._guestInfo=null,e.drunk=0,e}return n(e,t),e.prototype.start=function(){this.startServe(),this.onEnterRollDice()},e.prototype.startServe=function(){var t=this;this._guestInfo=s.default.getHero(),r.default.addLoaderDragonBones(this.heroDragon).loadArmature("hero/dragon/"+l.default.getHeroDataById(s.default.heroID).skeUrl,function(e){e||(t.heroDragon.armatureName="armatureName",t.heroDragon.playAnimation("\u5f85\u673a\u5750\u7740",0))}),this.count=0,this.dialogAnimation.node.scale=1,this.dialogAnimation.node.opacity=255,this.drunkProgressBar.node.active=!1},e.prototype.showDialog=function(t,e){this.dialogLabel.string=t,this.dialogAnimation.once(cc.Animation.EventType.FINISHED,function(){e&&e()}),this.dialogAnimation.play("dialog_1")},e.prototype.showAlwaysDialog=function(t){this.dialogLabel.string=t,this.dialogAnimation.play("dialog_3").wrapMode=cc.WrapMode.Normal},e.prototype.hideAlwaysDialog=function(){this.dialogAnimation.play("dialog_3").wrapMode=cc.WrapMode.Reverse},e.prototype.onEnterRollDice=function(){this.drunk=0,this.drunkProgressBar.node.active=!0,this.updateDrunk(),this.showDialog(c.default.getDialog(this._guestInfo.rollStartDialogue))},e.prototype.updateDrunk=function(){this.drunkProgressBar.progress=this.drunk/4},e.prototype.onHeroBeer=function(t){var e=this;d.default.mainAudio.playEffect(this.drunkAudioClip),this.heroDragon.once(dragonBones.EventObject.COMPLETE,function(){e.onDrunk(t)}),this.heroDragon.playAnimation("\u76b1\u7709",2)},e.prototype.rollDrunkOver=function(t){this.showDialog(c.default.getDialog(this._guestInfo.rollWrongDialogue),t)},e.prototype.onDrunk=function(t){this.drunk++,this.updateDrunk(),this.drunkAnimation.play("drunk_0").repeatCount=2,this.drunk>=2?this.heroDragon.playAnimation("\u6655\u4e4e\u4e4e",0):this.heroDragon.playAnimation("\u5f85\u673a\u5750\u7740",0),this.showDialog(c.default.getDialog(this._guestInfo.rollRightDialogue),t)},e.prototype.onRollDiceWin=function(t){var e=this;this.drunkAnimation.play("drunk_0").repeatCount=2,this.drunkAnimation.once(cc.Animation.EventType.FINISHED,function(){e.playSleep(t)}),this.showDialog(c.default.getDialog(this._guestInfo.rollWinDialogue))},e.prototype.playSleep=function(t){d.default.uiCenter.getUI("GuessNode").runAction(cc.sequence(cc.moveBy(.2,0,-50),cc.moveBy(.2,0,50))),this.heroDragon.once(dragonBones.EventObject.LOOP_COMPLETE,function(){t&&t()}),this.heroDragon.playAnimation("\u8db4\u684c\u9762",0),this.heroDragon.node.y-=50,this.node.zIndex=201},e.prototype.playHappy=function(){var t=this;this.heroDragon.once(dragonBones.EventObject.COMPLETE,function(){t.drunk>2?t.heroDragon.playAnimation("\u6655\u4e4e\u4e4e",0):t.heroDragon.playAnimation("\u5f85\u673a\u5750\u7740",0)}),this.heroDragon.playAnimation("\u9ad8\u5174",2)},a([h(cc.Node)],e.prototype,"window",void 0),a([h(cc.Animation)],e.prototype,"dialogAnimation",void 0),a([h(cc.Label)],e.prototype,"dialogLabel",void 0),a([h(dragonBones.ArmatureDisplay)],e.prototype,"heroDragon",void 0),a([h(cc.ProgressBar)],e.prototype,"drunkProgressBar",void 0),a([h({type:cc.AudioClip})],e.prototype,"drunkAudioClip",void 0),a([h(cc.Animation)],e.prototype,"drunkAnimation",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../InitScene/Script/data/GuessModel":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../framework/Script/component/LoaderDragonBones":void 0,"../../Script/center/Game":"Game"}],GuideNode:[function(t,e,o){"use strict";cc._RF.push(e,"06234mT8QlCeqOxmpxF4oLl","GuideNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GuideModel"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyNode=null,e.combineNode=null,e.beginNode=null,e.tryMountNode=null,e.mountNode=null,e.upgradeMountNode=null,e.showUpgradeNode=null,e.nowNode=null,e}return n(e,t),e.prototype.start=function(){r.default.isNewbie.isNewbie||this.node.destroy(),r.default.on(r.NEWBIE_EVENT.BUY_GUN,this.onBuyGunStep,this),r.default.on(r.NEWBIE_EVENT.COMBINE_GUN,this.onCombineGunStep,this),r.default.on(r.NEWBIE_EVENT.COMBINE_GUN_SUCCESS,this.onCombineSuccess,this),r.default.on(r.NEWBIE_EVENT.BEGIN_GAME,this.onBeginGameStep,this),r.default.on(r.NEWBIE_EVENT.BEGIN_GAME_SUCCESS,this.onBeginGameSuccess,this),r.default.on(r.NEWBIE_EVENT.CLICK_TRY_MOUNT,this.onClickTryMount,this),r.default.on(r.NEWBIE_EVENT.CLICK_TRY_MOUNT_SUCCESS,this.onClickTryMountSuccess,this),r.default.on(r.NEWBIE_EVENT.FINISTH_GUIDE,this.finish,this),r.default.nowStepName!=r.NEWBIE_EVENT.BUY_GUN&&r.default.nowStepName!=r.NEWBIE_EVENT.COMBINE_GUN&&r.default.nowStepName!=r.NEWBIE_EVENT.BEGIN_GAME||r.default.emit(r.default.nowStepName),r.default.nowStepName==r.NEWBIE_EVENT.COMBINE_GUN_SUCCESS&&(r.default.completeStep(),r.default.emit(r.default.nowStepName))},e.prototype.onClick=function(){r.default.nowStepName!=r.NEWBIE_EVENT.BEGIN_GAME?(r.default.completeStep(),r.default.nowStepName==r.NEWBIE_EVENT.COMBINE_GUN_SUCCESS&&(r.default.completeStep(),r.default.emit(r.default.nowStepName))):this.nowNode.active=!1},e.prototype.onBuyGunStep=function(){this.buyNode.active=!0,this.nowNode=this.buyNode},e.prototype.onCombineGunStep=function(){this.nowNode&&(this.nowNode.active=!1),this.combineNode.active=!0,this.nowNode=this.combineNode},e.prototype.onCombineSuccess=function(){this.nowNode&&(this.nowNode.active=!1)},e.prototype.onBeginGameStep=function(){this.beginNode.active=!0,this.nowNode=this.beginNode},e.prototype.onBeginGameSuccess=function(){this.nowNode&&(this.nowNode.active=!1)},e.prototype.onClickTryMount=function(){this.nowNode&&(this.nowNode.active=!1),this.nowNode=this.tryMountNode,this.tryMountNode.active=!0},e.prototype.onClickTryMountSuccess=function(){this.nowNode&&(this.nowNode.active=!1)},e.prototype.onClickMountStep=function(){this.mountNode.active=!0,this.nowNode=this.mountNode},e.prototype.onClickUpgradeStep=function(){this.nowNode&&(this.nowNode.active=!1),this.upgradeMountNode.active=!0,this.nowNode=this.upgradeMountNode},e.prototype.onShowUpgradeStep=function(){var t=this;this.nowNode&&(this.nowNode.active=!1),this.showUpgradeNode.active=!0,this.nowNode=this.showUpgradeNode,this.scheduleOnce(function(){t.nowNode&&(t.nowNode.active=!1),t.onClick()},4)},e.prototype.finish=function(){this.nowNode&&(this.nowNode.active=!1),this.nowNode=null,this.onClick(),r.default.isNewbie.isNewbie=!1},a([l(cc.Node)],e.prototype,"buyNode",void 0),a([l(cc.Node)],e.prototype,"combineNode",void 0),a([l(cc.Node)],e.prototype,"beginNode",void 0),a([l(cc.Node)],e.prototype,"tryMountNode",void 0),a([l(cc.Node)],e.prototype,"mountNode",void 0),a([l(cc.Node)],e.prototype,"upgradeMountNode",void 0),a([l(cc.Node)],e.prototype,"showUpgradeNode",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../InitScene/Script/data/GuideModel":void 0}],GunEggDwNode:[function(t,e,o){"use strict";cc._RF.push(e,"f010boKuhJC9bEN+mJlRg/+","GunEggDwNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.activityNode=null,e}return n(e,t),e.prototype.start=function(){if(c.default.gunDwVideoTime>=c.default.activityDwGunVideo)this.node.destroy();else{var t="gun/"+c.default.activityDwGunID;s.default.getGunDataById(c.default.activityDwGunID).isWeekup&&(t="gun/wakeup/"+c.default.activityDwGunID),r.default.addLoaderSprite(this.sprite).loadSprite(t),this.hideBtn(),c.default.on(c.ActivityType.SHOW_GUN_DW_0501,this.showBtn,this),c.default.on(c.ActivityType.HIDE_GUN_DW_0501,this.hideBtn,this)}},e.prototype.onClick=function(){l.default.uiCenter.showUi(this.activityNode)},e.prototype.showBtn=function(){this.sprite.node.active=!0},e.prototype.hideBtn=function(){this.sprite.node.active=!1},a([p(cc.Sprite)],e.prototype,"sprite",void 0),a([p(cc.Prefab)],e.prototype,"activityNode",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],GunEggXzNode:[function(t,e,o){"use strict";cc._RF.push(e,"b855dutMyZJ+poulJi6ztML","GunEggXzNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.activityNode=null,e}return n(e,t),e.prototype.start=function(){if(c.default.isGetDifficultGun)this.node.destroy();else{var t="gun/"+c.default.difficultXzGunID;s.default.getGunDataById(c.default.difficultXzGunID).isWeekup&&(t="gun/wakeup/"+c.default.difficultXzGunID),r.default.addLoaderSprite(this.sprite).loadSprite(t),this.hideBtn(),c.default.on(c.ActivityType.SHOW_GUN_XZ,this.showBtn,this),c.default.on(c.ActivityType.HIDE_GUN_XZ,this.hideBtn,this)}},e.prototype.onClick=function(){l.default.uiCenter.showUi(this.activityNode)},e.prototype.showBtn=function(){this.sprite.node.active=!0},e.prototype.hideBtn=function(){this.sprite.node.active=!1},a([p(cc.Sprite)],e.prototype,"sprite",void 0),a([p(cc.Prefab)],e.prototype,"activityNode",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],GunEgg:[function(t,e,o){"use strict";cc._RF.push(e,"c0d1dZwR1JBDZwF7vjwy8vN","GunEgg");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/ActivityModel"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activityNode=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.onClick=function(){var t=this;if(!(c.default.gunVideoTime>=c.default.activityGunVideo)){var e=this;2==s.default.useGunId&&cc.tween(e.node).to(.5,{opacity:0}).call(function(){var o="gun/"+c.default.activityGunID;s.default.getGunDataById(c.default.activityGunID).isWeekup&&(o="gun/wakeup/"+c.default.activityGunID),r.default.addLoaderSprite(e.node).loadSprite(o),t.node.scale=0,l.default.gameAudio.playUpgradeDwPowerClip()}).to(.5,{opacity:255,angle:-360,scaleX:-1,scaleY:1}).to(1.5,{angle:-3600+e.node.angle,scaleX:-2,scaleY:2}).to(.3,{scaleX:-2.6,scaleY:2.6}).to(.3,{scaleX:-2.2,scaleY:2.2}).call(e.openWindow.bind(e)).start()}},e.prototype.openWindow=function(){cc.log("this.node.angle",this.node.angle,this.node.scale),l.default.uiCenter.showUi(this.activityNode).once("onClose",this.callback,this)},e.prototype.callback=function(){var t="gun/"+s.default.useGunId;s.default.getGunDataById(s.default.useGunId).isWeekup&&(t="gun/wakeup/"+s.default.useGunId),r.default.addLoaderSprite(this.node).loadSprite(t),cc.tween(this.node).to(1,{scaleX:-1,scaleY:1}).start(),this.node.angle=-30},a([p(cc.Prefab)],e.prototype,"activityNode",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],GunView:[function(t,e,o){"use strict";cc._RF.push(e,"16865lV2VFMULi5F4rC+izj","GunView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.headNode=null,e.lightNode=null,e.leftHeadNode=null,e.rightHeadNode=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t,e){e?this.showLight():this.hideLight(),t?this.showHead():this.hideHead()},e.prototype.showLight=function(){this.lightNode.active=!0},e.prototype.hideLight=function(){this.lightNode.active=!1},e.prototype.showHead=function(){this.headNode.active=!0},e.prototype.hideHead=function(){this.headNode.active=!1},e.prototype.loadHead=function(t){r.default.addLoaderSprite(this.leftHeadNode).loadSprite("gun/head/left"+t),r.default.addLoaderSprite(this.rightHeadNode).loadSprite("gun/head/right"+t)},e.prototype.setColor=function(t){this.leftHeadNode.color=t,this.rightHeadNode.color=t,this.node.color=t},a([l(cc.Node)],e.prototype,"headNode",void 0),a([l(cc.Node)],e.prototype,"lightNode",void 0),a([l(cc.Node)],e.prototype,"leftHeadNode",void 0),a([l(cc.Node)],e.prototype,"rightHeadNode",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../../framework/Script/component/LoaderSprite":void 0}],HeadView:[function(t,e,o){"use strict";cc._RF.push(e,"c84c9X43SdPv65hiIszjnGw","HeadView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.sprite=null,e}return n(e,t),e.prototype.onLoad=function(){this.sprite.sizeMode=cc.Sprite.SizeMode.CUSTOM},e.prototype.start=function(){},e.prototype.init=function(t,e){this.label&&(this.label.string=e?e.length>5?e.substr(0,5)+"...":e:"\u533f\u540d"),r.default.addLoaderSprite(this.sprite).loadSprite(t)},e.prototype.delayInit=function(t,e,o){var i=this;return void 0===e&&(e=""),o?new Promise(function(n){i.scheduleOnce(function(){i.label&&(i.label.string=e?e.length>5?e.substr(0,5)+"...":e:"\u533f\u540d"),r.default.addLoaderSprite(i.sprite).loadSprite(t,cc.SpriteFrame,function(){n(t)})},o)}):this.init(t,e)},a([l(cc.Label)],e.prototype,"label",void 0),a([l(cc.Sprite)],e.prototype,"sprite",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0}],HeroView:[function(t,e,o){"use strict";cc._RF.push(e,"638845+fXFMcIev1LRuAaH9","HeroView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gunNode=null,e}return n(e,t),e.prototype.start=function(){},a([s(cc.Node)],e.prototype,"gunNode",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],HomeNode:[function(t,e,o){"use strict";cc._RF.push(e,"c40a2oqK+tMT60JwD9Vrgnf","HomeNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/GameData"),c=t("../../../InitScene/Script/data/PersonModel"),s=t("../../GameScene/manage/GameManage"),l=t("../../Script/center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.homeNode=null,e.farmNode=null,e.parentNode=null,e.pos=null,e.scale=null,e.isMove=!0,e.heroData=null,e}return n(e,t),e.prototype.start=function(){this.farmNode=s.default.getInstance().farmView,this.parentNode=this.homeNode.parent,this.pos=this.homeNode.getPosition(),this.scale=this.homeNode.scale,this.heroData=c.default.getHeroDataById(5),!this.heroData.isUnlock&&this.onHomeTouch(),this.heroData.on("onUnlock",this.offHomeTouch,this)},e.prototype.onHomeTouch=function(){this.homeNode.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.homeNode.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.homeNode.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.homeNode.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},e.prototype.offHomeTouch=function(){this.homeNode.off(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.homeNode.off(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.homeNode.off(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.homeNode.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},e.prototype.touchStart=function(t){if(this.isMove){var e=cc.v2(t.getLocation());this.homeNode.parent=this.farmNode.node,this.homeNode.zIndex=100,this.homeNode.setPosition(this.farmNode.node.convertToNodeSpaceAR(e)),l.default.event.emit(r.GameDataEvent.SHOW_FARM_HERO)}},e.prototype.touchMove=function(t){if(this.isMove){var e=t.getLocation();this.homeNode.setPosition(this.farmNode.node.convertToNodeSpaceAR(e))}},e.prototype.touchEnd=function(t){if(this.isMove){var e=cc.v2(t.getLocation()),o=this.farmNode.map.getBoundingBoxToWorld();e.x>o.x&&e.x<o.x+o.width&&e.y>o.y&&e.y<o.y+o.height?(this.homeNode.parent=this.farmNode.layout,this.homeNode.setPosition(this.farmNode.layout.convertToNodeSpaceAR(e)),this.homeNode.zIndex=2*-Math.floor((this.homeNode.y+this.farmNode.map.height/2)/this.farmNode.size)-2,this.scheduleOnce(this.back.bind(this,t),3),this.isMove=!1):this.back(t)}},e.prototype.back=function(t){var e=cc.v2(t.getLocation());this.homeNode.parent=this.parentNode,this.homeNode.setPosition(this.parentNode.convertToNodeSpaceAR(e)),this.homeNode.runAction(cc.sequence(cc.moveTo(.5,this.pos),cc.callFunc(function(){l.default.event.emit(r.GameDataEvent.HIDE_FARM_HERO)}))),this.isMove=!0},a([p(cc.Node)],e.prototype,"homeNode",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../InitScene/Script/data/GameData":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../GameScene/manage/GameManage":"GameManage","../../Script/center/Game":"Game"}],HpView:[function(t,e,o){"use strict";cc._RF.push(e,"b2cadjJwrFBuZe/Ki4ovtg+","HpView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.green=null,e.red=null,e.numLabel=null,e.white=null,e.black=null,e.max=0,e.d=0,e.x=1e3,e.isInvincible=!1,e}return n(e,t),e.prototype.start=function(){},e.prototype.init=function(t,e){void 0===e&&(e=!1),this.max=t,this.d=this.green.node.width/Math.floor(this.max/this.x),this.numLabel&&(this.numLabel.string="\u751f\u547d\u503c "+this.max),this.isInvincible=e,this.isInvincible&&this.numLabel&&(this.numLabel.string="\u751f\u547d\u503c \u221e"),this.reset()},e.prototype.reset=function(){this.node.active=!0,this.red&&(this.red.fillRange=1),this.refresh(this.max)},e.prototype.refresh=function(t,e){void 0===e&&(e=!1),this.isInvincible?(t=this.max,this.max>0&&(this.green.fillRange=1),this.numLabel&&(this.numLabel.string="\u751f\u547d\u503c \u221e")):(t=Math.min(t,this.max),this.max>0&&(this.green.fillRange=t/this.max),this.numLabel&&(this.numLabel.string="\u751f\u547d\u503c "+t))},e.prototype.update=function(t){this.red&&this.red.fillRange>this.green.fillRange&&(this.red.fillRange-=t/5)},a([s(cc.Sprite)],e.prototype,"green",void 0),a([s(cc.Sprite)],e.prototype,"red",void 0),a([s(cc.Label)],e.prototype,"numLabel",void 0),a([s(cc.Graphics)],e.prototype,"white",void 0),a([s(cc.Graphics)],e.prototype,"black",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],IllustratedItem:[function(t,e,o){"use strict";cc._RF.push(e,"8298dK/BcRPhqkMh5gaILZ1","IllustratedItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgSprite=null,e.avatarSprite=null,e.selectNode=null,e.formLevel=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.onSelect=function(t){this.selectNode.active=this.formLevel==t},e.prototype.setData=function(t,e,o,i){this.formLevel=t,o&&(this.avatarSprite.node.color=cc.Color.BLACK),this.setIcon(i+"/avatar/"+e)},e.prototype.setDataMax=function(t,e,o,i){this.formLevel=t,o&&(this.avatarSprite.node.color=cc.Color.BLACK),this.setIcon(i+"/avatar/wakeup/"+e)},e.prototype.setIcon=function(t){var e=this;this.scheduleOnce(function(){r.default.addLoaderSprite(e.avatarSprite).loadSprite(t,cc.SpriteFrame)},.1)},a([l(cc.Sprite)],e.prototype,"bgSprite",void 0),a([l(cc.Sprite)],e.prototype,"avatarSprite",void 0),a([l(cc.Node)],e.prototype,"selectNode",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0}],IllustratedNode:[function(t,e,o){"use strict";cc._RF.push(e,"63a35BccWtF/avs3FwwT3ZO","IllustratedNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../InitScene/Script/data/CombineHeroModel"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../../../InitScene/Script/data/MountModel"),d=t("../../../../InitScene/Script/data/PersonModel"),u=t("../../center/Game"),p=t("../prefabs/view/GunView"),h=t("./IllustratedItem"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mountIllustratedNode=null,e.heroIllustratedNode=null,e.scrollView=null,e.illustratedItem=null,e.mountNode=null,e.leftButton=null,e.rightButton=null,e.mountData=null,e.selectLevel=0,e.mountId=0,e.type="mount",e}return n(e,t),e.prototype.start=function(){this.onClickMount(),this.setButton()},e.prototype.setData=function(t){this.mountId=t,this.mountData=l.default.getMountDataById(t)},e.prototype.setFormList=function(){var t=this;this.scrollView.content.removeAllChildren();for(var e=function(e){var i=void 0;if(o.scrollView.content.children[e]?i=o.scrollView.content.children[e]:(i=cc.instantiate(o.illustratedItem),o.scrollView.content.addChild(i)),5==e?i.getComponent(h.default).setDataMax(e,o.mountData.id*l.MountFormNum+e,!o.mountData.isUnlock||e>o.mountData.formLevel,o.type):i.getComponent(h.default).setData(e,o.mountData.id*l.MountFormNum+e,!o.mountData.isUnlock||e>o.mountData.formLevel,o.type),i.getComponent(h.default).onSelect(o.selectLevel),i.on(cc.Node.EventType.TOUCH_END,function(){t.selectLevel!=e&&(t.selectLevel=e,t.resetSke(),t.resetSelect())},o),"combineHero"==o.type)return"break"},o=this,i=0;i<this.mountData.form.length&&"break"!==e(i);i++);},e.prototype.resetSke=function(){var t=this;this.mountNode.removeAllChildren(),"mount"==this.type?this.scheduleOnce(function(){t.playSke()},.1):this.scheduleOnce(function(){t.playHeroSke()},.1)},e.prototype.playSke=function(){var t=new cc.Node,e=l.default.getMountSkeUrl(this.mountData.id,Math.min(this.selectLevel,this.mountData.form.length-1)*l.FormMaxLevel+1),o=t.addComponent(sp.Skeleton);t.addComponent(r.default).loadAsset(e,sp.SkeletonData,function(e,i){t.isValid&&(o.skeletonData=i,o.animation="daiji")}),t.anchorY=0,this.mountNode.addChild(t),(!this.mountData.isUnlock||this.selectLevel>this.mountData.formLevel)&&(t.color=cc.Color.BLACK)},e.prototype.playHeroSke=function(){var t=this,e=""+d.default.useHeroId+this.mountData.id+Math.min(this.selectLevel+1,5),o="combineHero/dragonNew/"+c.default.getHeroDataById(e).skeUrl,i=new cc.Node,n=new cc.Node,a=i.addComponent(sp.Skeleton);i.addComponent(r.default).loadAsset(o,sp.SkeletonData,function(e,o){if(i.isValid){a.skeletonData=o;var c=a.attachUtil;c.generateAllAttachedNodes();var l=c.getAttachedNodes("qiangguadian")[0];l&&(n.parent=l,n.setPosition(cc.v2(0,0)));var d="gun/prefabs/combine/"+s.default.useGunId;r.default.addLoadingAssetNode(n).loadAsset(d,cc.Prefab,function(e,o){if(!e){var i=cc.instantiate(o),a=i.getComponent(p.default);a.init(!0,!1);var r=""+t.mountData.id+Math.min(t.selectLevel+1,5);a.loadHead(r),n.addChild(i),i.setPosition(cc.v2(0,20)),(!t.mountData.isUnlock||t.selectLevel>t.mountData.formLevel)&&a.setColor(cc.Color.BLACK)}}),a.animation="daiji"}}),i.anchorY=0,this.mountNode.addChild(i),(!this.mountData.isUnlock||this.selectLevel>this.mountData.formLevel)&&(i.color=cc.Color.BLACK)},e.prototype.resetSelect=function(){for(var t=0;t<this.scrollView.content.childrenCount;t++)this.scrollView.content.children[t].getComponent(h.default).onSelect(this.selectLevel);this.setButton()},e.prototype.setButton=function(){this.leftButton.interactable=this.selectLevel>0,this.rightButton.interactable=this.selectLevel<4},e.prototype.onChange=function(t,e){if("combineHero"!=this.type){this.selectLevel+=parseInt(e);var o=this.scrollView.content.children[this.selectLevel];this.resetSke(),this.resetSelect(),this.scrollView.content.x+=.7*o.width*-parseInt(e)}},e.prototype.onClose=function(){u.default.uiCenter.closeUI(this.node)},e.prototype.onClickMount=function(){this.type="mount",this.setFormList(),this.mountIllustratedNode.active=!0,this.heroIllustratedNode.active=!1,this.resetSke()},e.prototype.onClickHero=function(){this.type="combineHero",this.setFormList(),this.heroIllustratedNode.active=!0,this.mountIllustratedNode.active=!1,this.resetSke()},e.prototype.setBtnActive=function(t){this.leftButton.interactable=this.rightButton.interactable=t},a([y(cc.Node)],e.prototype,"mountIllustratedNode",void 0),a([y(cc.Node)],e.prototype,"heroIllustratedNode",void 0),a([y(cc.ScrollView)],e.prototype,"scrollView",void 0),a([y(cc.Prefab)],e.prototype,"illustratedItem",void 0),a([y(cc.Node)],e.prototype,"mountNode",void 0),a([y(cc.Button)],e.prototype,"leftButton",void 0),a([y(cc.Button)],e.prototype,"rightButton",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../../InitScene/Script/data/CombineHeroModel":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/component/LoaderAssetNode":void 0,"../../center/Game":"Game","../prefabs/view/GunView":"GunView","./IllustratedItem":"IllustratedItem"}],InfoUI:[function(t,e,o){"use strict";cc._RF.push(e,"23d0c6L+fxPI5ozBvfml4D5","InfoUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../center/Game"),c=t("../../../../framework/Script/component/UiComponent"),s=t("../../../../InitScene/Script/data/GameData"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coinLabel=null,e}return n(e,t),e.prototype.onStart=function(){this.coinLabel.string=s.default.totalCoinNum+""},e.prototype.onClose=function(){r.default.uiCenter.hideUI(this.node)},a([u(cc.Label)],e.prototype,"coinLabel",void 0),a([d],e)}(c.default);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../framework/Script/component/UiComponent":void 0,"../../center/Game":"Game"}],ItemView:[function(t,e,o){"use strict";cc._RF.push(e,"4451cTPYfJLPKr9nBO8+07J","ItemView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderSprite"),c=t("../../../../../InitScene/Script/data/GuideModel"),s=t("../../../../../InitScene/Script/data/GunModel"),l=t("../../../../../Script/base/Utils"),d=t("../../../center/Game"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.gunNode=null,e.profitLabel=null,e.box=null,e.rank=0,e.isEffect=!1,e}return n(e,t),e.prototype.onLoad=function(){this.profitLabel&&(this.profitLabel.node.stopAllActions(),this.profitLabel.node.active=!1)},e.prototype.start=function(){},e.prototype.init=function(t){this.box=t},e.prototype.refresh=function(){var t=this;if(!this.profitLabel){var e=d.default.mainUI;this.profitLabel=e.getProfit().getComponent(cc.Label),this.profitLabel.node.parent=this.node}this.profitLabel.string="+"+l.formatNumber(s.default.getProfit(this.rank)),this.scheduleOnce(function(){t.setGunSprite()}),d.default.event.on("upgradeGunSuccess",this.setGunSprite,this)},e.prototype.setGunSprite=function(){var t="gun/icon/"+this.rank;r.default.addLoaderSprite(this.sprite).loadSprite(t)},e.prototype.show=function(){this.schedule(this.showProfit,5*Math.random()+3)},e.prototype.clear=function(){this.profitLabel&&this.profitLabel.node&&(this.profitLabel.node.active=!1,d.default.mainUI.profitPool.put(this.profitLabel.node),this.profitLabel=null),this.node.destroy()},e.prototype.check=function(t){return t.rank==this.rank&&this.rank<s.default.getGunTotalNum()-1},e.prototype.combine=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=!0),c.default.isNewbie.isNewbie&&c.default.nowStepName==c.NEWBIE_EVENT.COMBINE_GUN&&c.default.completeStep(),t.box.item=null,t.box.refresh(),o?(t.isEffect=!0,this.isEffect=!0,this.doEffect(t,e)):(this.rank++,this.refresh(),this.box.refresh(),t.node.destroy(),e&&e())},e.prototype.doEffect=function(t,e){var o=this;t.node.setPosition(t.node.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.Vec2.ZERO))),t.node.runAction(cc.sequence(cc.moveBy(.2,cc.v2(80,0)),cc.moveBy(.2,cc.v2(-80,0)))),this.node.runAction(cc.sequence(cc.moveBy(.2,cc.v2(-80,0)),cc.moveBy(.2,cc.v2(80,0))));var i=d.default.mainUI,n=i.getCombine().getComponent(sp.Skeleton);n.clearTracks(),n.node.parent=this.node,n.node.setPosition(cc.Vec2.ZERO),this.scheduleOnce(function(){o.isEffect=!1,n.node.active=!0,n.setAnimation(0,"animation",!1),n.setCompleteListener(function(){d.default.gameAudio.playCombineGunClip(),n.clearTracks(),n.node.active=!1,i.combinePool.put(n.node),cc.log("\u64ad\u653e\u5b8c")}),o.rank++,!s.default.getGunDataById(o.rank).isUnlock&&s.default.getGunDataById(o.rank).onUnlock(),o.refresh(),o.box.refresh(),t.clear(),e&&e()},.5)},e.prototype.showProfit=function(){var t=this;if(!this.isEffect){this.sprite.node.runAction(cc.sequence(cc.scaleTo(.2,1.1),cc.scaleTo(.1,1)));var e=d.default.mainUI;this.profitLabel||(this.profitLabel=e.getProfit().getComponent(cc.Label),this.profitLabel.node.parent=this.node),this.profitLabel.node.active=!0,this.profitLabel.string="+"+l.formatNumber(s.default.getProfit(this.rank)),this.profitLabel.node.stopAllActions(),this.profitLabel.node.position=cc.v3(0,40,0),this.profitLabel.node.opacity=255,this.profitLabel.node.runAction(cc.sequence(cc.spawn(cc.fadeOut(.8),cc.sequence(cc.scaleTo(.2,1.1),cc.scaleTo(.1,1)),cc.moveBy(.5,cc.v2(0,50))),cc.callFunc(function(){t.profitLabel.node.active=!1,e.profitPool.put(t.profitLabel.node),t.profitLabel=null})))}},a([h(cc.Sprite)],e.prototype,"sprite",void 0),a([h(cc.Node)],e.prototype,"gunNode",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../../InitScene/Script/data/GuideModel":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../Script/base/Utils":void 0,"../../../../../framework/Script/component/LoaderSprite":void 0,"../../../center/Game":"Game"}],JQQDEggBtnNode:[function(t,e,o){"use strict";cc._RF.push(e,"35969j3cZtP5q0hVtziLk3n","JQQDEggBtnNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/ActivityModel"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getDiamondPrefab=null,e.clickNum=0,e}return n(e,t),e.prototype.start=function(){r.default.eggGetDiamondTime>=r.default.eggGetDiamondVideo&&(this.node.getComponent(cc.Button).interactable=!1)},e.prototype.onClick=function(){r.default.eggGetDiamondTime>=r.default.eggGetDiamondVideo||(this.clickNum++,1==this.clickNum&&this.scheduleOnce(this.reset,1),5==this.clickNum&&c.default.uiCenter.showUi(this.getDiamondPrefab).on("onClose",this.setBtn,this))},e.prototype.reset=function(){this.clickNum=0},e.prototype.setBtn=function(){r.default.eggGetDiamondTime>=r.default.eggGetDiamondVideo&&(this.node.getComponent(cc.Button).interactable=!1)},a([d(cc.Prefab)],e.prototype,"getDiamondPrefab",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/ActivityModel":void 0,"../../center/Game":"Game"}],JoystickCommon:[function(t,e,o){"use strict";cc._RF.push(e,"a3cee1KuqpEQpJY2gLhr1+c","JoystickCommon"),Object.defineProperty(o,"__esModule",{value:!0}),o.DirectionType=o.JoystickType=o.SpeedType=void 0;var i=new function(){};o.default=i,function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t["\u83b7\u5f97\u94bb\u77f3"]=2]="\u83b7\u5f97\u94bb\u77f3",t[t.FAST=3]="FAST"}(o.SpeedType||(o.SpeedType={})),function(t){t[t.FIXED=0]="FIXED",t[t.FOLLOW=1]="FOLLOW"}(o.JoystickType||(o.JoystickType={})),function(t){t[t.FOUR=4]="FOUR",t[t.EIGHT=8]="EIGHT",t[t.ALL=0]="ALL"}(o.DirectionType||(o.DirectionType={})),cc._RF.pop()},{}],KillView:[function(t,e,o){"use strict";cc._RF.push(e,"4c953AjzqdC7Lkk+7xYDT03","KillView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../Script/match/PlayerItem"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeleton=null,e.leftNode=null,e.rightNode=null,e}return n(e,t),e.prototype.setData=function(t,e){this.leftNode&&this.leftNode.setData(e),this.rightNode&&this.rightNode.setData(t),this.node.active=!0,this.skeleton.setAnimation(0,"animation",!1)},a([l(sp.Skeleton)],e.prototype,"skeleton",void 0),a([l(r.default)],e.prototype,"leftNode",void 0),a([l(r.default)],e.prototype,"rightNode",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../Script/match/PlayerItem":void 0}],LevelView:[function(t,e,o){"use strict";cc._RF.push(e,"b7528Iho99BGYRGpxQVpcAR","LevelView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderSprite"),c=t("../../../../../InitScene/Script/data/RankModel"),s=t("../../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelSprite=null,e.labelSprite=null,e.stars=null,e.maxLevel=null,e.starCount=null,e.starShow=null,e.starHide=null,e.upgradeLight1=null,e.upgradeLight2=null,e.downLight=null,e.starNum=0,e}return n(e,t),e.prototype.onEnable=function(){},e.prototype.start=function(){},e.prototype.refresh=function(t){var e=c.default.getRankLevel(t);r.default.addLoaderSprite(this.levelSprite).loadSprite("mainSceneRes/rank/icon/"+e.rankLevel),r.default.addLoaderSprite(this.labelSprite).loadSprite("mainSceneRes/rank/text/"+e.rankLevel),e.rankLevel==c.default.MaxRankLevel?(this.stars.active=!1,this.maxLevel.active=!0,this.starCount.string="X"+e.rankStar):(this.stars.active=!0,this.maxLevel.active=!1,this.refreshStar(e.rankStar))},e.prototype.refreshStar=function(t){var e=this;this.starNum=t,this.stars.children.forEach(function(o,i){return i<t?e.showStar(o):e.hideStar(o)})},e.prototype.showStar=function(t){t.getComponent(cc.Sprite).spriteFrame=this.starShow},e.prototype.hideStar=function(t){t.getComponent(cc.Sprite).spriteFrame=this.starHide},e.prototype.showLevel=function(){this.levelSprite.node.active=!0},e.prototype.hideLevel=function(){this.levelSprite.node.active=!1},e.prototype.upgrade=function(t){var e=this;s.default.gameAudio.playUpgradeDwPowerClip(),this.levelSprite.node.runAction(cc.sequence(cc.scaleTo(.3,0,1),cc.scaleTo(.3,1,1),cc.scaleTo(.25,0,1),cc.scaleTo(.25,1,1),cc.scaleTo(.2,0,1),cc.scaleTo(.2,1,1),cc.scaleTo(.15,0,1),cc.scaleTo(.15,1,1),cc.scaleTo(.1,0,1),cc.callFunc(function(){e.upgradeLight1.node.active=!0,e.upgradeLight1.once(dragonBones.EventObject.COMPLETE,function(){e.upgradeLight1.node.active=!1}),e.upgradeLight1.playAnimation("newAnimation",1)}),cc.scaleTo(.1,1,1),cc.scaleTo(.05,0,1),cc.scaleTo(.05,1,1),cc.repeat(cc.sequence(cc.scaleTo(.02,0,1),cc.scaleTo(.02,1,1)),15),cc.callFunc(function(){s.default.gameAudio.playUpgradeDwClip(),t&&t(),e.upgradeLight2.node.active=!0,e.upgradeLight2.once(dragonBones.EventObject.COMPLETE,function(){e.upgradeLight2.node.active=!1}),e.upgradeLight2.playAnimation("newAnimation",1)}),cc.scaleTo(.1,1.2,1.2),cc.delayTime(.2),cc.scaleTo(.1,1,1)))},e.prototype.down=function(t){var e=this;this.levelSprite.node.runAction(cc.sequence(cc.tintTo(.4,0,0,0),cc.tintTo(.4,255,255,255),cc.callFunc(function(){s.default.gameAudio.playDownDwClip(),t&&t(),e.refreshStar(3),e.downLight.node.active=!0,e.downLight.playAnimation("\u964d\u661f",1)})))},a([u(cc.Sprite)],e.prototype,"levelSprite",void 0),a([u(cc.Sprite)],e.prototype,"labelSprite",void 0),a([u(cc.Node)],e.prototype,"stars",void 0),a([u(cc.Node)],e.prototype,"maxLevel",void 0),a([u(cc.Label)],e.prototype,"starCount",void 0),a([u(cc.SpriteFrame)],e.prototype,"starShow",void 0),a([u(cc.SpriteFrame)],e.prototype,"starHide",void 0),a([u(dragonBones.ArmatureDisplay)],e.prototype,"upgradeLight1",void 0),a([u(dragonBones.ArmatureDisplay)],e.prototype,"upgradeLight2",void 0),a([u(dragonBones.ArmatureDisplay)],e.prototype,"downLight",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../../InitScene/Script/data/RankModel":void 0,"../../../../../framework/Script/component/LoaderSprite":void 0,"../../../center/Game":"Game"}],ListItem:[function(t,e,o){"use strict";cc._RF.push(e,"986b0LtiSBLC7vnWkRQFtml","ListItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=cc._decorator,s=c.ccclass,l=c.property,d=c.disallowMultiple,u=c.menu,p=c.executionOrder;(function(t){t[t.NONE=0]="NONE",t[t.TOGGLE=1]="TOGGLE",t[t.SWITCH=2]="SWITCH"})(r||(r={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectedMode=r.NONE,e.selectedFlag=null,e.selectedSpriteFrame=null,e._unselectedSpriteFrame=null,e.adaptiveSize=!1,e._selected=!1,e._eventReg=!1,e}return n(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this.selectedFlag)switch(this.selectedMode){case r.TOGGLE:this.selectedFlag.active=t;break;case r.SWITCH:var e=this.selectedFlag.getComponent(cc.Sprite);e&&(e.spriteFrame=t?this.selectedSpriteFrame:this._unselectedSpriteFrame)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"btnCom",{get:function(){return this._btnCom||(this._btnCom=this.node.getComponent(cc.Button)),this._btnCom},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(this.btnCom||(this.selectedMode,r.NONE),this.selectedMode==r.SWITCH){var t=this.selectedFlag.getComponent(cc.Sprite);this._unselectedSpriteFrame=t.spriteFrame}},e.prototype.onDestroy=function(){var t=this;t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChange,t)},e.prototype._registerEvent=function(){var t=this;t._eventReg||(t.btnCom&&t.list.selectedMode>0&&t.btnCom.clickEvents.unshift(t.createEvt(t,"onClickThis")),t.adaptiveSize&&t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChange,t),t._eventReg=!0)},e.prototype._onSizeChange=function(){this.list._onItemAdaptive(this.node)},e.prototype.createEvt=function(t,e,o){if(void 0===o&&(o=null),t.isValid){t.comName=t.comName||t.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g,"");var i=new cc.Component.EventHandler;return i.target=o||t.node,i.component=t.comName,i.handler=e,i}},e.prototype.showAni=function(t,e,o){var i,n=this;switch(t){case 0:i=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,2*this.node.height)];break;case 1:i=[cc.scaleTo(.2,.7),cc.moveBy(.3,2*this.node.width,0)];break;case 2:i=[cc.scaleTo(.2,.7),cc.moveBy(.3,0,-2*this.node.height)];break;case 3:i=[cc.scaleTo(.2,.7),cc.moveBy(.3,-2*this.node.width,0)];break;default:i=[cc.scaleTo(.3,.1)]}(e||o)&&i.push(cc.callFunc(function(){if(o){n.list._delSingleItem(n.node);for(var t=n.list.displayData.length-1;t>=0;t--)if(n.list.displayData[t].id==n.listId){n.list.displayData.splice(t,1);break}}e()})),this.node.runAction(cc.sequence(i))},e.prototype.onClickThis=function(){this.list.selectedId=this.listId},a([l({type:cc.Enum(r),tooltip:!1})],e.prototype,"selectedMode",void 0),a([l({type:cc.Node,tooltip:!1,visible:function(){return this.selectedMode>r.NONE}})],e.prototype,"selectedFlag",void 0),a([l({type:cc.SpriteFrame,tooltip:!1,visible:function(){return this.selectedMode==r.SWITCH}})],e.prototype,"selectedSpriteFrame",void 0),a([l({tooltip:!1})],e.prototype,"adaptiveSize",void 0),a([s,d(),u("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List Item"),p(-5001)],e)}(cc.Component);o.default=h,cc._RF.pop()},{}],List:[function(t,e,o){"use strict";cc._RF.push(e,"01889x7HW1MbYb/mNYWkyOv","List");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c,s,l=cc._decorator,d=l.ccclass,u=l.property,p=l.disallowMultiple,h=l.menu,f=l.executionOrder,m=l.requireComponent,y=t("./ListItem");(function(t){t[t.NODE=1]="NODE",t[t.PREFAB=2]="PREFAB"})(r||(r={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.ADHERING=2]="ADHERING",t[t.PAGE=3]="PAGE"}(c||(c={})),function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULT=2]="MULT"}(s||(s={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateType=r.NODE,e.tmpNode=null,e.tmpPrefab=null,e._slideMode=c.NORMAL,e.pageDistance=.3,e.pageChangeEvent=new cc.Component.EventHandler,e._virtual=!0,e.cyclic=!1,e.lackCenter=!1,e.lackSlide=!1,e._updateRate=0,e.frameByFrameRenderNum=0,e.renderEvent=new cc.Component.EventHandler,e.selectedMode=s.NONE,e.repeatEventSingle=!1,e.selectedEvent=null,e._selectedId=-1,e._forceUpdate=!1,e._updateDone=!0,e._numItems=0,e._inited=!1,e._needUpdateWidget=!1,e._aniDelRuning=!1,e._doneAfterUpdate=!1,e.adhering=!1,e._adheringBarrier=!1,e.curPageNum=0,e}return n(e,t),Object.defineProperty(e.prototype,"slideMode",{get:function(){return this._slideMode},set:function(t){this._slideMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"virtual",{get:function(){return this._virtual},set:function(t){null!=t&&(this._virtual=t),0!=this._numItems&&this._onScrolling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateRate",{get:function(){return this._updateRate},set:function(t){t>=0&&t<=6&&(this._updateRate=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this._selectedId},set:function(t){var e,o=this;switch(o.selectedMode){case s.SINGLE:if(!o.repeatEventSingle&&t==o._selectedId)return;e=o.getItemByListId(t);var i=void 0;if(o._selectedId>=0?o._lastSelectedId=o._selectedId:o._lastSelectedId=null,o._selectedId=t,e&&((i=e.getComponent(y.default)).selected=!0),o._lastSelectedId>=0&&o._lastSelectedId!=o._selectedId){var n=o.getItemByListId(o._lastSelectedId);n&&(n.getComponent(y.default).selected=!1)}o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],e,null==o._lastSelectedId?null:o._lastSelectedId%this._actualNumItems);break;case s.MULT:if(!(e=o.getItemByListId(t)))return;i=e.getComponent(y.default),o._selectedId>=0&&(o._lastSelectedId=o._selectedId),o._selectedId=t;var a=!i.selected;i.selected=a;var r=o.multSelected.indexOf(t);a&&r<0?o.multSelected.push(t):!a&&r>=0&&o.multSelected.splice(r,1),o.selectedEvent&&cc.Component.EventHandler.emitEvents([o.selectedEvent],e,null==o._lastSelectedId?null:o._lastSelectedId%this._actualNumItems,a)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._actualNumItems},set:function(t){var e=this;if(e.checkInited(!1))if(null==t||t<0)cc.error("numItems set the wrong::",t);else if(e._actualNumItems=e._numItems=t,e._forceUpdate=!0,e._virtual)e._resizeContent(),e.cyclic&&(e._numItems=e._cyclicNum*e._numItems),e._onScrolling(),e.frameByFrameRenderNum||e.slideMode!=c.PAGE||(e.curPageNum=e.nearestListId);else{var o=e.content.getComponent(cc.Layout);if(o&&(o.enabled=!0),e._delRedundantItem(),e.firstListId=0,e.frameByFrameRenderNum>0){for(var i=e.frameByFrameRenderNum>e._numItems?e._numItems:e.frameByFrameRenderNum,n=0;n<i;n++)e._createOrUpdateItem2(n);e.frameByFrameRenderNum<e._numItems&&(e._updateCounter=e.frameByFrameRenderNum,e._updateDone=!1)}else{for(n=0;n<t;n++)e._createOrUpdateItem2(n);e.displayItemNum=t}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollView",{get:function(){return this._scrollView},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._init()},e.prototype.onDestroy=function(){for(this._itemTmp&&this._itemTmp.isValid&&this._itemTmp.destroy();this._pool.size();)this._pool.get().destroy()},e.prototype.onEnable=function(){this._registerEvent(),this._init()},e.prototype.onDisable=function(){this._unregisterEvent()},e.prototype._registerEvent=function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.on("touch-up",t._onTouchUp,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.on("scroll-began",t._onScrollBegan,t,!0),t.node.on("scroll-ended",t._onScrollEnded,t,!0),t.node.on("scrolling",t._onScrolling,t,!0),t.node.on(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._unregisterEvent=function(){var t=this;t.node.off(cc.Node.EventType.TOUCH_START,t._onTouchStart,t,!0),t.node.off("touch-up",t._onTouchUp,t),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),t.node.off("scroll-began",t._onScrollBegan,t,!0),t.node.off("scroll-ended",t._onScrollEnded,t,!0),t.node.off("scrolling",t._onScrolling,t,!0),t.node.off(cc.Node.EventType.SIZE_CHANGED,t._onSizeChanged,t)},e.prototype._init=function(){var t=this;if(!t._inited)if(t._scrollView=t.node.getComponent(cc.ScrollView),t.content=t._scrollView.content,t.content){switch(t._layout=t.content.getComponent(cc.Layout),t._align=t._layout.type,t._resizeMode=t._layout.resizeMode,t._startAxis=t._layout.startAxis,t._topGap=t._layout.paddingTop,t._rightGap=t._layout.paddingRight,t._bottomGap=t._layout.paddingBottom,t._leftGap=t._layout.paddingLeft,t._columnGap=t._layout.spacingX,t._lineGap=t._layout.spacingY,t._colLineNum,t._verticalDir=t._layout.verticalDirection,t._horizontalDir=t._layout.horizontalDirection,t.setTemplateItem(cc.instantiate(t.templateType==r.PREFAB?t.tmpPrefab:t.tmpNode)),t._slideMode!=c.ADHERING&&t._slideMode!=c.PAGE||(t._scrollView.inertia=!1,t._scrollView._onMouseWheel=function(){}),t.virtual||(t.lackCenter=!1),t._lastDisplayData=[],t.displayData=[],t._pool=new cc.NodePool,t._forceUpdate=!1,t._updateCounter=0,t._updateDone=!0,t.curPageNum=0,t.cyclic&&(t._scrollView._processAutoScrolling=this._processAutoScrolling.bind(t),t._scrollView._startBounceBackIfNeeded=function(){return!1}),t._align){case cc.Layout.Type.HORIZONTAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}break;case cc.Layout.Type.VERTICAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.Type.GRID:switch(t._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(t._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:t._alignCalcType=3;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:t._alignCalcType=4}break;case cc.Layout.AxisDirection.VERTICAL:switch(t._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:t._alignCalcType=1;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:t._alignCalcType=2}}}t.content.children.forEach(function(e){e.removeFromParent(),e!=t.tmpNode&&e.isValid&&e.destroy()}),t._inited=!0}else cc.error(t.node.name+"'s cc.ScrollView unset content!")},e.prototype._processAutoScrolling=function(t){this._scrollView._autoScrollAccumulatedTime+=1*t;var e=Math.min(1,this._scrollView._autoScrollAccumulatedTime/this._scrollView._autoScrollTotalTime);if(this._scrollView._autoScrollAttenuate){var o=e-1;e=o*o*o*o*o+1}var i=this._scrollView._autoScrollStartPosition.add(this._scrollView._autoScrollTargetDelta.mul(e)),n=this._scrollView.getScrollEndedEventTiming(),a=Math.abs(e-1)<=n;Math.abs(e-1)<=this._scrollView.getScrollEndedEventTiming()&&!this._scrollView._isScrollEndedWithThresholdEventFired&&(this._scrollView._dispatchEvent("scroll-ended-with-threshold"),this._scrollView._isScrollEndedWithThresholdEventFired=!0),a&&(this._scrollView._autoScrolling=!1);var r=i.sub(this._scrollView.getContentPosition());this._scrollView._moveContent(this._scrollView._clampDelta(r),a),this._scrollView._dispatchEvent("scrolling"),this._scrollView._autoScrolling||(this._scrollView._isBouncing=!1,this._scrollView._scrolling=!1,this._scrollView._dispatchEvent("scroll-ended"))},e.prototype.setTemplateItem=function(t){if(t){var e=this;e._itemTmp=t,e._resizeMode==cc.Layout.ResizeMode.CHILDREN?e._itemSize=e._layout.cellSize:e._itemSize=cc.size(t.width,t.height);var o=t.getComponent(y.default),i=!1;switch(o||(i=!0),o&&(o._btnCom||t.getComponent(cc.Button)||(i=!0)),i&&(e.selectedMode=s.NONE),(o=t.getComponent(cc.Widget))&&o.enabled&&(e._needUpdateWidget=!0),e.selectedMode==s.MULT&&(e.multSelected=[]),e._align){case cc.Layout.Type.HORIZONTAL:e._colLineNum=1,e._sizeType=!1;break;case cc.Layout.Type.VERTICAL:e._colLineNum=1,e._sizeType=!0;break;case cc.Layout.Type.GRID:switch(e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var n=e.content.width-e._leftGap-e._rightGap;e._colLineNum=Math.floor((n+e._columnGap)/(e._itemSize.width+e._columnGap)),e._sizeType=!0;break;case cc.Layout.AxisDirection.VERTICAL:var a=e.content.height-e._topGap-e._bottomGap;e._colLineNum=Math.floor((a+e._lineGap)/(e._itemSize.height+e._lineGap)),e._sizeType=!1}}}},e.prototype.checkInited=function(t){return void 0===t&&(t=!0),!!this._inited||(t&&cc.error("List initialization not completed!"),!1)},e.prototype._resizeContent=function(){var t,e=this;switch(e._align){case cc.Layout.Type.HORIZONTAL:if(e._customSize){var o=e._getFixedSize(null);t=e._leftGap+o.val+e._itemSize.width*(e._numItems-o.count)+e._columnGap*(e._numItems-1)+e._rightGap}else t=e._leftGap+e._itemSize.width*e._numItems+e._columnGap*(e._numItems-1)+e._rightGap;break;case cc.Layout.Type.VERTICAL:e._customSize?(o=e._getFixedSize(null),t=e._topGap+o.val+e._itemSize.height*(e._numItems-o.count)+e._lineGap*(e._numItems-1)+e._bottomGap):t=e._topGap+e._itemSize.height*e._numItems+e._lineGap*(e._numItems-1)+e._bottomGap;break;case cc.Layout.Type.GRID:switch(e.lackCenter&&(e.lackCenter=!1),e._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:var i=Math.ceil(e._numItems/e._colLineNum);t=e._topGap+e._itemSize.height*i+e._lineGap*(i-1)+e._bottomGap;break;case cc.Layout.AxisDirection.VERTICAL:var n=Math.ceil(e._numItems/e._colLineNum);t=e._leftGap+e._itemSize.width*n+e._columnGap*(n-1)+e._rightGap}}var a=e.content.getComponent(cc.Layout);if(a&&(a.enabled=!1),e._allItemSize=t,e._allItemSizeNoEdge=e._allItemSize-(e._sizeType?e._topGap+e._bottomGap:e._leftGap+e._rightGap),e.cyclic){var r=e._sizeType?e.node.height:e.node.width;e._cyclicPos1=0,r-=e._cyclicPos1,e._cyclicNum=Math.ceil(r/e._allItemSizeNoEdge)+1;var c=e._sizeType?e._lineGap:e._columnGap;e._cyclicPos2=e._cyclicPos1+e._allItemSizeNoEdge+c,e._cyclicAllItemSize=e._allItemSize+e._allItemSizeNoEdge*(e._cyclicNum-1)+c*(e._cyclicNum-1),e._cycilcAllItemSizeNoEdge=e._allItemSizeNoEdge*e._cyclicNum,e._cycilcAllItemSizeNoEdge+=c*(e._cyclicNum-1)}e._lack=!e.cyclic&&e._allItemSize<(e._sizeType?e.node.height:e.node.width);var s=e._lack&&e.lackCenter||!e.lackSlide?.1:0,l=e._lack?(e._sizeType?e.node.height:e.node.width)-s:e.cyclic?e._cyclicAllItemSize:e._allItemSize;l<0&&(l=0),e._sizeType?e.content.height=l:e.content.width=l},e.prototype._onScrolling=function(t){if(void 0===t&&(t=null),null==this.frameCount&&(this.frameCount=this._updateRate),!this._forceUpdate&&t&&"scroll-ended"!=t.type&&this.frameCount>0)this.frameCount--;else if(this.frameCount=this._updateRate,!this._aniDelRuning){if(this.cyclic){var e=this.content.getPosition();e=this._sizeType?e.y:e.x;var o=this._allItemSizeNoEdge+(this._sizeType?this._lineGap:this._columnGap),i=this._sizeType?cc.v2(0,o):cc.v2(o,0);switch(this._alignCalcType){case 1:e>-this._cyclicPos1?(this.content.x=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.x=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)));break;case 2:e<this._cyclicPos1?(this.content.x=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.x=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 3:e<this._cyclicPos1?(this.content.y=this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i))):e>this._cyclicPos2&&(this.content.y=this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i)));break;case 4:e>-this._cyclicPos1?(this.content.y=-this._cyclicPos2,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.sub(i))):e<-this._cyclicPos2&&(this.content.y=-this._cyclicPos1,this._scrollView.isAutoScrolling()&&(this._scrollView._autoScrollStartPosition=this._scrollView._autoScrollStartPosition.add(i)))}}var n,a,r,c;if(this._calcViewPos(),this._sizeType?(n=this.viewTop,r=this.viewBottom):(a=this.viewRight,c=this.viewLeft),this._virtual){this.displayData=[];var s=void 0,l=0,d=this._numItems-1;if(this._customSize)for(var u=!1;l<=d&&!u;l++)switch(s=this._calcItemPos(l),this._align){case cc.Layout.Type.HORIZONTAL:s.right>=c&&s.left<=a?this.displayData.push(s):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.Type.VERTICAL:s.bottom<=n&&s.top>=r?this.displayData.push(s):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.Type.GRID:switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:s.bottom<=n&&s.top>=r?this.displayData.push(s):0!=l&&this.displayData.length>0&&(u=!0);break;case cc.Layout.AxisDirection.VERTICAL:s.right>=c&&s.left<=a?this.displayData.push(s):0!=l&&this.displayData.length>0&&(u=!0)}}else{var p=this._itemSize.width+this._columnGap,h=this._itemSize.height+this._lineGap;switch(this._alignCalcType){case 1:l=(c+this._leftGap)/p,d=(a+this._rightGap)/p;break;case 2:l=(-a-this._rightGap)/p,d=(-c-this._leftGap)/p;break;case 3:l=(-n-this._topGap)/h,d=(-r-this._bottomGap)/h;break;case 4:l=(r+this._bottomGap)/h,d=(n+this._topGap)/h}for(l=Math.floor(l)*this._colLineNum,d=Math.ceil(d)*this._colLineNum,l<0&&(l=0),--d>=this._numItems&&(d=this._numItems-1);l<=d;l++)this.displayData.push(this._calcItemPos(l))}if(this.displayData.length<=0||!this._numItems)return this._lastDisplayData=[],void this._delRedundantItem();this.firstListId=this.displayData[0].id,this.displayItemNum=this.displayData.length;var f=this._lastDisplayData.length;if(this._forceUpdate||this.displayItemNum!=f||this.firstListId!=this._lastDisplayData[0]||this.displayData[this.displayItemNum-1].id!=this._lastDisplayData[f-1])if(this._lastDisplayData=[],this.frameByFrameRenderNum>0)this._numItems>0?(this._updateDone?this._updateCounter=0:this._doneAfterUpdate=!0,this._updateDone=!1):(this._delRedundantItem(),this._updateCounter=0,this._updateDone=!0);else{for(var m=0;m<this.displayItemNum;m++)this._createOrUpdateItem(this.displayData[m]);this._delRedundantItem(),this._forceUpdate=!1}this._calcNearestItem()}}},e.prototype._calcViewPos=function(){var t=this.content.getPosition();switch(this._alignCalcType){case 1:this.elasticLeft=t.x>0?t.x:0,this.viewLeft=(t.x<0?-t.x:0)-this.elasticLeft,this.viewRight=this.viewLeft+this.node.width,this.elasticRight=this.viewRight>this.content.width?Math.abs(this.viewRight-this.content.width):0,this.viewRight+=this.elasticRight;break;case 2:this.elasticRight=t.x<0?-t.x:0,this.viewRight=(t.x>0?-t.x:0)+this.elasticRight,this.viewLeft=this.viewRight-this.node.width,this.elasticLeft=this.viewLeft<-this.content.width?Math.abs(this.viewLeft+this.content.width):0,this.viewLeft-=this.elasticLeft;break;case 3:this.elasticTop=t.y<0?Math.abs(t.y):0,this.viewTop=(t.y>0?-t.y:0)+this.elasticTop,this.viewBottom=this.viewTop-this.node.height,this.elasticBottom=this.viewBottom<-this.content.height?Math.abs(this.viewBottom+this.content.height):0,this.viewBottom+=this.elasticBottom;break;case 4:this.elasticBottom=t.y>0?Math.abs(t.y):0,this.viewBottom=(t.y<0?-t.y:0)-this.elasticBottom,this.viewTop=this.viewBottom+this.node.height,this.elasticTop=this.viewTop>this.content.height?Math.abs(this.viewTop-this.content.height):0,this.viewTop-=this.elasticTop}},e.prototype._calcItemPos=function(t){var e,o,i,n,a,r,c,s;switch(this._align){case cc.Layout.Type.HORIZONTAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:if(this._customSize){var l=this._getFixedSize(t);a=this._leftGap+(this._itemSize.width+this._columnGap)*(t-l.count)+(l.val+this._columnGap*l.count),e=(d=this._customSize[t])>0?d:this._itemSize.width}else a=this._leftGap+(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width;return r=a+e,this.lackCenter&&(a+=u=this.content.width/2-this._allItemSizeNoEdge/2,r+=u),{id:t,left:a,right:r,x:a+this._itemTmp.anchorX*e,y:this._itemTmp.y};case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:return this._customSize?(l=this._getFixedSize(t),r=-this._rightGap-(this._itemSize.width+this._columnGap)*(t-l.count)-(l.val+this._columnGap*l.count),e=(d=this._customSize[t])>0?d:this._itemSize.width):(r=-this._rightGap-(this._itemSize.width+this._columnGap)*t,e=this._itemSize.width),a=r-e,this.lackCenter&&(a-=u=this.content.width/2-this._allItemSizeNoEdge/2,r-=u),{id:t,right:r,left:a,x:a+this._itemTmp.anchorX*e,y:this._itemTmp.y}}break;case cc.Layout.Type.VERTICAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:return this._customSize?(l=this._getFixedSize(t),i=-this._topGap-(this._itemSize.height+this._lineGap)*(t-l.count)-(l.val+this._lineGap*l.count),o=(d=this._customSize[t])>0?d:this._itemSize.height):(i=-this._topGap-(this._itemSize.height+this._lineGap)*t,o=this._itemSize.height),n=i-o,this.lackCenter&&(i-=u=this.content.height/2-this._allItemSizeNoEdge/2,n-=u),{id:t,top:i,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*o};case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:var d,u;if(this._customSize)l=this._getFixedSize(t),n=this._bottomGap+(this._itemSize.height+this._lineGap)*(t-l.count)+(l.val+this._lineGap*l.count),o=(d=this._customSize[t])>0?d:this._itemSize.height;else n=this._bottomGap+(this._itemSize.height+this._lineGap)*t,o=this._itemSize.height;return i=n+o,this.lackCenter&&(i+=u=this.content.height/2-this._allItemSizeNoEdge/2,n+=u),{id:t,top:i,bottom:n,x:this._itemTmp.x,y:n+this._itemTmp.anchorY*o}}case cc.Layout.Type.GRID:var p=Math.floor(t/this._colLineNum);switch(this._startAxis){case cc.Layout.AxisDirection.HORIZONTAL:switch(this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:s=(n=(i=-this._topGap-(this._itemSize.height+this._lineGap)*p)-this._itemSize.height)+this._itemTmp.anchorY*this._itemSize.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:i=(n=this._bottomGap+(this._itemSize.height+this._lineGap)*p)+this._itemSize.height,s=n+this._itemTmp.anchorY*this._itemSize.height}switch(c=this._leftGap+t%this._colLineNum*(this._itemSize.width+this._columnGap),this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:c+=this._itemTmp.anchorX*this._itemSize.width,c-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:c+=(1-this._itemTmp.anchorX)*this._itemSize.width,c-=(1-this.content.anchorX)*this.content.width,c*=-1}return{id:t,top:i,bottom:n,x:c,y:s};case cc.Layout.AxisDirection.VERTICAL:switch(this._horizontalDir){case cc.Layout.HorizontalDirection.LEFT_TO_RIGHT:r=(a=this._leftGap+(this._itemSize.width+this._columnGap)*p)+this._itemSize.width,c=a+this._itemTmp.anchorX*this._itemSize.width,c-=this.content.anchorX*this.content.width;break;case cc.Layout.HorizontalDirection.RIGHT_TO_LEFT:c=(a=(r=-this._rightGap-(this._itemSize.width+this._columnGap)*p)-this._itemSize.width)+this._itemTmp.anchorX*this._itemSize.width,c+=(1-this.content.anchorX)*this.content.width}switch(s=-this._topGap-t%this._colLineNum*(this._itemSize.height+this._lineGap),this._verticalDir){case cc.Layout.VerticalDirection.TOP_TO_BOTTOM:s-=(1-this._itemTmp.anchorY)*this._itemSize.height,s+=(1-this.content.anchorY)*this.content.height;break;case cc.Layout.VerticalDirection.BOTTOM_TO_TOP:s-=this._itemTmp.anchorY*this._itemSize.height,s+=this.content.anchorY*this.content.height,s*=-1}return{id:t,left:a,right:r,x:c,y:s}}}},e.prototype._calcExistItemPos=function(t){var e=this.getItemByListId(t);if(!e)return null;var o={id:t,x:e.x,y:e.y};return this._sizeType?(o.top=e.y+e.height*(1-e.anchorY),o.bottom=e.y-e.height*e.anchorY):(o.left=e.x-e.width*e.anchorX,o.right=e.x+e.width*(1-e.anchorX)),o},e.prototype.getItemPos=function(t){return this._virtual?this._calcItemPos(t):this.frameByFrameRenderNum?this._calcItemPos(t):this._calcExistItemPos(t)},e.prototype._getFixedSize=function(t){if(!this._customSize)return null;null==t&&(t=this._numItems);var e=0,o=0;for(var i in this._customSize)parseInt(i)<t&&(e+=this._customSize[i],o++);return{val:e,count:o}},e.prototype._onScrollBegan=function(){this._beganPos=this._sizeType?this.viewTop:this.viewLeft},e.prototype._onScrollEnded=function(){var t=this;if(null!=t.scrollToListId){var e=t.getItemByListId(t.scrollToListId);t.scrollToListId=null,e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.06),cc.scaleTo(.1,1)))}t._onScrolling(),t._slideMode!=c.ADHERING||t.adhering?t._slideMode==c.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()):t.adhere()},e.prototype._onTouchStart=function(t,e){if(!this._scrollView._hasNestedViewGroup(t,e)&&(t.eventPhase!==cc.Event.AT_TARGET||t.target!==this.node)){for(var o=t.target;null==o._listId&&o.parent;)o=o.parent;this._scrollItem=null!=o._listId?o:t.target}},e.prototype._onTouchUp=function(){var t=this;t._scrollPos=null,t._slideMode==c.ADHERING?(this.adhering&&(this._adheringBarrier=!0),t.adhere()):t._slideMode==c.PAGE&&(null!=t._beganPos?this._pageAdhere():t.adhere()),this._scrollItem=null},e.prototype._onTouchCancelled=function(t,e){var o=this;o._scrollView._hasNestedViewGroup(t,e)||t.simulate||(o._scrollPos=null,o._slideMode==c.ADHERING?(o.adhering&&(o._adheringBarrier=!0),o.adhere()):o._slideMode==c.PAGE&&(null!=o._beganPos?o._pageAdhere():o.adhere()),this._scrollItem=null)},e.prototype._onSizeChanged=function(){this.checkInited(!1)&&this._onScrolling()},e.prototype._onItemAdaptive=function(t){var e=this;if(this.checkInited(!1)&&(!this._sizeType&&t.width!=this._itemSize.width||this._sizeType&&t.height!=this._itemSize.height)){this._customSize||(this._customSize={});var o=this._sizeType?t.height:t.width;this._customSize[t._listId]!=o&&(this._customSize[t._listId]=o,this._resizeContent(),this.content.children.forEach(function(t){e._updateItemPos(t)}),isNaN(this._scrollToListId)||(this._scrollPos=null,this.unschedule(this._scrollToSo),this.scrollTo(this._scrollToListId,Math.max(0,this._scrollToEndTime-(new Date).getTime()/1e3))))}},e.prototype._pageAdhere=function(){var t=this;if(t.cyclic||!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){var e=t._sizeType?t.viewTop:t.viewLeft,o=(t._sizeType?t.node.height:t.node.width)*t.pageDistance;if(Math.abs(t._beganPos-e)>o)switch(t._alignCalcType){case 1:case 4:t._beganPos>e?t.prePage(.5):t.nextPage(.5);break;case 2:case 3:t._beganPos<e?t.prePage(.5):t.nextPage(.5)}else t.elasticTop<=0&&t.elasticRight<=0&&t.elasticBottom<=0&&t.elasticLeft<=0&&t.adhere();t._beganPos=null}},e.prototype.adhere=function(){var t=this;if(t.checkInited()&&!(t.elasticTop>0||t.elasticRight>0||t.elasticBottom>0||t.elasticLeft>0)){t.adhering=!0,t._calcNearestItem();var e=(t._sizeType?t._topGap:t._leftGap)/(t._sizeType?t.node.height:t.node.width);t.scrollTo(t.nearestListId,.7,e)}},e.prototype.update=function(){if(!(this.frameByFrameRenderNum<=0||this._updateDone))if(this._virtual){for(var t=this._updateCounter+this.frameByFrameRenderNum>this.displayItemNum?this.displayItemNum:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++){var o=this.displayData[e];o&&this._createOrUpdateItem(o)}this._updateCounter>=this.displayItemNum-1?this._doneAfterUpdate?(this._updateCounter=0,this._updateDone=!1,this._scrollView.isScrolling()||(this._doneAfterUpdate=!1)):(this._updateDone=!0,this._delRedundantItem(),this._forceUpdate=!1,this._calcNearestItem(),this.slideMode==c.PAGE&&(this.curPageNum=this.nearestListId)):this._updateCounter+=this.frameByFrameRenderNum}else if(this._updateCounter<this._numItems){for(t=this._updateCounter+this.frameByFrameRenderNum>this._numItems?this._numItems:this._updateCounter+this.frameByFrameRenderNum,e=this._updateCounter;e<t;e++)this._createOrUpdateItem2(e);this._updateCounter+=this.frameByFrameRenderNum}else this._updateDone=!0,this._calcNearestItem(),this.slideMode==c.PAGE&&(this.curPageNum=this.nearestListId)},e.prototype._createOrUpdateItem=function(t){var e=this.getItemByListId(t.id);if(e)this._forceUpdate&&this.renderEvent&&(e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems));else{var o=this._pool.size()>0;if((e=o?this._pool.get():cc.instantiate(this._itemTmp))._listId!=t.id&&(e._listId=t.id,e.setContentSize(this._itemSize)),e.setPosition(cc.v2(t.x,t.y)),this._resetItemSize(e),this.content.addChild(e),o&&this._needUpdateWidget){var i=e.getComponent(cc.Widget);i&&i.updateAlignment()}e.setSiblingIndex(this.content.childrenCount-1);var n=e.getComponent(y.default);e.listItem=n,n&&(n.listId=t.id,n.list=this,n._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],e,t.id%this._actualNumItems)}this._resetItemSize(e),this._updateListItem(e.listItem),this._lastDisplayData.indexOf(t.id)<0&&this._lastDisplayData.push(t.id)},e.prototype._createOrUpdateItem2=function(t){var e,o=this.content.children[t];o?this._forceUpdate&&this.renderEvent&&(o._listId=t,e&&(e.listId=t),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,t)):((o=cc.instantiate(this._itemTmp))._listId=t,this.content.addChild(o),e=o.getComponent(y.default),o.listItem=e,e&&(e.listId=t,e.list=this,e._registerEvent()),this.renderEvent&&cc.Component.EventHandler.emitEvents([this.renderEvent],o,t)),this._updateListItem(e),this._lastDisplayData.indexOf(t)<0&&this._lastDisplayData.push(t)},e.prototype._updateListItem=function(t){if(t&&this.selectedMode>s.NONE)switch(this.selectedMode){case s.SINGLE:t.selected=this.selectedId==t.node._listId;break;case s.MULT:t.selected=this.multSelected.indexOf(t.node._listId)>=0}},e.prototype._resetItemSize=function(){},e.prototype._updateItemPos=function(t){var e=isNaN(t)?t:this.getItemByListId(t),o=this.getItemPos(e._listId);e.setPosition(o.x,o.y)},e.prototype.setMultSelected=function(t,e){var o=this;if(o.checkInited()){if(Array.isArray(t)||(t=[t]),null==e)o.multSelected=t;else{var i=void 0,n=void 0;if(e)for(var a=t.length-1;a>=0;a--)i=t[a],(n=o.multSelected.indexOf(i))<0&&o.multSelected.push(i);else for(a=t.length-1;a>=0;a--)i=t[a],(n=o.multSelected.indexOf(i))>=0&&o.multSelected.splice(n,1)}o._forceUpdate=!0,o._onScrolling()}},e.prototype.updateItem=function(t){if(this.checkInited()){Array.isArray(t)||(t=[t]);for(var e=0,o=t.length;e<o;e++){var i=t[e],n=this.getItemByListId(i);n&&cc.Component.EventHandler.emitEvents([this.renderEvent],n,i%this._actualNumItems)}}},e.prototype.updateAll=function(){this.checkInited()&&(this.numItems=this.numItems)},e.prototype.getItemByListId=function(t){for(var e=this.content.childrenCount-1;e>=0;e--)if(this.content.children[e]._listId==t)return this.content.children[e]},e.prototype._getOutsideItem=function(){for(var t,e,o=[],i=this.content.childrenCount-1;i>=0;i--){if(t=this.content.children[i],e=!0)for(var n=this.displayItemNum-1;n>=0;n--)if(this.displayData[n]){var a=this.displayData[n].id;if(t._listId==a){e=!1;break}}e&&o.push(t)}return o},e.prototype._delRedundantItem=function(){if(this._virtual)for(var t=this._getOutsideItem(),e=t.length-1;e>=0;e--){var o=t[e];this._scrollItem&&o._listId==this._scrollItem._listId||this._pool.put(o)}else for(;this.content.childrenCount>this._numItems;)this._delSingleItem(this.content.children[this.content.childrenCount-1])},e.prototype._delSingleItem=function(t){t.removeFromParent(),t.destroy&&t.destroy(),t=null},e.prototype.aniDelItem=function(t,e,o){var i=this;if(!i.checkInited()||i.cyclic||!i._virtual)return cc.error("This function is not allowed to be called!");if(i._aniDelRuning)return cc.warn("Please wait for the current deletion to finish!");var n,a=i.getItemByListId(t);if(a){n=a.getComponent(y.default),i._aniDelRuning=!0;var r=i.displayData[i.displayData.length-1].id,c=n.selected;n.showAni(o,function(){var o,n,l;if(r<i._numItems-2&&(o=r+1),null!=o){var d=i._calcItemPos(o);i.displayData.push(d),i._virtual?i._createOrUpdateItem(d):i._createOrUpdateItem2(o)}else i._numItems--;if(i.selectedMode==s.SINGLE)c?i._selectedId=-1:i._selectedId-1>=0&&i._selectedId--;else if(i.selectedMode==s.MULT&&i.multSelected.length){var u=i.multSelected.indexOf(t);u>=0&&i.multSelected.splice(u,1);for(var p=i.multSelected.length-1;p>=0;p--)(m=i.multSelected[p])>=t&&i.multSelected[p]--}if(i._customSize){i._customSize[t]&&delete i._customSize[t];var h={},f=void 0;for(var m in i._customSize){f=i._customSize[m];var y=parseInt(m);h[y-(y>=t?1:0)]=f}i._customSize=h}for(p=null!=o?o:r;p>=t+1;p--)if(a=i.getItemByListId(p)){var g=i._calcItemPos(p-1);n=[cc.moveTo(.2333,cc.v2(g.x,g.y))],p<=t+1&&(l=!0,n.push(cc.callFunc(function(){i._aniDelRuning=!1,e(t)}))),n.length>1?a.runAction(cc.sequence(n)):a.runAction(n[0])}l||(i._aniDelRuning=!1,e(t))},!0)}else e(t)},e.prototype.scrollTo=function(t,e,o,i){void 0===e&&(e=.5),void 0===o&&(o=null),void 0===i&&(i=!1);var n=this;if(n.checkInited(!1)){null==e?e=.5:e<0&&(e=0),t<0?t=0:t>=n._numItems&&(t=n._numItems-1),!n._virtual&&n._layout&&n._layout.enabled&&n._layout.updateLayout();var a,r,c=n.getItemPos(t);switch(n._alignCalcType){case 1:a=c.left,a-=null!=o?n.node.width*o:n._leftGap,c=cc.v2(a,0);break;case 2:a=c.right-n.node.width,a+=null!=o?n.node.width*o:n._rightGap,c=cc.v2(a+n.content.width,0);break;case 3:r=c.top,r+=null!=o?n.node.height*o:n._topGap,c=cc.v2(0,-r);break;case 4:r=c.bottom+n.node.height,r-=null!=o?n.node.height*o:n._bottomGap,c=cc.v2(0,-r+n.content.height)}var s=n.content.getPosition();s=Math.abs(n._sizeType?s.y:s.x);var l=n._sizeType?c.y:c.x;Math.abs((null!=n._scrollPos?n._scrollPos:s)-l)>.5&&(n._scrollView.scrollToOffset(c,e),n._scrollToListId=t,n._scrollToEndTime=(new Date).getTime()/1e3+e,n._scrollToSo=n.scheduleOnce(function(){if(n._adheringBarrier||(n.adhering=n._adheringBarrier=!1),n._scrollPos=n._scrollToListId=n._scrollToEndTime=n._scrollToSo=null,i){var e=n.getItemByListId(t);e&&e.runAction(cc.sequence(cc.scaleTo(.1,1.05),cc.scaleTo(.1,1)))}},e+.1),e<=0&&n._onScrolling())}},e.prototype._calcNearestItem=function(){var t,e,o,i,n,a,r=this;r.nearestListId=null,r._virtual&&r._calcViewPos(),o=r.viewTop,i=r.viewRight,n=r.viewBottom,a=r.viewLeft;for(var c=!1,s=0;s<r.content.childrenCount&&!c;s+=r._colLineNum)switch(t=r._virtual?r.displayData[s]:r._calcExistItemPos(s),e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:t.right>=a&&(r.nearestListId=t.id,a>e&&(r.nearestListId+=r._colLineNum),c=!0);break;case 2:t.left<=i&&(r.nearestListId=t.id,i<e&&(r.nearestListId+=r._colLineNum),c=!0);break;case 3:t.bottom<=o&&(r.nearestListId=t.id,o<e&&(r.nearestListId+=r._colLineNum),c=!0);break;case 4:t.top>=n&&(r.nearestListId=t.id,n>e&&(r.nearestListId+=r._colLineNum),c=!0)}if((t=r._virtual?r.displayData[r.displayItemNum-1]:r._calcExistItemPos(r._numItems-1))&&t.id==r._numItems-1)switch(e=r._sizeType?(t.top+t.bottom)/2:e=(t.left+t.right)/2,r._alignCalcType){case 1:i>e&&(r.nearestListId=t.id);break;case 2:a<e&&(r.nearestListId=t.id);break;case 3:n<e&&(r.nearestListId=t.id);break;case 4:o>e&&(r.nearestListId=t.id)}},e.prototype.prePage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum-1,t)},e.prototype.nextPage=function(t){void 0===t&&(t=.5),this.checkInited()&&this.skipPage(this.curPageNum+1,t)},e.prototype.skipPage=function(t,e){var o=this;if(o.checkInited())return o._slideMode!=c.PAGE?cc.error("This function is not allowed to be called, Must SlideMode = PAGE!"):void(t<0||t>=o._numItems||o.curPageNum!=t&&(o.curPageNum=t,o.pageChangeEvent&&cc.Component.EventHandler.emitEvents([o.pageChangeEvent],t),o.scrollTo(t,e)))},e.prototype.calcCustomSize=function(t){var e=this;if(e.checkInited()){if(!e._itemTmp)return cc.error("Unset template item!");if(!e.renderEvent)return cc.error("Unset Render-Event!");e._customSize={};var o=cc.instantiate(e._itemTmp);e.content.addChild(o);for(var i=0;i<t;i++)cc.Component.EventHandler.emitEvents([e.renderEvent],o,i),o.height==e._itemSize.height&&o.width==e._itemSize.width||(e._customSize[i]=e._sizeType?o.height:o.width);return Object.keys(e._customSize).length||(e._customSize=null),o.removeFromParent(),o.destroy&&o.destroy(),e._customSize}},a([u({type:cc.Enum(r),tooltip:!1})],e.prototype,"templateType",void 0),a([u({type:cc.Node,tooltip:!1,visible:function(){return this.templateType==r.NODE}})],e.prototype,"tmpNode",void 0),a([u({type:cc.Prefab,tooltip:!1,visible:function(){return this.templateType==r.PREFAB}})],e.prototype,"tmpPrefab",void 0),a([u()],e.prototype,"_slideMode",void 0),a([u({type:cc.Enum(c),tooltip:!1})],e.prototype,"slideMode",null),a([u({type:cc.Float,range:[0,1,.1],tooltip:!1,slide:!0,visible:function(){return this._slideMode==c.PAGE}})],e.prototype,"pageDistance",void 0),a([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this._slideMode==c.PAGE}})],e.prototype,"pageChangeEvent",void 0),a([u()],e.prototype,"_virtual",void 0),a([u({type:cc.Boolean,tooltip:!1})],e.prototype,"virtual",null),a([u({tooltip:!1,visible:function(){var t=this.virtual&&this.slideMode==c.NORMAL;return t||(this.cyclic=!1),t}})],e.prototype,"cyclic",void 0),a([u({tooltip:!1,visible:function(){return this.virtual}})],e.prototype,"lackCenter",void 0),a([u({tooltip:!1,visible:function(){var t=this.virtual&&!this.lackCenter;return t||(this.lackSlide=!1),t}})],e.prototype,"lackSlide",void 0),a([u({type:cc.Integer})],e.prototype,"_updateRate",void 0),a([u({type:cc.Integer,range:[0,6,1],tooltip:!1,slide:!0})],e.prototype,"updateRate",null),a([u({type:cc.Integer,range:[0,12,1],tooltip:!1,slide:!0})],e.prototype,"frameByFrameRenderNum",void 0),a([u({type:cc.Component.EventHandler,tooltip:!1})],e.prototype,"renderEvent",void 0),a([u({type:cc.Enum(s),tooltip:!1})],e.prototype,"selectedMode",void 0),a([u({tooltip:!1,visible:function(){return this.selectedMode==s.SINGLE}})],e.prototype,"repeatEventSingle",void 0),a([u({type:cc.Component.EventHandler,tooltip:!1,visible:function(){return this.selectedMode>s.NONE}})],e.prototype,"selectedEvent",void 0),a([u({serializable:!1})],e.prototype,"_numItems",void 0),a([d,p(),h("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/List"),m(cc.ScrollView),f(-5e3)],e)}(cc.Component);o.default=g,cc._RF.pop()},{"./ListItem":"ListItem"}],LoseView:[function(t,e,o){"use strict";cc._RF.push(e,"1b42cqE+c5JbpmXWvbORGYE","LoseView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/prefab/AwardButton"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../../Script/center/Game"),l=t("../../manage/GameManage"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.videoBtn=null,e.circle=null,e.timeLabel=null,e.player=null,e.isPause=!1,e.times=0,e}return n(e,t),e.prototype.onEnable=function(){},e.prototype.doStart=function(){this.timeLabel.string="5",this.circle.getComponent(cc.Animation).play(),this.times=0,this.schedule(this.turnTime,1)},e.prototype.turnTime=function(){var t=this;this.isPause||(this.circle.getComponent(cc.Animation).play(),s.default.gameAudio.playGameOverTimeClip(),++this.times<5&&(this.timeLabel.string=5-this.times+""),5==this.times&&(this.unschedule(this.turnTime),this.scheduleOnce(function(){t.hidePnl(),l.default.getInstance().endGame()},.1)))},e.prototype.onDisable=function(){this.unscheduleAllCallbacks()},e.prototype.onClickVideo=function(t){l.default.getInstance().pause(),t.target.getComponent(r.default).onClick(t)},e.prototype.videoCallback=function(){l.default.getInstance().resume(),this.callback()},e.prototype.videoFialCallback=function(){l.default.getInstance().resume()},e.prototype.onClickShare=function(){this&&this.callback()},e.prototype.onClickRestart=function(){c.default.totalDiamondNum>=30?(c.default.totalDiamondNum-=30,this.player&&this.player.restart(),this.hidePnl()):s.default.showToast("\u94bb\u77f3\u4e0d\u8db3")},e.prototype.onClickClose=function(){this.hidePnl(),l.default.getInstance().endGame()},e.prototype.changeBtn=function(){},e.prototype.start=function(){},e.prototype.callback=function(){var t=l.default.getInstance();this.player&&(t.restartcount++,this.player.restart(),this.player.model.ATK*=2),t.gameView.pet&&(t.gameView.pet.isDead=!1,t.gameView.pet.isStop=!1,t.gameView.pet.isStart=!0),this.hidePnl()},e.prototype.hidePnl=function(){var t=l.default.getInstance();cc.log(" gameManage.restartcount++",t.restartcount),this.unscheduleAllCallbacks(),this.node&&(this.node.active=!1),l.default.getInstance().checkGame(),s.default.uiCenter.closeUI(this.node)},a([p(cc.Button)],e.prototype,"videoBtn",void 0),a([p(cc.Node)],e.prototype,"circle",void 0),a([p(cc.Label)],e.prototype,"timeLabel",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../../Script/center/Game":"Game","../../manage/GameManage":"GameManage"}],MainPersonView:[function(t,e,o){"use strict";cc._RF.push(e,"467dbg4+qhD/qztf6/aoA8k","MainPersonView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../../InitScene/Script/data/GuanqiaModel"),s=t("../../../../../InitScene/Script/data/MountModel"),l=t("../../../center/Game"),d=t("../../cultivate/GetCultivateNode"),u=t("./PersonView"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=null,e.timeLabel=null,e.getButton=null,e}return n(e,t),e.prototype.say=function(t){this.unschedule(this.showDialog1),this.setDescLabel1(t),this.schedule(this.showDialog1.bind(this,null),8)},e.prototype.showDialog1=function(t){var e=this;this.dialog&&(this.dialog.active=!0),this.dialog&&this.dialog.getComponent(cc.Animation).play(),this.dialog&&this.dialog.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){e.dialog.active=!1,t&&t()})},e.prototype.setDescLabel1=function(t){this.descLabel&&(this.descLabel.string=t)},e.prototype.loadMount=function(){var t=s.default.useMountId;if(s.default.getMountDataById(0).isUnlock){if(this.time.active=!1,this.getButton.active=!1,-1==s.default.useMountId)return this.heroSke.node.parent=this.dragonSke.node.parent,this.heroSke.node.x=0,this.heroSke.node.scaleX=1,this.dragonSke.skeletonData=null,void(this.dragonSke.node.active=!1);this.heroSke.node.x=60,this.dragonSke.node.active=!0}else t=0,this.heroSke.node.x=60,this.dragonSke.node.active=!0,s.default.isCanGainWolf()?this.getButton.active=!0:(this.getButton.active=!1,this.time.active=!0,this.setDescLabel1("\u518d\u83b7\u80dc"+(2-c.default.guanqiaData.id)+"\u573a\uff0c\u7acb\u5373\u83b7\u5f97\u6211"),this.schedule(this.setTime,1));var e=this;return new Promise(function(o){var i=s.default.getMountDataById(t);e.scheduleOnce(function(){r.default.addLoadingAssetNode(e.dragonSke.node).loadAsset(s.default.getMountSkeUrl(i.id,i.level),sp.SkeletonData,function(t,i){e.petIdx=s.default.useMountId,e.scheduleOnce(function(){e.dragonSke.skeletonData=i,e.dragonSke.animation="daiji"}),o()})})})},e.prototype.setTime=function(){this.dialog&&(this.dialog.active=!0),this.timeLabel.string="\u9886\u53d6\u5012\u8ba1\u65f6"+this.timeToStr(s.default.timeWolf()),s.default.isCanGainWolf()&&(this.getButton.active=!0,this.unschedule(this.setTime),this.time.active=!1,this.dialog&&(this.dialog.active=!1))},e.prototype.getWolf=function(){var t=s.default.getMountDataById(0);t.onUnlock(),s.default.useMountId=t.id,l.default.uiCenter.showUi("GetCultivateNode").getComponent(d.default).setData("mount",s.default.getMountSkeUrl(t.id,0),"\u5f85\u673a",t.award,!0)},e.prototype.timeToStr=function(t){var e="",o=Math.floor(t/60/60),i=Math.floor((t-3600*o)/60),n=t-3600*o-60*i;return e=o<10?"0"+o+":":o+":",(e+=i<10?"0"+i+":":i+":")+(n<10?"0"+n:n)},e.prototype.update=function(){},a([f(cc.Node)],e.prototype,"time",void 0),a([f(cc.Label)],e.prototype,"timeLabel",void 0),a([f(cc.Node)],e.prototype,"getButton",void 0),a([h],e)}(u.default);o.default=m,cc._RF.pop()},{"../../../../../InitScene/Script/data/GuanqiaModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../center/Game":"Game","../../cultivate/GetCultivateNode":"GetCultivateNode","./PersonView":"PersonView"}],MainUI:[function(t,e,o){"use strict";cc._RF.push(e,"2c87c5d5l1MHbV/kajRPLCh","MainUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../center/Game"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../prefabs/view/BoxView"),l=t("../prefabs/BuyItem"),d=t("../../../../Script/base/Utils"),u=t("../../../../InitScene/Script/center/GameInit"),p=t("../prefabs/view/ItemView"),h=t("../prefabs/view/PersonView"),f=t("../prefabs/view/BgView"),m=t("../prefabs/view/EquipBoxView"),y=t("../prefabs/getGun/GetGun"),g=t("../../../../InitScene/Script/data/GunModel"),v=t("../../../../InitScene/Script/data/PersonModel"),_=t("../cultivate/CultivateNode"),S=t("../try/TryMoreNode"),b=t("../../../../InitScene/Script/data/GuideModel"),w=t("../../../../InitScene/Script/data/MountModel"),I=t("../../../../framework/Script/sdk/statistics"),M=t("../../../../framework/Script/cemter/SceneCenter"),k=t("../try/TryNode"),N=t("../mapMountNode/GetMapMountNode"),T=t("../../../GameScene/view/base/BaseView"),O=t("../../../GameScene/manage/GameManage"),C=t("../mapMountNode/MapMountNode"),P=t("../../../../InitScene/Script/data/BadgeModel"),A=t("../UpdateGunNode/UpdateGunNode"),D=t("../try/NewBieTryMoreNode"),L=cc._decorator,G=L.ccclass,x=L.property,R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tempBox=null,e.tempItem=null,e.tempEquip=null,e.layout=null,e.air=null,e.top=null,e.bottom=null,e.profitLabel=null,e.combineSkeleton=null,e.startBtn=null,e.delBtn=null,e.buyItem=null,e.personView=null,e.bgView=null,e.getGunPrefab=null,e.fingerNode=null,e.dwNode=null,e.xzNode=null,e.profitPool=new cc.NodePool,e.combinePool=new cc.NodePool,e.dwParentNode=null,e.xzParentNode=null,e.isMoveDw=!1,e.isMoveXz=!1,e.touchDwTime=0,e.touchXzTime=0,e.boxs=[],e.curItem=null,e.equips=[],e.combineCount=0,e.randCount=0,e.buyCount=0,e.queue=[],e}return n(e,t),e.prototype.onunopen=function(){r.default.showToast(r.default.gameConfig.gameString.tips)},e.prototype.onFuliUI=function(){r.default.uiCenter.showUi("FuliNode")},e.prototype.onHeroUI=function(){r.default.uiCenter.showUi("CultivateNode").getComponent(_.default).setData(_.CultivateType.Hero)},e.prototype.onMountUI=function(t){void 0===t&&(t=-1),-1==t&&(t=w.default.useMountId),r.default.uiCenter.showUi("CultivateNode").getComponent(_.default).setData(_.CultivateType.Mount,t)},e.prototype.onShopUI=function(){r.default.uiCenter.showUi("ShopNode")},e.prototype.onSignUI=function(){r.default.uiCenter.showUi("SignNode")},e.prototype.onTurnTableUI=function(){r.default.uiCenter.showUi("TurnTableNode")},e.prototype.onPostUI=function(){r.default.uiCenter.showUi("PostListNode")},e.prototype.onNoticeUI=function(){r.default.uiCenter.showUi("NoticeNode")},e.prototype.onMapUI=function(){r.default.uiCenter.showUi("MapListNode")},e.prototype.onOpenMapMountUI=function(t,e){e?r.default.uiCenter.showUi("MapMountNode").getComponent(C.default).init(e):r.default.uiCenter.showUi("MapMountNode")},e.prototype.onOpenMapDifficultNode=function(){r.default.uiCenter.showUi("DifficultGameNode")},e.prototype.onOpenDifficultLevelNode=function(){r.default.uiCenter.showUi("DifficultShowNode")},e.prototype.onOpenEgg=function(){r.default.uiCenter.showUi("ColorEggNode")},e.prototype.onGetMapMountUI=function(t){r.default.uiCenter.showUi("GetMapMountNode").getComponent(N.default).setData(t)},e.prototype.onOpenGameList=function(){r.default.uiCenter.showUi("GameListNode")},e.prototype.onChangeAvatarUI=function(){r.default.uiCenter.showUi("ChangeAvatarNode")},e.prototype.onLoad=function(){var t=this;r.default.mainUI=this,cc.sys.localStorage.getItem("game_data_LRCJ_isNewUser_EnterMainUI")||(cc.sys.localStorage.setItem("game_data_LRCJ_isNewUser_EnterMainUI",!0),I.default.setSceneEvent("EnterMainUI","\u8fdb\u5165\u4e3b\u754c\u9762","EnterMainUI")),g.default.on(g.GunEvent.AddNewGun,this.init,this),g.default.on(g.GunEvent.OpenAirdrop,this.addAirdropGun,this),r.default.event.on(c.GameDataEvent.SHOW_FINGER,this.showFinger,this),r.default.event.on(c.GameDataEvent.TRIAL_MOUNT,this.onTrialMount,this),r.default.event.on(c.GameDataEvent.PLAY_GAME,this.onClickPlay,this),this.scheduleOnce(function(){var e=t.layout.height/3-t.tempBox.height;cc.log("spacing",e,t.layout.height,t.tempBox.height),e>100?t.tempItem.getComponent(p.default).gunNode.scale=1:e>50&&(t.tempItem.getComponent(p.default).gunNode.scale=.9);for(var o=Math.floor(t.layout.width/t.tempBox.width),i=0;i<12;i++){var n=Math.floor(i/o),a=i%o,r=cc.instantiate(t.tempBox);r.parent=t.layout,r.x=a*t.tempBox.width+(t.tempBox.width/2-t.layout.width/2),r.y=-n*t.tempBox.height-t.tempBox.height/2-(e/2+n*e/2);var c=r.getComponent(s.default);c.idx=i,t.boxs.push(c)}t.init()})},e.prototype.onEnable=function(){var t=this;this.scheduleOnce(function(){var e=r.default.sceneCenter.getCustomData();cc.log(e,"MainUI"),e&&e.matchInfo.isShowCurrency&&(cc.log("MainUI,data.matchInfo",e.matchInfo),r.default.showCurrency(e.matchInfo.coin,e.matchInfo.diamond,e.matchInfo.bone)),e&&e.matchInfo.isOpenTurn&&(cc.log("isOpenTurn,data.matchInfo",e.matchInfo),t.onTurnTableUI()),e&&e.matchInfo.isOpenMountGame&&t.onOpenMapMountUI(null,e.matchInfo.mountID),e&&e.matchInfo.isOpenMount&&t.onMountUI(e.matchInfo.mountID),u.default.event.on(c.GameDataEvent.GET_MOUNT_SP,t.onGetMapMountUI,t),w.default.getMountDataById(0).isUnlock&&P.default.updateFarmBadge(1)},.1),r.default.event.on(c.GameDataEvent.MAP_SPACIAL,this.onClickPlaySpacial,this),r.default.event.on(c.GameDataEvent.MAP_MOUNT,this.onClickPlayMount,this),r.default.event.on(c.GameDataEvent.MAP_DIFFICULT,this.onClickDifficult,this),r.default.event.on(c.GameDataEvent.MAP_FARM,this.onClickPlayFarm,this),this.layout.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.layout.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.layout.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.layout.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),this.buyItem.refresh(),this.personView.init(),g.default.barViews.forEach(function(t){return t.refresh()}),this.curItem&&(this.curItem.box.appendItem(this.curItem),this.curItem=null)},e.prototype.onDisable=function(){this.layout.off(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.layout.off(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.layout.off(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.layout.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),this.curItem&&(this.curItem.box.appendItem(this.curItem),this.curItem=null)},e.prototype.onClickBuy=function(){if(c.default.totalCoinNum<this.buyItem.price)return r.default.showToast("\u91d1\u5e01\u4e0d\u8db3"),void r.default.uiCenter.showUi("FuliNode").once("onClose",function(){r.default.uiCenter.showUi("TryMoreNode").getComponent(S.default).setData("gun",null)},this);var t=this.boxs.filter(function(t){return null==t.item&&null==t.equip});if(0==t.length)return u.default.showToast("\u680f\u4f4d\u5df2\u6ee1");if(this.appendItem(this.buyItem.rank,t[0])){r.default.gameAudio.playBuy(),c.default.totalCoinNum-=this.buyItem.price,g.default.getGunDataById(this.buyItem.rank).onBuy(),this.buyItem.refresh(),this.updateMatrix(),g.default.barViews.forEach(function(t){return t.refresh()}),this.buyCount++;var e=Math.floor(5*Math.random())+5;cc.log("buyCount",this.buyCount,e),this.buyCount>e&&(this.buyCount=0,this.appendEquip(g.default.getSeniorBoxGunId(),1))}b.default.isNewbie.isNewbie&&b.default.nowStepName==b.NEWBIE_EVENT.BUY_GUN&&b.default.completeStep()},e.prototype.onTrialMount=function(t){w.default.tryMountId=t,w.default.tryMountLevel=(w.MountFormNum-1)*w.FormMaxLevel,O.default.getInstance().matchGame(),this.enterGame()},e.prototype.onClickPlay=function(){return cc.log("==========",b.default.nowStepName),b.default.isNewbie.isNewbie&&b.default.nowStepName==b.NEWBIE_EVENT.BEGIN_GAME?(b.default.completeStep(),O.default.getInstance().matchGame(),r.default.uiCenter.showUi("NewBieTryMoreNode").getComponent(D.default).setData(this.enterGame.bind(this)),void b.default.emit(b.default.nowStepName)):b.default.isNewbie.isNewbie&&b.default.nowStepName==b.NEWBIE_EVENT.CLICK_TRY_MOUNT?(O.default.getInstance().matchGame(),r.default.uiCenter.showUi("NewBieTryMoreNode").getComponent(D.default).setData(this.enterGame.bind(this)),void b.default.emit(b.default.nowStepName)):(O.default.getInstance().matchGame(),void(g.default.checkShowGunTry()?r.default.uiCenter.showUi("TryNode").getComponent(k.default).setTryList(this.enterGame.bind(this)):this.onStartGame(this.enterGame.bind(this))))},e.prototype.onClickPlayIO=function(){O.default.getInstance().matchGameIO(),g.default.checkShowGunTry()?r.default.uiCenter.showUi("TryNode").getComponent(k.default).setTryList(this.enterIOGame.bind(this)):this.onStartGame(this.enterIOGame.bind(this))},e.prototype.onEnterFarm=function(){var t=new M.SceneData;t.matchInfo={isShowUFO:!0},r.default.sceneCenter.runScene("FarmScene",t)},e.prototype.onClickDifficult=function(){O.default.getInstance().matchDifficultGame(),g.default.checkShowGunTry()?r.default.uiCenter.showUi("TryNode").getComponent(k.default).setTryList(this.enterDifficultGame.bind(this)):this.onStartGame(this.enterDifficultGame.bind(this))},e.prototype.onClickPlaySpacial=function(){},e.prototype.onClickPlayMount=function(t){O.default.getInstance().matchMountGame(t),g.default.checkShowGunTry()?r.default.uiCenter.showUi("TryNode").getComponent(k.default).setTryList(this.enterMountGame.bind(this,t)):this.onStartGame(this.enterMountGame.bind(this,t))},e.prototype.onClickPlayFarm=function(t){O.default.getInstance().matchGameFarm(t),g.default.checkShowGunTry()?r.default.uiCenter.showUi("TryNode").getComponent(k.default).setTryList(this.enterFarmGame.bind(this,t)):this.onStartGame(this.enterFarmGame.bind(this,t))},e.prototype.enterGame=function(){cc.log("\u666e\u901a\u5173\u5361"),r.default.sceneCenter.runScene("GameScene",{},!0)},e.prototype.enterIOGame=function(){cc.log("\u7ade\u6280\u573a"),r.default.sceneCenter.runScene("GameScene_IO",{},!0)},e.prototype.enterDifficultGame=function(){cc.log("\u56f0\u96be\u6a21\u5f0f"),r.default.sceneCenter.runScene("GameScene_difficult",{},!0)},e.prototype.enterSpacialGame=function(t){cc.log("\u81ea\u521b\u5730\u56fe");var e=new M.SceneData;e.matchInfo={isSpacial:!0,map_data:t},r.default.sceneCenter.runScene("GameScene_spacial",e,!0)},e.prototype.enterMountGame=function(t){cc.log("\u795e\u517d\u6218\u5f79");var e=new M.SceneData;e.matchInfo={isMount:!0,map_data:t},r.default.sceneCenter.runScene("GameScene_mount",e,!0)},e.prototype.enterFarmGame=function(t){cc.log("\u5bcc\u9976\u4e4b\u5730");var e=new M.SceneData;e.matchInfo={isFarm:!0,map_data:t},r.default.sceneCenter.runScene("GameScene_farm",e,!0)},e.prototype.onStartGame=function(t){var e=v.default.getNotUnlockRandomId()>=0,o=w.default.getNotUnlockRandomId()>=0;if(e&&o){var i=d.random(0,100),n=i<50?"hero":"mount";cc.log("\u8bd5\u7528",i,n),this.showTryMore(n,t)}else e&&e&&this.showTryMore("hero",t),o&&this.showTryMore("mount",t),!e&&!o&&t&&t()},e.prototype.showTryMore=function(t,e){r.default.uiCenter.showUi("TryMoreNode").getComponent(S.default).setData(t,e)},e.prototype.onClickAir=function(){r.default.uiCenter.showUi("AirdropBoxNode")},e.prototype.start=function(){var t=this;c.default.gameStartCount++,r.default.gameAudio.playMainBGMusic(),this.personView.init(),g.default.getGunMaxLevel()>4&&(this.randCount=10+Math.floor(10*Math.random())),this.schedule(function(){t.airdropAnimation()},30)},e.prototype.airdropAnimation=function(){var t=this;this.air.position=cc.v3(230,cc.winSize.height/2+this.air.height,0),this.air.runAction(cc.sequence(cc.moveTo(16,cc.v2(230,-(cc.winSize.height/2+this.air.height))),cc.callFunc(function(){t.air.position=cc.v3(-1200,0,0)})))},e.prototype.init=function(){var t=this;g.default.matrix.forEach(function(e,o){!isNaN(e)&&e>-1&&o<t.boxs.length&&t.appendItem(e,t.boxs[o])}),this.updateMatrix()},e.prototype.touchStart=function(t){var e=this,o=cc.v2(t.getLocation()),i=this.getBoxs(o);if(i.length>0){var n=i[0].item;n&&!n.isEffect&&(this.curItem=n,this.curItem.node.parent=this.node,this.curItem.node.setPosition(this.node.convertToNodeSpaceAR(o)),this.boxs.forEach(function(t){t.item&&t!=i[0]&&!t.item.isEffect&&t.item.check(e.curItem)&&t.showLight()}),this.delBtn.active=!0,this.delBtn.stopAllActions(),this.delBtn.scale=0,this.delBtn.runAction(cc.scaleTo(.2,1)),r.default.event.emit(c.GameDataEvent.HIDE_MAP_BTN))}},e.prototype.touchMove=function(t){if(this.curItem){var e=t.getLocation();this.curItem.node.setPosition(this.node.convertToNodeSpaceAR(e))}},e.prototype.touchEnd=function(t){if(this.curItem){var e=cc.v2(t.getLocation());this.boxs.forEach(function(t){return t.hideLight()});var o=this.getBoxs(e);if(o.length>0)this.switchItem(this.curItem,o[0]);else{console.log("resume");var i=this.delBtn.getBoundingBoxToWorld();if(e.x>i.x&&e.x<i.x+i.width&&e.y>i.y&&e.y<i.y+i.height)if(g.default.getGunPoolNum()<=1)u.default.showToast("\u5fc5\u987b\u4fdd\u7559\u4e00\u4e2a\u6b66\u5668"),this.curItem.box.resumeItem();else{this.curItem.box.removeItem();var n=g.default.getGunDataById(this.curItem.rank).sale;if(c.default.totalCoinNum+=n,u.default.showToast("+"+n+"\u91d1\u5e01"),this.curItem.node.destroy(),this.updateMatrix(),g.default.barViews.forEach(function(t){return t.refresh()}),this.equips.length>0)for(var a=this.boxs.filter(function(t){return null==t.item&&null==t.equip});a.length>0&&this.equips.length>0;)this.equips.pop().init({box:a[0]}),a=this.boxs.filter(function(t){return null==t.item&&null==t.equip})}else{this.curItem.box.resumeItem();var s=this.personView.node.getBoundingBoxToWorld();e.x>s.x&&e.x<s.x+s.width&&e.y>s.y&&e.y<s.y+s.height&&(g.default.useGunId=this.curItem.rank,this.personView.init())}}this.curItem=null,this.delBtn.active=!1,r.default.event.emit(c.GameDataEvent.SHOW_MAP_BTN)}},e.prototype.appendEquip=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),void 0===e&&(e=0),isNaN(t)&&(t=0);var o=cc.instantiate(this.tempEquip).getComponent(m.default),i=this.boxs.filter(function(t){return null==t.item&&null==t.equip});0==i.length?(o.init({type:e,rank:t}),this.equips.push(o)):o.init({type:e,rank:t,box:i[0]}),cc.log("\u6b66\u5668\u7bb1",i.length)},e.prototype.addAirdropGun=function(){this.air.getNumberOfRunningActions()>0&&(this.air.stopAllActions(),this.air.setPosition(cc.v2(-1200,0)));for(var t=0,e=g.default.getAirdropBoxGunId(),o=0;o<8;o++){var i=this.boxs.filter(function(t){return null==t.item&&null==t.equip});if(0==i.length){var n=g.default.getGunDataById(e).sale;t+=n,c.default.totalCoinNum+=n}else this.appendItem(e,i[0])&&this.updateMatrix()}t>0&&r.default.showCurrency(t)},e.prototype.playEffect=function(t,e){var o=this,i=this.getCombine().getComponent(sp.Skeleton),n=e.node.convertToWorldSpaceAR(cc.v2(0,0)),a=this.node.convertToNodeSpaceAR(n);i.clearTracks(),i.node.parent=this.node,i.node.setPosition(cc.v2(a)),i.node.active=!0,i.setAnimation(0,"animation",!1),i.setCompleteListener(function(){r.default.gameAudio.playCombineGunClip(),i.node.active=!1,o.appendItem(t,e),i.clearTracks(),i.node.active=!1,o.combinePool.put(i.node)})},e.prototype.appendItem=function(t,e){isNaN(t)&&(t=0);var o=cc.instantiate(this.tempItem).getComponent(p.default);return o?(o.rank=t,o.refresh(),o.show(),e.appendItem(o),o):null},e.prototype.switchItem=function(t,e){var o=this,i=e.item,n=e.equip;if(null==i&&null==n)t.box.item=null,t.box.refresh(),e.appendItem(t),this.updateMatrix();else if(n||i==t||i.isEffect)this.curItem.box.resumeItem();else if(t.check(i)){if(O.default.getInstance().level=0,this.checkExp(i,t)||i.combine(t,function(){o.updateMatrix()}),this.equips.length>0)for(var a=this.boxs.filter(function(t){return null==t.item&&null==t.equip});a.length>0&&this.equips.length>0;)this.equips.pop().init({box:a[0]}),a=this.boxs.filter(function(t){return null==t.item&&null==t.equip})}else this.curItem.box.appendItem(i),e.appendItem(this.curItem),this.updateMatrix()},e.prototype.showFinger=function(){var t=this;b.default.isNewbie.isNewbie||(this.fingerNode.active=!0,this.scheduleOnce(function(){t.fingerNode.active=!1},3))},e.prototype.checkExp=function(t,e){var o=this;if(cc.log("e",t.rank),g.default.getGunMaxLevel()<g.default.getGunTotalNum()&&!g.default.getGunDataById(t.rank+1).isUnlock)return t.combine(e,function(){o.updateMatrix()},!1),r.default.uiCenter.showUi("getGun").getComponent(y.default).setData(t.rank,!1),g.default.getGunDataById(t.rank).onUnlock(),g.default.useGunId=g.default.getGunMaxLevel(),this.personView.init(),cc.log("combine\u2014\u2014\u5347\u7ea7\uff0c\u5f39\u51fa\u83b7\u5f97\u65b0\u6b66\u5668\u7a97\u53e3",g.default.getGunMaxLevel(),t.rank),u.default.gameDataCenter.saveData(),!0;var i=Math.random();if(cc.log("\u89e6\u53d1\u666e\u901a\u5408\u6210\u65f6\u8fde\u5347\u6548\u679c",i,"GunModel.getGunMaxLevel() > 2 ",g.default.getGunMaxLevel()>2,g.default.getGunMaxLevel()-t.rank>2," GunModel.getGunMaxLevel() - e.rank > 2"),i<.2&&g.default.getGunMaxLevel()>2&&g.default.getGunMaxLevel()-t.rank>2)return cc.log("combine\u89e6\u53d1\u8fde\u53472\u7ea7",g.default.getGunMaxLevel()),t.combine(e,function(){r.default.uiCenter.showUi("UpdateGunNode").getComponent(A.default).setData(t,o.updateMatrix.bind(o))},!1),!0;if(0==this.randCount&&(this.randCount=5+Math.floor(10*Math.random())),this.combineCount++,this.combineCount==this.randCount){if(this.combineCount=0,this.randCount=5+Math.floor(10*Math.random()),g.default.getGunMaxLevel()>4&&g.default.getGunMaxLevel()-t.rank>3)return cc.log("\u539f\u6e38\u620fcombine111",g.default.getGunMaxLevel()),t.combine(e,function(){o.updateMatrix()},!1),!0;if(g.default.getGunMaxLevel()-t.rank>4||t.rank<4&&t.rank<g.default.getGunMaxLevel())return cc.log("\u539f\u6e38\u620fcombine222",g.default.getGunMaxLevel()),t.combine(e,function(){o.updateMatrix()},!1),!0}return!1},e.prototype.getBoxs=function(t){var e=cc.v2(this.layout.convertToNodeSpaceAR(t));return this.boxs.filter(function(t){return Math.abs(t.node.x-e.x)<t.node.width/2&&Math.abs(t.node.y-e.y)<t.node.height/2})},e.prototype.getProfit=function(){return this.profitPool.size()>0?this.profitPool.get():cc.instantiate(this.profitLabel.node)},e.prototype.getCombine=function(){return cc.log("this.combinePool.size()",this.combinePool.size()),this.combinePool.size()>0?this.combinePool.get():cc.instantiate(this.combineSkeleton.node)},e.prototype.updateMatrix=function(){var t=0;this.boxs.forEach(function(e,o){if(e.item){g.default.matrix[o]=e.item.rank;var i=g.default.getGunDataById(e.item.rank).profit;t+=i}else g.default.matrix[o]=-1}),g.default.profit=t,u.default.gameDataCenter.saveData()},e.prototype.parseTime=function(t){var e="",o=Math.floor(t/60);e+=o<10?"0"+o:o;var i=t%60;return(e+=":")+(i<10?"0"+i:i)},e.prototype.update=function(){},a([x(cc.Node)],e.prototype,"tempBox",void 0),a([x(cc.Node)],e.prototype,"tempItem",void 0),a([x(cc.Node)],e.prototype,"tempEquip",void 0),a([x(cc.Node)],e.prototype,"layout",void 0),a([x(cc.Node)],e.prototype,"air",void 0),a([x(cc.Node)],e.prototype,"top",void 0),a([x(cc.Node)],e.prototype,"bottom",void 0),a([x(cc.Label)],e.prototype,"profitLabel",void 0),a([x(sp.Skeleton)],e.prototype,"combineSkeleton",void 0),a([x(cc.Button)],e.prototype,"startBtn",void 0),a([x(cc.Node)],e.prototype,"delBtn",void 0),a([x(l.default)],e.prototype,"buyItem",void 0),a([x(h.default)],e.prototype,"personView",void 0),a([x(f.default)],e.prototype,"bgView",void 0),a([x(cc.Prefab)],e.prototype,"getGunPrefab",void 0),a([x(cc.Node)],e.prototype,"fingerNode",void 0),a([x(cc.Node)],e.prototype,"dwNode",void 0),a([x(cc.Node)],e.prototype,"xzNode",void 0),a([G],e)}(T.default);o.default=R,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GuideModel":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../Script/base/Utils":void 0,"../../../../framework/Script/cemter/SceneCenter":void 0,"../../../../framework/Script/sdk/statistics":void 0,"../../../GameScene/manage/GameManage":"GameManage","../../../GameScene/view/base/BaseView":"BaseView","../../center/Game":"Game","../UpdateGunNode/UpdateGunNode":"UpdateGunNode","../cultivate/CultivateNode":"CultivateNode","../mapMountNode/GetMapMountNode":"GetMapMountNode","../mapMountNode/MapMountNode":"MapMountNode","../prefabs/BuyItem":"BuyItem","../prefabs/getGun/GetGun":"GetGun","../prefabs/view/BgView":"BgView","../prefabs/view/BoxView":"BoxView","../prefabs/view/EquipBoxView":"EquipBoxView","../prefabs/view/ItemView":"ItemView","../prefabs/view/PersonView":"PersonView","../try/NewBieTryMoreNode":"NewBieTryMoreNode","../try/TryMoreNode":"TryMoreNode","../try/TryNode":"TryNode"}],MapBtnNode:[function(t,e,o){"use strict";cc._RF.push(e,"b5bbcmVMC1Dqo6yojGx1It4","MapBtnNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delBtn=null,e.btnNode=null,e}return n(e,t),e.prototype.start=function(){c.default.event.on(r.GameDataEvent.HIDE_MAP_BTN,this.hideBtn,this),c.default.event.on(r.GameDataEvent.SHOW_MAP_BTN,this.showBtn,this)},e.prototype.showBtn=function(){this.btnNode.active=!0},e.prototype.hideBtn=function(){this.btnNode.active=!1},a([d(cc.Node)],e.prototype,"delBtn",void 0),a([d(cc.Node)],e.prototype,"btnNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../center/Game":"Game"}],MapListItem:[function(t,e,o){"use strict";cc._RF.push(e,"6acb4wRd8VCwJddurwtNLLF","MapListItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nameLabel=null,e.mapLabel=null,e.avatar=null,e.videoBtn=null,e.actionBtn=null,e.data=null,e}return n(e,t),e.prototype.setData=function(t){this.data=t,this.nameLabel.string=t.name,this.mapLabel.string=t.map_name,r.default.addLoaderSprite(this.avatar).loadSprite(t.avatar_url),this.videoBtn.active=!t.isUnlock,this.actionBtn.active=t.isUnlock},e.prototype.onClick=function(){this.data.isUnlock?this.enterGame():(this.data.watchVideoTime++,this.data.isUnlock&&this.enterGame())},e.prototype.enterGame=function(){s.default.event.emit(c.GameDataEvent.MAP_SPACIAL,this.data)},a([u(cc.Label)],e.prototype,"nameLabel",void 0),a([u(cc.Label)],e.prototype,"mapLabel",void 0),a([u(cc.Sprite)],e.prototype,"avatar",void 0),a([u(cc.Node)],e.prototype,"videoBtn",void 0),a([u(cc.Node)],e.prototype,"actionBtn",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],MapListNode:[function(t,e,o){"use strict";cc._RF.push(e,"16a86S7OYhG9qWxEIHPUOe+","MapListNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/center/GameInit"),c=t("../../../../InitScene/Script/data/MapListModel"),s=t("../../center/Game"),l=t("../list/List"),d=t("./MapListItem"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapList=null,e.mapInfoList=[],e.index=0,e}return n(e,t),e.prototype.start=function(){this.mapInfoList=c.default.getMapList(),cc.log("this.mapInfoList",this.mapInfoList),this.mapInfoList.length>0&&(this.index=this.mapInfoList.length-1,this.mapList.numItems=this.mapInfoList.length)},e.prototype.onVerricalList=function(t,e){var o=this;t.getComponent(d.default).setData(this.mapInfoList[e]),t.on(cc.Node.EventType.TOUCH_END,function(){o.index!=e&&(o.index=e,s.default.gameAudio.playButtonClick())},this)},e.prototype.onClose=function(){r.default.uiCenter.closeUI(this.node)},a([h(l.default)],e.prototype,"mapList",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/MapListModel":void 0,"../../center/Game":"Game","../list/List":"List","./MapListItem":"MapListItem"}],MapMountBtn:[function(t,e,o){"use strict";cc._RF.push(e,"b54c9kD0SdB+6dCU9QSeuG9","MapMountBtn");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.offSprite=null,e.onSprite=null,e.data=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){this.data=t;var e=t.icon_url,o="mountMap/btnText/off/"+e+"_off",i="mountMap/btnText/on/"+e+"_on";r.default.addLoaderSprite(this.offSprite).loadSprite(o),r.default.addLoaderSprite(this.onSprite).loadSprite(i)},e.prototype.onClick=function(){this.node.emit("onClick",this.data),cc.log("onClick===========MapMountBtn")},a([l(cc.Sprite)],e.prototype,"offSprite",void 0),a([l(cc.Sprite)],e.prototype,"onSprite",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0}],MapMountItem:[function(t,e,o){"use strict";cc._RF.push(e,"57e3dpOwL5Jwr0pEFHKV2nb","MapMountItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../center/Game"),l=t("./FreeGetMountItemNode"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.levelSprite=null,e.levelSFs=[],e.tipNode=null,e.iconSprite=null,e.btnChallengeUnlock=null,e.btnChallengeVideo=null,e.btnChallenge=null,e.btnRewarded=null,e.data=null,e.getSPPrefab=null,e.clickNum=0,e}return n(e,t),e.prototype.onClick=function(){if(!(this.data.watchVideo_isVideo>=this.data.isVideo)&&(this.clickNum++,1==this.clickNum&&this.scheduleOnce(this.reset,1),5==this.clickNum)){var t=s.default.uiCenter.showUi(this.getSPPrefab);t.getComponent(l.default).setData(this.data),t.once("onClose",this.changeBtn,this)}},e.prototype.reset=function(){this.clickNum=0},e.prototype.start=function(){},e.prototype.setData=function(t){cc.log("======item======"),this.data=t,this.data.on("onUnlockVideo",this.changeBtn,this),this.tipNode.active=t.isSuccess,this.levelSprite.spriteFrame=this.levelSFs[t.id];var e=t.icon_url;r.default.addLoaderSprite(this.iconSprite).loadSprite(e),this.changeBtn()},e.prototype.changeBtn=function(){this.btnChallenge.active=this.btnChallengeVideo.active=this.btnChallengeUnlock.active=this.btnRewarded.active=!1,this.data.isUnlock?this.data.isUnlock&&(this.onReward(),this.data.isSuccess?this.data.isReward&&(this.btnRewarded.active=!0,this.node.emit("setIcon")):(this.btnChallengeVideo.active=this.data.watchVideo<this.data.video,this.btnChallenge.active=this.data.watchVideo>=this.data.video),this.iconSprite.node.parent.getComponent(cc.Button).interactable=this.data.isVideo>0&&(this.data.watchVideo_isVideo<this.data.isVideo||!this.data.isReward)):(this.btnChallengeUnlock.active=!0,this.iconSprite.node.parent.getComponent(cc.Button).interactable=!1),this.tipNode.active=this.data.isSuccess},e.prototype.onReward=function(){this.data.onReward()},e.prototype.onVideo=function(){this.data.onVideo(),this.changeBtn(),this.onChallenge()},e.prototype.onChallenge=function(){s.default.event.emit(c.GameDataEvent.MAP_MOUNT,this.data),this.node.emit("onChallenge")},a([p(cc.Sprite)],e.prototype,"levelSprite",void 0),a([p([cc.SpriteFrame])],e.prototype,"levelSFs",void 0),a([p(cc.Node)],e.prototype,"tipNode",void 0),a([p(cc.Sprite)],e.prototype,"iconSprite",void 0),a([p(cc.Node)],e.prototype,"btnChallengeUnlock",void 0),a([p(cc.Node)],e.prototype,"btnChallengeVideo",void 0),a([p(cc.Node)],e.prototype,"btnChallenge",void 0),a([p(cc.Node)],e.prototype,"btnRewarded",void 0),a([p(cc.Prefab)],e.prototype,"getSPPrefab",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","./FreeGetMountItemNode":"FreeGetMountItemNode"}],MapMountNode:[function(t,e,o){"use strict";cc._RF.push(e,"7fed7CEgGtK9aV1ko1nVosF","MapMountNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/center/GameInit"),s=t("../../../../InitScene/Script/data/BadgeModel"),l=t("../../../../InitScene/Script/data/GameData"),d=t("../../../../InitScene/Script/data/MountGameModel"),u=t("../../../../InitScene/Script/data/MountModel"),p=t("../../../GameScene/manage/GameManage"),h=t("../../center/Game"),f=t("../cultivate/CultivateNode"),m=t("../cultivate/GetCultivateNode"),y=t("./MapMountBtn"),g=t("./MapMountItem"),v=cc._decorator,_=v.ccclass,S=v.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnItemPrefab=null,e.btnsListNode=null,e.itemPrefab=null,e.levelListNode=null,e.dragonSprite=null,e.dragonSprite_wakeup=null,e.dragonMask=null,e.btnReward=null,e.btnrewardedNode=null,e.tipNode=null,e.lockBtnsNode=null,e.tryNode=null,e.goBtnsNode=[],e.lockNode=null,e.lockTipsLabel=null,e.lockArmatureDisplay=null,e.data=null,e.pool=new cc.NodePool,e.clickTimes=0,e.select_mountID=-1,e}return n(e,t),e.prototype.init=function(t){this.select_mountID=t},e.prototype.start=function(){for(var t=d.default.getMountGameList(),e=t.length,o=!1,i=null,n=0;n<e;n++){var a=t[n],r=cc.instantiate(this.btnItemPrefab);r.getComponent(y.default).setData(a),r.on("onClick",this.setData,this),r.parent=this.btnsListNode,this.select_mountID>-1&&a.mount_id==this.select_mountID&&(r.getComponent(cc.Toggle).check(),r.getComponent(y.default).onClick(),o=!0,i=r,this.select_mountID=-1),a.isReward||o||(r.getComponent(cc.Toggle).check(),r.getComponent(y.default).onClick(),o=!0,i=r)}i||((i=this.btnsListNode.children[0]).getComponent(cc.Toggle).check(),i.getComponent(y.default).onClick()),this.btnsListNode.x=this.btnsListNode.parent.width/2-i.x},e.prototype.recycle=function(){for(;this.levelListNode.childrenCount>0;)this.pool.put(this.levelListNode.children[0])},e.prototype.removePool=function(){this.recycle(),this.levelListNode.removeAllChildren()},e.prototype.getItem=function(){if(this.pool.size()>0)return this.pool.get();var t=cc.instantiate(this.itemPrefab);return this.pool.put(t),this.getItem()},e.prototype.setData=function(t){this.removePool(),this.data=t;for(var e=t.levelConfig.length,o=0;o<e;o++){var i=t.getLevel(o),n=this.getItem();n.getComponent(g.default).setData(i),n.on("setIcon",this.setIcon,this),n.on("onChallenge",this.setChallenge,this),n.parent=this.levelListNode}var a="mountMap/mount/mount_"+t.mount_id;r.default.addLoaderSprite(this.dragonSprite).loadSprite(a),r.default.addLoaderSprite(this.dragonMask).loadSprite(a),u.default.getMountDataById(t.mount_id),this.dragonSprite.node.getComponent(cc.Button).interactable=!1,this.dragonMask.fillStart=0,this.setIcon(),this.data.isUnlock()?this.lockNode.active=!1:(this.lockNode.active=!0,this.data.isUnlockCondition()?(this.lockArmatureDisplay.playAnimation("newAnimation",1),this.lockArmatureDisplay.on(dragonBones.EventObject.COMPLETE,this.lockArmatureComplete,this),s.default.updateMountGameBadge(2)):(this.lockArmatureDisplay.playAnimation("newAnimation1",0),this.lockArmatureDisplay.off(dragonBones.EventObject.COMPLETE,this.lockArmatureComplete,this)))},e.prototype.lockArmatureComplete=function(){this.lockNode.active=!1,this.data.unlock(),this.setData(this.data)},e.prototype.setIcon=function(){var t=this.data.levelConfig.length,e=this.data.mountItemCount;this.btnReward.active=e==t&&!this.data.isReward,this.btnrewardedNode.active=e==t&&this.data.isReward,this.tipNode.active=e<t&&!this.data.isReward,this.lockBtnsNode.active=!this.btnReward.active&&!this.data.isReward,this.dragonMask.fillStart=e/t,this.lockTipsLabel.string=this.data.lockTipsString;var o=this.goBtnsNode.length;if(this.lockBtnsNode.active){this.tryNode.active=this.data.triedCount<1;for(var i=0;i<o;i++)this.goBtnsNode[i].active=!1;cc.log("this.data.isUnlockCondition()",this.data.isUnlockCondition()),this.goBtnsNode[this.data.unlock_type].active=!this.data.isUnlockCondition()}},e.prototype.setChallenge=function(){p.default.getInstance().challenge_mountID=this.data.mount_id},e.prototype.onLeft=function(){var t=this.btnsListNode.x+this.btnsListNode.parent.width;t=Math.min(-300,t),this.btnsListNode.runAction(cc.moveTo(.1,t,0))},e.prototype.onRight=function(){var t=this.btnsListNode.x-this.btnsListNode.parent.width;t=Math.max(-this.btnsListNode.parent.width/2-(this.btnsListNode.width-this.btnsListNode.parent.width),t),this.btnsListNode.runAction(cc.moveTo(.1,t,0))},e.prototype.onReward=function(){this.data.onReward(),this.btnReward.active=!1;var t=u.default.getMountDataById(this.data.mount_id);c.default.uiCenter.showUi("GetCultivateNode").getComponent(m.default).setData("mount",u.default.getMountSkeUrl(t.id),"\u5f85\u673a",t.award,!0)},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},e.prototype.onTrial=function(){this.data.triedCount++,h.default.event.emit(l.GameDataEvent.TRIAL_MOUNT,this.data.mount_id)},e.prototype.onChallengeGame=function(){h.default.event.emit(l.GameDataEvent.PLAY_GAME),this.onClose()},e.prototype.onChallengeDifficult=function(){h.default.uiCenter.showUi("GameListNode"),this.onClose()},e.prototype.onUpgradeMount=function(){h.default.uiCenter.showUi("CultivateNode").getComponent(f.default).setData(f.CultivateType.Mount,this.data.unlock_id),this.onClose()},e.prototype.onWakeupMount=function(){this.clickTimes++,this.dragonSprite_wakeup.node.opacity=this.clickTimes/5*255,this.dragonSprite.node.opacity=(5-this.clickTimes)/5*255,cc.log("===========\u900f\u660e\u5ea6",this.dragonSprite_wakeup.node.opacity),5==this.clickTimes&&(h.default.uiCenter.showUi("activityMount"),this.onClose()),1==this.clickTimes&&this.scheduleOnce(this.resetClickTime,1)},e.prototype.resetClickTime=function(){this.clickTimes=0,this.dragonSprite_wakeup.node.opacity=0,this.dragonSprite.node.opacity=255},a([S(cc.Prefab)],e.prototype,"btnItemPrefab",void 0),a([S(cc.Node)],e.prototype,"btnsListNode",void 0),a([S(cc.Prefab)],e.prototype,"itemPrefab",void 0),a([S(cc.Node)],e.prototype,"levelListNode",void 0),a([S(cc.Sprite)],e.prototype,"dragonSprite",void 0),a([S(cc.Sprite)],e.prototype,"dragonSprite_wakeup",void 0),a([S(cc.Sprite)],e.prototype,"dragonMask",void 0),a([S(cc.Node)],e.prototype,"btnReward",void 0),a([S(cc.Node)],e.prototype,"btnrewardedNode",void 0),a([S(cc.Node)],e.prototype,"tipNode",void 0),a([S(cc.Node)],e.prototype,"lockBtnsNode",void 0),a([S(cc.Node)],e.prototype,"tryNode",void 0),a([S([cc.Node])],e.prototype,"goBtnsNode",void 0),a([S(cc.Node)],e.prototype,"lockNode",void 0),a([S(cc.Label)],e.prototype,"lockTipsLabel",void 0),a([S(dragonBones.ArmatureDisplay)],e.prototype,"lockArmatureDisplay",void 0),a([_],e)}(cc.Component);o.default=b,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/MountGameModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../../GameScene/manage/GameManage":"GameManage","../../center/Game":"Game","../cultivate/CultivateNode":"CultivateNode","../cultivate/GetCultivateNode":"GetCultivateNode","./MapMountBtn":"MapMountBtn","./MapMountItem":"MapMountItem"}],MountAINode:[function(t,e,o){"use strict";cc._RF.push(e,"c0135PNFN9BS6MuRmuKhDih","MountAINode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderDragonBones"),c=t("../../../InitScene/Script/data/MountModel"),s=t("../../../InitScene/Script/data/PlayerModel"),l=t("../../../Script/base/Utils"),d=t("../../../Script/common/Flash"),u=t("../../GameScene/joystick/JoystickCommon"),p=t("../../GameScene/manage/GameManage"),h=t("../../Script/center/Game"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragon=null,e.progress=null,e.flashMaterial=null,e.dialogNode=null,e.dialogLabel=null,e.mountData=null,e.mountIdx=0,e.mount_level=0,e._speedType=u.SpeedType.NORMAL,e._moveSpeed=10,e.moveDir=cc.v2(-1,0),e.offect=cc.Vec2.ZERO,e.farmView=null,e.model=new s.default,e.isPlay=!1,e.animation="",e.delay=1,e.think=.02,e.findTime=0,e.isRun=!1,e.isStart=!1,e}return n(e,t),e.prototype.start=function(){this.findTime=(new Date).getTime(),this.loadModel(this.mountIdx),this.loadSkin(this.mountIdx),this.changedir(),this.changeDialog(),this.schedule(this.changedir,l.rand(6,8)),this.schedule(this.changeDialog,8)},e.prototype.changedir=function(){this._speedType=u.SpeedType.NORMAL,this.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalize()},e.prototype.loadSkin=function(t){var e=this;this.scheduleOnce(function(){e.loadMount(t)})},e.prototype.loadMount=function(t){var e=this,o=this,i=c.default.getMountDataById(t).level,n=c.default.getMountSkeUrl(t,i);o.scheduleOnce(function(){r.default.addLoaderDragonBones(o.dragon).loadArmature(n,function(){o.scheduleOnce(function(){o.dragon.armatureName="Armature",o.dragon.playAnimation("\u79fb\u52a8"+e.mountData.bloodLevel,0)})})})},e.prototype.init=function(){var t=p.default.getInstance();this.farmView=t.farmView,this.randPos()},e.prototype.randPos=function(){var t=this.farmView.getEmptyGird(),e=t;return console.log("randPos\u2014\u2014\u731c\u6d4b\uff1a\u8fd4\u56de\u53ef\u884c\u8d70\u7684\u70b9this.farmView.getEmptyGird()",t,e),this.node.setPosition(t),t},e.prototype.initAI=function(t,e,o){console.log("\u5750\u9a91AI  \u521d\u59cb\u5316\u5750\u9a91AI",t,e,"\u5750\u9a91",o),this.index=t,void 0===e&&(e=1),this.model.group=100+t,this.mountIdx=o,this.think=e,this.mountData=c.default.getMountDataById(o),this.setProgress()},e.prototype.loadModel=function(){this.think>.2&&(this.think=.2)},e.prototype.move=function(t){var e=this.moveDir.mul(this._moveSpeed/(1/t)),o=this.node.getPosition().add(e);o.equals(this.node.getPosition())||(this.node.setPosition(this.check(o)),this.node.zIndex=2*-Math.floor((this.node.y+this.farmView.map.height/2)/this.farmView.size)-1),e.x>0?this.dragon.node.scaleX=this.dragon.node.scaleY:this.dragon.node.scaleX=-this.dragon.node.scaleY},e.prototype.check=function(t){var e=Math.abs((this.node.width-this.farmView.map.width)/2),o=Math.abs((this.node.height-this.farmView.map.height)/2),i=this.farmView.map.y;t.x>e?(t.x=e,this.moveDir.x*=-1):t.x<-e&&(t.x=-e,this.moveDir.x*=-1),t.y>i+o?(t.y=i+o,this.moveDir.y*=-1):t.y<i-o&&(t.y=i-o,this.moveDir.y*=-1);var n=this.node.getBoundingBox();return n.x+=t.sub(this.node.getPosition()).x,n.y+=t.sub(this.node.getPosition()).y,n.height+=3,t},e.prototype.changeAnimation=function(t){var e=this;t.flag&&(this.isPlay=!1,this.animation=""),this.dragon&&this.dragon.isValid&&(this.isPlay||(t.loop?this.animation!=t.animation&&(this.animation=t.animation,this.dragon.timeScale=1,this.dragon.playAnimation(t.animation,0),t.animation.indexOf("\u79fb\u52a8")>-1&&(this.dragon.timeScale=.5),t.callback&&t.callback()):(this.dragon.once(dragonBones.EventObject.COMPLETE,function(){e.isPlay=!1,t.callback&&t.callback()}),this.isPlay=!0,this.animation="",this.dragon.timeScale=1,this.dragon.playAnimation(t.animation,1))))},e.prototype.setProgress=function(){var t;t=this.mountData.bloodLevel<this.mountData.needFood.length-1?this.mountData.needFood[this.mountData.bloodLevel+1]:this.mountData.needFood[this.mountData.bloodLevel],cc.tween(this.progress).to(.3,{progress:Math.min(this.mountData.nowExp/parseInt(t),1)}).start(),cc.log("needFood",t,this.mountData.bloodLevel,this.progress.progress,Math.min(this.mountData.nowExp/parseInt(t),1))},e.prototype.onEat=function(t){return this.mountData.bloodLevel<this.mountData.needFood.length-1&&(this.mountData.exp+=t,cc.log("mountdata.exp:",this.mountData.exp,t),this.dragon.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.dragon.addComponent(d.default).updateFlash(),this.unschedule(this.hideProgress),this.progress.node.runAction(cc.fadeIn(.2)),this.setProgress(),this.scheduleOnce(this.hideProgress,2),this.mountData.nowExp>=parseInt(this.mountData.needFood[this.mountData.bloodLevel+1])&&(this.mountData.bloodLevel++,this.mountData.level=0,this.progress.progress=1,h.default.gameAudio.playMount_upgrade10Clip(),cc.tween(this.progress).to(.3,{progress:0}).start(),this.farmView.onOpenChange(this.mountData),this.loadMount(this.mountIdx)),h.default.gameAudio.playEatClip(),!0)},e.prototype.hideProgress=function(){this.progress.node.runAction(cc.fadeOut(.5))},e.prototype.changeDialog=function(){this.dialogNode.stopAllActions(),this.dialogNode.scale=0,0==c.default.getMountDataById(0).bloodLevel?(this.dialogLabel.string="\u5feb\u53bb\u4e30\u9976\u4e4b\u5730\uff0c\u6253\u83e0\u841d\u7ed9\u6211\u5403",this.dialogNode.runAction(cc.sequence(cc.scaleTo(.3,1),cc.delayTime(3),cc.scaleTo(.2,0)))):this.unschedule(this.changeDialog)},e.prototype.update=function(t){switch(this._speedType){case u.SpeedType.STOP:this._moveSpeed=0,this.changeAnimation({animation:"\u5f85\u673a",loop:!0});break;case u.SpeedType.NORMAL:case u.SpeedType.FAST:this._moveSpeed=30,this.changeAnimation({animation:"\u79fb\u52a8",loop:!0})}this.move(t)},a([y(dragonBones.ArmatureDisplay)],e.prototype,"dragon",void 0),a([y(cc.ProgressBar)],e.prototype,"progress",void 0),a([y(cc.Material)],e.prototype,"flashMaterial",void 0),a([y(cc.Node)],e.prototype,"dialogNode",void 0),a([y(cc.Label)],e.prototype,"dialogLabel",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../InitScene/Script/data/MountModel":void 0,"../../../InitScene/Script/data/PlayerModel":void 0,"../../../Script/base/Utils":void 0,"../../../Script/common/Flash":void 0,"../../../framework/Script/component/LoaderDragonBones":void 0,"../../GameScene/joystick/JoystickCommon":"JoystickCommon","../../GameScene/manage/GameManage":"GameManage","../../Script/center/Game":"Game"}],MountChangeNode:[function(t,e,o){"use strict";cc._RF.push(e,"cfb3aeOjj9IvZxEj8x/x3Ve","MountChangeNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/cemter/SceneCenter"),c=t("../../../framework/Script/component/LoaderDragonBones"),s=t("../../../InitScene/Script/data/MountModel"),l=t("../../Script/center/Game"),d=t("../../Script/ui/cultivate/AttributeView"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.beforeMount=null,e.behindeMount=null,e.attributeView=null,e.mountData=null,e.id=0,e.isCanMove=!0,e}return n(e,t),e.prototype.setData=function(t){this.mountData=t,this.id=this.mountData.id,this.loadMount(),this.attributeView.setCombineLabel("\u5408\u4f53\u5f62\u6001:"+this.mountData.combine),this.attributeView.setLabel(this.mountData.specialName.replace("X",this.mountData.value+"%"))},e.prototype.start=function(){},e.prototype.loadMount=function(){var t=this,e=s.default.getMountSkeUrl(this.id,0);c.default.addLoaderDragonBones(this.beforeMount).loadArmature(e,function(){t.scheduleOnce(function(){t.beforeMount.armatureName="Armature",t.beforeMount.playAnimation("\u5f85\u673a",0)})}),c.default.addLoaderDragonBones(this.behindeMount).loadArmature(e,function(){t.scheduleOnce(function(){t.behindeMount.armatureName="Armature",t.behindeMount.playAnimation("\u5f85\u673a",0)})})},e.prototype.onGoMain=function(){var t=new r.SceneData;t.matchInfo={isOpenMount:!0,mountID:this.id},l.default.sceneCenter.runScene("MainScene",t),this.onClose()},e.prototype.onClose=function(){l.default.uiCenter.closeUI(this.node)},a([h(dragonBones.ArmatureDisplay)],e.prototype,"beforeMount",void 0),a([h(dragonBones.ArmatureDisplay)],e.prototype,"behindeMount",void 0),a([h(d.default)],e.prototype,"attributeView",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../InitScene/Script/data/MountModel":void 0,"../../../framework/Script/cemter/SceneCenter":void 0,"../../../framework/Script/component/LoaderDragonBones":void 0,"../../Script/center/Game":"Game","../../Script/ui/cultivate/AttributeView":"AttributeView"}],MountGameView:[function(t,e,o){"use strict";cc._RF.push(e,"63bbc6EepNE84B+NC7n7yYx","MountGameView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../manage/GameManage"),c=t("../../../BasePlayer"),s=t("../../../Player"),l=t("../../../public/AStar"),d=t("../../../public/QuadTree"),u=t("../../../test/EditView"),p=t("../GameBlock"),h=t("../../../../../MainScene/Script/center/Game"),f=t("../../../../../InitScene/Script/data/GameData"),m=t("../../../../../InitScene/Script/data/OtherData"),y=t("../Account/AccountAwardNode"),g=t("../../../../../InitScene/Script/data/GunModel"),v=t("../../../../../InitScene/Script/data/PersonModel"),_=t("../../../../../InitScene/Script/data/MountModel"),S=t("../../../../../InitScene/Script/data/MountGameModel"),b=t("../../../../../InitScene/Script/data/MapListModel"),w=t("../Enemy/EnemyNode"),I=t("../GameView/GameView"),M=cc._decorator,k=M.ccclass,N=(M.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=null,e}return n(e,t),e.prototype.onLoad=function(){r.default.getInstance().gameView=this},e.prototype.start=function(){h.default.gameAudio.playGameBGMusic(),h.default.event.on(f.GameDataEvent.GAME_ACCOUNT,this.showAcc,this),this.boxShadowNode.active=!1;var t=h.default.sceneCenter.getCustomData();t&&t.matchInfo.isMount&&(this.data=t.matchInfo.map_data);var e=this.mapPrefab,o=r.default.getInstance().maptype;switch(o){case b.MapState.\u91ce\u5916:e=this.mapPrefab;break;case b.MapState.\u79d1\u6280:e=this.map2Prefab;break;case b.MapState.\u68ee\u6797:e=this.map3Prefab}this.map.getComponent(cc.Sprite).spriteFrame=this.mapSF[o];var i=e.length,n=Math.floor(Math.random()*i);1==f.default.gameCount?n=1:2==f.default.gameCount?n=1:3==f.default.gameCount?n=0:4==f.default.gameCount?n=2:5==f.default.gameCount&&(n=0);var a=cc.instantiate(e[n]);a.parent=this.map,a.zIndex=-1,this.layout=a,this.player.parent=this.layout,this.init(this.json.json["map"+o+n]),cc.log("=====MapItemInfo======",this.data)},e.prototype.init=function(t){var e=this,o=this;this.quadTree=new d.default(this.map.getBoundingBox()),t.point&&(this.points=t.point.map(function(t){return cc.v2(t)}).sort(function(){return Math.random()-.5})),cc.log("==this.points==",this.points[0]),this.nameList=["box","shu_gan","shu2","xian_ren_zhang","luo_xue_de_shu","tree","pool_water","pool_up","pool_down","pool_left","pool_right","pool_right_up","pool_right_down","pool_left_up","pool_left_down","shi_bei","shi_tou_die","pu_tong_shi_tou","shi_tou_gu","dai_gu_ci_shi_tou","zhang_peng","map_left_down","map_right_down","map_left_up","map_right_up","map_down","map_up","map_left","map_right","map","mountain_1","mountain_2","mountain_3","mountain_4","shi_tou1","shi_tou2","bing_wu1","bing_wu2","pen_quan","rongyanjianci"],this.layout.children.forEach(function(t){if(e.nameList.indexOf(t.name)>=0){var i=t.getComponent(p.default),n=t.getPosition().add(cc.v2(e.map.width/2,e.map.height/2)).div(e.size);i.gird=cc.v2(Math.floor(n.x),Math.floor(n.y)),t.setPosition(i.gird.add(cc.v2(1,1)).mul(e.size).sub(cc.v2(e.map.width/2,e.map.height/2).add(cc.v2(e.size/2,e.size/2)))),i.type!=u.ItemType.WATER?(t.zIndex=2*-i.gird.y,t.name.indexOf("map")>=0&&(t.zIndex=10*-i.gird.y)):t.zIndex=2*-Math.floor(e.map.height/e.size),o.blocks.push(i),i.init()}else"grass1"==t.name||"grass2"==t.name||"guang"==t.name?t.zIndex=2*-Math.floor(e.map.height/e.size)+1:"addHpLogo"==t.name?t.zIndex=1:"addHpCircle"==t.name&&(n=t.getPosition().add(cc.v2(e.map.width/2,e.map.height/2)).div(e.size),t.setPosition(cc.v2(Math.floor(n.x),Math.floor(n.y)).add(cc.v2(1,1)).mul(e.size).sub(cc.v2(e.map.width/2,e.map.height/2).add(cc.v2(e.size/2,e.size/2)))),t.zIndex=t.zIndex=2*-Math.floor(e.map.height/e.size)-10)}),this.astar||(this.astar=new l.default),this.astar.init(this.size,this.size,Math.floor(this.map.width/this.size)-1,Math.floor(this.map.height/this.size)-1),this.astar.initMap(),this.astar.resetMap(),this.blocks.forEach(function(t){t.type!=u.ItemType.BLOCK&&t.type!=u.ItemType.WATER&&t.type!=u.ItemType.SHADOW&&t.type!=u.ItemType.MOUNTAIN||0!=o.astar.gridsList[t.gird.x][t.gird.y].type||(o.astar.gridsList[t.gird.x][t.gird.y].type=-1)}),this.doStart(),this.schedule(this.airDrop,m.default.airDropTime)},e.prototype.doStart=function(){this.initEnemy(),this.targets=this.layout.getComponentsInChildren(c.default),this.players=this.layout.getComponentsInChildren(s.default),this.curPlayer=this.players[0],r.default.getInstance().model.players=this.players.map(function(t){return t.model}),this.players.forEach(function(t){return t.init()}),console.log("=======\u731c\u6d4b\uff1a\u73a9\u5bb6=======GameManage.getInstance().model.players",r.default.getInstance().model.players),this.tipsView.gameView=this,this.tipsView.node.active=!0,this.tipsView.startGame()},e.prototype.startGame=function(){var t=this;this.attackView.node.active=!0,this.timeView.node.active=!0,this.timeView.init(120),this.timeView.startTimer(),this.timeView.node.on("finished",function(){t.doEnd(),r.default.getInstance().endGame()},this),this.mapView.node.active=!0,this.mapView.init(Math.max(this.map.width,this.map.height)),this.shadow.active=!1,this.enemys.forEach(function(t){return t.isStart=!0})},e.prototype.endGame=function(){this.isAccount||(this.isAccount=!0,this.attackView.stopAttack(),this.timeView.pauseTimer(),this.shadow.active=!0,this.tipsView.node.active=!0,this.tipsView.endGame(),this.unschedule(this.airDrop),r.default.getInstance().endGame())},e.prototype.initEnemy=function(){var t=g.default.getGunMaxLevel(),e=v.default.useHeroId,o=_.default.getMountDataById(_.default.useMountId).level,i=null,n=(Math.min(_.MountMaxLevel,o+2),this.rand(Math.max(_.default.useMountId-3,0),Math.min(_.default.useMountId+3,_.default.getMountMaxId())),Math.min(t+2,g.default.getGunTotalNum()-1),(i=cc.instantiate(this.aiPrefab)).getComponent(w.default));n.initEnemy(0,.1,n.getPersonIdx(e+2),!0,!1,this.data.hpBuff,this.data.atkBuff),i.parent=this.layout,this.enemys.push(n)},e.prototype.showAcc=function(t){cc.log("player",t),0==(0==t.rank)?3==this.data.id&&S.default.getMountGameItem(this.data.ID).onLock():this.data.success(),h.default.uiCenter.showUi(this.accountPrefab).getComponent(y.default).init()},e.prototype.update=function(){var t=this.players.filter(function(t){return t&&t.node.active&&t.model&&!t.model.isDead()});this.updateMap(t)},a([k],e)}(I.default));o.default=N,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MapListModel":void 0,"../../../../../InitScene/Script/data/MountGameModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/OtherData":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../BasePlayer":"BasePlayer","../../../Player":"Player","../../../manage/GameManage":"GameManage","../../../public/AStar":"AStar","../../../public/QuadTree":"QuadTree","../../../test/EditView":"EditView","../Account/AccountAwardNode":"AccountAwardNode","../Enemy/EnemyNode":"EnemyNode","../GameBlock":"GameBlock","../GameView/GameView":"GameView"}],MountUnlockNode:[function(t,e,o){"use strict";cc._RF.push(e,"79c87PGAI1PA6paxHshAHvy","MountUnlockNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../InitScene/Script/center/GameInit"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/MountModel"),d=t("./GetCultivateNode"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tipsLabel=null,e.mountNode=null,e.mountId=0,e.skeUrl="",e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){var e=this;this.mountId=t;var o=l.default.getMountDataById(t);this.skeUrl=l.default.getMountSkeUrl(t,0),this.tipsLabel.string="\u89e3\u9501\u5750\u9a91"+o.name+"\n\u9700\u82b1\u8d39"+o.bone+"\u57fa\u56e0",this.scheduleOnce(function(){e.setSke(e.skeUrl)},.1)},e.prototype.setSke=function(t){var e=this,o=this.mountNode.addComponent(dragonBones.ArmatureDisplay);this.mountNode.addComponent(r.default).loadArmature(t,function(){e.mountNode.isValid&&(o.armatureName="Armature",o.playAnimation("\u5f85\u673a",0))})},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},e.prototype.onUnlock=function(){var t=l.default.getMountDataById(this.mountId);s.default.totalBoneNum>=t.bone&&(s.default.totalBoneNum-=t.bone,t.onUnlock(),l.default.useMountId=t.id,this.node.emit("onUnlock"),c.default.uiCenter.showUi("GetCultivateNode").getComponent(d.default).setData("mount",this.skeUrl,"\u5f85\u673a",t.award,!0),c.default.uiCenter.closeUI(this.node))},a([h(cc.Label)],e.prototype,"tipsLabel",void 0),a([h(cc.Node)],e.prototype,"mountNode",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"./GetCultivateNode":"GetCultivateNode"}],MountView:[function(t,e,o){"use strict";cc._RF.push(e,"80eb2xoK81FMK42+ZzdW6U1","MountView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../../../InitScene/Script/data/MountModel"),l=t("../../../../Script/common/Flash"),d=t("../../center/Game"),u=t("../illustrated/IllustratedNode"),p=t("./AttributeView"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeNode=null,e.curBoneLabel=null,e.maxBoneLabel=null,e.levelLabel=null,e.attributeList=null,e.previewBtn=null,e.lightNode=null,e.flashMaterial=null,e.dragonNode=null,e.mountId=-1,e.formLevel=0,e.isFlah=!1,e}return n(e,t),e.prototype.start=function(){this.lightNode&&(this.lightNode.active=!1)},e.prototype.setBoneLabel=function(){var t=s.default.getMountDataById(this.mountId);this.curBoneLabel.string=""+Math.min(c.default.totalBoneNum,t.bone)},e.prototype.showLight=function(){var t=this;this.lightNode.opacity=0,this.lightNode.active=!0,this.isFlah=!0,cc.tween(this.lightNode).sequence(cc.tween().to(.5,{opacity:255}),cc.tween().delay(5),cc.tween().to(.5,{opacity:0})).call(function(){t.lightNode.active=!1}).start()},e.prototype.updateUI=function(t){var e=this,o=s.default.getMountDataById(this.mountId);t==o.formLevel?this.levelLabel.string=(o.level<s.MountMaxLevel?o.attributeLevel:s.FormMaxLevel)+"":this.levelLabel.string=s.FormMaxLevel+"",this.attributeList&&(this.attributeList.setLabel(o.skillDesc.replace("X",o.value+"%")),this.attributeList.setCombineLabel("\u5408\u4f53\u5f62\u6001:"+o.combine)),t!=this.formLevel&&(this.formLevel=t,this.skeNode.removeAllChildren(),this.scheduleOnce(function(){e.loadDragon(o.isUnlock&&o.formLevel==t)},.1))},e.prototype.setData=function(t,e,o){var i=this;if(void 0===o&&(o=!0),this.mountId==t)return this.previewBtn.active=o,this.updateUI(e),void(s.default.useMountId==this.mountId&&s.default.emit(s.MountEvent.ChangeMount,t));var n=s.default.getMountDataById(t);this.mountId=t,this.formLevel=e,this.previewBtn.active=o,n.isUnlock?(e==n.formLevel?this.levelLabel.string=(n.level<s.MountMaxLevel?n.attributeLevel:s.FormMaxLevel)+"":this.levelLabel.string=s.FormMaxLevel+"",this.maxBoneLabel.node.parent.active=!1):(n.bone>0?(cc.log("mount",n),this.curBoneLabel.string=""+Math.min(c.default.totalBoneNum,n.bone),this.maxBoneLabel.string=n.bone.toString(),this.maxBoneLabel.node.parent.active=!0,c.default.on(c.GameDataEvent.EVENT_TOTAL_BONE_CHANGE,this.setBoneLabel,this)):this.maxBoneLabel.node.parent.active=!1,this.levelLabel.node.parent.active=!1),this.attributeList&&(this.attributeList.setLabel(n.skillDesc.replace("X",n.value+"%")),this.attributeList.setCombineLabel("\u5408\u4f53\u5f62\u6001:"+n.combine)),this.skeNode.removeAllChildren(),this.scheduleOnce(function(){i.loadDragon(n.isUnlock&&n.formLevel==e)},.1)},e.prototype.loadDragon=function(t){var e=this;this.dragonNode=new cc.Node;var o=s.default.getMountDataById(this.mountId).form.length,i=s.default.getMountSkeUrl(this.mountId,Math.min(this.formLevel,o)*s.FormMaxLevel+1),n=this.dragonNode.addComponent(sp.Skeleton);this.dragonNode.addComponent(r.default).loadAsset(i,sp.SkeletonData,function(o,i){e.dragonNode.isValid&&(n.skeletonData=i,n.animation="daiji",t&&e.isFlah&&(e.isFlah=!1,e.dragonNode.getComponent(sp.Skeleton).setMaterial(0,e.flashMaterial),e.dragonNode.addComponent(l.default).updateFlash()))}),!t&&(this.dragonNode.color=cc.Color.BLACK),this.skeNode.addChild(this.dragonNode)},e.prototype.onIllustrated=function(){d.default.uiCenter.showUi("IllustratedNode").getComponent(u.default).setData(this.mountId)},e.prototype.onDisable=function(){this.formLevel=-1,c.default.off(c.GameDataEvent.EVENT_TOTAL_BONE_CHANGE,this.setBoneLabel)},a([m(cc.Node)],e.prototype,"skeNode",void 0),a([m(cc.Label)],e.prototype,"curBoneLabel",void 0),a([m(cc.Label)],e.prototype,"maxBoneLabel",void 0),a([m(cc.Label)],e.prototype,"levelLabel",void 0),a([m(p.default)],e.prototype,"attributeList",void 0),a([m(cc.Node)],e.prototype,"previewBtn",void 0),a([m(cc.Node)],e.prototype,"lightNode",void 0),a([m(cc.Material)],e.prototype,"flashMaterial",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../Script/common/Flash":void 0,"../../../../framework/Script/component/LoaderAssetNode":void 0,"../../center/Game":"Game","../illustrated/IllustratedNode":"IllustratedNode","./AttributeView":"AttributeView"}],NewBieTryMoreNode:[function(t,e,o){"use strict";cc._RF.push(e,"c66dbYltANEMo2t9vhpeQ/w","NewBieTryMoreNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/data/GuideModel"),l=t("../../../../InitScene/Script/data/MountModel"),d=t("../../center/Game"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeNode=null,e.type="",e.id=0,e.callback=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){this.callback=t,this.id=0,this.setSke(l.default.getMountSkeUrl(this.id,l.MountMaxLevel-1),"\u5f85\u673a","Armature")},e.prototype.setSke=function(t,e,o){var i=this;void 0===o&&(o="armatureName"),this.skeNode.active=!0;var n=this.skeNode.addComponent(sp.Skeleton);this.skeNode.addComponent(r.default).loadAsset(t,sp.SkeletonData,function(t,e){i.skeNode.isValid&&(n.skeletonData=e,n.animation="daiji")})},e.prototype.onClick=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.trySuccess=function(){l.default.tryMountId=this.id,l.default.tryMountLevel=l.MountMaxLevel-1,s.default.completeStep(),s.default.emit(s.NEWBIE_EVENT.CLICK_TRY_MOUNT_SUCCESS),this.close(!0)},e.prototype.close=function(t){this.callback&&this.callback(t),d.default.uiCenter.closeUI(this.node)},e.prototype.onClose=function(){this.close(!1)},a([h(cc.Node)],e.prototype,"skeNode",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../InitScene/Script/data/GuideModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game"}],NoticeNode:[function(t,e,o){"use strict";cc._RF.push(e,"38936FcvplLdqIKBwj8duEt","NoticeNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/OtherData"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLabel=null,e.textLabel=null,e}return n(e,t),e.prototype.start=function(){r.default.noticeTitle?this.titleLabel.string=r.default.noticeTitle:this.titleLabel.node.active=!1,this.textLabel.string=r.default.noticeText},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([d(cc.Label)],e.prototype,"titleLabel",void 0),a([d(cc.Label)],e.prototype,"textLabel",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/OtherData":void 0,"../../center/Game":"Game"}],OfflineNode:[function(t,e,o){"use strict";cc._RF.push(e,"eb9a3Hk+wtG2YNup7qFQLav","OfflineNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/prefab/AwardButton"),c=t("../../../../InitScene/Script/center/GameInit"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/GunModel"),d=t("../../../../InitScene/Script/data/OtherData"),u=t("../../../../InitScene/Script/data/TimeModel"),p=t("../../../../Script/base/Utils"),h=t("../../center/Game"),f=t("../prefabs/CoinNode"),m=cc._decorator,y=m.ccclass,g=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeLabel=null,e.coinText=null,e.coinProfit=0,e}return n(e,t),e.prototype.start=function(){h.default.gameAudio.playWindow();var t=Math.floor(u.default.totalOffline/36e5),e=Math.floor((u.default.totalOffline-36e5*t)/6e4);this.timeLabel.string="\u79bb\u7ebf\u65f6\u95f4"+(t>0?t+"\u65f6":"")+(e>0?e+"\u5206":""),cc.log("\u79bb\u7ebf\u63cf\u8ff0",Math.floor(u.default.totalOffline/1e3)),this.coinProfit=Math.min(Math.floor(u.default.totalOffline/1e3),d.default.offlineSecond)*l.default.profit*d.default.offlineRatio,this.coinText.string=this.coinText.string.replace("x",p.formatNumber(this.coinProfit))},e.prototype.onReceive=function(t){u.default.totalOffline=0,s.default.totalCoinNum+=this.coinProfit,h.default.event.emit(f.CoinEvent.TotalCoinChangeAnimoEvent,t.touch.getStartLocation(),c.default.uiCenter.node),h.default.gameAudio.playOfflineCoin(),this.onClose()},e.prototype.onTriple=function(t){t.target.getComponent(r.default).onClick(t)},e.prototype.videoSuccess=function(t){u.default.totalOffline=0,s.default.totalCoinNum+=3*this.coinProfit,h.default.event.emit(f.CoinEvent.TotalCoinChangeAnimoEvent,t.touch.getStartLocation(),c.default.uiCenter.node),h.default.gameAudio.playOfflineCoin(),this.onClose()},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},a([g(cc.Label)],e.prototype,"timeLabel",void 0),a([g(cc.RichText)],e.prototype,"coinText",void 0),a([y],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/OtherData":void 0,"../../../../InitScene/Script/data/TimeModel":void 0,"../../../../Script/base/Utils":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../prefabs/CoinNode":"CoinNode"}],OnlineAwardNode:[function(t,e,o){"use strict";cc._RF.push(e,"b398263bqpGsK7QSAGOXm8/","OnlineAwardNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GunModel"),c=t("../../../../InitScene/Script/data/OnlineModel"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeLabel=null,e.awardSprite=null,e.awardSpriteFrame=[],e.awardLabel=null,e.getBtn=null,e}return n(e,t),e.prototype.start=function(){this.setNode(),this.setAward(),this.setTime(),this.schedule(this.setTime,1)},e.prototype.setNode=function(){this.node.active=!c.default.isAwardAll},e.prototype.onAward=function(){c.default.isCanGetAward&&(c.default.getAward(),this.setNode(),this.setBtn(),this.setAward(),s.default.gameAudio.playWindow())},e.prototype.setAward=function(){var t=c.default.nowAward;0==t.type?this.awardLabel.string="X"+c.default.awardNum*r.default.profit:this.awardLabel.string="X"+t.num,this.awardSprite.spriteFrame=this.awardSpriteFrame[t.type]},e.prototype.setBtn=function(){c.default.isCanGetAward&&this.getBtn.interactable!==c.default.isCanGetAward?this.getBtn.getComponent(cc.Animation).play():c.default.isCanGetAward||(this.getBtn.getComponent(cc.Animation).stop(),this.getBtn.node.scale=1),this.getBtn.interactable=c.default.isCanGetAward},e.prototype.setTime=function(){this.timeLabel.string=this.timeToStr(),this.setBtn()},e.prototype.timeToStr=function(){var t=Math.max(0,c.default.needtime-c.default.onlineTime),e=Math.floor(t/60),o=t-60*e;return(e<10?"0"+e+":":e+":")+(o<10?"0"+o:o)},a([u(cc.Label)],e.prototype,"timeLabel",void 0),a([u(cc.Sprite)],e.prototype,"awardSprite",void 0),a([u([cc.SpriteFrame])],e.prototype,"awardSpriteFrame",void 0),a([u(cc.Label)],e.prototype,"awardLabel",void 0),a([u(cc.Button)],e.prototype,"getBtn",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/OnlineModel":void 0,"../../center/Game":"Game"}],PersonView:[function(t,e,o){"use strict";cc._RF.push(e,"e1308lOSXhJfa8L45KG3rz3","PersonView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../../framework/Script/component/LoaderDragonBones"),s=t("../../../../../InitScene/Script/data/GunModel"),l=t("../../../../../InitScene/Script/data/MountModel"),d=t("../../../../../InitScene/Script/data/PersonModel"),u=t("../../../../../InitScene/Script/data/PostModel"),p=t("../../cultivate/AttributeView"),h=t("./GunView"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.dragon=null,e.hero=null,e.invincibleNode=null,e.heroSke=null,e.dragonSke=null,e.hpProgress=null,e.hpLabel=null,e.attributeList=null,e.descLabel=null,e.dialog=null,e.isScale=!1,e.isPlayActvity=!1,e.isHero=!1,e.personIdx=null,e.gunIdx=null,e.petIdx=-1,e.clickTimes=0,e.isPlay=!1,e}return n(e,t),e.prototype.onEnable=function(){this.changeMount()},e.prototype.start=function(){l.default.on(l.MountEvent.ChangeMount,this.changeMount,this),s.default.on(s.GunEvent.ChangeGun,this.changeGun,this),d.default.on(d.HeroEvent.ChangeHero,this.changeHero,this),this.dialog&&(this.dialog.active=!1),u.default.emitpostInfoList.click3Mount&&!u.default.emitpostInfoList.click3Mount.isSent&&(this.showDialog(),this.schedule(this.showDialog,13))},e.prototype.showDialog=function(){var t=this;this.isPlayActvity&&-1!=l.default.useMountId&&!u.default.activity0501&&(this.dialog&&(this.dialog.active=!0),this.dialog&&this.dialog.getComponent(cc.Animation).play(),this.dialog&&this.dialog.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){t.dialog.active=!1}))},e.prototype.onClickMount=function(){},e.prototype.changeHero=function(t){t||(t=d.default.useHeroId),this.personIdx=t,this.loadHeroSke()},e.prototype.changeMount=function(t){void 0===t&&(t=-1),this.petIdx=-2,this.loadMount()},e.prototype.init=function(t,e,o,i){var n=this;null==t?(t=d.default.useHeroId,this.isHero=!1):this.isHero=!0,this.sprite.node.active=!0,-1!=e?(null==e&&(e=s.default.useGunId),this.gunIdx=e):this.sprite.node.active=!1,this.hideDescBg(),this.unschedule(this.setDescLabel),this.unschedule(this.hideDescBg),this.personIdx!=t?(this.personIdx=t,this.loadHeroSke().then(function(){-1!=e&&n.changeGun(e),i&&i()}),this.scheduleOnce(this.setDescLabel,2)):(-1!=e&&n.changeGun(e),i&&i()),this.loadHp(t),this.setAttributePanel()},e.prototype.setDescLabel=function(){this.descLabel&&(this.descLabel.node.parent.active=!0,this.descLabel.string=d.default.getHeroDescById(this.personIdx),this.scheduleOnce(this.hideDescBg,3))},e.prototype.hideDescBg=function(){this.descLabel&&(this.descLabel.node.parent.active=!1)},e.prototype.setAttributePanel=function(){if(this.attributeList){for(var t=[],e=s.default.getGunAttributeDataById(this.gunIdx),o=d.default.getHeroAttributeDataById(this.personIdx),i=[],n=0;n<e.length;n++){var a=e[n]+o[n];i.push(a)}this.isHero?(t=d.default.getHeroAttributeDataById(d.default.useHeroId),this.attributeList.setData(i,d.default.getAttributeDiff(t,o))):(t=s.default.getGunAttributeDataById(s.default.useGunId),this.attributeList.setData(i,d.default.getAttributeDiff(t,e)))}},e.prototype.loadHp=function(t){this.hpLabel&&(this.hpProgress.node.active=this.isHero,this.isHero&&(this.hpLabel.string=d.default.getHeroDataById(t).HP.toString()))},e.prototype.changeGun=function(t){this.sprite&&this.loadGun(t)},e.prototype.loadPerson=function(){var t=this,e="hero/dragon/"+d.default.getHeroDataById(this.personIdx).skeUrl;return new Promise(function(o){t.loadMount(),t.scheduleOnce(function(){c.default.addLoaderDragonBones(t.hero).loadArmature(e,function(){t.scheduleOnce(function(){t.hero.armatureName="armatureName";var e=t.hero.attachUtil.generateAttachedNodes("\u67aa")[0];t.sprite.node.parent=e,t.sprite.node.setPosition(cc.v2(0,0)),t.hero.playAnimation("\u5f85\u673a",0),o&&o()})})})})},e.prototype.loadGun=function(t){var e=this;return new Promise(function(o,i){e.sprite.node.removeAllChildren(),e.scheduleOnce(function(){var n="gun/prefabs/normal/"+t;r.default.addLoadingAssetNode(e.sprite.node).loadAsset(n,cc.Prefab,function(t,n){if(t)i();else{console.log("PersonView loadGun......");var a=cc.instantiate(n);a.getComponent(h.default).init(!0,!1),e.sprite.node.addChild(a),a.setPosition(cc.v2(0,20)),o()}})})})},e.prototype.loadMount=function(){if(-1==l.default.useMountId)return this.heroSke.node.parent=this.dragonSke.node.parent,this.heroSke.node.x=0,this.heroSke.node.scaleX=1,this.dragonSke.skeletonData=null,void(this.dragonSke.node.active=!1);this.heroSke.node.x=60,this.dragonSke.node.active=!0;var t=this;return new Promise(function(e){var o=l.default.getMountDataById(l.default.useMountId);t.scheduleOnce(function(){r.default.addLoadingAssetNode(t.dragonSke.node).loadAsset(l.default.getMountSkeUrl(o.id,o.level),sp.SkeletonData,function(o,i){t.petIdx=l.default.useMountId,t.scheduleOnce(function(){t.dragonSke.skeletonData=i,t.dragonSke.animation="daiji"}),e()})})})},e.prototype.update=function(){},e.prototype.loadHeroSke=function(){var t=this,e="hero/dragon/"+d.default.getHeroDataById(this.personIdx).skeUrl;return new Promise(function(o){t.loadMount(),t.scheduleOnce(function(){r.default.addLoadingAssetNode(t.heroSke.node).loadAsset(e,sp.SkeletonData,function(e,i){t.scheduleOnce(function(){t.heroSke.skeletonData=i;var e=t.heroSke.attachUtil;e.generateAllAttachedNodes();var n=e.getAttachedNodes("qiangguadian")[0];t.sprite.node.parent=n,t.sprite.node.setPosition(cc.v2(0,0)),t.heroSke.animation="daiji",o&&o()})})})})},a([y(cc.Sprite)],e.prototype,"sprite",void 0),a([y(dragonBones.ArmatureDisplay)],e.prototype,"dragon",void 0),a([y(dragonBones.ArmatureDisplay)],e.prototype,"hero",void 0),a([y(cc.Node)],e.prototype,"invincibleNode",void 0),a([y(sp.Skeleton)],e.prototype,"heroSke",void 0),a([y(sp.Skeleton)],e.prototype,"dragonSke",void 0),a([y(cc.ProgressBar)],e.prototype,"hpProgress",void 0),a([y(cc.Label)],e.prototype,"hpLabel",void 0),a([y(p.default)],e.prototype,"attributeList",void 0),a([y(cc.Label)],e.prototype,"descLabel",void 0),a([y(cc.Node)],e.prototype,"dialog",void 0),a([y(cc.Boolean)],e.prototype,"isScale",void 0),a([y(cc.Boolean)],e.prototype,"isPlayActvity",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/PostModel":void 0,"../../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../../framework/Script/component/LoaderDragonBones":void 0,"../../cultivate/AttributeView":"AttributeView","./GunView":"GunView"}],PetBase:[function(t,e,o){"use strict";cc._RF.push(e,"549b5f8O+NPXLwaFFX9ilQ9","PetBase");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/PlayerModel"),c=t("../../../joystick/JoystickCommon"),s=t("../../../manage/GameManage"),l=t("../../../test/EditView"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragon=null,e.dragonSke=null,e.mountIdx=0,e.mount_level=0,e.bloodLevel=0,e._speedType=c.SpeedType.STOP,e._moveSpeed=200,e.moveDir=cc.v2(-1,0),e.moveCan=[l.ItemType.BLOCK,l.ItemType.BOX,l.ItemType.WATER,l.ItemType.SHADOW,l.ItemType.MOUNTAIN,l.ItemType.CN],e.flymoveCan=[l.ItemType.MOUNTAIN],e.attackDir=cc.v2(-1,0),e.offect=cc.Vec2.ZERO,e.target=null,e.gameView=null,e.model=new r.default,e.isIdle=!1,e.isFill=!1,e.atkDir=null,e.attacking=!1,e.isStop=!1,e.isPlay=!1,e.animation="",e.isDead=!1,e}return n(e,t),e.prototype.init=function(){this.gameView=s.default.getInstance().gameView},e.prototype.changeAnimation=function(t){var e=this;t.flag&&(this.isPlay=!1,this.animation=""),this.dragon&&this.dragon.isValid&&(this.isPlay||(t.loop?this.animation!=t.animation&&(this.animation=t.animation,this.dragon.timeScale=1,this.dragon.playAnimation(t.animation,0),t.callback&&t.callback()):(this.dragon.once(dragonBones.EventObject.COMPLETE,function(){e.isPlay=!1,t.callback&&t.callback()}),this.isPlay=!0,this.animation="",this.dragon.timeScale=1,this.dragon.playAnimation(t.animation,1))))},e.prototype.move=function(t){var e=1/t;e=Math.max(40,e);var o=this.moveDir.mul(this._moveSpeed/e).add(this.offect.mul(1/e)),i=this.node.getPosition().add(o);i.equals(this.node.getPosition())||(this.node.setPosition(this.check(i)),this.node.zIndex=2*-Math.floor((this.node.y+this.gameView.mapSizeY/2)/this.gameView.size)-1)},e.prototype.pauseMove=function(t){void 0===t&&(t=!1),t&&!this.isStop&&(this.isStop=!0,this.offect=cc.Vec2.ZERO,this.attacking=!1),this._speedType=c.SpeedType.STOP},e.prototype.resumeMove=function(t){void 0===t&&(t=!1),t&&this.isStop&&(this.isStop=!1,this.offect=cc.Vec2.ZERO,this.attacking=!0),this._speedType=c.SpeedType.NORMAL},e.prototype.check=function(t){var e=this,o=Math.abs((this.node.width-this.gameView.mapSizeX)/2),i=Math.abs((this.node.height-this.gameView.mapSizeY)/2);t.x>o?t.x=o:t.x<-o&&(t.x=-o),t.y>i?t.y=i-this.node.height:t.y<-i&&(t.y=-i);var n=this.node.getBoundingBox();n.x+=t.sub(this.node.getPosition()).x,n.y+=t.sub(this.node.getPosition()).y,n.height+=3;var a=new Set;if(this.gameView&&this.gameView.quadTree.retrieve(n).forEach(function(o){if(e.gameView.nameList.indexOf(o.node.name)>-1&&e.moveCan.indexOf(o.type)>-1){var i=0,n=cc.v2(o.node.position),r=cc.v2(t.x,e.node.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),c=cc.v2(e.node.x,t.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),s=(o.node.width+e.node.width)/2,l=(o.node.height+e.node.height)/2;(Math.abs(n.x-r.x)>=s||Math.abs(n.y-r.y)>=l||t.sub(n).mag()>e.node.getPosition().sub(n).mag()&&!cc.Intersection.lineRect(cc.v2(e.node.x,e.node.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),r,o.node.getBoundingBox()))&&i++,(Math.abs(n.x-c.x)>=s||Math.abs(n.y-c.y)>=l||t.sub(n).mag()>e.node.getPosition().sub(n).mag()&&!cc.Intersection.lineRect(cc.v2(e.node.x,e.node.y+(.5-e.node.anchorY)*e.node.height*e.node.scaleY),c,o.node.getBoundingBox()))&&(i+=2),a.add(i)}}),a.size<5){var r=Array.from(a.values()),c=r.every(function(t){return 3==t}),s=r.every(function(t){return 1==t||3==t}),l=r.every(function(t){return 2==t||3==t});c||(s?t.y=this.node.y:l?t.x=this.node.x:t=this.node.getPosition())}else t=this.node.getPosition();return t},e.prototype.checkTarget=function(){return!this.isDead},e.prototype.findTargets=function(){var t=this;return this.gameView.targets.filter(function(e){return t.checkTarget(e)&&0==e.model.group}).sort(function(e,o){return e.node.position.sub(t.node.position).mag()-o.node.position.sub(t.node.position).mag()})},e.prototype.getDir=function(t){return void 0===t&&(t=this.target),this.checkTarget(t)?cc.v2(t.node.getPosition().sub(this.node.getPosition()).normalizeSelf()):this.moveDir},e.prototype.getOffect=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.dragonSke?cc.v2(t,e):cc.Vec2.ZERO},e.prototype.updateDir=function(t){t=this.moveDir,this.dragonSke&&(t.x>0?this.dragonSke.node.scaleX=.4:this.dragonSke.node.scaleX=-.4)},e.prototype.die=function(){this.offect=cc.Vec2.ZERO,this.target=null,this.dragonSke&&this.dragonSke.node.active?this.isStop?(this.isStop=!1,this.isDead=!0,this.dragonSke&&this.changeAnimation({animation:"\u6b7b\u4ea1",loop:!1,flag:!0})):(this.isDead=!0,this.dragonSke&&this.changeAnimation({animation:"\u6b7b\u4ea1",loop:!1,flag:!0})):(this.isDead=!0,this.isStop,this.node&&(this.node.active=!1))},a([p(dragonBones.ArmatureDisplay)],e.prototype,"dragon",void 0),a([p(sp.Skeleton)],e.prototype,"dragonSke",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../../../InitScene/Script/data/PlayerModel":void 0,"../../../joystick/JoystickCommon":"JoystickCommon","../../../manage/GameManage":"GameManage","../../../test/EditView":"EditView"}],PetNode:[function(t,e,o){"use strict";cc._RF.push(e,"b1086tgPv9FQqtrbhQN/A7m","PetNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../../InitScene/Script/data/GunModel"),s=t("../../../../../InitScene/Script/data/MountModel"),l=t("../../../../../InitScene/Script/data/PersonModel"),d=t("../../../../../InitScene/Script/data/PlayerModel"),u=t("../../../joystick/JoystickCommon"),p=t("../../../manage/GameManage"),h=t("./PetBase"),f=cc._decorator,m=f.ccclass,y=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delay=1,e.think=.02,e.findTime=0,e.path_idx=0,e.path=[],e.isRun=!1,e.isStart=!1,e.isDelay=!1,e.group=0,e}return n(e,t),e.prototype.start=function(){this.loadModel(this.mountIdx),this.loadSkin(this.mountIdx),this.init()},e.prototype.loadSkin=function(t){var e=this;t||0===t||(t=s.default.useMountId),e.scheduleOnce(function(){t>-1&&e.loadMount(t)})},e.prototype.loadMount=function(t){var e=this,o=s.default.getMountSkeUrl(t,this.mount_level);r.default.addLoadingAssetNode(e.dragonSke.node).loadAsset(o,sp.SkeletonData,function(t,o){e.scheduleOnce(function(){e.dragonSke.skeletonData=o,e.dragonSke.animation="daiji"})})},e.prototype.init=function(){var t,e=p.default.getInstance();if(this.gameView=e.gameView,0==this.group)t=this.gameView.player.getPosition();else{var o=this;this.gameView.ais.some(function(e){return e.model.group==o.group&&(t=e.node.getPosition()),e.model.group==o.group})}this.node.setPosition(t)},e.prototype.initPet=function(t,e,o,i,n,a){void 0===i&&(i=1),void 0===n&&(n=0),void 0===a&&(a=-1),-1==a&&(a=this.gameView.curPlayer.personIdx),this.group=n;var r=this;this.index=t,void 0===e&&(e=1),this.mountIdx=o,this.mount_level=i,this.model.group=1e3+t,this.bloodLevel=0,this.model.type&&(this.think=e),s.default.getMountDataById(o).getUpgradeLevelValue(),console.log("petnode initpet heroIdx:"+a),this.model.SPE=l.default.getHeroDataById(a).MOVESPE,this.schedule(function(){r.isStart&&!r.isStop&&r.run()},this.think)},e.prototype.getDir=function(t){return t=t||this.target,this.checkTarget(t)?cc.v2(t.node.getPosition().sub(this.node.getPosition()).normalizeSelf()):this.atkDir?this.atkDir:this.moveDir},e.prototype.updateAtkDir=function(t){if(t){var e=t.node.getPosition().sub(this.node.getPosition());0!=this.model.group&&(this.model.type==d.ArmType.\u72d9\u51fb||this.model.type==d.ArmType.\u5bfc\u5f39||this.model.type==d.ArmType.\u8d2f\u7a7f)&&e.mag()<5e3?(this.attacking=!1,0==this.moveDir.x&&0==this.moveDir.y&&(this.moveDir=this.dragonSke.node.scaleX>0?cc.v2(-1,0):cc.v2(1,0)),this.updateDir(this.atkDir?this.atkDir:this.moveDir)):(this.attacking=!0,this.updateDir(e.normalize()))}else this.attacking=!1,0==this.moveDir.x&&0==this.moveDir.y&&(this.moveDir=this.dragonSke.node.scaleX>0?cc.v2(-1,0):cc.v2(1,0)),this.updateDir(this.atkDir?this.atkDir:this.moveDir)},e.prototype.findTargets=function(t){void 0===t&&(t=0);var e=this;return this.gameView.targets.filter(function(o){return e.checkTarget(o)&&o.model.group==t}).sort(function(t,o){return t.node.position.sub(e.node.position).mag()-o.node.position.sub(e.node.position).mag()})},e.prototype.loadModel=function(t){cc.log("AIloadModel:",t,this.model.group),this.model.IDLE<=.2&&this.think>.2&&(this.think=.2)},e.prototype.isAttack=function(){return!1},e.prototype.isAttackBlock=function(){return!1},e.prototype.doAttack=function(){return!!this.checkTarget(this)&&(this.isFill,!0)},e.prototype.attack=function(){},e.prototype.delayAttack=function(){this.isDelay=!1,this.isStop||(this.updateDir(this.getDir()),this.doAttack()&&(this._speedType=u.SpeedType.NORMAL,this.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf()))},e.prototype.run=function(){var t=this;this.isRun||(this.findTime+1e3*this.delay>(new Date).getTime()&&this.attacking&&this.checkTarget(this.target)?(this._speedType=u.SpeedType.NORMAL,this.moveDir=this.moveDir.rotate(Math.PI/20*(Math.random()-.5)),this.isRun=!0,this.scheduleOnce(function(){t.isRun=!1},this.delay)):this.isFind()?(this.isRun=!0,this.doRun()):(this.isRun=!0,this.scheduleOnce(function(){t.isRun=!1},this.delay)))},e.prototype.doRun=function(){var t=this;if(this.path_idx>-1&&this.path_idx<this.path.length)if(this.isStop)this.scheduleOnce(function(){t.doRun()},this.delay);else{var e=this.gameView.astar.getPos(this.path[this.path_idx]).sub(this.node.getPosition());this.moveDir=e.normalize(),this.scheduleOnce(function(){t.path_idx--,t.path_idx<0?t.isRun=!1:t.doRun()},1/Math.max(1,t.path_idx))}},e.prototype.isFind=function(){var t=this,e=this.findTargets(this.group),o=e.filter(function(e){return e==t.gameView.curPlayer});if(o.length>0){if(this.target=o[0],this.findPath(o[0]),this.path.length>1)return this.path_idx=this.path.length-2,!0}else if(e.length>0){if(this.target=e[0],this.findPath(e[0]),this.path.length>1)return this.path_idx=this.path.length-2,!0}else if(this.checkTarget(this.target)&&Math.abs(this.target.node.x-this.node.x)<=cc.winSize.width/2+500&&Math.abs(this.target.node.y-this.node.y)<=cc.winSize.height/2+500&&(this.findPath(this.target),this.path.length>1))return this.path_idx=this.path.length-2,!0;return this.target=null,!1},e.prototype.findPath=function(t){var e=this.gameView.astar.getGird(this.node.getPosition()),o=this.gameView.astar.getGird(t.node.getPosition());this.path=this.gameView.astar.findPath(e,o),this.gameView.astar.floyd(this.path),this.findTime=(new Date).getTime()},e.prototype.findItems=function(){},e.prototype.getPersonIdx=function(t){var e=t;return e>=l.default.getHeroTotalNum()&&(e=l.default.getHeroTotalNum()-Math.floor(3*Math.random())-1),e<0&&(e=0),e},e.prototype.getGunIdx=function(t){var e=t;return e>=c.default.getGunTotalNum()&&(e=c.default.getGunTotalNum()-Math.floor(3*Math.random())-1),e<0&&(e=0),e},e.prototype.changeAnimation=function(t){var e=this;t.flag&&(this.isPlay=!1,this.animation=""),this.dragonSke&&this.dragonSke.isValid&&(this.isPlay||(t.loop?this.animation!=t.animation&&(this.animation=t.animation,"\u79fb\u52a8"==this.animation?this.dragonSke.timeScale=2:this.dragonSke.timeScale=1,this.dragonSke.setAnimation(0,t.animation,!0),t.callback&&t.callback()):(this.dragonSke.timeScale=1,this.dragonSke.setCompleteListener(function(){e.isPlay=!1,t.callback&&t.callback(),0==e.model.group&&cc.log("dragon\u5750\u9a91",e.model.group,e.isPlay,t.callback),e.dragonSke.setCompleteListener(null)}),this.isPlay=!0,this.animation="",this.dragonSke.timeScale=1,this.dragonSke.setAnimation(0,t.animation,!1))))},e.prototype.update=function(t){if(this.checkTarget(this)){if(!this.isStop&&this.checkTarget(this))switch(this.isStart&&(this.updateAtkDir(this.target),this.target&&this.target.node.getPosition().sub(this.node.getPosition()).mag()<128&&(this.isRun=!1,this._speedType=u.SpeedType.STOP),this.isRun&&(this._speedType=u.SpeedType.NORMAL)),this._speedType){case u.SpeedType.STOP:this._moveSpeed=0,this.changeAnimation({animation:"daiji",loop:!0});break;case u.SpeedType.NORMAL:case u.SpeedType.FAST:this._moveSpeed=this.model.SPE,this.changeAnimation({animation:"yidong",loop:!0})}this.move(t)}},a([m],e)}(h.default));o.default=y,cc._RF.pop()},{"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../InitScene/Script/data/PlayerModel":void 0,"../../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../joystick/JoystickCommon":"JoystickCommon","../../../manage/GameManage":"GameManage","./PetBase":"PetBase"}],PlayManage:[function(t,e,o){"use strict";cc._RF.push(e,"5b166+OvOhFBrg1OIkQlyeM","PlayManage");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/center/GameInit"),c=t("../../../../InitScene/Script/data/GuideModel"),s=t("../../../../InitScene/Script/data/RankModel"),l=t("../../../../InitScene/Script/data/TimeModel"),d=t("../../../../Script/base/Utils"),u=t("../../center/Game"),p=cc._decorator,h=p.ccclass,f=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){c.default.isNewbie.isNewbie&&!c.default.stepsMainData[c.NEWBIE_EVENT.BEGIN_GAME].isComplete||(this.checkSeasonOver(),u.default.event.once("checkSeasonOver",this.checkSeasonOver,this))},e.prototype.checkOfflineTime=function(){l.default.totalOffline>0&&r.default.uiCenter.showUi("OfflineNode")},e.prototype.checkSeasonOver=function(){d.isDateUpdata(s.default.todayOpenTime)?(-1!=s.default.lastLevel?(r.default.uiCenter.showUi("SeasonOverNode"),r.default.uiCenter.showUi("SeasonBeginNode")):r.default.uiCenter.showUi("SeasonDayReportNode"),s.default.todayOpenTime=(new Date).getTime()):this.checkOfflineTime()},a([h],e)}(cc.Component));o.default=f,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GuideModel":void 0,"../../../../InitScene/Script/data/RankModel":void 0,"../../../../InitScene/Script/data/TimeModel":void 0,"../../../../Script/base/Utils":void 0,"../../center/Game":"Game"}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"14a2anvKcdNHJCFbfRclF2e","Player");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../InitScene/Script/data/GunModel"),c=t("../../InitScene/Script/data/PersonModel"),s=t("../../InitScene/Script/data/PlayerModel"),l=t("./manage/GameManage"),d=t("./BasePlayer"),u=t("./FollowCamare"),p=t("./joystick/JoystickCommon"),h=t("./test/EditView"),f=t("./view/game/ArmView"),m=t("./view/game/FireView"),y=t("../../InitScene/Script/data/MountModel"),g=t("../../framework/Script/component/LoaderDragonBones"),v=t("../../MainScene/Script/center/Game"),_=t("./view/game/SkillView"),S=t("../../framework/Script/component/LoaderAssetNode"),b=t("../Script/ui/prefabs/view/GunView"),w=t("../../Script/common/Flash"),I=t("../../InitScene/Script/data/GameData"),M=t("../../InitScene/Script/data/CombineHeroModel"),k=t("../../InitScene/Script/data/SkillsModel"),N=t("../../InitScene/Script/data/GMModel"),T=cc._decorator,O=T.ccclass,C=T.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.circle=null,e.line=null,e.flashMaterial=null,e.skillLight=!1,e.atkDir=null,e.fire=null,e.isIdle=!1,e.isFill=!1,e.isLine=!1,e.isHurt=!1,e.isShadow=!1,e.lineLen=0,e.CDtime=0,e.skilltime=0,e.combineCDtime=0,e.combine_skilltime=0,e.skillAtk=0,e.hpBuff=0,e.atkBuff=0,e.speBuff=0,e.bloodLevel=0,e.skill_playTimes=0,e.combineSkill_playTimes=0,e.isPlayDie=!1,e.isCombine=!1,e.pet=null,e.gameType=null,e.targetBlock=null,e.isLoadGunFinsh=!1,e}var o;return n(e,t),o=e,e.prototype.start=function(){if(this.gameType=l.default.getInstance().gameType,this.personIdx=c.default.useHeroId,this.gunIdx=r.default.useGunId,this.mountIdx=y.default.useMountId,this.mountIdx>-1&&(this.mount_level=y.default.getMountDataById(this.mountIdx).level),r.default.tryGunId>-1&&(this.gunIdx=r.default.tryGunId,r.default.tryGunId=-1),c.default.tryHeroId>-1&&(this.personIdx=c.default.tryHeroId,c.default.tryHeroId=-1),y.default.tryMountId>-1&&(this.mountIdx=y.default.tryMountId,y.default.tryMountId=-1),y.default.tryMountLevel>-1&&(this.mount_level=y.default.tryMountLevel,y.default.tryMountLevel=0),this.gameView.initPet(this.mountIdx,this.mount_level),this.loadModel(this.personIdx,this.gunIdx,this.mountIdx),this.loadSkin(this.personIdx,this.mountIdx),this.gameType==l.GameType.\u7ade\u6280\u573a){var t=l.default.getInstance().player;this.model.nickname=t.name,this.model.icon=t.avatarUrl,this.model.playerItemData=t}},e.prototype.loadModel=function(t,e,o){var i,n,a,s;n=c.default.getHeroDataById(t),i=r.default.getGunDataById(e),a=y.default.getMountDataById(o),this.skill=n.skill,this.skill_playTimes=n.skill_playTimes,this.skillAtk=n.SkillATK;var d=""+this.personIdx+this.mountIdx+(Math.floor(this.mount_level/y.FormMaxLevel)+1),u=M.default.getHeroDataById(d);this.combineSkill=u?u.skill:0,0==this.model.group?(this.isInvincible=N.default.godMode,s=y.default.getUpgradeLevelValue(o,this.mount_level),this.model.MAX_HP=this.model.HP=Math.floor(n.HP+i.HP+s.hp),this.gameType==l.GameType.\u7ade\u6280\u573a&&(this.model.MAX_HP=this.model.HP=4*Math.floor(n.HP+i.HP+s.hp)),this.model.ATK=Math.floor(n.ATK+i.ATK+s.atk),this.model.SkillATK=n.ATK*(n.SkillATK/100),this.model.IDLE=n.IDLE+i.IDLE,this.model.CRI=n.CRI+i.CRI,this.model.RAN=i.RAN+n.DIST+s.ran,this.model.ROT=i.ROT,this.model.MOV=i.MOV+n.ATKSPE+s.atk_spe,this.model.bullet=i.bullet,this.model.fire=i.fire,this.model.type=i.ATtypeK,this.model.audio=i.audio,this.model.hurt_audio=i.hurt_audio,this.model.num=i.num,this.model.total=i.total,this.model.time=i.time,this.model.pow=i.pow,this.model.hit=i.hit,this.model.die_audio=n.die_audio,cc.log("\u73a9\u5bb6loadModel",o,a,i,n,t,c.default.useHeroId,this.model.MAX_HP,this.model.HP)):this.gameType==l.GameType.\u7ade\u6280\u573a&&(this.isInvincible=!1,s=y.default.getUpgradeLevelValue(o,this.mount_level),this.model.MAX_HP=this.model.HP=4*Math.floor(n.HP+i.HP+s.hp),this.model.ATK=Math.floor(n.ATK+i.ATK+s.atk),this.model.SkillATK=n.ATK*(n.SkillATK/100),this.model.IDLE=2,this.model.CRI=n.CRI+i.CRI,this.model.RAN=i.RAN+n.DIST+s.ran,this.model.ROT=i.ROT,this.model.MOV=i.MOV+n.ATKSPE+s.atk_spe,this.model.bullet=i.bullet,this.model.fire=i.fire,this.model.type=i.ATtypeK,this.model.audio=i.audio,this.model.hurt_audio=i.hurt_audio,this.model.num=i.num,this.model.total=i.total,this.model.time=i.time,this.model.pow=i.pow,this.model.hit=i.hit,this.model.die_audio=n.die_audio,cc.log("AI",i,n,t,this.model.MAX_HP,this.model.HP)),cc.log("player",n,i,a,s),y.default.getMountDataById(this.mountIdx).passive==y.SpecialType.AddSPE?this.isUseSkill||(this.isUseSkill=!0,this.speBuff=y.default.getMountDataById(this.mountIdx).value/100):y.default.getMountDataById(this.mountIdx).passive==y.SpecialType.CUT_HURT&&(this.isUseSkill||(this.isUseSkill=!0,this.model.CUT_HURT=y.default.getMountDataById(this.mountIdx).value/100)),this.model.SPE=(n.MOVESPE+i.SPE+s.spe)*(1+this.speBuff),this.slotName=i.slot,this.CDtime=n.skillCD,this.hpView.init(this.model.MAX_HP,this.isInvincible),this.changeGun(e),y.default.getMountDataById(o).passive==y.SpecialType.AddSPE&&this.flyMount&&(this.flyMount.node.active=!0,this.flyMount.playAnimation("newAnimation",0)),cc.log("mode.fire",this.model.fire,"mode.audio",this.model.audio),cc.log("this.model.SPE",this.model.SPE)},e.prototype.changeGun=function(t,e){this.sprite&&this.loadGun(t).then(function(){e&&e()})},e.prototype.loadGun=function(t){var e=this;return new Promise(function(o){e.scheduleOnce(function(){e.sprite.node.removeAllChildren();var i="gun/prefabs/normal/"+t;S.default.addLoadingAssetNode(e.sprite.node).loadAsset(i,cc.Prefab,function(t,i){if(!t){var n=cc.instantiate(i);n.getComponent(b.default).init(!0,!0),e.sprite.node.addChild(n),n.setPosition(cc.v2(0,20)),e.isLoadGunFinsh=!0,o()}})})})},e.prototype.loadSkin=function(t,e){var o=this;t||0===t||(t=c.default.useHeroId),e||0===e||(e=y.default.useMountId),this.scheduleOnce(function(){o.loadHeroSke(t)})},e.prototype.loadHero=function(t){var e=this,o="hero/dragon/"+c.default.getHeroDataById(t).skeUrl;g.default.addLoaderDragonBones(e.hero).loadArmature(o,function(){e.scheduleOnce(function(){e.hero.armatureName="armatureName";var t=e.hero.attachUtil.generateAttachedNodes("\u67aa")[0];t&&(e.sprite.node.setPosition(t.getPosition()),e.gunNode=t),e.sprite.node.parent=t,e.hero.playAnimation("\u5f85\u673a",0),e.isCanHurt=!0})})},e.prototype.loadHeroSke=function(t){var e=this,o=this,i=c.default.getHeroDataById(t);console.log("player loadheroske:"+t+","+this.node.name);var n="hero/dragon/"+i.skeUrl;S.default.addLoadingAssetNode(o.heroSke.node).loadAsset(n,sp.SkeletonData,function(t,i){o.scheduleOnce(function(){o.heroSke.skeletonData=i;var t=o.heroSke.attachUtil;t.generateAllAttachedNodes();var n=t.getAttachedNodes("qiangguadian")[0];n&&(o.sprite.node.setPosition(n.getPosition()),o.gunNode=n),o.sprite.node.parent=n,o.heroSke.animation=e._speedType==p.SpeedType.STOP?"daiji":"yidong",o.isCanHurt=!0})})},e.prototype.loadMount=function(){},e.prototype.init=function(){var t=l.default.getInstance();this.gameView=t.gameView,this.setPos()},e.prototype.randPos=function(){var t=this.gameView.getEmptyGird(),e=t;return console.log("randPos\u2014\u2014\u731c\u6d4b\uff1a\u8fd4\u56de\u53ef\u884c\u8d70\u7684\u70b9this.gameView.getEmptyGird()",t,e),this.node.setPosition(t.scale(cc.v2(180,this.node.height)).add(cc.v2((180-this.gameView.mapSizeX)/2,(this.node.height-this.gameView.mapSizeY)/2))),t},e.prototype.setPos=function(t,e){void 0===e&&(e=!1),console.log("setPos========\u521d\u59cb\u5316\u4f4d\u7f6e",t,e),t||0==this.model.group&&(t=-1);var o=this.gameView.getGird(t,e);return this.node.setPosition(o.scale(cc.v2(this.gameView.size,this.gameView.size)).add(cc.v2((this.gameView.size-this.gameView.mapSizeX)/2,(this.gameView.size-this.gameView.mapSizeY)/2))),this.node.zIndex=2*-Math.floor((this.node.y+this.gameView.mapSizeY/2)/this.gameView.size)-1,console.log("setPos========\u73a9\u5bb6\u4f4d\u7f6e",o.x,o.y,t,e,this.node.zIndex),o},e.prototype.restart=function(){this&&this.model&&this.model.isDead()&&(console.log("restart\u590d\u6d3b",this.model.group,this.model),this.isPlayDie=!1,this.model.restart(),this.isUseSkill=!1,l.default.getInstance(),this.setPos(),this.node.active=!0,this.node.stopAllActions(),this.hpView.reset(),this.sprite.node.active=!0,this.changeAnimation({animation:"daiji",loop:!0,flag:!0}),this.pet&&this.pet.changeAnimation({animation:"daiji",loop:!0,flag:!0}),this.pet&&(this.pet.node.opacity=255),y.default.getMountDataById(this.mountIdx).passive==y.SpecialType.AddSPE?this.flyMount&&(this.flyMount.node.active=!0,this.flyMount.playAnimation("newAnimation",0)):(y.default.getMountDataById(this.mountIdx).passive,y.SpecialType.CUT_HURT))},e.prototype.isAttack=function(t){if(this.checkTarget(this)&&this.checkTarget(t)&&!this.isStop){var e=cc.v2(this.node.position),o=cc.v2(t.node.position);return!(e.sub(o).mag()>this.model.RAN||this.gameView.quadTree.retrieve(this.node.getBoundingBox()).concat(this.gameView.quadTree.retrieve(t.node.getBoundingBox())).some(function(t){return(t.type==h.ItemType.BLOCK||t.type==h.ItemType.BOX||t.type==h.ItemType.CN||t.type==h.ItemType.SHADOW||t.type==h.ItemType.MOUNTAIN)&&cc.Intersection.lineRect(e,o,t.rect)}))}return!1},e.prototype.doAttack=function(){var t=this;if(!this.checkTarget(this))return!1;if(this.isFill)return!0;v.default.gameAudio.playGunFireClip(this.model.audio);for(var e=this.model.getCount(),o=0;o<e;o++){var i=this.gameView.getArm().getComponent(f.default);if(i){var n=this.sprite.node.getChildByName(""+this.gunIdx).getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)),a=this.gameView.layout.convertToNodeSpaceAR(n);if(i.node.setParent(this.gameView.layout),i.node.setPosition(a),0!==this.model.group&&this.gameType==l.GameType.\u7ade\u6280\u573a){var r,c=Math.random();r=this.model.type==s.ArmType.\u6563\u5c04?0:this.model.type==s.ArmType.\u5bfc\u5f39||this.model.type==s.ArmType.\u72d9\u51fb||this.model.type==s.ArmType.\u8d2f\u7a7f?c<.4?this.randomRadians(60,90):c<=.4&&c>.75?this.randomRadians(40,60):c<=.75&&c>.9?this.randomRadians(20,40):this.randomRadians(0,20):c<.15?this.randomRadians(60,90):c<=.15&&c>.45?this.randomRadians(40,60):c<=.45&&c>.8?this.randomRadians(20,40):this.randomRadians(0,20),i.init(this,this.getDir().rotate(cc.misc.degreesToRadians(r)))}else i.init(this,this.getDir());this.offect=this.getDir().mul(2*-this.model.pow);var d=this.getDir().mul(-this.model.pow),u=this.getDir().mul(this.model.pow);this.dragon.node.scaleX<0&&(d=this.getDir().add(cc.v2(-2*this.getDir().x,0)).mul(-this.model.pow),u=this.getDir().add(cc.v2(-2*this.getDir().x,0)).mul(this.model.pow)),this.sprite.node.runAction(cc.sequence(cc.moveBy(.05,d),cc.moveBy(.05,u)))}}return this.addFire(),this.model.IDLE>0&&(this.isIdle||(this.isIdle=!0,this.scheduleOnce(function(){t.isIdle=!1},this.model.IDLE))),this.model.time>0&&this.model.addCount(e)&&(this.isFill=!0,this.scheduleOnce(function(){t.isFill=!1,t.model.clearCount()},this.model.time)),!0},e.prototype.updateSkillCD=function(){0===this.model.group&&-1!=this.mountIdx&&y.default.getMountDataById(this.mountIdx)},e.prototype.updateSkillHP=function(){this.addHP(this.model.MAX_HP*(y.default.getMountDataById(this.mountIdx).value/5/100)),cc.log("\u88ab\u52a8\u6280\u80fd\u56de\u8840")},e.prototype.randomRadians=function(t,e){var o=t+Math.random()*(e-t);return Math.random()<.5?-o:o},e.prototype.doSkillAtk=function(){this.skilltime=(new Date).getTime();var t=y.default.getMountDataById(this.mountIdx),e=this.gameView.getSkill().getComponent(_.default);if(e){var o=this.sprite.node.getChildByName(""+this.gunIdx).getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)),i=this.gameView.layout.convertToNodeSpaceAR(o);e.node.setParent(this.gameView.layout),e.node.setPosition(i),e.init(this,this.getDir(),t,this.mount_level)}},e.prototype.doCombineSkillAtk=function(){var t=this;this.combine_skilltime=(new Date).getTime();var e=y.default.getMountDataById(this.mountIdx),o=this.gameView.getSkill().getComponent(_.default);if(o){var i=this.sprite.node.getChildByName(""+this.gunIdx).getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)),n=this.gameView.layout.convertToNodeSpaceAR(i);o.node.setParent(this.gameView.layout),o.node.setPosition(n),o.initCombine(this,this.getDir(),e,this.mount_level),2==this.mountIdx&&(this.headMount.node.active=!0,this.headMount.once(dragonBones.EventObject.COMPLETE,function(){t.headMount.node.active=!1},this),this.headMount.playAnimation("newAnimation",1))}},e.prototype.doAirSkillAtk=function(){if(!(this.airSkillTimes<=0)){this.airSkillTimes--;var t=this.gameView.airSkill,e=y.default.getMountDataById(this.mountIdx);t&&(this.node.position,t.node.setParent(this.gameView.layout),t.node.setPosition(this.gameView.followCamera.node.getPosition()),t.node.active=!0,t.init(this,e))}},e.prototype.addFire=function(){var t;this.fire?(t=this.fire.getComponent(m.default))&&t.doFire():(this.fire=this.gameView.getFire(),(t=this.fire.getComponent(m.default))&&this.model.fire>=0?(this.fire.setParent(this.sprite.node.getChildByName(""+this.gunIdx).getChildByName("fire")),this.updateFire(),t.init(this.model,this.removeFire.bind(this)),t.doFire()):this.removeFire())},e.prototype.updateFire=function(){this.getDir()},e.prototype.removeFire=function(){if(this.fire){var t=this.fire.getComponent(m.default);t&&t.stopFire(),this.gameView.putFire(this.fire),this.fire=null}},e.prototype.hurt=function(t){if(this.isCanHurt){var e=this;if(!t.player.isPlayDie&&this.checkTarget(this))if(this.doHurt(t),v.default.gameAudio.playHurtClip(t.hurt_audio),this.model.isDead()){var o=t.player;o&&(o.model.kill_count++,0==o.model.group&&v.default.event.emit(I.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.gameType!=l.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=l.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=o.model.group?this.gameType==l.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,o.model):this.gameView.showKill(this.model,o.model)),this.isHurt||(this.isHurt=!0,this.hero?(this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),i=this.hero.addComponent(w.default)):(this.heroSke.setMaterial(0,this.flashMaterial),i=this.heroSke.addComponent(w.default)),i.updateFlashHurt(function(){e.isHurt=!1})),this.isStop||this.model.SPE>0&&(this.offect=t.speed.normalize().mul(20*t.player.model.pow)),this.die()}else{var i;this.isStop||this.model.SPE>0&&(this.offect=t.speed.normalize().mul(40*t.player.model.pow)),this.isHurt||(this.isHurt=!0,this.hero?(this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),i=this.hero.addComponent(w.default)):(this.heroSke.setMaterial(0,this.flashMaterial),i=this.heroSke.addComponent(w.default)),i.updateFlashHurt(function(){e.isHurt=!1})),this.isHurt||(this.isHurt=!0,this.hero?(this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),i=this.hero.addComponent(w.default)):(this.heroSke.setMaterial(0,this.flashMaterial),i=this.heroSke.addComponent(w.default)),i.updateFlash()),t.type==s.ArmType.\u51b0\u51bb&&t.state==s.ArmState.\u51b0\u51bb&&this.doIce(function(){e.sprite&&(e.sprite.node.active=!0)})}}},e.prototype.hurtBySkill=function(t){if(this.isCanHurt){var e=this;if(this.checkTarget(this)){var i;if(this.doHurtBySkill(t),this.model.isDead())(i=t.player)instanceof o&&i.model.kill_count++,this.gameType!=l.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=l.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=i.model.group?this.gameType==l.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,i.model):this.gameView.showKill(this.model,i.model),0==i.model.group&&v.default.event.emit(I.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.die();else t.isCombine||((i=t.player).skill==c.HeroSkillType.Hammer?this.doSwim(null,1):i.skill==c.HeroSkillType.Camera?this.doSwim(null,3):i.skill==c.HeroSkillType.Fire&&this.doBlood(.15,3)),this.isStop||this.model.SPE>0&&(this.offect=t.dir.normalize().mul(2e3)),cc.log("=========",this.isStop,t.dir.x,t.dir.y);if(!this.isHurt){this.isHurt=!0;var n=void 0;null!=this.heroSke?(console.log("hurt heroSke setMaterial..."),this.heroSke.setMaterial(0,this.flashMaterial),n=this.heroSke.addComponent(w.default)):(console.log("hurt hero setMaterial..."),this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),n=this.hero.addComponent(w.default)),n.updateFlashHurt(function(){e.isHurt=!1})}}}},e.prototype.hurtByEnemySkill=function(t){if(this.isCanHurt){var e=this;if(this.checkTarget(this)){if(this.doHurtByEnemySkill(t),this.model.isDead())(i=t.player)instanceof o&&i.model.kill_count++,this.gameType!=l.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=l.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=i.model.group?this.gameType==l.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,i.model):this.gameView.showKill(this.model,i.model),0==i.model.group&&v.default.event.emit(I.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.die();else{var i=t.player;this.isStop||(this.offect=t.speed.normalize().mul(400))}var n;this.isHurt||(this.isHurt=!0,this.hero?(this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),n=this.hero.addComponent(w.default)):(this.heroSke.setMaterial(0,this.flashMaterial),n=this.heroSke.addComponent(w.default)),n.updateFlashHurt(function(){e.isHurt=!1}))}}},e.prototype.hurtByCN=function(t,e){if(this.isCanHurt){var i=this;if(this.checkTarget(this)){if(this.doHurtByCN(e),this.model.isDead()){var n=t.player;n instanceof o&&n.model.kill_count++,this.gameType!=l.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=l.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=n.model.group?this.gameType==l.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,n.model):this.gameView.showKill(this.model,n.model),0==n.model.group&&v.default.event.emit(I.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.die()}var a;this.isHurt||(this.isHurt=!0,this.hero?(this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),a=this.hero.addComponent(w.default)):(this.heroSke.setMaterial(0,this.flashMaterial),a=this.heroSke.addComponent(w.default)),a.updateFlashHurt(function(){i.isHurt=!1}))}}},e.prototype.hurtByAirSkill=function(t){if(this.isCanHurt){var e=this;if(this.checkTarget(this)){var o=cc.instantiate(this.gameView.airSkill.node);this.node.addChild(o),o.setPosition(cc.v2(0,0));var i=o.getComponent(dragonBones.ArmatureDisplay);i.once(dragonBones.EventObject.COMPLETE,function(){e.doHurtByAirSkill(t),e.hurtByAirSkillCallBack(t),i.destroy()}),i.playAnimation("B",1)}}},e.prototype.hurtByAirSkillCallBack=function(t){var e,i=this;if(this.model.isDead()){var n=t.player;n instanceof o&&n.model.kill_count++,this.gameType!=l.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=l.GameType.\u5e7d\u6d6e\u7ed1\u67b6||0!=n.model.group?this.gameType==l.GameType.\u7ade\u6280\u573a&&this.gameView.showKill(this.model,n.model):this.gameView.showKill(this.model,n.model),0==n.model.group&&v.default.event.emit(I.GameDataEvent.ADD_COMBINE_ENERGY,this.gameView.killEnergy),this.die()}else this.isStop||(this.offect=t.speed.normalize().mul(400));this.isHurt||(this.isHurt=!0,this.hero?(this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),e=this.hero.addComponent(w.default)):(this.heroSke.setMaterial(0,this.flashMaterial),e=this.heroSke.addComponent(w.default)),e.updateFlashHurt(function(){i.isHurt=!1}))},e.prototype.die=function(){this.unschedule(this.updateSkillHP),v.default.gameAudio.playDieClip(this.model.die_audio),this.isAtking=!1;var t=this;this.offect=cc.Vec2.ZERO,this.goSkillOffect=cc.Vec2.ZERO,this.target=null,this.removeFire(),this.hpView.node.active=!1,this.sprite.node.active=!1,this.model.rank=l.default.getInstance().model.players.filter(function(t){return!t.isDead()}).length,this.heroSke&&this.heroSke.node.active?this.isStop?(this.isStop=!1,t.heroSke&&(t.changeAnimation({animation:"siwang",loop:!1,flag:!0,callback:function(){t.model.group>=1e5&&t.node&&t.node.runAction(cc.sequence(cc.callFunc(function(){t.dropCoin(),t.dropDiamond(),t.dropDNA()}),cc.fadeOut(1),cc.callFunc(function(){t.node.active=!1,t.heroSke.node.active=!1}))),t.pet&&t.pet.node.runAction(cc.fadeOut(1))}}),this.pet&&this.pet.die(),this.isPlayDie=!0)):(this.heroSke&&this.changeAnimation({animation:"siwang",loop:!1,flag:!0,callback:function(){t.model.group>=1e5&&t.node&&t.node.runAction(cc.sequence(cc.callFunc(function(){t.dropCoin(),t.dropDiamond(),t.dropDNA()}),cc.fadeOut(1),cc.callFunc(function(){t.node.active=!1,t.heroSke.node.active=!1}))),t.pet&&t.pet.node.runAction(cc.fadeOut(1))}}),this.pet&&this.pet.die(),this.isPlayDie=!0):(this.isStop,this.node&&(this.node.active=!1)),cc.log("\u91cd\u65b0\u5f00\u59cb\u6e38\u620f\u7684\u6b21\u6570",l.default.getInstance().restartcount,this.gameType),this.gameType==l.GameType.\u7ade\u6280\u573a?0==this.model.group?l.default.getInstance().restartcount<1?l.default.getInstance().loseGame():l.default.getInstance().endGame():l.default.getInstance().checkGame():this.gameType!=l.GameType.\u666e\u901a\u5173\u5361&&this.gameType!=l.GameType.\u5e7d\u6d6e\u7ed1\u67b6||l.default.getInstance().checkGame()},e.prototype.updateAtkDir=function(t,e){if(void 0===e&&(e=!1),t){var o;e?(o=t.node.parent.convertToNodeSpaceAR(t.node.convertToWorldSpaceAR(cc.v2(0,0))),this.targetBlock=t):o=null!=t.hero?t.node.parent.convertToNodeSpaceAR(t.hero.node.convertToWorldSpaceAR(cc.v2(0,t.hero.node.height/3))):t.node.parent.convertToNodeSpaceAR(t.heroSke.node.convertToWorldSpaceAR(cc.v2(0,t.heroSke.node.height/3)));var i=this.node.parent.convertToNodeSpaceAR(this.gunNode.convertToWorldSpaceAR(cc.v2(0,0))),n=cc.v2(o.sub(i).normalizeSelf()),a=!0;o.sub(i).mag()<this.node.width&&(a=!1),0!=this.model.group&&(this.model.type==s.ArmType.\u72d9\u51fb||this.model.type==s.ArmType.\u5bfc\u5f39||this.model.type==s.ArmType.\u8d2f\u7a7f)&&n.mag()<1e3?(this.attacking=!0,a&&this.updateDir(n.normalize())):n.mag()>this.model.RAN?(this.attacking=!1,0==this.moveDir.x&&0==this.moveDir.y&&(this.moveDir=this.dragon.node.scaleX>0?cc.v2(-1,0):cc.v2(1,0)),a&&this.updateDir(this.atkDir)):(this.attacking=!0,a&&this.updateDir(n.normalize()))}else this.attacking=!1,0==this.moveDir.x&&0==this.moveDir.y&&(this.moveDir=this.dragon.node.scaleX>0?cc.v2(-1,0):cc.v2(1,0)),this.updateDir(this.atkDir)},e.prototype.getDir=function(t){var e;if(t=t||this.target,this.checkTarget(t)){var o;o=null!=t.hero?t.node.parent.convertToNodeSpaceAR(t.hero.node.convertToWorldSpaceAR(cc.v2(0,t.hero.node.height/3))):t.node.parent.convertToNodeSpaceAR(t.heroSke.node.convertToWorldSpaceAR(cc.v2(0,t.heroSke.node.height/3))),i=this.gunNode?this.node.parent.convertToNodeSpaceAR(this.gunNode.convertToWorldSpaceAR(cc.v2(0,0))):this.node.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0,0))),e=cc.v2(o.sub(i).normalizeSelf())}else{if(this.targetBlock){var i,n=this.targetBlock.node.parent.convertToNodeSpaceAR(this.targetBlock.node.convertToWorldSpaceAR(cc.v2(0,0)));return i=this.gunNode?this.node.parent.convertToNodeSpaceAR(this.gunNode.convertToWorldSpaceAR(cc.v2(0,0))):this.node.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(cc.v2(0,0))),cc.v2(n.sub(i).normalizeSelf())}e=this.atkDir?this.atkDir:this.moveDir}return e},e.prototype.findTargets=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var o=this;return this.gameView.targets.filter(function(i){if(!(o.checkTarget(i)&&i.model.group>=1e5))return!1;var n=o.node.getPosition().sub(i.node.getPosition()).mag();return!t||n<=k.default.getSkillRanBySkillType(e?o.combineSkill:o.skill)}).sort(function(t,e){return t.node.position.sub(o.node.position).mag()-e.node.position.sub(o.node.position).mag()})},e.prototype.findBlocks=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var o=this;return this.gameView.blocks.filter(function(i){return i.type==h.ItemType.BOX&&(t?o.node.position.sub(i.node.position).mag()<=k.default.getSkillRanBySkillType(e?o.combineSkill:o.skill):o.node.position.sub(i.node.position).mag()<=o.model.RAN)}).sort(function(t,e){return t.node.position.sub(o.node.position).mag()-e.node.position.sub(o.node.position).mag()})},e.prototype.showCircle=function(){},e.prototype.hideCircle=function(){},e.prototype.showLine=function(){this.line&&!this.line.node.active&&(this.line.node.active=!0)},e.prototype.hideLine=function(){var t=this;this.lineLen=68,this.line&&(this.line.node.width=this.lineLen,this.line.node.active=!1,this.isLine||(this.isLine=!0,this.scheduleOnce(function(){t.isLine=!1},1)))},e.prototype.update=function(t){if(!this.isStop&&this.checkTarget(this)){switch(this._speedType){case p.SpeedType.STOP:this._moveSpeed=0,!this.isAtking&&this.changeAnimation({animation:"daiji",loop:!0});break;case p.SpeedType.NORMAL:case p.SpeedType.FAST:this._moveSpeed=this.model.SPE,!this.isAtking&&this.changeAnimation({animation:"yidong",loop:!0})}if(this.fire&&this.updateFire(),this.circle&&this.circle.node.active&&(this.circle.clear(),this.circle.circle(0,0,this.model.RAN),this.circle.fill(),this.circle.stroke()),this.line)if(this.line.node.active){var e;e=this.gameType==l.GameType.\u7ade\u6280\u573a?.4:.45,this.lineLen+=1e3*t;var o=this.getDir();this.updateDir(o);var i=this.sprite.node.convertToWorldSpaceAR(cc.v2(0,0)),n=this.line.node.parent.convertToNodeSpaceAR(i);this.line.node.setPosition(n),this.line.node.angle=-(90+cc.misc.radiansToDegrees(Math.atan2(o.x,o.y))),this.line.node.width=this.lineLen,this.gameView&&this.gameView.followCamera&&this.gameView.followCamera.zoomRatio>e&&(this.gameView.followCamera.node.parent.getComponent(u.default).updatePos(this.gameView.followCamera.zoomRatio-t/2),this.gameView.followCamera.zoomRatio-=t/2,this.gameView.followCamera.node.parent.getComponent(u.default).isAuto=!1)}else{var a=.65;this.gameType,l.GameType.\u7ade\u6280\u573a,a=.62,this.gameView&&this.gameView.followCamera&&this.gameView.followCamera.zoomRatio<a&&!this.isLine&&(this.gameView.followCamera.node.parent.getComponent(u.default).isAuto=!1,this.gameView.followCamera.node.parent.getComponent(u.default).updatePos(this.gameView.followCamera.zoomRatio+t),this.gameView.followCamera.zoomRatio+=t,this.gameView.followCamera.zoomRatio>a&&(this.gameView.followCamera.node.parent.getComponent(u.default).isAuto=!0,this.gameView.followCamera.node.parent.getComponent(u.default).updatePos(a),this.gameView.followCamera.zoomRatio=a))}this.offect.mag()>1?this.offect=this.offect.mul(.9):this.offect=cc.Vec2.ZERO,this.goSkillOffect.mag()>1?this.goSkillOffect=this.goSkillOffect.mul(.9):this.goSkillOffect=cc.Vec2.ZERO,this.sprite&&this.heroSke&&this.gunNode&&(this.sprite.node.parent=this.gunNode,this.sprite.node.setPosition(cc.v2(0,0))),this.heroSke&&this.dragon&&this.heroNode&&(this.heroSke.node.parent=this.heroNode,this.heroSke.node.setPosition(cc.v2(0,0))),this.line&&this.line.node.active||!this.skillLight&&this.move(t)}},e.prototype.toNextLevel=function(t){var e=this,o=this;this.breathNormalFloorNode.once(dragonBones.EventObject.COMPLETE,function(){o.breathNormalFloorNode.node.active=!1}),o.breathNormalNode.once(dragonBones.EventObject.COMPLETE,function(){o.breathNormalNode.node.active=!1}),this.hpView.node.active=!1,this.heroSke.node.runAction(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){e.breathNormalFloorNode.node.active=!0,e.breathNormalNode.node.active=!0,e.breathNormalFloorNode.playAnimation("newAnimation",1),e.breathNormalNode.playAnimation("newAnimation",1)}),cc.fadeOut(.5),cc.delayTime(.5),cc.callFunc(function(){t&&t()})))},e.prototype.getNextLevel=function(t){var e=this,o=this;this.breathNormalFloorNode.node.active=!0,this.breathNormalNode.node.active=!0,this.breathNormalFloorNode.once(dragonBones.EventObject.COMPLETE,function(){o.breathNormalFloorNode.node.active=!1}),this.breathNormalNode.once(dragonBones.EventObject.COMPLETE,function(){o.breathNormalNode.node.active=!1}),this.breathNormalNode.playAnimation("newAnimation",1),this.breathNormalFloorNode.playAnimation("newAnimation",1),this.heroSke.node.runAction(cc.sequence(cc.fadeIn(.1),cc.delayTime(.5),cc.callFunc(function(){t&&t(),e.hpView.node.active=!0})))},e.prototype.dropCoin=function(){},e.prototype.dropDiamond=function(){},e.prototype.dropDNA=function(){},e.prototype.getAward=function(t){var e=t.convertToWorldSpaceAR(cc.v2(0,0)),o=this.node.parent.convertToNodeSpaceAR(e);t.parent=this.node.parent,t.setPosition(o),t.runAction(cc.sequence(cc.moveTo(.5*Math.random(),this.node.getPosition()),cc.callFunc(function(){v.default.gameAudio.playGetCoinClip()}),cc.fadeOut(.3),cc.callFunc(function(){t.destroy()})))},e.prototype.onCombine=function(){var t=""+this.personIdx+this.mountIdx+Math.min(Math.floor(this.mount_level/y.FormMaxLevel)+1,5);this.loadComineHeroSke(t),this.loadCombineModel(this.personIdx,this.gunIdx,this.mountIdx,this.mount_level,t),this.isCombine=!0},e.prototype.loadComineHero=function(t){var e=this,o=M.default.getHeroDataById(t);cc.log("===\u5408\u4f53\u7f16\u53f7====",t,this.mount_level),cc.log("=======",o,o.skeUrl);var i="combineHero/dragon/"+o.skeUrl;g.default.addLoaderDragonBones(e.hero).loadArmature(i,function(){e.scheduleOnce(function(){e.hero.armatureName=o.armatureName;var t=e.hero.attachUtil.generateAttachedNodes("\u67aa")[0];t&&(e.sprite.node.setPosition(t.getPosition()),e.gunNode=t),e.sprite.node.parent=t,e.hero.playAnimation("\u5f85\u673a",0),e.isCanHurt=!0})})},e.prototype.loadComineHeroSke=function(t){var e=this,o="combineHero/dragonNew/"+M.default.getHeroDataById(t).skeUrl;S.default.addLoadingAssetNode(e.heroSke.node).loadAsset(o,sp.SkeletonData,function(t,o){e.scheduleOnce(function(){e.heroSke.skeletonData=o;var t=e.heroSke.attachUtil;t.generateAllAttachedNodes();var i=t.getAttachedNodes("qiangguadian")[0];i&&(e.sprite.node.setPosition(i.getPosition()),e.gunNode=i),e.sprite.node.parent=i,e.heroSke.animation="daiji",e.isCanHurt=!0})})},e.prototype.loadCombineModel=function(t,e,o,i,n){var a,s,l,d=M.default.getHeroDataById(n);s=c.default.getHeroDataById(t),a=r.default.getGunDataById(e),0==this.model.group&&(this.combineSkill=d.skill,this.combineSkill_playTimes=d.skill_playTimes,this.skillAtk=d.SkillATK,this.isInvincible=!1,l=y.default.getUpgradeLevelValue(o,i),this.model.MAX_HP=this.model.HP=Math.floor(s.HP+a.combine_HP+l.hp),this.model.ATK=Math.floor((s.ATK+a.combine_ATK+l.atk)*(d.atkBuff/100)),this.model.CombineSkillATK=Math.floor((s.ATK+l.atk)*(d.SkillATK/100)*(d.skillBuff/100)),this.model.IDLE=s.IDLE+a.combine_IDLE,this.model.SPE=(s.MOVESPE+a.combine_SPE+l.spe)*(1+this.speBuff),this.model.CRI=Math.floor((s.CRI+a.combine_CRI)*(d.CRIBuff/100)),this.model.RAN=a.combine_RAN+s.DIST+l.ran,this.model.ROT=a.combine_ROT,this.model.MOV=a.combine_MOV+s.ATKSPE+l.atk_spe,this.model.bullet=a.combine_bullet,this.model.fire=a.combine_fire,this.model.type=a.combine_ATKtype,this.model.audio=a.combine_audio,this.model.hurt_audio=a.combine_hurt_audio,this.model.num=a.combine_num,this.model.total=a.combine_total,this.model.time=a.combine_time,this.model.pow=a.combine_pow,this.model.hit=a.combine_hit,this.model.die_audio=d.die_audio,cc.log("player",this.model)),this.combineCDtime=d.skillCD,this.skilltime=0,this.hpView.init(this.model.MAX_HP,this.isInvincible),this.loadCombineGun(e,n),this.fire&&this.removeFire()},e.prototype.loadCombineGun=function(t){var e=this;return new Promise(function(o){e.scheduleOnce(function(){e.sprite.node.removeAllChildren();var i="gun/prefabs/combine/"+t;S.default.addLoadingAssetNode(e.sprite.node).loadAsset(i,cc.Prefab,function(t,i){if(!t){var n=cc.instantiate(i),a=n.getComponent(b.default);a.init(!0,!0);var r=""+e.mountIdx+Math.min(Math.floor(e.mount_level/y.FormMaxLevel)+1,5);a.loadHead(r),e.sprite.node.addChild(n),n.setPosition(cc.v2(0,20)),o()}})})})},e.prototype.offCombine=function(){this.isCombine=!1,this.loadNormalModel(this.personIdx,this.gunIdx,this.mountIdx),this.loadSkin(this.personIdx,this.mountIdx)},e.prototype.loadNormalModel=function(t,e,o){var i,n,a;n=c.default.getHeroDataById(t),i=r.default.getGunDataById(e),this.skill=n.skill,this.skill_playTimes=n.skill_playTimes,this.skillAtk=n.SkillATK,this.isInvincible=!1,0==this.model.group?(a=y.default.getUpgradeLevelValue(o,this.mount_level),this.model.MAX_HP=Math.floor(n.HP+i.HP+a.hp),this.gameType==l.GameType.\u7ade\u6280\u573a&&(this.model.MAX_HP=4*Math.floor(n.HP+i.HP+a.hp)),this.model.HP=Math.min(this.model.HP,this.model.MAX_HP),this.model.ATK=Math.floor(n.ATK+i.ATK+a.atk),this.model.SkillATK=n.ATK*(n.SkillATK/100),this.model.IDLE=n.IDLE+i.IDLE,this.model.CRI=n.CRI+i.CRI,this.model.RAN=i.RAN+n.DIST+a.ran,this.model.ROT=i.ROT,this.model.MOV=i.MOV+n.ATKSPE+a.atk_spe,this.model.bullet=i.bullet,this.model.fire=i.fire,this.model.type=i.ATtypeK,this.model.audio=i.audio,this.model.hurt_audio=i.hurt_audio,this.model.num=i.num,this.model.total=i.total,this.model.time=i.time,this.model.pow=i.pow,this.model.hit=i.hit,this.model.die_audio=n.die_audio):this.gameType==l.GameType.\u7ade\u6280\u573a&&(a=y.default.getUpgradeLevelValue(o,this.mount_level),this.model.MAX_HP=4*Math.floor(n.HP+i.HP+a.hp),this.model.HP=Math.min(this.model.HP,this.model.MAX_HP),this.model.ATK=Math.floor(n.ATK+i.ATK+a.atk),this.model.SkillATK=n.ATK*(n.SkillATK/100),this.model.IDLE=n.IDLE+i.IDLE,this.model.CRI=n.CRI+i.CRI,this.model.RAN=i.RAN+n.DIST+a.ran,this.model.ROT=i.ROT,this.model.MOV=i.MOV+n.ATKSPE+a.atk_spe,this.model.bullet=i.bullet,this.model.fire=i.fire,this.model.type=i.ATtypeK,this.model.audio=i.audio,this.model.hurt_audio=i.hurt_audio,this.model.num=i.num,this.model.total=i.total,this.model.time=i.time,this.model.pow=i.pow,this.model.hit=i.hit,this.model.die_audio=n.die_audio),this.model.SPE=(n.MOVESPE+i.SPE+a.spe)*(1+this.speBuff),this.hpView.init(this.model.MAX_HP,this.isInvincible),this.changeGun(e),y.default.getMountDataById(o).passive==y.SpecialType.AddSPE&&this.flyMount&&(this.flyMount.node.active=!0,this.flyMount.playAnimation("newAnimation",0))},e.prototype.loadNormalSkin=function(t){var e=this,o="hero/dragon/"+c.default.getHeroDataById(t).skeUrl;g.default.addLoaderDragonBones(e.hero).loadArmature(o,function(){e.scheduleOnce(function(){e.hero.armatureName="armatureName";var t=e.hero.attachUtil.generateAttachedNodes("\u67aa")[0];t&&(e.sprite.node.setPosition(t.getPosition()),e.gunNode=t),e.sprite.node.parent=t,e.hero.playAnimation("\u5f85\u673a",0),e.isCanHurt=!0})})},e.prototype.updateDir=function(t){t=t||(this.moveDir.x>0?cc.v2(90,0):cc.v2(-90,0)),this.dragon&&(Math.abs(t.x)>.2&&(t.x>0?this.dragon.node.scaleX=.4:this.dragon.node.scaleX=-.4),this.dragon.node.scaleY=.4,this.sprite&&(this.dragon.node.scaleX>0?this.sprite.node.angle=-(-90+cc.misc.radiansToDegrees(Math.atan2(t.x,t.y))):this.sprite.node.angle=-(-90-cc.misc.radiansToDegrees(Math.atan2(t.x,t.y)))))},a([C(cc.Graphics)],e.prototype,"circle",void 0),a([C(cc.Sprite)],e.prototype,"line",void 0),a([C(cc.Material)],e.prototype,"flashMaterial",void 0),o=a([O],e)}(d.default);o.default=P,cc._RF.pop()},{"../../InitScene/Script/data/CombineHeroModel":void 0,"../../InitScene/Script/data/GMModel":void 0,"../../InitScene/Script/data/GameData":void 0,"../../InitScene/Script/data/GunModel":void 0,"../../InitScene/Script/data/MountModel":void 0,"../../InitScene/Script/data/PersonModel":void 0,"../../InitScene/Script/data/PlayerModel":void 0,"../../InitScene/Script/data/SkillsModel":void 0,"../../MainScene/Script/center/Game":"Game","../../Script/common/Flash":void 0,"../../framework/Script/component/LoaderAssetNode":void 0,"../../framework/Script/component/LoaderDragonBones":void 0,"../Script/ui/prefabs/view/GunView":"GunView","./BasePlayer":"BasePlayer","./FollowCamare":"FollowCamare","./joystick/JoystickCommon":"JoystickCommon","./manage/GameManage":"GameManage","./test/EditView":"EditView","./view/game/ArmView":"ArmView","./view/game/FireView":"FireView","./view/game/SkillView":"SkillView"}],PostListItem:[function(t,e,o){"use strict";cc._RF.push(e,"82e82hJ821NgpOUip13gkco","PostListItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/center/GameInit"),c=t("../../../../InitScene/Script/data/PostModel"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.txtLabel=null,e.selectedNode=null,e.bgSprite=null,e.bgSF=[],e.iconSprite=null,e.iconSF=[],e.pointNode=null,e.postData=null,e}return n(e,t),e.prototype.start=function(){r.default.event.on(c.PostEvent.ReceivePostAward,this.setIcon,this)},e.prototype.onSelect=function(t,e){this.selectedNode.active=this.postData.id==t,this.selectedNode.active&&!this.postData.isRead&&(this.postData.isRead=!0,this.setIcon()),this.bgSprite.spriteFrame=this.bgSF[e%this.bgSF.length]},e.prototype.setIcon=function(){this.postData.isReceive?this.iconSprite.spriteFrame=this.iconSF[1]:this.iconSprite.spriteFrame=this.iconSF[0],this.setPoint()},e.prototype.setPoint=function(){this.pointNode.active=!this.postData.isReceive},e.prototype.setData=function(t){this.postData=t,this.txtLabel.string=t.title+"\n"+t.date,this.setIcon()},e.prototype.setGary=function(t,e){var o;o=e?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite"),t.getComponent(cc.Sprite).setMaterial(0,o)},a([d(cc.Label)],e.prototype,"txtLabel",void 0),a([d(cc.Node)],e.prototype,"selectedNode",void 0),a([d(cc.Sprite)],e.prototype,"bgSprite",void 0),a([d([cc.SpriteFrame])],e.prototype,"bgSF",void 0),a([d(cc.Sprite)],e.prototype,"iconSprite",void 0),a([d([cc.SpriteFrame])],e.prototype,"iconSF",void 0),a([d(cc.Node)],e.prototype,"pointNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/PostModel":void 0}],PostListNode:[function(t,e,o){"use strict";cc._RF.push(e,"540cdWrSRVLWZSEzHYWed/b","PostListNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/center/GameInit"),c=t("../../../../InitScene/Script/data/PostModel"),s=t("../../center/Game"),l=t("../list/List"),d=t("./PostListItem"),u=t("./PostNode"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.postList=null,e.postInfoList=[],e.index=0,e.isRain=!1,e.activity=0,e}return n(e,t),e.prototype.start=function(){this.postInfoList=c.default.getNewPostList(),cc.log("this.postInfoList",this.postInfoList),this.postInfoList.length>0&&(this.index=this.postInfoList.length-1,this.postList.numItems=this.postInfoList.length)},e.prototype.onVerricalList=function(t,e){var o=this;t.getComponent(d.default).setData(this.postInfoList[e]),t.getComponent(d.default).onSelect(this.postInfoList[this.index].id,e),t.on(cc.Node.EventType.TOUCH_END,function(){o.index=e,o.setPageData(),o.resetSelectedNode(),s.default.gameAudio.playButtonClick()},this)},e.prototype.resetSelectedNode=function(){for(var t=0;t<this.postList.content.childrenCount;t++)this.postList.content.children[t].getComponent(d.default).onSelect(this.postInfoList[this.index].id,t)},e.prototype.setPageData=function(){s.default.uiCenter.openUI("PostNode").getComponent(u.default).setPageData(this.index)},e.prototype.onClose=function(){r.default.uiCenter.closeUI(this.node)},a([f(l.default)],e.prototype,"postList",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/PostModel":void 0,"../../center/Game":"Game","../list/List":"List","./PostListItem":"PostListItem","./PostNode":"PostNode"}],PostNode:[function(t,e,o){"use strict";cc._RF.push(e,"a26a7fLpjRD46r3BoYdFXgi","PostNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/center/GameInit"),c=t("../../../../InitScene/Script/data/BadgeModel"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/PostModel"),d=t("../../center/Game"),u=t("../main/GetCurrencyNode"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.postInfoLabel=null,e.receiveButton=null,e.receiveVideoButton=null,e.videoLabel=null,e.coinLabel=null,e.diamondLabel=null,e.coinNode=null,e.diamondNode=null,e.postInfoList=[],e.index=0,e.isRain=!1,e.activity=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.setPageData=function(t){if(this.index=t,this.postInfoList=l.default.getNewPostList(),this.postInfoList.length>0){var e=this.postInfoList[this.index];cc.log("post",e),this.postInfoLabel.string=e.word;for(var o=0;o<e.award.length;o++){var i=e.award[o].split("|");"coin"==i[0]?this.coinLabel.string=i[1]:this.diamondLabel.string=i[1]}this.receiveButton.interactable=this.postInfoList.length>0&&!this.postInfoList[this.index].isReceive,this.receiveButton.node.active=this.postInfoList[this.index].watchVideoTime>=this.postInfoList[this.index].videoTimes,this.receiveVideoButton.interactable=this.postInfoList.length>0&&!this.postInfoList[this.index].isReceive&&this.postInfoList[this.index].watchVideoTime<this.postInfoList[this.index].videoTimes,this.receiveVideoButton.node.active=this.postInfoList[this.index].watchVideoTime<this.postInfoList[this.index].videoTimes,this.setGary(this.coinNode,!this.receiveButton.interactable&&!this.receiveVideoButton.interactable),this.setGary(this.diamondNode,!this.receiveButton.interactable&&!this.receiveVideoButton.interactable),this.receiveVideoButton.node.active&&(this.videoLabel.string="("+this.postInfoList[this.index].watchVideoTime+"/"+this.postInfoList[this.index].videoTimes+")")}else this.postInfoLabel.string="",this.receiveButton.node.active=this.receiveVideoButton.node.active=!1},e.prototype.onReceive=function(){var t=parseInt(this.coinLabel.string),e=parseInt(this.diamondLabel.string);this.postInfoList[this.index].onReceive(),s.default.totalCoinNum+=t,s.default.totalDiamondNum+=e,r.default.uiCenter.showUi("GetCurrencyNode").getComponent(u.default).setData(t,e,0),this.onClose(),c.default.updatePostBadge()},e.prototype.onVideoSuccess=function(){this.postInfoList[this.index].watchVideoTime++,this.postInfoList[this.index].watchVideoTime>=this.postInfoList[this.index].videoTimes&&(this.onReceive(),this.postInfoList[this.index].isActivity&&(this.isRain=!0,this.activity=this.postInfoList[this.index].index)),this.setPageData(this.index)},e.prototype.setGary=function(t,e){var o;o=e?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite"),t.getComponent(cc.Sprite).setMaterial(0,o)},e.prototype.onClose=function(){this.isRain&&d.default.event.emit(s.GameDataEvent.AWARD_RAIN,this.activity),r.default.uiCenter.closeUI(this.node)},a([f(cc.Label)],e.prototype,"postInfoLabel",void 0),a([f(cc.Button)],e.prototype,"receiveButton",void 0),a([f(cc.Button)],e.prototype,"receiveVideoButton",void 0),a([f(cc.Label)],e.prototype,"videoLabel",void 0),a([f(cc.Label)],e.prototype,"coinLabel",void 0),a([f(cc.Label)],e.prototype,"diamondLabel",void 0),a([f(cc.Node)],e.prototype,"coinNode",void 0),a([f(cc.Node)],e.prototype,"diamondNode",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/PostModel":void 0,"../../center/Game":"Game","../main/GetCurrencyNode":"GetCurrencyNode"}],PrefabView:[function(t,e,o){"use strict";cc._RF.push(e,"a99c8v49TFDko/edeMQlqSE","PrefabView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/PlayerData"),c=t("./BaseView"),s=cc._decorator,l=s.ccclass,d=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onDisable=function(){this.node.destroy()},e.prototype.onDestroy=function(){r.default.UIManager.releasePnl(this.text)},e.prototype.start=function(){},a([l],e)}(c.default));o.default=d,cc._RF.pop()},{"../../../../InitScene/Script/data/PlayerData":void 0,"./BaseView":"BaseView"}],QuadTree:[function(t,e,o){"use strict";cc._RF.push(e,"2378fnonn1NpJv1z25mGJGO","QuadTree"),Object.defineProperty(o,"__esModule",{value:!0}),o.QuadTreeNode=void 0;var i=function(){};o.QuadTreeNode=i;var n=function(){function t(t,e){void 0===e&&(e=0),this.objects=[],this.nodes=[],this.objects=[],this.nodes=[],this.level=e,this.bounds=t}return t.prototype.o=function(t,e){for(var o=[cc.v2(e.x+e.width,e.y+e.height),cc.v2(e.x,e.y+e.height),cc.v2(e.x,e.y),cc.v2(e.x+e.width,e.y)],i=0;i<o.length;i++){var n=o[i];if(!(n.x>=t.x&&n.x<=t.x+t.width&&n.y>=t.y&&n.y<=t.y+t.height))return!1}return!0},t.prototype.getIndex=function(t){if(!this.o(this.bounds,t))return-1;var e=this.bounds.x,o=this.bounds.y,i=this.bounds.width/2,n=this.bounds.height/2,a=cc.rect(e+i,o+n,i,n),r=cc.rect(e,o+n,i,n),c=cc.rect(e,o,i,n),s=cc.rect(e+i,o,i,n);return this.o(a,t)?0:this.o(r,t)?1:this.o(c,t)?2:this.o(s,t)?3:-1},t.prototype.split=function(){if(!(this.nodes.length>0)){var e=this.bounds.x,o=this.bounds.y,i=this.bounds.width/2,n=this.bounds.height/2,a=new t(cc.rect(e+i,o+n,i,n),this.level+1),r=new t(cc.rect(e,o+n,i,n),this.level+1),c=new t(cc.rect(e,o,i,n),this.level+1),s=new t(cc.rect(e+i,o,i,n),this.level+1);this.nodes.push(a,r,c,s)}},t.prototype.insert=function(t){var e=this;if(this.nodes.length>0){var o=this.getIndex(t.rect);if(null!=o&&-1!=o)return void this.nodes[o].insert(t);var n=!1;if(this.nodes.forEach(function(o,a){var r=new cc.Rect;if(o.bounds.intersection(r,t.rect),r.width>0&&r.height>0){var c=new i;c.node=t.node,c.type=t.type,c.gird=t.gird,c.rect=r,e.nodes[a].insert(c),n=!0}}),n)return}if(this.objects.push(t),0==this.nodes.length&&this.objects.length>10&&this.level<5){this.split(),e=this;for(var a=function(){var t=e.getIndex(e.objects[r].rect);if(null!=t&&-1!=t)e.nodes[t].insert(e.objects.splice(r,1)[0]);else{var o=!1;e.nodes.forEach(function(t,n){var a=new cc.Rect;if(t.bounds.intersection(a,e.objects[r].rect),a.width>0&&a.height>0){var c=new i;c.node=e.objects[r].node,c.type=e.objects[r].type,c.rect=a,e.nodes[n].insert(c),o=!0}}),o?e.objects.splice(r,1):r++}},r=0;r<this.objects.length;)a()}},t.prototype.retrieve=function(t){var e=[];if(this.nodes.length>0){var o=this.getIndex(t);null!=o&&-1!=o?this.nodes[o].retrieve(t).forEach(function(t){return e.push(t)}):-1==o&&this.nodes.forEach(function(o){var i=new cc.Rect;o.bounds.intersection(i,t),i.width>0&&i.height>0&&(e=e.concat(o.retrieve(i)))})}return e=e.concat(this.objects)},t.prototype.carve=function(t,e){var o,i,n,a,r=[];return e.y>t.y&&e.y<t.y+t.height&&e.x>t.x&&e.x<t.x+t.width?(o=cc.rect(t.x,t.y,e.x-t.x,e.y-t.y),i=cc.rect(t.x,e.y,e.x-t.x,t.y+t.height-e.y),n=cc.rect(e.x,t.y,t.x+t.width-e.x,e.y-t.y),a=cc.rect(e.x,e.y,t.x+t.width-e.x,t.y+t.height-e.y),r.push(o,i,n,a)):e.y>t.y&&e.y<t.y+t.height?(o=cc.rect(t.x,t.y,t.width,e.y-t.y),i=cc.rect(t.x,e.y,t.width,t.y+t.height-e.y),r.push(o,i)):e.x>t.x&&e.x<t.x+t.width&&(o=cc.rect(t.x,t.y,e.x-t.x,t.height),i=cc.rect(e.x,t.y,t.x+t.width-e.x,t.height),r.push(o,i)),r},t.prototype.isInner=function(t,e){var o=t.getBoundingBox();return o.x>=e.x&&o.x+o.width<=e.x+e.width&&o.y>=e.y&&o.y+o.height<=e.y+e.height},t.prototype.refresh=function(t){void 0===t&&(t=this);var e,o,i,n,a=this.objects;for(i=0;a.length>0&&i<a.length;)e=a[i],o=this.getIndex(e),this.isInner(e,this.bounds)?this.nodes.length&&-1!=o?this.nodes[o].insert(a.splice(i,1)[0]):i++:this!==t?t.insert(a.splice(i,1)[0]):i++;for(i=0,n=this.nodes.length;i<n;i++)this.nodes[i].refresh(t)},t.prototype.remove=function(t){for(var e=0;e<this.objects.length;){var o=this.objects[e];o&&o.node.uuid==t?this.objects.splice(e,1):e++}this.nodes.forEach(function(e){return e.remove(t)})},t.prototype.clear=function(){this.objects=[],this.nodes.forEach(function(t){return t.clear()})},t}();o.default=n,cc._RF.pop()},{}],RankAwardItem:[function(t,e,o){"use strict";cc._RF.push(e,"8a21enkAM1BJZ3kcyM1qXKX","RankAwardItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/RankModel"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgSprite=null,e.bgSF=[],e.curRankLabel=null,e.nextRankLabel=null,e.diamondLabel=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){var e=r.default.getRankData(t.inherit);this.curRankLabel.string=t.name,this.nextRankLabel.string=e.name,this.diamondLabel.string=t.award+""},a([l(cc.Sprite)],e.prototype,"bgSprite",void 0),a([l([cc.SpriteFrame])],e.prototype,"bgSF",void 0),a([l(cc.Label)],e.prototype,"curRankLabel",void 0),a([l(cc.Label)],e.prototype,"nextRankLabel",void 0),a([l(cc.Label)],e.prototype,"diamondLabel",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../InitScene/Script/data/RankModel":void 0}],RankAwardNode:[function(t,e,o){"use strict";cc._RF.push(e,"ff442xla8BLrZyw+swr63F+","RankAwardNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/center/GameInit"),c=t("../../../../InitScene/Script/data/RankModel"),s=t("../../center/Game"),l=t("../list/List"),d=t("./RankAwardItem"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.awardList=null,e.curSeasonLabel=null,e.nextSeasonLabel=null,e.rankList=[],e}return n(e,t),e.prototype.start=function(){this.rankList=r.default.gameConfig.rankConfig,this.awardList.numItems=this.rankList.length,this.setTitle()},e.prototype.onVerticalList=function(t,e){t.getComponent(d.default).setData(this.rankList[this.rankList.length-1-e])},e.prototype.setTitle=function(){this.curSeasonLabel.string="S"+c.default.season+"\u8d5b\u5b63\u6bb5\u4f4d",this.nextSeasonLabel.string="S"+(c.default.season+1)+"\u8d5b\u5b63\u6bb5\u4f4d"},e.prototype.onReturn=function(){s.default.uiCenter.showUi("RankNode"),s.default.uiCenter.closeUI("RankAwardNode")},a([h(l.default)],e.prototype,"awardList",void 0),a([h(cc.Label)],e.prototype,"curSeasonLabel",void 0),a([h(cc.Label)],e.prototype,"nextSeasonLabel",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/RankModel":void 0,"../../center/Game":"Game","../list/List":"List","./RankAwardItem":"RankAwardItem"}],RankInfoNode:[function(t,e,o){"use strict";cc._RF.push(e,"c3a8eFZFFxDi6GhnhLpRyy/","RankInfoNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/OtherData"),s=t("../../../../InitScene/Script/data/PersonModel"),l=t("../../../../InitScene/Script/data/RankingModel"),d=t("../../../../InitScene/Script/data/RankModel"),u=t("../../center/Game"),p=t("../cultivate/GetCultivateNode"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.seasonLabel=null,e.heroNode=null,e.diamondNode=null,e.tipsLabel=null,e.rankLabel=null,e.rewardBtn=null,e.seasonCountLabel=null,e}return n(e,t),e.prototype.start=function(){this.rewardBtn&&(this.rewardBtn.active=!1),this.setUI()},e.prototype.setUI=function(){var t=this;this.setLabel(),s.default.getHeroDataById(c.default.rankingHero).isUnlock?(this.heroNode.active=!1,this.diamondNode.active=!0):(this.scheduleOnce(function(){t.loadDragon()}),this.diamondNode.active=!1)},e.prototype.setLabel=function(){d.default.level;var t=d.default.getRankingList();if(this.seasonCountLabel.string=d.default.season+"",this.seasonLabel.string=this.seasonLabel.string.replace("X",d.default.getSeasonOverDay()+""),cc.log("PersonModel.getHeroDataById(OtherData.seasonHero).isUnlock",s.default.getHeroDataById(c.default.rankingHero).isUnlock),s.default.getHeroDataById(c.default.rankingHero).isUnlock){var e=d.default.getRankLevel(d.default.level).rankLevel,o=d.default.getRankData(e);this.tipsLabel.string=" \u8d5b\u5b63\u7ed3\u675f\u53ef\u83b7\u5f97\u5956\u52b1\u94bb\u77f3x"+o.season,this.rewardBtn&&(this.rewardBtn.active=!1)}else this.rewardBtn&&(this.rewardBtn.active=c.default.seasonWin<=d.default.win),this.tipsLabel.string=" \u80dc\u5229"+c.default.seasonWin+"\u573a "+d.default.win+"/"+c.default.seasonWin;for(var i=0;i<t.length;i++)if(-1==t[i].id){i<l.default.MaxRankNum?this.rankLabel.string="\u6392\u540d\uff1a"+(i+1)+"\u540d":this.rankLabel.string="\u6392\u540d\uff1a100+\u540d";break}},e.prototype.loadDragon=function(){var t=this.heroNode.addComponent(cc.Sprite);r.default.addLoaderSprite(t).loadSprite("hero/avatar/"+c.default.rankingHero),this.heroNode.scale=2},e.prototype.onAwardInfo=function(){u.default.uiCenter.showUi("RankAwardNode"),u.default.uiCenter.closeUI("RankNode")},e.prototype.getSeasonAward=function(){var t=s.default.getHeroDataById(c.default.rankingHero);t.isUnlock||(t.onUnlock(),u.default.uiCenter.showUi("GetCultivateNode").getComponent(p.default).setData("hero","hero/dragon/"+t.skeUrl,"\u8ba4\u771f",t.award),s.default.useHeroId=c.default.rankingHero),this.setUI()},a([m(cc.Label)],e.prototype,"seasonLabel",void 0),a([m(cc.Node)],e.prototype,"heroNode",void 0),a([m(cc.Node)],e.prototype,"diamondNode",void 0),a([m(cc.Label)],e.prototype,"tipsLabel",void 0),a([m(cc.Label)],e.prototype,"rankLabel",void 0),a([m(cc.Node)],e.prototype,"rewardBtn",void 0),a([m(cc.Label)],e.prototype,"seasonCountLabel",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/data/OtherData":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../InitScene/Script/data/RankModel":void 0,"../../../../InitScene/Script/data/RankingModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","../cultivate/GetCultivateNode":"GetCultivateNode"}],RankNode:[function(t,e,o){"use strict";cc._RF.push(e,"05b77WIwUxKoZx8ggy6MPz0","RankNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/BadgeModel"),c=t("../../../../InitScene/Script/data/RankModel"),s=t("../../center/Game"),l=t("../list/List"),d=t("./RankPlayerItem"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rankList=null,e.topPlayerItem=[],e.playerList=[],e}return n(e,t),e.prototype.start=function(){this.playerList=c.default.getRankingList(),this.setTopPlayer(),this.rankList.numItems=this.playerList.length-this.topPlayerItem.length-10,r.default.updateRankBadge(!1)},e.prototype.setTopPlayer=function(){for(var t=0;t<this.topPlayerItem.length;t++)this.topPlayerItem[t].setData(t,this.playerList[t])},e.prototype.onVerticalList=function(t,e){t.getComponent(d.default).setData(e+3,this.playerList[e+3])},e.prototype.onClose=function(){s.default.uiCenter.closeUI(this.node)},a([h(l.default)],e.prototype,"rankList",void 0),a([h(d.default)],e.prototype,"topPlayerItem",void 0),a([p],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/RankModel":void 0,"../../center/Game":"Game","../list/List":"List","./RankPlayerItem":"RankPlayerItem"}],RankPlayerItem:[function(t,e,o){"use strict";cc._RF.push(e,"a92e7haLqJB/rD5eN9YiVfw","RankPlayerItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/RankModel"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgSprite=null,e.bgSF=[],e.rankLabel=null,e.avatarSprite=null,e.nameLabel=null,e.iconSprite=null,e.starLabel=null,e.selectedNode=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t,e){this.bgSprite.spriteFrame=this.bgSF[t%this.bgSF.length];var o=c.default.getRankLevel(e.star);if(this.rankLabel&&(this.rankLabel.string=t+1+""),this.setIcon("mainSceneRes/rank/icon/"+o.rankLevel),this.starLabel.string="X"+o.rankStar,this.selectedNode&&(this.selectedNode.active=-1==e.id),-1==e.id)this.nameLabel.string=s.default.userInfo&&s.default.userInfo.nickName||"\u6211";else{var i=s.default.gameConfig.aiConfig[e.id];this.nameLabel.string=i.nickName,this.setAvatar("avatar/"+i.avatarUrl)}},e.prototype.setAvatar=function(t){this.avatarSprite.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.avatarSprite.node.setScale(1),this.avatarSprite.node.setContentSize(cc.size(95,95)),r.default.addLoaderSprite(this.avatarSprite).loadSprite(t,cc.SpriteFrame)},e.prototype.setHeroAvatar=function(t){this.avatarSprite.sizeMode=cc.Sprite.SizeMode.TRIMMED,this.avatarSprite.node.setScale(.8),r.default.addLoaderSprite(this.avatarSprite).loadSprite(t,cc.SpriteFrame)},e.prototype.setIcon=function(t){r.default.addLoaderSprite(this.iconSprite).loadSprite(t,cc.SpriteFrame)},a([u(cc.Sprite)],e.prototype,"bgSprite",void 0),a([u([cc.SpriteFrame])],e.prototype,"bgSF",void 0),a([u(cc.Label)],e.prototype,"rankLabel",void 0),a([u(cc.Sprite)],e.prototype,"avatarSprite",void 0),a([u(cc.Label)],e.prototype,"nameLabel",void 0),a([u(cc.Sprite)],e.prototype,"iconSprite",void 0),a([u(cc.Label)],e.prototype,"starLabel",void 0),a([u(cc.Node)],e.prototype,"selectedNode",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/RankModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],RankView:[function(t,e,o){"use strict";cc._RF.push(e,"e88e5biNypN74jopiha32WO","RankView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/RankModel"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.nameSprite=null,e.starNode=null,e.starSpriteFrame=[],e.numLabel=null,e}return n(e,t),e.prototype.start=function(){this.setRank()},e.prototype.setRank=function(){var t=c.default.getRankLevel(c.default.level);cc.log("\u6bb5\u4f4d",t),t.rankLevel==c.default.MaxRankLevel?(this.starNode.active=!1,this.numLabel.string="X"+t.rankStar):(this.numLabel.node.parent.active=!1,this.setStar(t.rankStar)),this.setSprite("mainSceneRes/rank/icon/"+t.rankLevel,this.iconSprite),this.setSprite("mainSceneRes/rank/text/"+t.rankLevel,this.nameSprite)},e.prototype.setStar=function(t){for(var e=0,o=0;e<c.MaxStar;e++){var i=(new cc.Node).addComponent(cc.Sprite);o<t?(i.spriteFrame=this.starSpriteFrame[1],o++):i.spriteFrame=this.starSpriteFrame[0],this.starNode.addChild(i.node)}},e.prototype.setSprite=function(t,e){this.scheduleOnce(function(){r.default.addLoaderSprite(e).loadSprite(t,cc.SpriteFrame)},.1)},e.prototype.onRankUI=function(){s.default.uiCenter.showUi("RankNode")},a([u(cc.Sprite)],e.prototype,"iconSprite",void 0),a([u(cc.Sprite)],e.prototype,"nameSprite",void 0),a([u(cc.Node)],e.prototype,"starNode",void 0),a([u(cc.SpriteFrame)],e.prototype,"starSpriteFrame",void 0),a([u(cc.Label)],e.prototype,"numLabel",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/RankModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],RareGunButton:[function(t,e,o){"use strict";cc._RF.push(e,"51560XT0CFLwqMVc1D0vrrs","RareGunButton");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/center/GameInit"),l=t("../../../../InitScene/Script/data/GameData"),d=t("../../../../InitScene/Script/data/GunModel"),u=t("../../../../InitScene/Script/data/OtherData"),p=t("../../center/Game"),h=t("../prefabs/getGun/GetGun"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gunSprite=null,e.videoLabel=null,e.gunData=null,e}return n(e,t),e.prototype.start=function(){this.setButton(),s.default.event.on(d.GunEvent.UnlockGun,this.setButton,this)},e.prototype.setButton=function(){if(d.default.rareCount>=1||null==d.default.getRareGunId())this.node.parent.emit("videoSuccess");else if(u.default.watchRareGunVideo>=u.default.rareGunVideo)this.node.parent.emit("videoSuccess");else{this.gunData=d.default.getRareGunId(),cc.log("\u66f4\u65b0\u6b66\u5668",this.gunData),!this.gunData&&this.node.destroy();var t="gun/icon/"+this.gunData.id;this.gunData&&this.setIcon(t),this.videoLabel.string="("+u.default.watchRareGunVideo+"/"+u.default.rareGunVideo+")"}},e.prototype.setIcon=function(t){var e=this;this.scheduleOnce(function(){r.default.addLoaderSprite(e.gunSprite).loadSprite(t,cc.SpriteFrame)},.1)},e.prototype.onClick=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.videoSuccess=function(){if(u.default.watchRareGunVideo++,u.default.watchRareGunVideo<u.default.rareGunVideo)this.setButton();else{var t=this.gunData.id;d.default.rareCount+=1,this.gunData.onUnlock(),p.default.uiCenter.showUi("getGun").getComponent(h.default).setData(t,!0);var e=p.default.mainUI,o=e.boxs.filter(function(t){return null==t.item&&null==t.equip});if(o.length>0)e.appendItem(t,o[0]),e.updateMatrix();else{var i=d.default.getSale(t);l.default.totalCoinNum+=i,p.default.showCurrency(i)}d.default.useGunId=t,this.node.parent.emit("videoSuccess")}},a([y(cc.Sprite)],e.prototype,"gunSprite",void 0),a([y(cc.Label)],e.prototype,"videoLabel",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/OtherData":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../prefabs/getGun/GetGun":"GetGun"}],RareHeroButton:[function(t,e,o){"use strict";cc._RF.push(e,"c76dcZVEKFNF49573w94weG","RareHeroButton");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/data/OtherData"),l=t("../../../../InitScene/Script/data/PersonModel"),d=t("../../center/Game"),u=t("../cultivate/GetCultivateNode"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroSprite=null,e.videoLabel=null,e.heroData=null,e.id=0,e}return n(e,t),e.prototype.start=function(){this.id=s.default.rareHeroID,this.heroData=l.default.getHeroDataById(this.id),this.setButton()},e.prototype.setIcon=function(t){var e=this;this.scheduleOnce(function(){r.default.addLoaderSprite(e.heroSprite).loadSprite(t,cc.SpriteFrame)},.1)},e.prototype.setButton=function(){if(s.default.watchRareHeroVideo>=s.default.rareHeroVideo)this.node.destroy();else{var t="hero/avatar/"+this.id;this.setIcon(t),this.videoLabel.string="("+s.default.watchRareHeroVideo+"/"+s.default.rareHeroVideo+")"}},e.prototype.onClick=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.videoSuccess=function(){s.default.watchRareHeroVideo++,s.default.watchRareHeroVideo>=s.default.rareHeroVideo&&(this.heroData.onUnlock(),l.default.useHeroId=this.id,d.default.uiCenter.showUi("GetCultivateNode").getComponent(u.default).setData("hero","hero/dragon/"+this.heroData.skeUrl,"\u5f85\u673a",this.heroData.award,!0)),this.setButton(),this.node.parent.emit("videoSuccess")},a([f(cc.Sprite)],e.prototype,"heroSprite",void 0),a([f(cc.Label)],e.prototype,"videoLabel",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../InitScene/Script/data/OtherData":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../cultivate/GetCultivateNode":"GetCultivateNode"}],RollDice:[function(t,e,o){"use strict";cc._RF.push(e,"161cdWlgcRKMKjXvnahdcd1","RollDice");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/GameData"),c=t("../../../InitScene/Script/data/GuessModel"),s=t("../../../InitScene/Script/data/OtherData"),l=t("../../../InitScene/Script/data/PersonModel"),d=t("../../../Script/base/Utils"),u=t("../../Script/center/Game"),p=t("../../Script/ui/cultivate/GetCultivateNode"),h=t("./BoyGuestNode"),f=t("./GrilGuestNode"),m=cc._decorator,y=m.ccclass,g=m.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hero=null,e.roll=null,e.animation=null,e.diceAnimations=[],e.correctlyAnimation=null,e.heroBeerAnimation=null,e.rollBeerAnimation=null,e.endNode=null,e.winNode=null,e.loseNode=null,e.rollDiceBgmAudioClip=null,e.finishedCount=0,e.moveCount=0,e.speed=1,e.isGuess=!1,e.clickAnimation=null,e.girlScore=4,e.boyScore=3,e.guestInfoList=null,e}return n(e,t),e.prototype.start=function(){this.node.active=!1;for(var t=0;t<this.diceAnimations.length;t++)this.diceAnimations[t].on(cc.Animation.EventType.FINISHED,this.onFinished,this);this.heroBeerAnimation.node.active=!1,this.rollBeerAnimation.node.active=!1,this.scheduleOnce(this.onStartRoll,2)},e.prototype.onStartRoll=function(){var t=this;this.endNode.active=!1,this.guestInfoList=c.default.getCurGuest(),u.default.event.emit("onEnterRollDice"),this.heroBeerAnimation.node.active=!0,this.rollBeerAnimation.node.active=!0,this.node.active=!0,this.girlScore=4,this.boyScore=3,this.speed=1,this.moveCount=0,this.animation.play("rollDice_1").wrapMode=cc.WrapMode.Normal,this.scheduleOnce(function(){for(var e=0;e<t.diceAnimations.length;e++)t.diceAnimations[e].play("dice_cup_1").wrapMode=cc.WrapMode.Normal;t.scheduleOnce(function(){for(var e=0;e<t.diceAnimations.length;e++)t.diceAnimations[e].play("dice_cup_1").wrapMode=cc.WrapMode.Reverse;t.scheduleOnce(function(){t.onMove()},1)},1)},1),u.default.mainAudio.playMusic(this.rollDiceBgmAudioClip,!0)},e.prototype.onAgainRoll=function(){for(var t=this,e=0;e<this.diceAnimations.length;e++)this.diceAnimations[e].play("dice_cup_1").wrapMode=cc.WrapMode.Reverse;this.speed=d.choice([.8,.9,1,1.1,1.2,1.3,1.4,1.5]),this.moveCount=0,this.scheduleOnce(function(){t.onMove()},1.5)},e.prototype.onMove=function(){this.isGuess=!1,this.moveCount++;var t=[1,2,3];d.randomSort(t);var e=t.pop(),o=t.pop(),i=this.diceAnimations[e-1],n=this.diceAnimations[o-1];this.finishedCount=0,cc.log("===\u901f\u5ea6\uff1a",this.speed,e,o),i.play("dice_cup_"+e+"-"+o).speed=this.speed,n.play("dice_cup_"+o+"-"+e).speed=this.speed,e>o?(i.node.zIndex=0,n.node.zIndex=2):(i.node.zIndex=2,i.node.zIndex=0),this.diceAnimations[t[0]-1].node.zIndex=1,this.diceAnimations[e-1]=n,this.diceAnimations[o-1]=i},e.prototype.onFinished=function(t,e){"dice_cup_1"!=e.name&&(this.finishedCount++,this.finishedCount>=2&&(this.moveCount<10?(this.speed+=.05,this.onMove()):this.isGuess=!0))},e.prototype.onClick=function(t){var e=this;if(this.isGuess){this.isGuess=!1;var o=t.currentTarget;this.clickAnimation=o.getComponent(cc.Animation),this.clickAnimation.play("dice_cup_1").wrapMode=cc.WrapMode.Normal,this.scheduleOnce(function(){e.clickAnimation==e.correctlyAnimation?(e.heroBeerAnimation.play("girlBeer"),e.roll.guessTrue(),e.hero.onHeroBeer(e.heroDrunkOver.bind(e))):(e.rollBeerAnimation.play("boyBeer"),e.roll.onBoyBeer(e.rollDrunkOver.bind(e)),e.hero.playHappy())},1)}},e.prototype.heroDrunkOver=function(){for(var t=this,e=0;e<this.diceAnimations.length;e++){var o=this.diceAnimations[e];this.clickAnimation!=o&&(o.play("dice_cup_1").wrapMode=cc.WrapMode.Normal)}this.girlScore--,this.girlScore<=0?this.hero.onRollDiceWin(this.win.bind(this)):this.scheduleOnce(function(){t.onAgainRoll()},2)},e.prototype.rollDrunkOver=function(){this.hero.rollDrunkOver(this.rollNext.bind(this))},e.prototype.rollNext=function(){for(var t=this,e=0;e<this.diceAnimations.length;e++){var o=this.diceAnimations[e];this.clickAnimation!=o&&(o.play("dice_cup_1").wrapMode=cc.WrapMode.Normal)}this.boyScore--,this.boyScore<=0?this.roll.onRollDiceLose(this.lose.bind(this)):this.scheduleOnce(function(){t.onAgainRoll()},2)},e.prototype.win=function(){var t=this;this.winNode.active=!0,this.loseNode.active=!1,this.endNode.active=!0,this.animation.play("rollDice_end"),this.roll.onRollDiceWin(),r.default.totalBoneNum+=s.default.guessWin,c.default.guessTimes++,c.default.win++,this.scheduleOnce(function(){u.default.showCurrency(0,0,s.default.guessWin),t.onExitRollDice()},5)},e.prototype.lose=function(){var t=this;this.winNode.active=!1,this.loseNode.active=!0,this.endNode.active=!0,this.animation.play("rollDice_end"),r.default.totalBoneNum+=s.default.guessLose,c.default.guessTimes++,c.default.lose++,this.scheduleOnce(function(){u.default.showCurrency(0,0,s.default.guessLose),t.onExitRollDice()},5)},e.prototype.onExitRollDice=function(){console.log("GuessModel.guessTimes >= OtherData.guessAwardTime",c.default.guessTimes>=s.default.guessAwardTime),u.default.uiCenter.closeUI("GuessNode");var t=l.default.getHeroDataById(s.default.guessHeroID);t.onUnlock(),c.default.guessTimes>=s.default.guessAwardTime&&!t.isUnlock&&(u.default.uiCenter.showUi("GetCultivateNode").getComponent(p.default).setData("hero","hero/dragon/"+t.skeUrl,"\u5f85\u673a",t.award),l.default.useHeroId=t.id),u.default.mainAudio.playMainBGMusic()},a([g(f.default)],e.prototype,"hero",void 0),a([g(h.default)],e.prototype,"roll",void 0),a([g(cc.Animation)],e.prototype,"animation",void 0),a([g([cc.Animation])],e.prototype,"diceAnimations",void 0),a([g(cc.Animation)],e.prototype,"correctlyAnimation",void 0),a([g(cc.Animation)],e.prototype,"heroBeerAnimation",void 0),a([g(cc.Animation)],e.prototype,"rollBeerAnimation",void 0),a([g(cc.Node)],e.prototype,"endNode",void 0),a([g(cc.Node)],e.prototype,"winNode",void 0),a([g(cc.Node)],e.prototype,"loseNode",void 0),a([g({type:cc.AudioClip})],e.prototype,"rollDiceBgmAudioClip",void 0),a([y],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../../InitScene/Script/data/GameData":void 0,"../../../InitScene/Script/data/GuessModel":void 0,"../../../InitScene/Script/data/OtherData":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../Script/base/Utils":void 0,"../../Script/center/Game":"Game","../../Script/ui/cultivate/GetCultivateNode":"GetCultivateNode","./BoyGuestNode":"BoyGuestNode","./GrilGuestNode":"GrilGuestNode"}],SeaView:[function(t,e,o){"use strict";cc._RF.push(e,"f44f700bh5Dn4RlL/TdfsBg","SeaView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/ActivityModel"),c=t("../../Script/center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroPrefab=null,e.progress=null,e}return n(e,t),e.prototype.start=function(){this.progress.node.opacity=0,this.progress.progress=r.default.wakeupHeroEatCount/r.default.wakeupHeroNeedEatCount},e.prototype.onEat=function(t){var e=this;this.progress.node.setPosition(this.node.convertToNodeSpaceAR(t).add(cc.v2(0,80))),this.progress.node.opacity=0,this.progress.node.runAction(cc.sequence(cc.fadeIn(1),cc.callFunc(function(){e.scheduleOnce(e.onClickMount,.5)}),cc.delayTime(2),cc.fadeOut(1))),cc.tween(this.progress).delay(1).to(.5,{progress:r.default.wakeupHeroEatCount/r.default.wakeupHeroNeedEatCount}).start()},e.prototype.showMount=function(){},e.prototype.onClickMount=function(){r.default.isWakeupHeroEatCount&&(r.default.isWakeupHero0||c.default.uiCenter.showUi(this.heroPrefab))},a([d(cc.Prefab)],e.prototype,"heroPrefab",void 0),a([d(cc.ProgressBar)],e.prototype,"progress",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../InitScene/Script/data/ActivityModel":void 0,"../../Script/center/Game":"Game"}],SeasonBeginNode:[function(t,e,o){"use strict";cc._RF.push(e,"f93f7dI1h1MQrsHMxuXq2FT","SeasonBeginNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../center/Game"),c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onGo=function(){this.onClose(),r.default.uiCenter.showUi("RankNode")},e.prototype.onClose=function(){this.node.destroy()},a([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{"../../center/Game":"Game"}],SeasonDayReport:[function(t,e,o){"use strict";cc._RF.push(e,"18707H1HZtGFIL1+oVdox4j","SeasonDayReport");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/RankModel"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.daylabel=null,e.rankLabel=null,e}return n(e,t),e.prototype.start=function(){this.daylabel.string=""+r.default.getSeasonOverDay();for(var t=r.default.getRankingList(),e=0;e<t.length;e++)if(-1==t[e].id){this.rankLabel.string=e<50?"\u5f53\u524d\u6392\u540d\uff1a"+(e+1)+"\u540d":"\u5f53\u524d\u6392\u540d\uff1a50+\u540d";break}},e.prototype.onClose=function(){this.node.destroy()},e.prototype.onGo=function(){this.onClose(),c.default.uiCenter.showUi("RankNode")},a([d(cc.Label)],e.prototype,"daylabel",void 0),a([d(cc.Label)],e.prototype,"rankLabel",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/RankModel":void 0,"../../center/Game":"Game"}],SeasonOverNode:[function(t,e,o){"use strict";cc._RF.push(e,"62ae0IkzRBOhJeLHcwwDXrz","SeasonOverNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderDragonBones"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/OtherData"),d=t("../../../../InitScene/Script/data/PersonModel"),u=t("../../../../InitScene/Script/data/RankModel"),p=t("../../center/Game"),h=cc._decorator,f=h.ccclass,m=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skeNode=null,e.diamondNode=null,e.diamondText=null,e}return n(e,t),e.prototype.start=function(){var t=u.default.getRankData(u.default.lastLevel);!d.default.getHeroDataById(l.default.rankingHero).isUnlock&&u.default.level>=l.default.seasonRank&&(this.skeNode.parent.active=!0,this.diamondNode.active=!1,this.loadDragon(),d.default.getHeroDataById(l.default.rankingHero).onUnlock(),d.default.useHeroId=l.default.rankingHero),s.default.totalDiamondNum+=t.season,this.diamondText.string=this.diamondText.string.replace("x",t.season+""),u.default.lastLevel=-1,u.default.seasonWin=0},e.prototype.loadDragon=function(){var t=this,e=this.skeNode.addComponent(dragonBones.ArmatureDisplay),o=this.skeNode.addComponent(r.default),i=d.default.getHeroDataById(l.default.rankingHero);o.loadArmature("hero/dragon/"+i.skeUrl,function(){t.skeNode.isValid&&(e.armatureName="armatureName",e.playAnimation("\u5f85\u673a",0))})},e.prototype.onOk=function(){p.default.uiCenter.closeUI(this.node),p.default.event.emit("checkSeasonOver")},e.prototype.onDiamond=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.diamondSuccess=function(){s.default.totalDiamondNum+=100,this.onOk()},a([m(cc.Node)],e.prototype,"skeNode",void 0),a([m(cc.Node)],e.prototype,"diamondNode",void 0),a([m(cc.RichText)],e.prototype,"diamondText",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/OtherData":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../InitScene/Script/data/RankModel":void 0,"../../../../framework/Script/component/LoaderDragonBones":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game"}],SeedItemNode:[function(t,e,o){"use strict";cc._RF.push(e,"f524d272wFHE4Y2ov3U5dLl","SeedItemNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderSprite"),c=t("../../../InitScene/Script/data/TreeModel"),s=t("../../GameScene/manage/GameManage"),l=t("../../Script/center/Game"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.seedNum=null,e.move_icon=null,e.icon=null,e.seedData=null,e.id=0,e.farmNode=null,e.parentNode=null,e.pos=null,e.isCanMove=!0,e}return n(e,t),e.prototype.setData=function(t){this.seedData=t,cc.log("seedData",this.seedData),this.id=this.seedData.id;var e="farm/seed/"+this.id;r.default.addLoaderSprite(this.move_icon).loadSprite(e),r.default.addLoaderSprite(this.icon).loadSprite(e),this.setIsMove()},e.prototype.onEnable=function(){this.onTreeFruit()},e.prototype.start=function(){this.farmNode=s.default.getInstance().farmView,this.parentNode=this.move_icon.node.parent,this.pos=this.move_icon.node.getPosition()},e.prototype.setIsMove=function(){this.seedNum.string=""+this.seedData.seedCount,this.seedData.seedCount>0?(this.isCanMove=!0,this.move_icon.node.color=cc.color(255,255,255)):(this.isCanMove=!1,this.move_icon.node.color=cc.color(0,0,0))},e.prototype.resumeItem=function(){this.move_icon.node.parent=this.parentNode,this.move_icon.node.runAction(cc.moveTo(0,this.pos))},e.prototype.onTreeFruit=function(){this.move_icon.node.on(cc.Node.EventType.TOUCH_START,this.touchStartSeed,this),this.move_icon.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveSeed,this),this.move_icon.node.on(cc.Node.EventType.TOUCH_END,this.touchEndSeed,this),this.move_icon.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndSeed,this)},e.prototype.offTreeFruit=function(){this.move_icon.node.off(cc.Node.EventType.TOUCH_START,this.touchStartSeed,this),this.move_icon.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveSeed,this),this.move_icon.node.off(cc.Node.EventType.TOUCH_END,this.touchEndSeed,this),this.move_icon.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEndSeed,this)},e.prototype.touchStartSeed=function(t){var e=cc.v2(t.getLocation());this.isCanMove&&(this.move_icon.node.parent=this.farmNode.node,this.move_icon.node.setPosition(this.farmNode.node.convertToNodeSpaceAR(e)))},e.prototype.touchMoveSeed=function(t){if(this.isCanMove){var e=t.getLocation();this.move_icon.node.setPosition(this.farmNode.node.convertToNodeSpaceAR(e))}},e.prototype.touchEndSeed=function(t){if(this.isCanMove){var e=cc.v2(t.getLocation()),o=this.farmNode.treeView.node.getBoundingBoxToWorld();e.x>o.x&&e.x<o.x+o.width&&e.y>o.y&&e.y<o.y+o.height&&(-1==c.default.nowSeed?(c.default.nowSeed=this.id,c.default.time=(new Date).getTime(),this.seedData.seedCount--,l.default.showToast("\u79cd\u690d\u6210\u529f"),this.farmNode.treeView.init()):l.default.showToast("\u5df2\u79cd\u690d\u4e86"+c.default.getByID(c.default.nowSeed).name))}this.farmNode.seedBoxs.forEach(function(t){t.setIsMove()}),this.resumeItem()},e.prototype.onDisable=function(){this.offTreeFruit()},a([p(cc.Label)],e.prototype,"seedNum",void 0),a([p(cc.Sprite)],e.prototype,"move_icon",void 0),a([p(cc.Sprite)],e.prototype,"icon",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../InitScene/Script/data/TreeModel":void 0,"../../../framework/Script/component/LoaderSprite":void 0,"../../GameScene/manage/GameManage":"GameManage","../../Script/center/Game":"Game"}],SeedNode:[function(t,e,o){"use strict";cc._RF.push(e,"ec767uTF+1Jw57mR0M50THT","SeedNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/TreeModel"),c=t("../../GameScene/manage/GameManage"),s=t("./SeedItemNode"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.seedlayout=null,e.seedPrefab=null,e.farmView=null,e}return n(e,t),e.prototype.start=function(){this.farmView=c.default.getInstance().farmView,this.setSeedList()},e.prototype.setSeedList=function(){for(var t=r.default.seedArr,e=t.length,o=0;o<e;o++){var i=cc.instantiate(this.seedPrefab),n=i.getComponent(s.default);n.setData(t[o]),i.parent=this.seedlayout,this.farmView.seedBoxs.push(n)}},a([u(cc.Node)],e.prototype,"seedlayout",void 0),a([u(cc.Prefab)],e.prototype,"seedPrefab",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../InitScene/Script/data/TreeModel":void 0,"../../GameScene/manage/GameManage":"GameManage","./SeedItemNode":"SeedItemNode"}],ShareButton:[function(t,e,o){"use strict";cc._RF.push(e,"664c0UytEZML7z0MKioCjyy","ShareButton");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/sdk/share"),c=cc._decorator,s=c.ccclass,l=c.property,d=c.requireComponent,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shareId=0,e}return n(e,t),e.prototype.start=function(){this.node.on("click",this.onClick,this)},e.prototype.onClick=function(){r.default.shareToSociety({shareType:this.shareId})},a([l({tooltip:"\u5206\u4eabid"})],e.prototype,"shareId",void 0),a([s,d(cc.Button)],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../framework/Script/sdk/share":void 0}],ShopItem:[function(t,e,o){"use strict";cc._RF.push(e,"968d7WCmuBBu50k0SFnNa4k","ShopItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/center/GameInit"),s=t("../../../../InitScene/Script/data/GameData"),l=t("../../../../InitScene/Script/data/GunModel"),d=t("../../center/Game"),u=t("../prefabs/getGun/GetGun"),p=cc._decorator,h=p.ccclass,f=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgSprite=null,e.bgSF=[],e.iconSprite=null,e.nameLabel=null,e.levelLabel=null,e.buyBtn=null,e.notUnlockNode=null,e.selectedNode=null,e.coinLabel=null,e.profitLabel=null,e.itemId=0,e.price=0,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t,e){var o=this;this.bgSprite.spriteFrame=this.bgSF[e%this.bgSF.length],this.itemId=t.id,this.iconSprite.spriteFrame=null,d.default.event.on("upgradeGunSuccess",function(){var e="gun/icon/"+t.id;o.setIcon(e)},this);var i="gun/icon/"+t.id;this.setIcon(i),this.nameLabel.string=t.gun_name,this.levelLabel.string=""+(t.id+1),this.price=t.buyPrice,this.profitLabel.string=this.formatNumber(t.profit),this.coinLabel.string=this.formatNumber(this.price),t.id<=l.default.maxLevelCanBuy?(this.buyBtn.active=!0,this.notUnlockNode.active=!1):(this.buyBtn.active=!1,this.notUnlockNode.active=!0),t.id<=l.default.getGunMaxLevel()?this.iconSprite.node.color=cc.Color.WHITE:this.iconSprite.node.color=cc.Color.BLACK},e.prototype.onClickBuy=function(){if(s.default.totalCoinNum<this.price)return console.log("\u91d1\u5e01\u4e0d\u8db3"),void d.default.uiCenter.showUi("FuliNode");var t=d.default.mainUI,e=t.boxs.filter(function(t){return null==t.item&&null==t.equip});if(0==e.length)return c.default.showToast("\u680f\u4f4d\u5df2\u6ee1");t.appendItem(this.itemId,e[0])&&(d.default.gameAudio.playBuy(),s.default.totalCoinNum-=this.price,l.default.getGunDataById(this.itemId).onBuy(),t.buyItem.refresh(),t.updateMatrix(),this.price=l.default.getPrice(this.itemId),this.coinLabel.string=this.formatNumber(this.price),l.default.barViews.forEach(function(t){return t.refresh()}),l.default.getGunDataById(this.itemId).isUnlock||(l.default.getGunDataById(this.itemId).onUnlock(),d.default.uiCenter.showUi("getGun").getComponent(u.default).setData(this.itemId,!0)))},e.prototype.formatNumber=function(t){if(isNaN(t))return"0";if(t<1e3)return t.toFixed();if(t<1e6)return(t/1e3).toFixed(2)+"K";if(t<1e9)return(t/1e3/1e3).toFixed(2)+"M";if(t<1e12)return(t/1e3/1e3/1e3).toFixed(2)+"B";if(t<1e15)return(t/1e3/1e3/1e3/1e3).toFixed(2)+"T";var e=Math.round(t).toString(),o=e.indexOf("e+");if(o>0){var i=e.substr(o+2);return e.substr(0,4)+"/"+i}var n=Math.round(t).toString().length-1;return(t/Math.pow(10,n)).toFixed()+"/"+n},e.prototype.onSelect=function(t){this.selectedNode.active=this.itemId==t},e.prototype.setIcon=function(t){var e=this;this.scheduleOnce(function(){r.default.addLoaderSprite(e.iconSprite).loadSprite(t,cc.SpriteFrame)},.1)},a([f(cc.Sprite)],e.prototype,"bgSprite",void 0),a([f([cc.SpriteFrame])],e.prototype,"bgSF",void 0),a([f(cc.Sprite)],e.prototype,"iconSprite",void 0),a([f(cc.Label)],e.prototype,"nameLabel",void 0),a([f(cc.Label)],e.prototype,"levelLabel",void 0),a([f(cc.Node)],e.prototype,"buyBtn",void 0),a([f(cc.Node)],e.prototype,"notUnlockNode",void 0),a([f(cc.Node)],e.prototype,"selectedNode",void 0),a([f(cc.Label)],e.prototype,"coinLabel",void 0),a([f(cc.Label)],e.prototype,"profitLabel",void 0),a([h],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","../prefabs/getGun/GetGun":"GetGun"}],ShopNode:[function(t,e,o){"use strict";cc._RF.push(e,"ead28FX+x9AfbAcWkoDWhuY","ShopNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/center/GameInit"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../center/Game"),d=t("../list/List"),u=t("../prefabs/BoneNode"),p=t("./ShopItem"),h=t("./ShopUpgrade"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gunSprite=null,e.nameLabel=null,e.levelLabel=null,e.gunList=null,e.upgradeNode=null,e.lightNode=null,e.eyelightNode=null,e.upgradeLight=null,e.isFlah=!1,e.gunData=[],e.selectId=0,e}return n(e,t),e.prototype.start=function(){this.gunData=s.default.getGunListSort(),this.gunList.numItems=this.gunData.length,this.setPageInfo()},e.prototype.onVerticalList=function(t,e){var o=this,i=t.getComponent(p.default);i.setData(this.gunData[e],e),i.onSelect(this.selectId);var n=function(){o.selectId!=o.gunData[e].id&&(o.selectId=o.gunData[e].id,o.setPageInfo(),o.resetSelectedNode())};t.on(cc.Node.EventType.TOUCH_END,n,this),i.buyBtn.on(cc.Node.EventType.TOUCH_END,n,this)},e.prototype.resetSelectedNode=function(){for(var t=0;t<this.gunList.content.childrenCount;t++)this.gunList.content.children[t].getComponent(p.default).onSelect(this.selectId)},e.prototype.setPageInfo=function(){var t=this,e=s.default.getGunDataById(this.selectId);e.off(s.GunEvent.AddExp),this.gunSprite.node.color=e.isUnlock?cc.Color.WHITE:cc.Color.BLACK,this.scheduleOnce(function(){var o="gun/"+e.id;t.eyelightNode.active=!1,r.default.addLoaderSprite(t.gunSprite).loadSprite(o,cc.SpriteFrame)},.1),this.upgradeNode.node.active=!1,this.gunSprite.node.getComponent(cc.Button).interactable=!1,e.off(s.GunEvent.AddExp),this.nameLabel.string=e.gun_name,this.levelLabel.string=""+(e.id+1)},e.prototype.playAni=function(){var t=this;s.default.getGunDataById(this.selectId),l.default.event.emit(u.BoneEvent.TotalBoneUseAnimoEvent,this.gunSprite.node.convertToWorldSpaceAR(cc.Vec2.ZERO),this.gunSprite.node),this.showLight(function(){t.flash(!1),t.setPageInfo()}),l.default.gameAudio.playMount_upgrade()},e.prototype.onClose=function(){c.default.uiCenter.closeUI(this.node)},e.prototype.showLight=function(t){var e=this;this.lightNode.opacity=0,this.lightNode.active=!0,this.isFlah=!0,cc.tween(this.lightNode).sequence(cc.tween().to(.3,{opacity:255}),cc.tween().delay(1),cc.tween().to(.3,{opacity:0})).call(function(){e.lightNode.active=!1,t&&t()}).start()},e.prototype.flash=function(t){var e=this;t&&this.isFlah&&(l.default.gameAudio.playMount_upgrade10Clip(),this.isFlah=!1,this.upgradeLight.node.active=!0,this.upgradeLight.once(dragonBones.EventObject.COMPLETE,function(){e.upgradeLight.node.active=!1}),this.upgradeLight.playAnimation("newAnimation",1),s.default.emit(s.GunEvent.ChangeGun,this.selectId),l.default.event.emit("upgradeGunSuccess"),this.eyelightNode.active=!0)},a([y(cc.Sprite)],e.prototype,"gunSprite",void 0),a([y(cc.Label)],e.prototype,"nameLabel",void 0),a([y(cc.Label)],e.prototype,"levelLabel",void 0),a([y(d.default)],e.prototype,"gunList",void 0),a([y(h.default)],e.prototype,"upgradeNode",void 0),a([y(cc.Node)],e.prototype,"lightNode",void 0),a([y(cc.Node)],e.prototype,"eyelightNode",void 0),a([y(dragonBones.ArmatureDisplay)],e.prototype,"upgradeLight",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game","../list/List":"List","../prefabs/BoneNode":"BoneNode","./ShopItem":"ShopItem","./ShopUpgrade":"ShopUpgrade"}],ShopUpgrade:[function(t,e,o){"use strict";cc._RF.push(e,"4104717q7VPE53UT2HaDQhP","ShopUpgrade");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=t("../../../../InitScene/Script/data/GunModel"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boneLabel=null,e.boneProgressBar=null,e.data=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){this.data&&this.data.off(c.GunEvent.AddExp,this.updateUI,this),this.data=t,t.on(c.GunEvent.AddExp,this.updateUI,this),this.updateUI()},e.prototype.addExp=function(){if(r.default.totalBoneNum<this.data.needBone)return s.default.showToast("\u57fa\u56e0\u4e0d\u8db3"),void s.default.uiCenter.showUi("FuliNode");r.default.totalBoneNum-=this.data.needBone,this.data.onAddExp(),this.updateUI()},e.prototype.updateUI=function(){this.boneLabel.string=this.data.needBone*this.data.exp+"/"+this.data.needBone*this.data.needExp;var t=this.data.exp/this.data.needExp;this.updateProgress(!0,t)},e.prototype.updateProgress=function(t,e){t?cc.tween(this.boneProgressBar).to(.5,{progress:e}).start():this.boneProgressBar.progress=e},a([u(cc.Label)],e.prototype,"boneLabel",void 0),a([u(cc.ProgressBar)],e.prototype,"boneProgressBar",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../center/Game":"Game"}],SignItem:[function(t,e,o){"use strict";cc._RF.push(e,"fd4c8GeMq9Pvb/0tUSmO07U","SignItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateSprite=null,e.lineNode=null,e.dayLabel=null,e.iconSprite=null,e.numLabel=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.isGray=function(t){this.lineNode.active&&(this.lineNode.active=!t),this.setGary(this.iconSprite.node,t)},e.prototype.setGary=function(t,e){var o;o=e?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite"),t.getComponent(cc.Sprite).setMaterial(0,o)},a([s(cc.Sprite)],e.prototype,"stateSprite",void 0),a([s(cc.Node)],e.prototype,"lineNode",void 0),a([s(cc.Label)],e.prototype,"dayLabel",void 0),a([s(cc.Sprite)],e.prototype,"iconSprite",void 0),a([s(cc.Label)],e.prototype,"numLabel",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],SignNode:[function(t,e,o){"use strict";cc._RF.push(e,"80926+xgJpApITl9otqNSFp","SignNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/center/GameInit"),l=t("../../../../InitScene/Script/data/BadgeModel"),d=t("../../../../InitScene/Script/data/GameData"),u=t("../../../../InitScene/Script/data/GunModel"),p=t("../../../../InitScene/Script/data/PersonModel"),h=t("../../../../InitScene/Script/data/TimeModel"),f=t("../../center/Game"),m=t("../cultivate/GetCultivateNode"),y=t("../main/GetCurrencyNode"),g=t("../prefabs/getGun/GetGun"),v=t("./SignItem"),_=cc._decorator,S=_.ccclass,b=_.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentNode=null,e.signItem=null,e.receiveButton=null,e.videoButton=null,e.gunSprite=null,e.hero=null,e.titleSprite=null,e.nameSprite=null,e.typeSpriteFrame=[],e.stateSpriteFrame=[],e.awardSpriteFrame=[],e.titleText=null,e.signData=[],e.isAutoRecieve=!1,e.chineseNumbers=["\u96f6","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"],e}return n(e,t),e.prototype.setData=function(t){this.isAutoRecieve=t},e.prototype.start=function(){var t=this;this.setSignList(),this.setButton(),this.setNext(),this.scheduleOnce(function(){t.isAutoRecieve&&t.onReceive()},1)},e.prototype.setButton=function(){this.receiveButton.interactable=-1==h.default.lastSignTime,this.videoButton.interactable=-1==h.default.lastSignTime,-1==h.default.lastSignTime&&(this.videoButton.interactable="gun"!=this.signData[h.default.day].type&&"hero"!=this.signData[h.default.day].type)},e.prototype.setSignList=function(){this.signData=s.default.gameConfig.signConfig[h.default.dayRound].round;for(var t=0;t<this.signData.length;t++){var e=this.signData[t],o=cc.instantiate(this.signItem),i=o.getComponent(v.default);switch(e.type){case"coin":i.numLabel.node.active=!0,i.numLabel.string=""+e.num*u.default.profit,i.iconSprite.spriteFrame=this.typeSpriteFrame[e.icon],i.iconSprite.node.setScale(1),(t<h.default.day||this.isInteger(h.default.dayCount/7)&&-1!=h.default.lastSignTime)&&(i.numLabel.node.active=!1);break;case"diamond":case"bone":i.numLabel.node.active=!0,i.numLabel.string=""+this.formatNumber(e.num),i.iconSprite.spriteFrame=this.typeSpriteFrame[e.icon],i.iconSprite.node.setScale(1);break;case"hero":this.setIcon("hero/avatar/"+e.icon,i.iconSprite),i.stateSprite.spriteFrame=this.stateSpriteFrame[0],i.lineNode.active=!0,i.iconSprite.node.setScale(.45),i.iconSprite.node.y=10;break;case"gun":var n=7==e.day?1:0,a="gun/icon/"+e.icon;this.setIcon(a,i.iconSprite),i.stateSprite.spriteFrame=this.stateSpriteFrame[n],i.lineNode.active=!0,i.iconSprite.node.setScale(.7)}i.dayLabel.string="\u7b2c"+e.day+"\u5929",-1==h.default.lastSignTime&&t==h.default.day&&(i.stateSprite.spriteFrame=this.stateSpriteFrame[2]),i.isGray(t<h.default.day||this.isInteger(h.default.dayCount/7)&&-1!=h.default.lastSignTime),this.contentNode.addChild(o)}},e.prototype.formatNumber=function(t){if(isNaN(t))return"0";if(t<1e3)return t.toFixed();if(t<1e6)return(t/1e3).toFixed()+"*";if(t<1e9)return(t/1e3/1e3).toFixed()+",";if(t<1e12)return(t/1e3/1e3/1e3).toFixed()+"-";if(t<1e15)return(t/1e3/1e3/1e3/1e3).toFixed()+".";var e=Math.round(t).toString(),o=e.indexOf("e+");if(o>0){var i=e.substr(o+2);return e.substr(0,4)+"/"+i}var n=Math.round(t).toString().length-1;return(t/Math.pow(10,n)).toFixed()+"/"+n},e.prototype.setSelected=function(t){t.spriteFrame=this.stateSpriteFrame[2]},e.prototype.isInteger=function(t){return/^\+?[1-9][0-9]*$/.test(t+"")},e.prototype.setIcon=function(t,e){this.scheduleOnce(function(){r.default.addLoaderSprite(e).loadSprite(t,cc.SpriteFrame)},.1)},e.prototype.setNext=function(){if(0==h.default.dayRound)for(var t=h.default.day;t<this.signData.length;t++){var e=this.signData[t];if("gun"==e.type){this.gunSprite.node.scale=1.5,this.gunSprite.node.angle=50;var o="gun/"+e.icon;this.setIcon(o,this.gunSprite),this.setText(e.day,u.default.getGunDataById(e.icon).gun_name),this.hero.active=!1,this.gunSprite.node.active=!0;break}if("hero"==e.type){this.setText(e.day,p.default.getHeroDataById(e.icon).name),p.default.getHeroDataById(e.icon),this.playArmature(this.gunSprite.node,"hero/avatar/"+e.icon,"\u5f85\u673a",cc.v2(0,0),null,function(t){t.setScale(2),t.anchorY=0,t.y=10}),this.hero.active=!0,this.gunSprite.node.active=!1;break}}else this.gunSprite.spriteFrame=this.awardSpriteFrame[this.signData[h.default.day].icon]},e.prototype.setText=function(t,e){this.titleText.string="<b><outline color=black width=4><color=#FFFFFF>\u7b2c"+this.chineseNumbers[t]+"\u5929\u767b\u5f55\u5373\u9001</c><color=#FFD100>"+e+"</color></outline><b/>"},e.prototype.playArmature=function(t,e,o,i,n,a){var c=this.hero,s=c.addComponent(cc.Sprite);r.default.addLoaderSprite(s).loadSprite(e),i instanceof cc.Node?c.setPosition(i.getPosition()):c.setPosition(i),a&&a(c)},e.prototype.drapedtoujin=function(){},e.prototype.onReceive=function(){this.signGain(1)},e.prototype.signGain=function(t){var e=this.contentNode.children[h.default.day].getComponent(v.default),o=this.signData[h.default.day],i=0;switch(h.default.lastSignTime=(new Date).getTime(),h.default.dayCount+=1,o.type){case"coin":i=o.num*t*u.default.profit,d.default.totalCoinNum+=i,s.default.uiCenter.showUi("GetCurrencyNode").getComponent(y.default).setData(i);break;case"diamond":i=o.num*t,d.default.totalDiamondNum+=i,s.default.uiCenter.showUi("GetCurrencyNode").getComponent(y.default).setData(0,i);break;case"bone":i=o.num*t,d.default.totalBoneNum+=i,s.default.uiCenter.showUi("GetCurrencyNode").getComponent(y.default).setData(0,0,i);break;case"hero":var n=p.default.getHeroDataById(o.icon);n.onUnlock(),p.default.useHeroId=n.id,s.default.uiCenter.showUi("GetCultivateNode").getComponent(m.default).setData("hero","hero/dragon/"+n.skeUrl,"\u5f85\u673a",n.award,!0);break;case"gun":var a=u.default.getGunDataById(o.icon);a.onUnlock(),u.default.useGunId=a.id;var r=f.default.mainUI,c=r.boxs.filter(function(t){return null==t.item&&null==t.equip});r.appendItem(a.id,c[0])&&r.updateMatrix(),f.default.uiCenter.showUi("getGun").getComponent(g.default).setData(a.id,!0)}l.default.updateSignBadge(),e.stateSprite.spriteFrame=this.stateSpriteFrame[3],e.lineNode.active=!1,e.isGray(!0),this.setButton()},e.prototype.onManyTimes=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.videoSuccess=function(){this.signGain(2)},e.prototype.onClose=function(){s.default.uiCenter.closeUI(this.node)},a([b(cc.Node)],e.prototype,"contentNode",void 0),a([b(cc.Prefab)],e.prototype,"signItem",void 0),a([b(cc.Button)],e.prototype,"receiveButton",void 0),a([b(cc.Button)],e.prototype,"videoButton",void 0),a([b(cc.Sprite)],e.prototype,"gunSprite",void 0),a([b(cc.Node)],e.prototype,"hero",void 0),a([b(cc.Sprite)],e.prototype,"titleSprite",void 0),a([b(cc.Sprite)],e.prototype,"nameSprite",void 0),a([b(cc.SpriteFrame)],e.prototype,"typeSpriteFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"stateSpriteFrame",void 0),a([b(cc.SpriteFrame)],e.prototype,"awardSpriteFrame",void 0),a([b(cc.RichText)],e.prototype,"titleText",void 0),a([S],e)}(cc.Component);o.default=w,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../InitScene/Script/data/TimeModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../cultivate/GetCultivateNode":"GetCultivateNode","../main/GetCurrencyNode":"GetCurrencyNode","../prefabs/getGun/GetGun":"GetGun","./SignItem":"SignItem"}],SkillFortNode:[function(t,e,o){"use strict";cc._RF.push(e,"7962dDcCz5Fk53ljMqmzQgq","SkillFortNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../../InitScene/Script/data/GunModel"),c=t("../../../../../InitScene/Script/data/MountModel"),s=t("../../../../../InitScene/Script/data/PersonModel"),l=t("../../../../../Script/common/Flash"),d=t("../../../../Script/center/Game"),u=t("../../../joystick/JoystickCommon"),p=t("../../../manage/GameManage"),h=t("../../../Player"),f=t("../../../test/EditView"),m=t("../ArmView"),y=t("../FireView"),g=cc._decorator,v=g.ccclass,_=g.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boomNode=null,e}return n(e,t),e.prototype.start=function(){var t=this;this.gameView=p.default.getInstance().gameView,this.gunIdx=0,this.personIdx=0,this.mountIdx=0,this.loadModel(this.personIdx,this.gunIdx,this.mountIdx),this.scheduleOnce(function(){t.isCanHurt=!0,t.breath(),t.setAI()},.2)},e.prototype.breath=function(){var t=this;this.breathNormalFloorNode.node.active=!0,this.breathNormalNode.node.active=!0,this.breathNormalFloorNode.once(dragonBones.EventObject.COMPLETE,function(){t.breathNormalFloorNode.node.active=!1}),t.breathNormalNode.once(dragonBones.EventObject.COMPLETE,function(){t.breathNormalNode.node.active=!1}),this.breathNormalFloorNode.playAnimation("newAnimation",1),this.breathNormalNode.playAnimation("newAnimation",1)},e.prototype.loadModel=function(t,e,o){var i,n,a;if(n=s.default.getHeroDataById(t),i=r.default.getGunDataById(e),a=c.default.getMountDataById(o),this.model.group=-1,this.skill=n.skill,this.skillAtk=n.SkillATK,this.isInvincible=!1,this.mount_level=10,this.bloodLevel=a.bloodLevel,this.model.MAX_HP=this.model.HP=600,this.model.ATK=100,this.model.IDLE=n.IDLE+i.IDLE,this.model.SPE=0,this.model.CRI=n.CRI+i.CRI,this.model.RAN=i.RAN+n.DIST,this.model.ROT=i.ROT,this.model.MOV=i.MOV+n.ATKSPE,this.model.bullet=i.bullet,this.model.fire=i.fire,this.model.type=i.ATtypeK,this.model.audio=i.audio,this.model.hurt_audio=i.hurt_audio,this.model.num=i.num,this.model.total=i.total,this.model.time=i.time,this.model.pow=0,this.model.hit=i.hit,this.slotName=i.slot,this.CDtime=n.skillCD,this.hpView.init(this.model.MAX_HP,this.isInvincible),p.default.getInstance().gameType==p.GameType.\u7ade\u6280\u573a){var l=p.default.getInstance().player;this.model.nickname=l.name,this.model.icon=l.avatarUrl,this.model.playerItemData=l}},e.prototype.setAI=function(){this.gameView.targets.push(this),this.schedule(function(){var t=this,e=t.findTargets().filter(function(e){return t.isAttack(e)});if(e.length>0)t.target=e[0],t.attack();else if(!t.isFill&&!t.isIdle){var o=t.gameView.quadTree.retrieve(t.node.getBoundingBox()).filter(function(e){return t.gameView.nameList.indexOf(e.node.name)>-1&&e.type==f.ItemType.CN}).filter(function(e){return t.isAttackBlock(e)});if(o.length>0)return t.moveDir=cc.v2(o[0].rect.x+o[0].rect.width/2,o[0].rect.y+o[0].rect.height/2).sub(t.node.getPosition()).normalizeSelf(),t.updateDir(t.getDir()),void(t.doAttack()&&(t._speedType=u.SpeedType.NORMAL,t.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf()))}},.1)},e.prototype.findTargets=function(){var t=this;return this.gameView.targets.filter(function(e){return t.checkTarget(e)&&e.model.group>=1e5}).sort(function(e,o){return e.node.position.sub(t.node.position).mag()-o.node.position.sub(t.node.position).mag()})},e.prototype.attack=function(){this.isFill||this.isIdle||(this.updateDir(this.getDir()),this.doAttack()&&(this._speedType=u.SpeedType.NORMAL,this.moveDir=cc.v2(Math.random()-.5,Math.random()-.5).normalizeSelf()))},e.prototype.getDir=function(t){var e;if(t=t||this.target,this.checkTarget(t)){var o=t.hero?t.hero.node:t.heroSke.node,i=t.node.parent.convertToNodeSpaceAR(o.convertToWorldSpaceAR(cc.v2(0,o.height/3))),n=this.node.parent.convertToNodeSpaceAR(this.sprite.node.convertToWorldSpaceAR(cc.v2(0,0)));e=cc.v2(i.sub(n).normalizeSelf())}else e=this.atkDir?this.atkDir:this.moveDir;return e},e.prototype.doAttack=function(){var t=this;if(!this.checkTarget(this))return!1;if(this.isFill)return!0;d.default.gameAudio.playGunFireClip(this.gunIdx);for(var e=this.model.getCount(),o=0;o<e;o++){var i=this.gameView.getArm().getComponent(m.default);if(i){var n=this.sprite.node.getChildByName("fire").convertToWorldSpaceAR(cc.v2(0,0)),a=this.gameView.layout.convertToNodeSpaceAR(n);i.node.setParent(this.gameView.layout),i.node.setPosition(a),i.init(this,this.getDir()),this.offect=this.getDir().mul(2*-this.model.pow);var r=this.getDir().mul(-this.model.pow),c=this.getDir().mul(this.model.pow);this.dragon.node.scaleX<0&&(r=this.getDir().add(cc.v2(-2*this.getDir().x,0)).mul(-this.model.pow),c=this.getDir().add(cc.v2(-2*this.getDir().x,0)).mul(this.model.pow)),this.sprite.node.runAction(cc.sequence(cc.moveBy(.05,r),cc.moveBy(.05,c)))}}return this.addFire(),this.model.IDLE>0&&(this.isIdle||(this.isIdle=!0,this.scheduleOnce(function(){t.isIdle=!1},this.model.IDLE))),this.model.time>0&&this.model.addCount(e)&&(this.isFill=!0,this.scheduleOnce(function(){t.isFill=!1,t.model.clearCount()},this.model.time)),!0},e.prototype.addFire=function(){var t;this.fire?(t=this.fire.getComponent(y.default))&&t.doFire():(this.fire=this.gameView.getFire(),(t=this.fire.getComponent(y.default))&&this.model.fire>=0?(this.fire.setParent(this.sprite.node.getChildByName("fire")),this.updateFire(),t.init(this.model,this.removeFire.bind(this)),t.doFire()):this.removeFire())},e.prototype.updateDir=function(t){t=t||this.moveDir,this.dragon&&(t.x>0?this.dragon.node.scaleX=1:this.dragon.node.scaleX=-1,this.sprite&&(this.dragon.node.scaleX>0?this.sprite.node.angle=-(-90+cc.misc.radiansToDegrees(Math.atan2(t.x,t.y))):this.sprite.node.angle=-(-90-cc.misc.radiansToDegrees(Math.atan2(t.x,t.y)))))},e.prototype.hurt=function(t){if(this.isCanHurt){var e=this;this.checkTarget(this)&&(this.doHurt(t),d.default.gameAudio.playHurtClip(t.hurt_audio),this.model.isDead()?(this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(l.default).updateFlashHurt(function(){e.isHurt=!1})),this.die()):(this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(l.default).updateFlashHurt(function(){e.isHurt=!1})),this.isHurt||(this.isHurt=!0,this.hero.getComponent(dragonBones.ArmatureDisplay).setMaterial(0,this.flashMaterial),this.hero.addComponent(l.default).updateFlash())))}},e.prototype.changeAnimation=function(t){var e=this;t.flag&&(this.isPlay=!1,this.animation=""),this.hero&&this.hero.isValid&&(this.isPlay||(t.loop?this.animation!=t.animation&&(this.animation=t.animation,t.animation.indexOf("\u6b7b\u4ea1")>-1?(this.isPlayDie=!0,this.boomNode.node.active=!0,d.default.gameAudio.playHurtClip(2),this.boomNode.once(dragonBones.EventObject.COMPLETE,function(){t.callback&&t.callback(),e.node.opacity=0},this),this.boomNode.playAnimation("newAnimation",1)):t.callback&&t.callback()):(this.isPlay=!1,this.isPlay=!0,this.animation="",t.animation.indexOf("\u6b7b\u4ea1")>-1?(this.isPlayDie=!0,this.boomNode.node.active=!0,d.default.gameAudio.playHurtClip(2),this.boomNode.once(dragonBones.EventObject.COMPLETE,function(){t.callback&&t.callback(),e.node.opacity=0},this),this.boomNode.playAnimation("newAnimation",1)):t.callback&&t.callback())))},e.prototype.isAttackBlock=function(t){if(t&&this.checkTarget(this)&&!this.isStop){var e=cc.v2(this.node.position),o=cc.v2(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/2);return e.sub(o).mag()>this.model.RAN}return!1},e.prototype.update=function(){if(!this.isStop&&this.checkTarget(this)){switch(this._speedType){case u.SpeedType.STOP:case u.SpeedType.NORMAL:case u.SpeedType.FAST:this._moveSpeed=0,!this.isAtking&&this.changeAnimation({animation:"newAnimation",loop:!0})}this.fire&&this.updateFire(),this.circle&&this.circle.node.active&&(this.circle.clear(),this.circle.circle(0,0,this.model.RAN),this.circle.fill(),this.circle.stroke());var t=this.hero?this.hero:this.heroSke;this.offect.mag()>1?this.offect=this.offect.mul(.9):this.offect=cc.Vec2.ZERO,this.sprite&&t&&this.gunNode&&(this.sprite.node.parent=this.gunNode,this.sprite.node.setPosition(cc.v2(0,0))),t&&this.dragon&&this.heroNode&&(t.node.parent=this.heroNode,t.node.setPosition(cc.v2(0,0)))}},a([_(dragonBones.ArmatureDisplay)],e.prototype,"boomNode",void 0),a([v],e)}(h.default);o.default=S,cc._RF.pop()},{"../../../../../InitScene/Script/data/GunModel":void 0,"../../../../../InitScene/Script/data/MountModel":void 0,"../../../../../InitScene/Script/data/PersonModel":void 0,"../../../../../Script/common/Flash":void 0,"../../../../Script/center/Game":"Game","../../../Player":"Player","../../../joystick/JoystickCommon":"JoystickCommon","../../../manage/GameManage":"GameManage","../../../test/EditView":"EditView","../ArmView":"ArmView","../FireView":"FireView"}],SkillModel:[function(t,e,o){"use strict";cc._RF.push(e,"bc42dH3xoxECaURgpA6culk","SkillModel");var i=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../../../InitScene/Script/data/PlayerModel"),a=cc._decorator,r=a.ccclass,c=(a.property,function(){function t(){this.group=0,this.ATK=100,this.CRI=0,this.RAN=0,this.speed=cc.Vec2.ZERO,this.dir=cc.Vec2.ZERO,this.type=n.ArmType.\u6b63\u5e38,this.state=n.ArmState.\u6b63\u5e38,this.pos=cc.Vec2.ZERO,this.mount_atk=10,this.player=null,this.mount=null,this.isCombine=!1}return t.prototype.reset=function(){this.dir=cc.Vec2.ZERO,this.speed=cc.Vec2.ZERO,this.type=n.ArmType.\u6b63\u5e38,this.state=n.ArmState.\u6b63\u5e38,this.player=null},i([r],t)}());o.default=c,cc._RF.pop()},{"../../../../InitScene/Script/data/PlayerModel":void 0}],SkillView:[function(t,e,o){"use strict";cc._RF.push(e,"0d42515OTRAqp23M9o9lAbY","SkillView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=t("../../manage/GameManage"),d=t("../../BasePlayer"),u=t("../../test/EditView"),p=t("./GameBlock"),h=t("../../../../MainScene/Script/center/Game"),f=t("../model/SkillModel"),m=t("../../../../InitScene/Script/data/MountModel"),y=t("../../FollowCamare"),g=t("../../../../InitScene/Script/data/PersonModel"),v=t("../../../../Script/base/Utils"),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skill=[],e.combineskill=[],e.hurtSkill=[],e.skillNode=null,e.fortNode=null,e.hurt_ani=null,e.ani=null,e.gameView=null,e.particle=null,e.model=new f.default,e.isDestory=!1,e.isFollow=!1,e.target=null,e.life=0,e.radius=200,e.CD=.2,e.atkTime=(new Date).getTime(),e.isAtk0=!0,e.isAtkTargets=!0,e.flyLenght=0,e.flytime=0,e.hurt=null,e.hurtID=0,e.dir=null,e.curSkill=null,e.isCombineskill=!1,e}return n(e,t),e.prototype.onLoad=function(){this.gameView=l.default.getInstance().gameView},e.prototype.start=function(){},e.prototype.setModel=function(t,e,o){this.model.mount_atk=m.default.getUpgradeLevelValue(e.id,o)[0],this.model.mount=e,this.model.group=t.model.group,this.model.ATK=t.model.ATK,this.model.CRI=t.model.CRI,this.model.RAN=t.model.RAN,this.model.type=t.model.type,this.model.pos=t.node.getPosition(),this.model.player=t},e.prototype.init=function(t,e,o,i){var n,a=this,r=this;switch(this.model.isCombine=!1,this.isCombineskill=!1,this.hurtID=t.model.hit,this.dir=e,(n=this.skill[t.skill])&&(n.timeScale=1),this.skillNode.width=0,t.skill){case g.HeroSkillType.Hammer:this.reset(),this.setModel(t,o,i),this.model.speed=e.mul(0);var c=this.doSkill0(this.dir);this.node.setPosition(c),n.on(dragonBones.EventObject.START,function(){h.default.gameAudio.playSkill(t.skill)});break;case g.HeroSkillType.Carrot:this.reset(),this.model.dir=t.getDir(),this.setModel(t,o,i),this.model.speed=e.mul(800);break;case g.HeroSkillType.Shears:this.reset(),this.model.dir=t.getDir(),this.setModel(t,o,i),this.model.speed=e.mul(1e3),this.flyLenght=0,this.flytime=0,this.schedule(this.changeShears,.1),h.default.gameAudio.playSkill(t.skill);break;case g.HeroSkillType.Hair:this.reset(),this.model.dir=t.getDir(),this.setModel(t,o,i),this.model.speed=e.mul(0),this.node.setPosition(this.model.player.node.getPosition()),this.doSkill3(),h.default.gameAudio.playSkill(t.skill);break;case g.HeroSkillType.Go:this.reset(),this.model.dir=t.getDir(),this.setModel(t,o,i),this.model.speed=e.mul(4e3),this.node.setPosition(this.model.player.node.getPosition().add(cc.v2(0,50))),this.node.zIndex=-1e3,this.doSkill4(),h.default.gameAudio.playSkill(t.skill);break;case g.HeroSkillType.Camera:this.reset(),this.model.dir=t.getDir(),this.setModel(t,o,i),this.model.speed=e.mul(0),this.doSkill5(e),h.default.gameAudio.playSkill(t.skill);break;case g.HeroSkillType.Fire:this.reset(),this.setModel(t,o,i),this.model.speed=e.mul(0),c=this.doSkill6(this.dir),this.node.setPosition(c),h.default.gameAudio.playSkill(t.skill)}n&&n.once(dragonBones.EventObject.COMPLETE,function(){n.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE),n.removeEventListener(dragonBones.EventObject.START),n.node.active=!1,r.model.speed=e.mul(t.model.MOV),r.updateDir(e),t.isAtking=!1,cc.log(">>>>>>>>>>>\u64ad\u653e\u5b8c\u6210\u5f53\u524d\u6280\u80fd1",t.isAtking,a.model.player.isStop),r.doDestory()}),n&&(n.node.active=!0),n&&n.playAnimation("newAnimation",t.skill_playTimes),t.isAtking=!0,cc.log("player.skill_playTimes1",t.skill_playTimes,t.isAtking),n&&(this.curSkill=n),this.updateDir(e)},e.prototype.initCombine=function(t,e,o,i){cc.log("initCombine",t.combineSkill);var n,a=this;switch(this.isCombineskill=!0,this.model.isCombine=!0,this.hurtID=t.model.hit,this.dir=e,(n=this.combineskill[t.combineSkill-100])&&(n.timeScale=1),this.skillNode.width=0,t.combineSkill){case g.HeroSkillType.Fort:return this.reset(),this.setModel(t,o,i),this.model.speed=e.mul(0),void this.doSkill100();case g.HeroSkillType.Light:return this.reset(),this.setModel(t,o,i),this.model.speed=e.mul(0),this.updateDir(e),this.skillNode.angle+=12.5,this.schedule(this.showLight,.02),n=null,this.model.player.skillLight=!0,h.default.gameAudio.playCombineSkill(t.combineSkill),this.scheduleOnce(this.doDestory,.5),void(t.isAtking=!0);case g.HeroSkillType.Tree:this.reset(),this.model.dir=t.getDir(),this.setModel(t,o,i),this.model.speed=e.mul(0),this.doSkill101(e),cc.log("player",t.combineSkill),h.default.gameAudio.playCombineSkill(t.combineSkill)}n&&n.once(dragonBones.EventObject.COMPLETE,function(){n.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE),n.removeEventListener(dragonBones.EventObject.START),n.node.active=!1,cc.log(">>>>>>>>>>>\u64ad\u653e\u5b8c\u6210\u5f53\u524d\u6280\u80fd"),a.model.speed=e.mul(t.model.MOV),a.updateDir(e),t.isAtking=!1,a.doDestory()}),n&&(n.node.active=!0),n&&n.playAnimation("newAnimation",t.combineSkill_playTimes),cc.log("player.skill_playTimes",t.combineSkill_playTimes),t.isAtking=!0,n&&(this.curSkill=n),this.updateDir(e)},e.prototype.showLight=function(){cc.log("showLight",this.skillNode.width),this.doSkill102(),this.skillNode.width+=300,this.skillNode.width>=512&&(this.skillNode.width=512),this.skillNode.width>384&&(this.skillNode.angle-=2)},e.prototype.changeShears=function(){this.model.player.isAtking=!1,this.flyLenght>640&&0==this.flytime?(cc.log("\u5f80\u56de\u98de",this.flyLenght),this.model.speed=this.model.player.node.getPosition().sub(this.node.getPosition()).normalize().mul(1e3),this.flytime=1,this.flyLenght=640):this.flyLenght>640&&(this.model.speed=this.model.player.node.getPosition().sub(this.node.getPosition()).normalize().mul(1e3),this.model.player.node.getPosition().sub(this.node.getPosition()).mag()<50&&(this.doDestory(),this.flytime=0,this.flyLenght=0,this.unschedule(this.changeShears)))},e.prototype.showFire=function(){this.dir=this.model.player.getDir(),this.model.speed=this.dir.mul(0),this.updateDir(this.dir),this.doSkill8(this.dir)},e.prototype.reset=function(){this.isFollow=!1,this.isDestory=!1,this.radius=240,this.model.reset()},e.prototype.check=function(t){var e=this,o=[],i=this.checkBlock(t),n=[];if(n=this.checkTargets(t),this.isCombineskill||this.model.player.skill!=g.HeroSkillType.Go||(i=this.checkBlock(t,cc.rect(this.node.x-128,this.node.y-128,128,128)),n=this.checkTargets(t,cc.rect(this.node.x-128,this.node.y-128,128,128))),(o=o.concat(i.map(function(t){return{type:"block",item:t}})).concat(n.map(function(t){return{type:"target",item:t}})).sort(function(t,o){return t.item.node.getPosition().sub(e.node.getPosition()).mag()-o.item.node.getPosition().sub(e.node.getPosition()).mag()})).length>0){if(this.isCombineskill&&this.model.player.combineSkill==g.HeroSkillType.Light||!this.isCombineskill&&(this.model.player.skill==g.HeroSkillType.Shears||this.model.player.skill==g.HeroSkillType.Go)){for(var a=0;a<o.length;a++)switch(o[a].type){case"block":this.hintBlock(o[a].item);break;case"target":this.hintTarget(o[a].item)}return!0}switch(o[0].type){case"block":return this.hintBlock(o[0].item);case"target":return this.hintTarget(o[0].item)}}return!1},e.prototype.checkTargets=function(t,e){var o=this;void 0===e&&(e=this.node.getBoundingBox());var i=cc.v2((e.xMin+e.xMax)/2,(e.yMin+e.yMax)/2);return this.gameView.targets.filter(function(n){if(n.checkTarget(n)&&n.model.group!=o.model.group){var a=n.node.getBoundingBox();return a.x+=10,a.y+=n.dragon.node.y+50,a.width-=10,a.height-=50,cc.Intersection.lineRect(i,i.add(o.model.speed.mul(t)),a)||i.sub(cc.v2(a.x,a.y)).mag()<=a.width/2+e.width/2}return!1})},e.prototype.checkBlock=function(t,e){return void 0===e&&(e=this.node.getBoundingBox()),this.checkCustom(e,t)},e.prototype.checkCustom=function(t,e){var o=this;return this.gameView.quadTree.retrieve(t).filter(function(i){return o.gameView.nameList.indexOf(i.node.name)>-1&&(i.type==u.ItemType.BLOCK||i.type==u.ItemType.BOX||i.type==u.ItemType.CN||i.type==u.ItemType.SHADOW||i.type==u.ItemType.MOUNTAIN)&&(cc.Intersection.lineRect(o.node.getPosition(),o.node.getPosition().add(o.model.speed.mul(e)),i.rect)||cc.v2(t.x,t.y).sub(cc.v2(i.rect.x,i.rect.y)).mag()<=t.width/2+i.rect.width/2)})},e.prototype.clear=function(){this.target=null,this.hurt&&(this.node.removeChild(this.hurt),this.hurt.destroy(),this.hurt=null),this.node.removeAllChildren(),this.unscheduleAllCallbacks(),this.node.stopAllActions(),this.particle&&(this.particle=null),this.hurt_ani&&(this.gameView.removeAni(this.hurt_ani),this.node.removeAllChildren(),this.hurt_ani=null),this.gameView.putArm(this.node)},e.prototype.doDestory=function(){var t=this;this.isDestory||(this.isDestory=!0,this.unscheduleAllCallbacks(),this.curSkill&&(this.curSkill.timeScale=100),this.curSkill&&(this.curSkill.node.active=!1),this.isCombineskill||this.model.player.skill!=g.HeroSkillType.Carrot||(h.default.gameAudio.playHurtClip(1),this.hurtSkill[this.model.player.skill].node.active=!0,this.hurtSkill[this.model.player.skill].node.angle=-this.node.angle,this.hurtSkill[this.model.player.skill].on(dragonBones.EventObject.COMPLETE,function(){t.node.destroy()}),this.hurtSkill[this.model.player.skill].playAnimation("newAnimation",1),this.curSkill.node.active=!1),this.isCombineskill&&this.model.player.combineSkill==g.HeroSkillType.Light&&(this.schedule(this.hideSkillNode,0),this.model.player.changeAnimation({animation:"\u5f85\u673a",loop:!0})),this.model.player.isStop=!1,cc.log("this.model.player.isStop",this.model.player.isStop))},e.prototype.hideSkillNode=function(){this.skillNode.width-=100,this.skillNode.width<=0&&(this.skillNode.width=0,this.model.player.skillLight=!1,this.model.player.isAtking=!1,this.unschedule(this.hideSkillNode))},e.prototype.doFollow=function(){var t=this;this.schedule(function(){t.target&&t.target.node&&t.target.node.active?t.model.speed=t.target.node.getPosition().sub(t.node.getPosition()).normalizeSelf().mul(1500):t.findTarget(cc.rect(t.node.x-40,t.node.y-40,80,80))},.1)},e.prototype.doSkill0=function(t,e){var o=this;void 0===e&&(e=400);var i=this.model.player.node.getPosition().add(t.mul(e)),n=cc.rect(i.x-e,i.y-e,2*e,2*e),a=new Map;return this.gameView.quadTree.retrieve(n).forEach(function(t){!a.has(t.node.uuid)&&(t.type==u.ItemType.BOX||t.type==u.ItemType.CN)&&t.node.getPosition().sub(i).mag()<=e&&a.set(t.node.uuid,t.node)}),Array.from(a.values()).forEach(function(t){if(t){var e=t.getComponent(p.default);e&&e.hurt(o.model)}}),this.gameView.targets.forEach(function(t){t&&t.checkTarget(t)&&0!=t.model.group&&t.node.getPosition().sub(i).mag()<e&&t.hurtBySkill(o.model)}),this.gameView.followCamera.node.parent.getComponent(y.default).shark(60),i},e.prototype.doSkill1=function(t,e){var o=this;void 0===e&&(e=256);var i=[],n=this.checkBlock(t,cc.rect(this.node.x-20,this.node.y-20,40,40)),a=this.checkTargets(t,cc.rect(this.node.x-20,this.node.y-20,40,40));if((i=i.concat(n.map(function(t){return{type:"block",item:t}})).concat(a.map(function(t){return{type:"target",item:t}})).sort(function(t,e){return t.item.node.getPosition().sub(o.node.getPosition()).mag()-e.item.node.getPosition().sub(o.node.getPosition()).mag()})).length>0){try{var r=i[0].item.node,c=cc.rect(r.x-e,r.y-e,2*e,2*e),s=new Map;(r.type==u.ItemType.BOX||r.type==u.ItemType.CN)&&s.set(r.uuid,r),this.gameView.quadTree.retrieve(c).forEach(function(t){!s.has(t.node.uuid)&&(t.type==u.ItemType.BOX||t.type==u.ItemType.CN)&&t.node.getPosition().sub(r.getPosition()).mag()<=e&&s.set(t.node.uuid,t.node)}),Array.from(s.values()).forEach(function(t){if(t){var e=t.getComponent(p.default);e&&e.hurt(o.model)}}),this.gameView.targets.forEach(function(t){t&&t.checkTarget(t)&&t.model.group!=o.model.group&&t.node.getPosition().sub(r.getPosition()).mag()<e&&t.hurtBySkill(o.model)})}catch(l){}return this.gameView.followCamera.node.parent.getComponent(y.default).shark(60),!0}return!1},e.prototype.doSkill2=function(){},e.prototype.doSkill3=function(){var t=this,e=new Map,o=this.node.getPosition(),i=cc.rect(o.x-448,o.y-448,896,448*1.6);this.gameView.quadTree.retrieve(i).forEach(function(t){e.has(t.node.uuid)||t.type!=u.ItemType.BOX&&t.type!=u.ItemType.CN||cc.v2(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/2).sub(o).mag()<448&&e.set(t.node.uuid,t.node)}),Array.from(e.values()).forEach(function(e){if(e){var o=e.getComponent(p.default);o&&o.hurt(t.model)}}),cc.log("=====",t.model.dir),this.gameView.targets.forEach(function(e){e&&e.checkTarget(e)&&e.model.group!=t.model.group&&e.node.getPosition().sub(o).mag()<448&&e.hurtBySkill(t.model)}),this.model.player.isAtking=!1},e.prototype.doSkill4=function(){var t=this;this.model.player.goSkillOffect=this.model.speed,this.model.player.dragon.timeScale=20,this.model.player.isAtking=!0,this.scheduleOnce(function(){t.model.player.isAtking=!1,t.model.player.hero?t.model.player.hero.timeScale=1:t.model.player.heroSke.timeScale=1,t.doDestory()},1)},e.prototype.doSkill5=function(t){var e=this,o=new Map,i=this.node.getPosition();this.gameView.quadTree.retrieve(this.getRectByVec(i,t.mul(384),80)).forEach(function(e){if(!o.has(e.node.uuid)&&e.type==u.ItemType.BOX){var n=cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(i);n.mag()<384&&cc.misc.radiansToDegrees(n.angle(t))<80&&o.set(e.node.uuid,e.node)}}),Array.from(o.values()).forEach(function(t){if(t){var o=t.getComponent(p.default);o&&o.hurt(e.model)}}),this.gameView.targets.forEach(function(o){if(o&&o.checkTarget(o)&&o.model.group!=e.model.group){var n=o.node.getPosition().sub(i);n.mag()<414&&cc.misc.radiansToDegrees(n.angle(t))<90&&o.hurtBySkill(e.model),cc.log("\u5f20\u8001\u5e08\u7167\u76f8\u6280\u80fd",n.mag(),414,"\u89d2\u5ea6",cc.misc.radiansToDegrees(n.angle(t)))}})},e.prototype.doSkill6=function(t,e){var o=this;void 0===e&&(e=384);var i=this.model.player.node.getPosition().add(t.mul(e));cc.log("pos",cc.misc.radiansToDegrees(cc.v2(0,1).angle(t)));var n=cc.misc.radiansToDegrees(cc.v2(0,1).angle(t));i=n<20&&n>=0||n>160?this.model.player.node.getPosition().add(t.mul(e/2)):n<40&&n>=20||n>120?this.model.player.node.getPosition().add(t.mul(2*e/3)):this.model.player.node.getPosition().add(t.mul(e));var a=cc.rect(i.x-e,i.y-128,2*e,e),r=new Map;return this.gameView.quadTree.retrieve(a).forEach(function(t){if(!r.has(t.node.uuid)&&(t.type==u.ItemType.BOX||t.type==u.ItemType.CN)){var e=t.node.getPosition();e.x<a.xMax&&e.x>a.xMin&&e.y<a.yMax&&e.y>a.yMin&&r.set(t.node.uuid,t.node)}}),Array.from(r.values()).forEach(function(t){if(t){var e=t.getComponent(p.default);e&&e.hurt(o.model)}}),this.gameView.targets.forEach(function(t){if(t&&t.checkTarget(t)&&0!=t.model.group&&-1!==t.model.group){var e=t.node.getPosition();e.x<a.xMax&&e.x>a.xMin&&e.y<a.yMax&&e.y>a.yMin&&t.hurtBySkill(o.model)}}),this.gameView.followCamera.node.parent.getComponent(y.default).shark(60),i},e.prototype.doSkill100=function(){var t=this.fortPos(),e=cc.instantiate(this.fortNode);this.fortDrop(e,t.pos,t.gird)},e.prototype.fortDrop=function(t,e,o){var i=this,n=this;t.parent=this.gameView.layout,t.active=!0,t.setPosition(cc.v2(e.x,e.y+5*this.gameView.size)),t.runAction(cc.sequence(cc.moveTo(.2,e),cc.callFunc(function(){h.default.gameAudio.playCombineSkill(i.model.player.combineSkill),i.doSkillBack(),i.gameView.followCamera.node.parent.getComponent(y.default).shark(),t.parent=n.gameView.layout,t.zIndex=2*-o.y})))},e.prototype.fortPos=function(){for(var t=this.gameView.curPlayer.node.getPosition(),e=t.add(cc.v2(this.gameView.mapSizeX/2,this.gameView.mapSizeY/2)).div(this.gameView.size),o=cc.v2(Math.floor(e.x),Math.floor(e.y)),i=(this.gameView.size,[]),n=Math.max(1-o.x,-Math.floor(1.5));n<=Math.floor(1.5);n++){var a=o.x+n;if(a>this.gameView.maxGirdX-2)break;for(var r=Math.max(1-o.y,-Math.floor(1.5));r<=Math.floor(1.5);r++){var c=o.y+r;if(c>this.gameView.maxGirdY-2)break;var s=cc.v2(a,c);i.push(s)}}var l=[];this.gameView.blocks.forEach(function(t){t.gird.x<=o.x+Math.floor(1.5)&&t.gird.x>=o.x-Math.floor(1.5)&&t.gird.y<=o.y+Math.floor(1.5)&&t.gird.y>=o.y-Math.floor(1.5)&&l.push(t.gird)});var d=i.filter(function(t){return!l.some(function(e){return t.equals(e)})}),u=[],p=function(t){var e=d[t].x,o=d[t].y,i=cc.v2(e+1,o);d.some(function(t){return t.equals(i)})&&u.push(d[t])};for(n=0;n<d.length;n++)p(n);0==u.length&&u.push(t);var h=v.choice(u);return{pos:h.mul(this.gameView.size).sub(cc.v2(this.gameView.mapSizeX/2,this.gameView.mapSizeY/2)).add(cc.v2(this.gameView.size/2,this.gameView.size/2)),gird:h}},e.prototype.doSkillBack=function(){var t=this,e=new Map,o=this.node.getPosition(),i=cc.rect(o.x-256,o.y-256,512,384);this.gameView.quadTree.retrieve(i).forEach(function(t){e.has(t.node.uuid)||t.type!=u.ItemType.BOX&&t.type!=u.ItemType.CN||cc.v2(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/2).sub(o).mag()<256&&e.set(t.node.uuid,t.node)}),Array.from(e.values()).forEach(function(e){if(e){var o=e.getComponent(p.default);o&&o.hurt(t.model)}}),this.gameView.targets.forEach(function(t){if(t&&t.checkTarget(t)&&t.model.group>=1e5){var e=t.node.getPosition().sub(o);e.mag()<256&&(t.model.SPE>0&&(t.offect=e.normalize().mul(3e3)),t.moveDir=cc.v2(0,0),t.scheduleOnce(function(){t.doStop(null)},.1))}})},e.prototype.doSkill101=function(t){var e=this,o=new Map,i=this.node.getPosition(),n=cc.rect(i.x-384,i.y-384,768,576);this.gameView.quadTree.retrieve(n).forEach(function(e){if(!o.has(e.node.uuid)&&(e.type==u.ItemType.BOX||e.type==u.ItemType.CN)){var n=cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(i);n.mag()<384&&cc.misc.radiansToDegrees(n.angle(t))<90&&o.set(e.node.uuid,e.node)}}),Array.from(o.values()).forEach(function(t){if(t){var o=t.getComponent(p.default);o&&o.hurt(e.model)}}),this.gameView.targets.forEach(function(o){if(o&&o.checkTarget(o)&&o.model.group>=1e5){var n=o.node.getPosition().sub(i);n.mag()<414&&cc.misc.radiansToDegrees(n.angle(t))<90&&o.hurtBySkill(e.model),cc.log("\u718a\u5927",n.mag(),414,"\u89d2\u5ea6",cc.misc.radiansToDegrees(n.angle(t)),"\u4f4d\u7f6e\uff1a",i.x,i.y)}})},e.prototype.doSkill102=function(){var t=this,e=new Map,o=(this.node.getPosition(),this.node.getBoundingBox());this.gameView.quadTree.retrieve(o).forEach(function(o){if(!e.has(o.node.uuid)&&(o.type==u.ItemType.BOX||o.type==u.ItemType.CN)){var i=t.node.angle/180*Math.PI,n=t.node.x,a=t.node.y,r=t.node.height/2,c=t.node.width*t.node.scaleX,s=cc.v2(n+Math.cos(Math.PI/2+i)*(r/2),a+Math.sin(Math.PI/2+i)*(r/2)),l=cc.v2(n+Math.cos(-Math.PI/2+i)*(r/2),a+Math.sin(-Math.PI/2+i)*(r/2)),d=cc.v2(s.x+Math.cos(i)*c,s.y+Math.sin(i)*c),p=[s,l,cc.v2(l.x+Math.cos(i)*c,l.y+Math.sin(i)*c),d],h=o.node.getBoundingBox(),f=[cc.v2(h.xMin,h.yMin),cc.v2(h.xMax,h.yMin),cc.v2(h.xMax,h.yMax),cc.v2(h.xMin,h.yMax)];cc.Intersection.polygonPolygon(p,f)&&e.set(o.node.uuid,o.node)}}),Array.from(e.values()).forEach(function(e){if(e){var o=e.getComponent(p.default);o&&o.hurt(t.model)}}),this.gameView.targets.forEach(function(e){if(e&&e.checkTarget(e)&&e.model.group!=t.model.group){var o=t.node.angle/180*Math.PI,i=t.node.x,n=t.node.y,a=t.node.height/2,r=t.node.width*t.node.scaleX,c=cc.v2(i+Math.cos(Math.PI/2+o)*(a/2),n+Math.sin(Math.PI/2+o)*(a/2)),s=cc.v2(i+Math.cos(-Math.PI/2+o)*(a/2),n+Math.sin(-Math.PI/2+o)*(a/2)),l=cc.v2(c.x+Math.cos(o)*r,c.y+Math.sin(o)*r),d=[c,s,cc.v2(s.x+Math.cos(o)*r,s.y+Math.sin(o)*r),l],u=e.node.getBoundingBox(),p=[cc.v2(u.xMin,u.yMin),cc.v2(u.xMax,u.yMin),cc.v2(u.xMax,u.yMax),cc.v2(u.xMin,u.yMax)];cc.Intersection.polygonPolygon(d,p)&&e.hurtBySkill(t.model),cc.log("\u6fc0\u5149")}})},e.prototype.doSkill8=function(t){var e=this,o=new Map,i=this.node.getPosition();this.gameView.quadTree.retrieve(this.getRectByVec(i,t.mul(660),70)).forEach(function(e){if(!o.has(e.node.uuid)&&(e.type==u.ItemType.BOX||e.type==u.ItemType.CN)){var n=cc.v2(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2).sub(i);n.mag()<660&&cc.misc.radiansToDegrees(n.angle(t))<60&&o.set(e.node.uuid,e.node),n.mag()<125&&o.set(e.node.uuid,e.node)}}),Array.from(o.values()).forEach(function(t){if(t){var o=t.getComponent(p.default);o&&o.hurt(e.model)}}),this.gameView.targets.forEach(function(o){if(o&&o.checkTarget(o)&&o.model.group!=e.model.group){var n=o.node.getPosition().sub(i);n.mag()<660&&cc.misc.radiansToDegrees(n.angle(t))<60&&o.hurtBySkill(e.model)}})},e.prototype.lineRect=function(t,e,o){var i=t.add(e),n=e.mag(),a=cc.v2((o.x+o.xMax)/2,(o.y+o.yMax)/2);if(Math.abs(a.x-t.x)<=o.width/2+n&&Math.abs(a.y-t.y)<=o.height/2+n&&(Math.abs(a.x-t.x)>o.width/2||Math.abs(a.y-t.y)>o.height/2)){var r=cc.v2(o.x,o.y),c=cc.v2(o.x,o.yMax),s=cc.v2(o.xMax,o.yMax),l=cc.v2(o.xMax,o.y),d=[];return cc.Intersection.lineLine(t,i,r,c)&&d.push({i:0,d:r.sub(t).mag()+c.sub(t).mag()}),cc.Intersection.lineLine(t,i,c,s)&&d.push({i:1,d:c.sub(t).mag()+s.sub(t).mag()}),cc.Intersection.lineLine(t,i,s,l)&&d.push({i:2,d:s.sub(t).mag()+l.sub(t).mag()}),cc.Intersection.lineLine(t,i,l,r)&&d.push({i:3,d:l.sub(t).mag()+r.sub(t).mag()}),d.length>0?(d.sort(function(t,e){return t.d-e.d}),d[0].i):-2}return Math.abs(a.x-t.x)<o.width/2&&Math.abs(a.y-t.y)<o.height/2?-1:-2},e.prototype.findTarget=function(t){if(void 0===t&&(t=this.node.getBoundingBox()),this.model.player){var e=this.model.player;if(e.checkTarget(e)&&e.target&&e.target.node.getPosition().sub(e.node.getPosition()).mag()<e.model.RAN)return this.target=e.target,void(this.model.speed=e.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV));var o=this.gameView.targets.filter(function(t){return t.model.group!=e.model.group&&t.checkTarget(t)}).sort(function(t,o){return t.node.getPosition().sub(e.node.getPosition()).mag()-o.node.getPosition().sub(e.node.getPosition()).mag()});if(o.length>0&&o[0].node.getPosition().sub(e.node.getPosition()).mag()<e.model.RAN)return this.target=o[0],void(this.model.speed=this.target.node.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV));var i=new Map,n=this;this.gameView.quadTree.retrieve(t).forEach(function(t){i.has(t.node.uuid)||n.gameView.nameList.indexOf(t.node.name)>-1||t.type!=u.ItemType.BOX&&t.type!=u.ItemType.CN||i.set(t.node.uuid,t.node)});var a=Array.from(i.values()).sort(function(t,o){return t.getPosition().sub(e.node.getPosition()).mag()-o.getPosition().sub(e.node.getPosition()).mag()});a.length>0&&a[0].getPosition().sub(this.node.getPosition()).mag()<320&&(this.target=a[0],this.model.speed=this.target.getPosition().sub(this.node.getPosition()).normalizeSelf().mul(e.model.MOV))}},e.prototype.updateDir=function(t){(this.isCombineskill||this.model.player.skill!=g.HeroSkillType.Hammer&&this.model.player.skill!=g.HeroSkillType.Hair&&this.model.player.skill!=g.HeroSkillType.Fire)&&(0==t.x?t.y>0?this.node.angle=-90*this.gameView.curPlayer.dragon.node.scaleX/this.gameView.curPlayer.dragon.node.scaleY:t.y<0?this.node.angle=90*this.gameView.curPlayer.dragon.node.scaleX/this.gameView.curPlayer.dragon.node.scaleY:this.node.angle=0:this.node.angle=-(-90+cc.misc.radiansToDegrees(Math.atan2(t.x,t.y))))},e.prototype.update=function(t){if(this.gameView&&this.model.player&&!this.isDestory){if(this.model.player.model.isDead())return this.doDestory();if(this.isCombineskill)switch(this.model.player.combineSkill){case g.HeroSkillType.Light:}else switch(this.model.player.skill){case g.HeroSkillType.Hair:case g.HeroSkillType.Hammer:case g.HeroSkillType.Fire:break;case g.HeroSkillType.Carrot:this.model.player.isAtking=!1,this.model.speed.mulSelf(1.01),this.doSkill1(t)?this.doDestory():this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t)));break;case g.HeroSkillType.Shears:this.check(t),this.node.setPosition(this.node.getPosition().add(this.model.speed.mul(t))),this.flyLenght+=this.model.speed.mul(t).mag();break;case g.HeroSkillType.Go:this.check(t),this.node.setPosition(this.model.player.node.getPosition().add(cc.v2(0,50)))}}},e.prototype.hintBlock=function(t){switch(t.type){case u.ItemType.MOUNTAIN:return!1;case u.ItemType.BLOCK:case u.ItemType.BOX:case u.ItemType.CN:if(t.type==u.ItemType.BOX||t.type==u.ItemType.CN){var e=t.node.getComponent(p.default);if(e&&!e.hurt(this.model))return!0}}return!1},e.prototype.hintTarget=function(t){var e=t.getComponent(d.default);return!(!e||!e.checkTarget(e)||(e.hurtBySkill(this.model),this.isCombineskill||this.model.player.skill==g.HeroSkillType.Shears||this.model.player.skill==g.HeroSkillType.Go))},e.prototype.getRectByVec=function(t,e,o){var i,n,a,r,c,s,l;return o>0?(s=t.add(e.rotate(cc.misc.degreesToRadians(o))),l=t.add(e.rotate(cc.misc.degreesToRadians(-o))),i=t.add(e),c=Math.min(t.x,s.x,l.x,i.x),n=Math.min(t.y,s.y,l.y,i.y),c==(a=Math.max(t.x,s.x,l.x,i.x))&&(a+=1),n==(r=Math.max(t.y,s.y,l.y,i.y))&&(r+=1),cc.rect(c,n,a-c,r-n)):(i=t.add(e),c=Math.min(t.x,i.x),n=Math.min(t.y,i.y),c==(a=Math.max(t.x,i.x))&&(a+=1),n==(r=Math.max(t.y,i.y))&&(r+=1),cc.rect(c,n,a-c,r-n))},a([s([dragonBones.ArmatureDisplay])],e.prototype,"skill",void 0),a([s({tooltip:"\u5408\u4f53\u6280\u80fd\uff0c\u6309\u5e8f\u53f7\u53d6\uff0c\u7a7a\u4e3a\u8be5\u5408\u4f53\u82f1\u96c4\u6280\u80fd\u975e\u52a8\u753b",type:[dragonBones.ArmatureDisplay]})],e.prototype,"combineskill",void 0),a([s({tooltip:"\u6280\u80fd\u4f24\u5bb3\u52a8\u753b\uff0c\u6309\u5e8f\u53f7\u53d6\uff0c\u7a7a\u4e3a\u8be5\u82f1\u96c4\u6280\u80fd\u65e0\u53d7\u51fb\u6548\u679c",type:[dragonBones.ArmatureDisplay]})],e.prototype,"hurtSkill",void 0),a([s(cc.Node)],e.prototype,"skillNode",void 0),a([s(cc.Prefab)],e.prototype,"fortNode",void 0),a([c],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../MainScene/Script/center/Game":"Game","../../../../Script/base/Utils":void 0,"../../BasePlayer":"BasePlayer","../../FollowCamare":"FollowCamare","../../manage/GameManage":"GameManage","../../test/EditView":"EditView","../model/SkillModel":"SkillModel","./GameBlock":"GameBlock"}],SkinView:[function(t,e){"use strict";cc._RF.push(e,"64f3c/vjKJFCojaeyu/ykfx","SkinView"),cc._RF.pop()},{}],SpacialGameView:[function(t,e,o){"use strict";cc._RF.push(e,"d9defbbpS5LmrOFXRqWTyb8","SpacialGameView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../manage/GameManage"),c=t("../../../BasePlayer"),s=t("../../../Player"),l=t("../../../public/AStar"),d=t("../../../public/QuadTree"),u=t("../../../test/EditView"),p=t(".././AI"),h=t("../GameBlock"),f=t("../../../../../MainScene/Script/center/Game"),m=t("../../../../../InitScene/Script/data/GameData"),y=t("../../../../../InitScene/Script/data/OtherData"),g=t("../Account/AccountAwardNode"),v=t("../GameView/GameView"),_=cc._decorator,S=_.ccclass,b=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=null,e}return n(e,t),e.prototype.onLoad=function(){r.default.getInstance().gameView=this},e.prototype.start=function(){f.default.gameAudio.playGameBGMusic(),f.default.event.on(m.GameDataEvent.GAME_ACCOUNT,this.showAcc,this),this.boxShadowNode.active=!1;var t=r.default.getInstance().maptype;this.map.getComponent(cc.Sprite).spriteFrame=this.mapSF[t];var e=f.default.sceneCenter.getCustomData();e&&e.matchInfo.isSpacial&&(this.data=e.matchInfo.map_data);var o=cc.instantiate(this.mapPrefab[this.data.id]);o.parent=this.map,o.zIndex=-1,this.layout=o,this.player.parent=this.layout,this.init(null),cc.log("=====MapItemInfo======",this.data)},e.prototype.init=function(){var t=this,e=this;this.quadTree=new d.default(this.map.getBoundingBox()),this.nameList=["box","shu_gan","shu2","xian_ren_zhang","luo_xue_de_shu","tree","pool_water","pool_up","pool_down","pool_left","pool_right","pool_right_up","pool_right_down","pool_left_up","pool_left_down","shi_bei","shi_tou_die","pu_tong_shi_tou","shi_tou_gu","dai_gu_ci_shi_tou","zhang_peng","map_left_down","map_right_down","map_left_up","map_right_up","map_down","map_up","map_left","map_right","map","mountain_1","mountain_2","mountain_3","mountain_4","shi_tou1","shi_tou2","bing_wu1","bing_wu2","pen_quan","rongyanjianci"],this.layout.children.forEach(function(o){if(t.nameList.indexOf(o.name)>=0){var i=o.getComponent(h.default),n=o.getPosition().add(cc.v2(t.map.width/2,t.map.height/2)).div(t.size);i.gird=cc.v2(Math.floor(n.x),Math.floor(n.y)),o.setPosition(i.gird.add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.map.width/2,t.map.height/2).add(cc.v2(t.size/2,t.size/2)))),i.type!=u.ItemType.WATER?(o.zIndex=2*-i.gird.y,o.name.indexOf("map")>=0&&(o.zIndex=10*-i.gird.y)):o.zIndex=2*-Math.floor(t.map.height/t.size),e.blocks.push(i),i.init()}else"grass1"==o.name||"grass2"==o.name||"guang"==o.name?o.zIndex=2*-Math.floor(t.map.height/t.size)+1:"addHpLogo"==o.name?o.zIndex=1:"addHpCircle"==o.name&&(n=o.getPosition().add(cc.v2(t.map.width/2,t.map.height/2)).div(t.size),o.setPosition(cc.v2(Math.floor(n.x),Math.floor(n.y)).add(cc.v2(1,1)).mul(t.size).sub(cc.v2(t.map.width/2,t.map.height/2).add(cc.v2(t.size/2,t.size/2)))),o.zIndex=o.zIndex=2*-Math.floor(t.map.height/t.size)-10)}),this.astar||(this.astar=new l.default),this.astar.init(this.size,this.size,Math.floor(this.map.width/this.size)-1,Math.floor(this.map.height/this.size)-1),this.astar.initMap(),this.astar.resetMap(),this.blocks.forEach(function(t){t.type!=u.ItemType.BLOCK&&t.type!=u.ItemType.WATER&&t.type!=u.ItemType.SHADOW&&t.type!=u.ItemType.MOUNTAIN||0!=e.astar.gridsList[t.gird.x][t.gird.y].type||(e.astar.gridsList[t.gird.x][t.gird.y].type=-1)}),this.doStart(),this.schedule(this.airDrop,y.default.airDropTime)},e.prototype.doStart=function(){this.initEnemy(),this.targets=this.layout.getComponentsInChildren(c.default),this.players=this.layout.getComponentsInChildren(s.default),this.curPlayer=this.players[0],r.default.getInstance().model.players=this.players.map(function(t){return t.model}),this.players.forEach(function(t){return t.init()}),console.log("=======\u731c\u6d4b\uff1a\u73a9\u5bb6=======GameManage.getInstance().model.players",r.default.getInstance().model.players),this.tipsView.gameView=this,this.tipsView.node.active=!0,this.tipsView.startGame()},e.prototype.startGame=function(){var t=this;this.attackView.node.active=!0,this.timeView.node.active=!0,this.timeView.init(120),this.timeView.startTimer(),this.timeView.node.on("finished",function(){t.doEnd(),r.default.getInstance().endGame()},this),this.data.isHide?this.mapView.node.active=!1:(this.mapView.node.active=!0,this.mapView.init(Math.max(this.map.width,this.map.height))),this.shadow.active=!1,this.enemys.forEach(function(t){return t.isStart=!0})},e.prototype.endGame=function(){this.isAccount||(this.isAccount=!0,this.attackView.stopAttack(),this.timeView.pauseTimer(),this.shadow.active=!0,this.tipsView.node.active=!0,this.tipsView.endGame(),this.unschedule(this.airDrop),r.default.getInstance().endGame())},e.prototype.getGird=function(t){void 0===t&&(t=-1),cc.log("==========SpacialGameVidw============");var e=cc.v2(0,0);if(t>=0){var o=this.data.AIConfig[t];e=cc.v2(o.posX,o.posY)}else e=cc.v2(this.data.posX,this.data.posY);return e},e.prototype.initEnemy=function(){for(var t=this.data.AIConfig,e=t.length,o=null,i=0,n=0,a=0,r=!1,c=0;c<e;c++){var s=t[c];n=s.hero,a=0,i=-1,r=s.isAttack;var l=(o=cc.instantiate(this.aiPrefab)).getComponent(p.default);l.initAI(c,.1,n,a,i,0,r),o.parent=this.layout,this.enemys.push(l)}},e.prototype.showAcc=function(t){var e;cc.log("player",t),e=0==t.rank,f.default.uiCenter.showUi(this.accountPrefab).getComponent(g.default).init(e)},e.prototype.update=function(){var t=this.players.filter(function(t){return t&&t.node.active&&t.model&&!t.model.isDead()});this.updateMap(t)},a([S],e)}(v.default));o.default=b,cc._RF.pop()},{"../../../../../InitScene/Script/data/GameData":void 0,"../../../../../InitScene/Script/data/OtherData":void 0,"../../../../../MainScene/Script/center/Game":"Game","../../../BasePlayer":"BasePlayer","../../../Player":"Player","../../../manage/GameManage":"GameManage","../../../public/AStar":"AStar","../../../public/QuadTree":"QuadTree","../../../test/EditView":"EditView",".././AI":"AI","../Account/AccountAwardNode":"AccountAwardNode","../GameBlock":"GameBlock","../GameView/GameView":"GameView"}],TableItem:[function(t,e,o){"use strict";cc._RF.push(e,"f2403nH3apMyIcoF5HerzUs","TableItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.numSprite=null,e.tableData=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t){this.tableData=t,"gun"==t.type||this.setIcon("mainSceneRes/turnTable/"+t.num,this.numSprite)},e.prototype.setIcon=function(t,e){r.default.addLoaderSprite(e).loadSprite(t,cc.SpriteFrame)},a([l(cc.Sprite)],e.prototype,"iconSprite",void 0),a([l(cc.Sprite)],e.prototype,"numSprite",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../framework/Script/component/LoaderSprite":void 0}],Text51hengfu:[function(t,e,o){"use strict";cc._RF.push(e,"b9cd1dwhAJDQ5P99Qik8AfM","Text51hengfu");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GameData"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hengfuNode=null,e.hengfuSF=[],e}return n(e,t),e.prototype.start=function(){c.default.event.on(r.GameDataEvent.AWARD_RAIN,this.show,this),c.default.event.on(r.GameDataEvent.AWARD_RAIN_OVER,this.hide,this)},e.prototype.show=function(t){this.hengfuNode.getComponent(cc.Sprite).spriteFrame=this.hengfuSF[t],this.node.zIndex=cc.macro.MAX_ZINDEX+1,this.hengfuNode.scaleX=0,this.hengfuNode.runAction(cc.sequence(cc.scaleTo(.3,1),cc.scaleTo(.3,1.3),cc.scaleTo(.1,1)))},e.prototype.hide=function(){this.hengfuNode.runAction(cc.scaleTo(.1,0,1))},a([d(cc.Node)],e.prototype,"hengfuNode",void 0),a([d([cc.SpriteFrame])],e.prototype,"hengfuSF",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../center/Game":"Game"}],TimeView:[function(t,e,o){"use strict";cc._RF.push(e,"a91e0QttzlGpZAdsoZF0J3M","TimeView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../MainScene/Script/center/Game"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.skeleton=null,e.type=1,e.num=0,e.total=180,e.isPause=!1,e}return n(e,t),e.prototype.start=function(){this.skeleton&&(this.skeleton.timeScale=1.425)},e.prototype.init=function(t){void 0===t&&(t=180),this.skeleton&&this.skeleton.setAnimation(0,"animation",!0),this.endTimer(),this.num=t,this.total=this.num,this.label.node.color=cc.Color.WHITE,this.refresh()},e.prototype.sub=function(t){this.num>t?this.num-=20:(this.num=0,this.endTimer()),this.refresh()},e.prototype.startTimer=function(){this.endTimer(),this.skeleton&&(this.skeleton.paused=!1),this.doTimer(),this.schedule(this.doTimer,1,this.num-1)},e.prototype.doTimer=function(){this.isPause||(this.num>0&&this.num--,this.refresh())},e.prototype.endTimer=function(){this.skeleton&&(this.skeleton.paused=!0),this.label.node.stopAllActions(),this.label.node.scale=1,this.unschedule(this.doTimer)},e.prototype.pauseTimer=function(){this.unschedule(this.playTimeAudio),this.isPause=!0,this.skeleton&&(this.skeleton.paused=!0)},e.prototype.resumeTimer=function(){this.num<=30&&this.schedule(this.playTimeAudio,1),this.isPause=!1,this.skeleton&&(this.skeleton.paused=!1)},e.prototype.refresh=function(){this.label.string=this.parseTime(this.num),0===this.num?(this.node.emit("finished"),this.endTimer()):10!==this.num&&30===this.num&&(this.schedule(this.playTimeAudio,1),this.label.node.color=cc.Color.RED,this.label.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.2,1.1),cc.scaleTo(.2,1),cc.delayTime(.6)))))},e.prototype.playTimeAudio=function(){r.default.gameAudio.playGameOverTimeClip()},e.prototype.parseTime=function(t){var e="";if(1===this.type)e+=(o=Math.floor(t/60))<10?"0"+o:o,e+=":";else if(2===this.type){var o,i=Math.floor(t/3600);e+=i<10?"0"+i:i,e+=":",e+=(o=Math.floor(t%3600/60))<10?"0"+o:o,e+=":"}var n=t%60;return e+(n<10?"0"+n:n)},a([l(cc.Label)],e.prototype,"label",void 0),a([l(sp.Skeleton)],e.prototype,"skeleton",void 0),a([l],e.prototype,"type",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../../MainScene/Script/center/Game":"Game"}],TipsView:[function(t,e,o){"use strict";cc._RF.push(e,"1b27a0BC6VEJI+npatq88r9","TipsView");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../MainScene/Script/center/Game"),c=t("../../manage/GameManage"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startSkeleton=null,e.endSkeleton=null,e.bg=null,e.nextSkeleton=null,e.bossWarnNode=null,e.gameView=null,e}return n(e,t),e.prototype.start=function(){this.bg.active=!1},e.prototype.startGame=function(){var t=this;this.endSkeleton.node.active=!1,this.startSkeleton.node.active=!0,this.startSkeleton.setAnimation(0,"animation",!1),this.startSkeleton.setEventListener(function(){r.default.gameAudio.playFillBulletClip()}),r.default.gameAudio.playReadyClip(),this.startSkeleton.setCompleteListener(function(){t.startSkeleton.setCompleteListener(null),t.startSkeleton.setAnimation(0,"animation2",!1),t.startSkeleton.setCompleteListener(function(){t.startSkeleton.setCompleteListener(null),t.startSkeleton.node.active=!1,t.node.active=!1,c.default.getInstance().startGame()})})},e.prototype.endGame=function(){console.log("TipsView..."),0==this.gameView.curPlayer.model.rank?r.default.gameAudio.playWinClip():r.default.gameAudio.playLoseClip();var t=this;this.startSkeleton.node.active=!1,this.endSkeleton.node.active=!0,this.endSkeleton.setCompleteListener(function(){t.endSkeleton.setCompleteListener(function(){t.endSkeleton.setCompleteListener(null),t.endSkeleton.node.active=!1,t.node.active=!1,cc.log("EndGame==================="),c.default.getInstance().accountGame()}),t.endSkeleton.setAnimation(0,"animation2",!1)}),this.endSkeleton.setAnimation(0,"animation",!1)},e.prototype.nextLevel=function(t){var e=this;this.node.active=!0,this.nextSkeleton.node.active=!0,this.nextSkeleton.setCompleteListener(function(){e.bg.active=!0,e.bg.opacity=0,e.bg.runAction(cc.sequence(cc.delayTime(.5),cc.fadeIn(.5),cc.delayTime(.5),cc.fadeOut(.5),cc.callFunc(function(){e.bg.active=!1,t&&t(),e.node.active=!1}))),e.nextSkeleton.setCompleteListener(function(){e.nextSkeleton.setCompleteListener(null),e.nextSkeleton.node.active=!1}),e.nextSkeleton.setAnimation(0,"animation2",!1)}),this.nextSkeleton.setAnimation(0,"animation",!1)},e.prototype.bossWarn=function(t){var e=this;this.bossWarnNode.active=!0,this.bossWarnNode.opacity=0,r.default.gameAudio.playWarningClip(),this.bossWarnNode.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(.6),cc.fadeOut(.2),cc.fadeIn(.1),cc.delayTime(.8),cc.fadeOut(.1),cc.callFunc(function(){t&&t(),e.bossWarnNode.active=!1,e.node.active=!1})))},a([d(sp.Skeleton)],e.prototype,"startSkeleton",void 0),a([d(sp.Skeleton)],e.prototype,"endSkeleton",void 0),a([d(cc.Node)],e.prototype,"bg",void 0),a([d(sp.Skeleton)],e.prototype,"nextSkeleton",void 0),a([d(cc.Node)],e.prototype,"bossWarnNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../MainScene/Script/center/Game":"Game","../../manage/GameManage":"GameManage"}],TreeItemNode:[function(t,e,o){"use strict";cc._RF.push(e,"eb9e0qXqYBKQajbzBIFgoiG","TreeItemNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/TreeModel"),c=t("../../GameScene/manage/GameManage"),s=t("../../Script/center/Game"),l=cc._decorator,d=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.farmNode=null,e.parentNode=null,e.pos=null,e.scale=null,e.fruitData=null,e.id=0,e}return n(e,t),e.prototype.setData=function(t){this.fruitData=t,cc.log("fruitData",this.fruitData),this.id=this.fruitData.id,this.onTreeFruit()},e.prototype.start=function(){this.farmNode=c.default.getInstance().farmView,this.parentNode=this.node.parent,this.pos=this.node.getPosition(),this.scale=this.node.scale},e.prototype.setIsMove=function(){this.node.destroy()},e.prototype.resumeItem=function(){this.node.parent=this.parentNode,this.node.scale=this.scale,this.node.runAction(cc.moveTo(.3,this.pos))},e.prototype.eat=function(){var t=this;this.node.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){t.resumeItem(),t.node.active=!1,t.fruitData.fruitCount--,t.offTreeFruit(),0==t.fruitData.fruitCount&&t.node.emit(r.TreeEventType.EAT_ALL_FRUIT)},this)))},e.prototype.onTreeFruit=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStartFruit,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveFruit,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEndFruit,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndFruit,this)},e.prototype.offTreeFruit=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.touchStartFruit,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveFruit,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEndFruit,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEndFruit,this)},e.prototype.touchStartFruit=function(t){var e=cc.v2(t.getLocation());this.node.parent=this.farmNode.node,this.node.setPosition(this.farmNode.node.convertToNodeSpaceAR(e))},e.prototype.touchMoveFruit=function(t){if(this.node.active&&this.fruitData){var e=t.getLocation();this.node.setPosition(this.farmNode.node.convertToNodeSpaceAR(e))}},e.prototype.touchEndFruit=function(t){if(this.node.active){var e=cc.v2(t.getLocation()),o=this.farmNode.players.filter(function(t){var o=t.node.getBoundingBoxToWorld();return e.x>o.x&&e.x<o.x+o.width&&e.y>o.y&&e.y<o.y+o.height});o.length>0?(o.sort(function(t,e){return-(t.node.zIndex-e.node.zIndex)}),this.fruitData.exp,o[0].onEat(this.fruitData.exp),this.eat(),s.default.showToast("\u5582\u517b\u6210\u529f")):this.resumeItem()}},a([d],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../../../InitScene/Script/data/TreeModel":void 0,"../../GameScene/manage/GameManage":"GameManage","../../Script/center/Game":"Game"}],TreeNode:[function(t,e,o){"use strict";cc._RF.push(e,"201cdM2iiRKm7zbncNXJrJ3","TreeNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderSprite"),c=t("../../../InitScene/Script/data/TreeModel"),s=t("../../Script/center/Game"),l=t("./TreeItemNode"),d=cc._decorator,u=d.ccclass,p=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timelabel=null,e.progressBar=null,e.pointNode=null,e.treeSprite=null,e.treeSF=[],e.fruitSprite=[],e.treeData=null,e.beginTime=0,e.needTime=0,e}return n(e,t),e.prototype.start=function(){var t=c.default.nowSeed;cc.log("id",t),-1==t?this.treeSprite.node.active=!1:(this.treeSprite.node.active=!0,this.treeData=c.default.getByID(t),this.needTime=this.treeData.time,this.beginTime=c.default.time,this.init()),this.hidePoint(),s.default.event.on(c.TreeEventType.SHOW_POINT,this.showPoint,this),s.default.event.on(c.TreeEventType.HIDE_POINT,this.hidePoint,this)},e.prototype.showPoint=function(){c.default.nowSeed>-1||(this.pointNode.active=!0)},e.prototype.hidePoint=function(){this.pointNode.active=!1},e.prototype.setTreeTime=function(){var t=(new Date).getTime()-this.beginTime,e=Math.ceil(this.needTime-t);if(e<0)return this.finish(),void this.unschedule(this.setTreeTime);this.timelabel.string=this.timeFtt(e),this.progressBar.progress=1-e/this.needTime},e.prototype.timeFtt=function(t){var e=Math.floor(t/1e3/60/60),o=e>9?e:"0"+e,i=Math.floor(t/1e3/60)-60*e,n=i>9?i:"0"+i,a=Math.floor(t/1e3)-60*i-3600*e;return o+":"+n+":"+(a>9?a:"0"+a)},e.prototype.reset=function(){c.default.nowSeed=-1,this.treeSprite.node.active=!1},e.prototype.init=function(){this.treeSprite.node.active=!0,this.hidePoint(),this.progressBar.node.active=!0,this.fruitSprite[0].node.parent.active=!1,this.treeSprite.spriteFrame=this.treeSF[0],this.treeData=c.default.getByID(c.default.nowSeed),this.needTime=this.treeData.time,this.beginTime=c.default.time,this.schedule(this.setTreeTime,1),this.setTreeTime()},e.prototype.finish=function(){c.default.time=0,this.progressBar.node.active=!1,this.treeSprite.spriteFrame=this.treeSF[1],this.fruitSprite[0].node.parent.active=!0;for(var t=this.treeData.fruitCount=this.treeData.fruitCount||this.treeData.num,e=this.fruitSprite.length,o=0;o<e;o++)if(o<t){var i="farm/fruit/"+this.treeData.id;r.default.addLoaderSprite(this.fruitSprite[o]).loadSprite(i),this.fruitSprite[o].node.active=!0,this.fruitSprite[o].node.getComponent(l.default).setData(this.treeData),this.fruitSprite[o].node.on(c.TreeEventType.EAT_ALL_FRUIT,this.reset,this)}else this.fruitSprite[o].node.active=!1},a([p(cc.Label)],e.prototype,"timelabel",void 0),a([p(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([p(cc.Node)],e.prototype,"pointNode",void 0),a([p(cc.Sprite)],e.prototype,"treeSprite",void 0),a([p([cc.SpriteFrame])],e.prototype,"treeSF",void 0),a([p([cc.Sprite])],e.prototype,"fruitSprite",void 0),a([u],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../../InitScene/Script/data/TreeModel":void 0,"../../../framework/Script/component/LoaderSprite":void 0,"../../Script/center/Game":"Game","./TreeItemNode":"TreeItemNode"}],TryItem:[function(t,e,o){"use strict";cc._RF.push(e,"58e82YkrLJIo63hc6sPcciH","TryItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../../../InitScene/Script/data/MountModel"),d=t("../../../../InitScene/Script/data/PersonModel"),u=t("../../../../Script/base/Utils"),p=t("../../center/Game"),h=t("./TryMoreNode"),f=cc._decorator,m=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iconSprite=null,e.tryBtn=null,e.startBtn=null,e.tryBtn1=null,e.startBtn1=null,e.btnList=null,e.btnList1=null,e.lightNode=null,e.gunId=0,e.callback=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t,e,o){this.callback=o,this.gunId=t;var i=s.default.getGunDataById(t).isUnlock;e?(this.btnList.active=!1,this.btnList1.active=!0,this.tryBtn1.active=!i,this.startBtn1.active=i):(this.btnList.active=!0,this.btnList1.active=!1,this.tryBtn.active=!i,this.startBtn.active=i);var n="gun/icon/"+t;this.setIcon(n)},e.prototype.setIcon=function(t){var e=this;this.scheduleOnce(function(){r.default.addLoaderSprite(e.iconSprite).loadSprite(t,cc.SpriteFrame)},.1)},e.prototype.onStartGame=function(){var t=d.default.getNotUnlockRandomId()>=0,e=l.default.getNotUnlockRandomId()>=0;if(t&&e){var o=u.random(0,100),i=o<50?"hero":"mount";cc.log("\u8bd5\u7528",o,i),this.showTryMore(i)}else t&&t&&this.showTryMore("hero"),e&&this.showTryMore("mount"),!t&&!e&&this.callback();p.default.uiCenter.closeUI("TryNode")},e.prototype.showTryMore=function(t){p.default.uiCenter.showUi("TryMoreNode").getComponent(h.default).setData(t,this.callback)},e.prototype.onTry=function(t){t.target.getComponent(c.default).onClick(t)},e.prototype.gunTrySuccess=function(){s.default.tryGunId=this.gunId,this.onStartGame()},a([y(cc.Sprite)],e.prototype,"iconSprite",void 0),a([y(cc.Node)],e.prototype,"tryBtn",void 0),a([y(cc.Node)],e.prototype,"startBtn",void 0),a([y(cc.Node)],e.prototype,"tryBtn1",void 0),a([y(cc.Node)],e.prototype,"startBtn1",void 0),a([y(cc.Node)],e.prototype,"btnList",void 0),a([y(cc.Node)],e.prototype,"btnList1",void 0),a([y(cc.Node)],e.prototype,"lightNode",void 0),a([m],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../Script/base/Utils":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","./TryMoreNode":"TryMoreNode"}],TryMoreNode:[function(t,e,o){"use strict";cc._RF.push(e,"80de0afz4tCPLhSY01ELC1f","TryMoreNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../framework/Script/component/LoaderSprite"),s=t("../../../../framework/Script/prefab/AwardButton"),l=t("../../../../InitScene/Script/data/GameData"),d=t("../../../../InitScene/Script/data/GuanqiaModel"),u=t("../../../../InitScene/Script/data/GunModel"),p=t("../../../../InitScene/Script/data/MountModel"),h=t("../../../../InitScene/Script/data/OtherData"),f=t("../../../../InitScene/Script/data/PersonModel"),m=t("../../../../Script/base/Utils"),y=t("../../center/Game"),g=t("../prefabs/getGun/GetGun"),v=t("../prefabs/view/GunView"),_=cc._decorator,S=_.ccclass,b=_.property,w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleSprite=null,e.titleSpriteFrame=[],e.descSprite=null,e.descSpriteFrame=[],e.gunNode=null,e.gunSprite=null,e.skeNode=null,e.skeMountNode=null,e.gainBtn=null,e.tryBtn=null,e.numLabel=null,e.btnList0Node=null,e.btnList1Node=null,e.type="",e.videoCount=0,e.id=0,e.heroID=0,e.mountID=0,e.callback=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setData=function(t,e,o){switch(void 0===o&&(o=null),this.callback=e,this.type=t,this.skeNode.scale=1,this.videoCount=h.default.otherData.seniorGunVideoTime,"gun"==t?(this.btnList0Node.active=!0,this.btnList1Node.active=!1):d.default.guanqiaData.id<4?(this.btnList0Node.active=!0,this.btnList1Node.active=!1):Math.random()<.5?(this.btnList0Node.active=!0,this.btnList1Node.active=!1):(this.btnList0Node.active=!1,this.btnList1Node.active=!0),t){case"gun":this.id=Math.max(Math.min(u.default.getGunMaxLevel(!1),u.default.getGunMaxLevel()-m.choice([2,3,4])),0);var i="gun/"+this.id;this.setGun(i),this.titleSprite.spriteFrame=null,this.descSprite.spriteFrame=this.descSpriteFrame[0],this.gainBtn.active=!0,this.setLabel();break;case"hero":this.skeNode.setPosition(new cc.Vec2(-115.391,20)),this.id=f.default.getNotUnlockRandomId();var n=f.default.getHeroDataById(this.id);this.setSke("hero/dragon/"+n.skeUrl,"\u5f85\u673a","armatureName",!0),this.skeNode.scale=1,this.titleSprite.spriteFrame=this.titleSpriteFrame[0],this.descSprite.spriteFrame=this.descSpriteFrame[1],this.tryBtn.active=!0;break;case"mount":this.skeNode.scaleX=-1,this.skeNode.x=-143.279,this.id=null!=o?o:p.default.getNotUnlockRandomId(),this.setSke(p.default.getMountSkeUrl(this.id,p.MountMaxLevel-1),"\u5f85\u673a","Armature",!1),this.titleSprite.spriteFrame=this.titleSpriteFrame[1],this.descSprite.spriteFrame=this.descSpriteFrame[2],this.tryBtn.active=!0}},e.prototype.setTryHeroMount=function(t,e,o,i){void 0===i&&(i=null),this.heroID=t,this.mountID=e,this.callback=o,this.videoCount=h.default.otherData.seniorGunVideoTime,d.default.guanqiaData.id<4?(this.btnList0Node.active=!0,this.btnList1Node.active=!1):Math.random()<.5?(this.btnList0Node.active=!0,this.btnList1Node.active=!1):(this.btnList0Node.active=!1,this.btnList1Node.active=!0),this.skeNode.y=20;var n=f.default.getHeroDataById(t);this.setSke("hero/dragon/"+n.skeUrl,"\u5f85\u673a","armatureName",!0),this.setSkeMount(p.default.getMountSkeUrl(e,p.MountMaxLevel-1),"\u5f85\u673a","Armature",!1),this.titleSprite.spriteFrame=this.titleSpriteFrame[0],this.descSprite.spriteFrame=this.descSpriteFrame[1],this.tryBtn.active=!0},e.prototype.setGun=function(t){var e=this;this.gunSprite.node.active=!0,this.scheduleOnce(function(){c.default.addLoaderSprite(e.gunSprite).loadSprite(t,cc.SpriteFrame)},.1),this.gunNode.active=!0},e.prototype.setSke=function(t,e,o,i){var n=this;void 0===o&&(o="armatureName");var a=this;this.skeNode.active=!0;var c=this.skeNode.addComponent(sp.Skeleton);this.skeNode.addComponent(r.default).loadAsset(t,sp.SkeletonData,function(t,e){if(n.skeNode.isValid){if(c.skeletonData=e,i){var o=c.attachUtil;o.generateAllAttachedNodes();var s=o.getAttachedNodes("qiangguadian")[0];s&&r.default.addLoadingAssetNode(a.skeNode).loadAsset("gun/prefabs/normal/"+(u.default.tryGunId>-1?u.default.tryGunId:u.default.useGunId),cc.Prefab,function(t,e){var o=cc.instantiate(e);o.getComponent(v.default).init(!0,!0),o.setPosition(s.getPosition()),o.parent=s}),a.skeNode.scale=.85,a.skeNode.y-=40,a.skeNode.x-=20}c.animation="daiji"}})},e.prototype.setSkeMount=function(t,e,o){var i=this;void 0===o&&(o="armatureName"),this.skeMountNode.active=!0;var n=this.skeMountNode.addComponent(sp.Skeleton);this.skeMountNode.addComponent(r.default).loadAsset(t,sp.SkeletonData,function(t,e){i.skeMountNode.isValid&&(n.skeletonData=e,n.animation="daiji")})},e.prototype.setLabel=function(){this.numLabel.string="("+this.videoCount+"/"+h.default.seniorGunVideo+")",h.default.seniorGunVideo<2&&(this.numLabel.string="")},e.prototype.onClick=function(t){t.target.getComponent(s.default).onClick(t)},e.prototype.trySuccess=function(){switch(this.type){case"hero":f.default.tryHeroId=this.id;break;case"mount":p.default.tryMountId=this.id,p.default.tryMountLevel=p.MountMaxLevel-1}this.close(!0)},e.prototype.close=function(t){"gun"!=this.type&&this.callback&&this.callback(t),y.default.uiCenter.closeUI(this.node)},e.prototype.onClose=function(){this.close(!1)},e.prototype.gainSuccess=function(){if(h.default.otherData.seniorGunVideoTime++,this.videoCount=h.default.otherData.seniorGunVideoTime,this.setLabel(),this.videoCount>=h.default.seniorGunVideo){u.default.onUnlockGun(this.id),u.default.useGunId=this.id;var t=y.default.mainUI;y.default.uiCenter.showUi("getGun").getComponent(g.default).setData(this.id,!0);var e=t.boxs.filter(function(t){return null==t.item&&null==t.equip});if(e.length>0)t.appendItem(this.id,e[0]),t.updateMatrix();else{var o=u.default.getSale(this.id);l.default.totalCoinNum+=o,y.default.showCurrency(o)}t.updateMatrix(),h.default.otherData.seniorGunVideoTime=0,y.default.uiCenter.closeUI(this.node)}},a([b(cc.Sprite)],e.prototype,"titleSprite",void 0),a([b(cc.SpriteFrame)],e.prototype,"titleSpriteFrame",void 0),a([b(cc.Sprite)],e.prototype,"descSprite",void 0),a([b(cc.SpriteFrame)],e.prototype,"descSpriteFrame",void 0),a([b(cc.Node)],e.prototype,"gunNode",void 0),a([b(cc.Sprite)],e.prototype,"gunSprite",void 0),a([b(cc.Node)],e.prototype,"skeNode",void 0),a([b(cc.Node)],e.prototype,"skeMountNode",void 0),a([b(cc.Node)],e.prototype,"gainBtn",void 0),a([b(cc.Node)],e.prototype,"tryBtn",void 0),a([b(cc.Label)],e.prototype,"numLabel",void 0),a([b(cc.Node)],e.prototype,"btnList0Node",void 0),a([b(cc.Node)],e.prototype,"btnList1Node",void 0),a([S],e)}(cc.Component);o.default=w,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GuanqiaModel":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/OtherData":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../Script/base/Utils":void 0,"../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../prefabs/getGun/GetGun":"GetGun","../prefabs/view/GunView":"GunView"}],TryNode:[function(t,e,o){"use strict";cc._RF.push(e,"1d97eSgilxMroS8CvI0tkJh","TryNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GunModel"),c=t("./TryItem"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentNode=null,e.tryItem=null,e}return n(e,t),e.prototype.start=function(){},e.prototype.setTryList=function(t){for(var e=r.default.getGunTryList(),o=0;o<e.length;o++){var i=cc.instantiate(this.tryItem);i.getComponent(c.default).setData(e[o],o==e.length-1,t),this.contentNode.addChild(i)}},a([d(cc.Node)],e.prototype,"contentNode",void 0),a([d(cc.Prefab)],e.prototype,"tryItem",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../../InitScene/Script/data/GunModel":void 0,"./TryItem":"TryItem"}],TurnTableNode:[function(t,e,o){"use strict";cc._RF.push(e,"122b8wIyg5DhoAbgISGNngD","TurnTableNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderAssetNode"),c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/center/GameInit"),l=t("../../../../InitScene/Script/data/BadgeModel"),d=t("../../../../InitScene/Script/data/GameData"),u=t("../../../../InitScene/Script/data/GunModel"),p=t("../../../../InitScene/Script/data/MountModel"),h=t("../../../../InitScene/Script/data/OtherData"),f=t("../../../../InitScene/Script/data/TurnTableModel"),m=t("../../../../Script/base/Utils"),y=t("../../center/Game"),g=t("../cultivate/GetCultivateNode"),v=t("../main/GetCurrencyNode"),_=t("../prefabs/CoinNode"),S=t("./TableItem"),b=cc._decorator,w=b.ccclass,I=b.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mulLabel=null,e.list=null,e.wheelItemSprite=[],e.btnList=[],e.normalLabel=null,e.seniorLabel=null,e.tipsText=null,e.maxLabel=null,e.countLabel=null,e.dragonNode=null,e.iconSpriteFrame=[],e.turningAnim=null,e.awardSprite=null,e.light_state=0,e.wheel_state=0,e.isTurn=!1,e.index=0,e.poolId=0,e.payCoin=0,e.isAutoRecieve=!1,e}return n(e,t),e.prototype.setData=function(t){this.isAutoRecieve=t,cc.log("\u662f\u5426\u81ea\u52a8\u8f6c\u76d81 ",t)},e.prototype.onLoad=function(){},e.prototype.start=function(){for(var t=this,e=0;e<y.default.gameConfig.turnTableConfig.length;e++){var o=y.default.gameConfig.turnTableConfig[e],i=this.list.children[e].getComponent(S.default);switch(i.setData(o),o.type){case"coin":i.iconSprite.spriteFrame=this.iconSpriteFrame[0];break;case"diamond":i.iconSprite.spriteFrame=this.iconSpriteFrame[1];break;case"bone":i.iconSprite.spriteFrame=this.iconSpriteFrame[2]}}this.normalLabel.string=this.formatNumber(u.default.profit*h.default.turnTableNormal)+"",this.seniorLabel.string=this.formatNumber(u.default.profit*h.default.turnTableSenior)+"",this.setBottom(),l.default.updateTableBadge(!1),cc.log("\u662f\u5426\u81ea\u52a8\u8f6c\u76d82 ",this.isAutoRecieve),this.scheduleOnce(function(){cc.log("\u662f\u5426\u81ea\u52a8\u8f6c\u76d83 ",t.isAutoRecieve),t.isAutoRecieve&&t.videoSuccess()})},e.prototype.setBottom=function(){if(this.tipsText.string=this.tipsText.string.replace("x",h.default.drawMax+""),this.tipsText.string=this.tipsText.string.replace("y",p.default.getMountDataById(h.default.mountTurnAward).name),this.maxLabel.string=h.default.drawMax+"",this.setCountLabel(),this.playDragon(),f.default.todayDrawCount>=f.default.draw10Time_max)return m.setGary(this.btnList[1].node,!0)},e.prototype.playDragon=function(){var t=this;if(!(f.default.drawCount>=h.default.drawMax)){var e=p.default.getMountSkeUrl(h.default.mountTurnAward,45),o=this.dragonNode.addComponent(sp.Skeleton);this.dragonNode.addComponent(r.default).loadAsset(e,sp.SkeletonData,function(e,i){t.dragonNode.isValid&&(o.skeletonData=i,o.animation="daiji")})}},e.prototype.setCountLabel=function(){f.default.drawCount<h.default.drawMax?this.countLabel.string=f.default.drawCount+"":this.countLabel.node.parent.active=!1},e.prototype.onWheelNormal=function(){if(this.payCoin=u.default.profit*h.default.turnTableNormal,d.default.totalCoinNum<this.payCoin)return s.default.showToast("\u91d1\u5e01\u4e0d\u8db3");this.poolId=1,d.default.totalCoinNum-=this.payCoin,this.setBtnState(!1),this.onTurn(1)},e.prototype.onWheelSenior=function(){if(this.payCoin=u.default.profit*h.default.turnTableSenior,d.default.totalCoinNum<this.payCoin)return s.default.showToast("\u91d1\u5e01\u4e0d\u8db3");this.poolId=2,d.default.totalCoinNum-=this.payCoin,this.setBtnState(!1),this.onTurn(1)},e.prototype.onWheelVideo=function(t){if(cc.log(f.default.todayDrawCount,"\u8f6c\u76d8"),f.default.todayDrawCount>=f.default.draw10Time_max)return y.default.showToast("\u4eca\u5929\u7684\u6b21\u6570\u7528\u5b8c\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427");t.target.getComponent(c.default).onClick(t)},e.prototype.videoSuccess=function(){f.default.todayDrawCount+=1,l.default.updateTenDrawBadge(!1),this.poolId=2,this.payCoin=u.default.profit*h.default.turnTableNormal,this.setBtnState(!1),this.onTurn(10)},e.prototype.onAward=function(){for(var t=0,e=0,o=0,i=this.list.children,n=0;n<this.awardList.length;n++){var a=i[this.awardList[n]].getComponent(S.default).tableData;switch(a.type){case"coin":t+=a.num*u.default.profit;break;case"diamond":e+=a.base;break;case"bone":o+=a.base}}s.default.uiCenter.showUi("GetCurrencyNode").getComponent(v.default).setData(t,e,o),this.setBtnState(!0),this.isTurn=!1,d.default.emit(_.CoinEvent.TotalCoinChangeAnimoEvent,this.mulLabel.node.convertToWorldSpaceAR(cc.v2(0,0)))},e.prototype.onTurn=function(t){var e=this;y.default.gameAudio.playTurnning(),this.initTurn(),this.isTurn=!0;for(var o=function(t){var o=t*(.1*Math.random()+.25)*1e3;setTimeout(function(){e.turning(t)},Math.max(o,0))},i=0;i<t;i++)o(i);this.turningAnim.play().speed=1},e.prototype.initTurn=function(){var t=this.list.children,e=t.length;this.awardList=[],this.stopList=[],this.turnList=[];for(var o=0;o<e;o++)t[o].getComponent(cc.Sprite).spriteFrame=this.wheelItemSprite[0];this.index=Math.floor(Math.random()*e),this.mulLabel.string="0"},e.prototype.turning=function(t){var e=this,o=0,i=null,n=this.list.children,a=n.length,r=this.wheelItemSprite[1],c=this.index,s=0,l=function(){s=f.default.getResult(e.poolId)-1,e.awardList.indexOf(s)<0?e.awardList.push(s):l()};l(),cc.log("\u5f00\u59cb\u683c\u5b50\u7684\u5e8f\u53f7",c,"\u5956\u52b1\u7684\u683c\u5b50\u5e8f\u53f7",this.awardList),i=null;var d=function(){e.turnList[t]=c%a;var l=e.turnList[t],u=n[l].getComponent(S.default).tableData;switch(i&&(i.spriteFrame=e.wheelItemSprite[0]),e.awardSprite.node.setScale(.7),u.type){case"coin":e.mulLabel.string=""+u.num*e.payCoin,e.awardSprite.spriteFrame=e.iconSpriteFrame[0];break;case"diamond":e.mulLabel.string=""+u.num*u.base,e.awardSprite.spriteFrame=e.iconSpriteFrame[1];break;case"bone":e.mulLabel.string=""+u.num*u.base,e.awardSprite.node.setScale(1),e.awardSprite.spriteFrame=e.iconSpriteFrame[2]}for(var p=0;p<e.stopList.length;p++)n[e.stopList[p]].getComponent(cc.Sprite).spriteFrame=r;if((i=n[c%a].getComponent(cc.Sprite)).spriteFrame=r,o>2*a){if(c%a==s)return e.stopList.push(s),e.stopList.length==e.awardList.length&&(y.default.gameAudio.stopTurnning(),1==e.awardList.length&&0==u.num?(y.default.toast.show("\u5f88\u9057\u61be\uff0c\u5f53\u524d\u500d\u6570\u4e3a0\uff0c\u65e0\u6cd5\u83b7\u53d6\u5956\u52b1\uff01"),e.checkGainMount(),e.scheduleOnce(function(){e.setBtnState(!0),e.isTurn=!1},1)):(e.checkGainMount(),e.onAward()),y.default.gameAudio.playTurnOver(),e.turningAnim.stop(),e.turningAnim.node.y=-23),cc.log("\u8857\u673a\u8f6c\u76d8\u786e\u8ba4\u5956\u52b1\u7269\uff08\u82e5\u8fde\u62bd\u4e09\u6b21\u5219\u5355\u72ec\u51fa\u73b0\u591a2\u6b21\u8be5\u97f3\u6548\uff09",s),void e.unschedule(d);s-c%a<4&&(e.unschedule(d),e.turningAnim.play().speed=.28,e.schedule(d,.2))}c++,o++};this.schedule(d,.08)},e.prototype.setBtnState=function(t){for(var e=this.btnList.length,o=0;o<e;o++)this.btnList[o].interactable=t;if(m.setGary(this.btnList[1].node,!t),f.default.todayDrawCount>=f.default.draw10Time_max)return m.setGary(this.btnList[1].node,!0)},e.prototype.checkGainMount=function(){if(f.default.drawCount<h.default.drawMax&&(f.default.drawCount+=this.awardList.length,f.default.drawCount>=h.default.drawMax)){var t=p.default.getMountDataById(h.default.mountTurnAward);t.onUnlock(),p.default.useMountId=t.id,s.default.uiCenter.showUi("GetCultivateNode").getComponent(g.default).setData("mount",p.default.getMountSkeUrl(t.id,0),"\u5f85\u673a",t.award,!0)}this.setCountLabel()},e.prototype.onClose=function(){this.isTurn||this.node.destroy()},e.prototype.formatNumber=function(t){if(isNaN(t))return"0";if(t<1e3)return t.toFixed();if(t<1e6)return(t/1e3).toFixed()+"K";if(t<1e9)return(t/1e3/1e3).toFixed()+"M";if(t<1e12)return(t/1e3/1e3/1e3).toFixed()+"B";if(t<1e15)return(t/1e3/1e3/1e3/1e3).toFixed()+"T";var e=Math.round(t).toString(),o=e.indexOf("e+");if(o>0){var i=e.substr(o+2);return e.substr(0,4)+"/"+i}var n=Math.round(t).toString().length-1;return(t/Math.pow(10,n)).toFixed()+"/"+n},a([I(cc.Label)],e.prototype,"mulLabel",void 0),a([I(cc.Node)],e.prototype,"list",void 0),a([I(cc.SpriteFrame)],e.prototype,"wheelItemSprite",void 0),a([I(cc.Button)],e.prototype,"btnList",void 0),a([I(cc.Label)],e.prototype,"normalLabel",void 0),a([I(cc.Label)],e.prototype,"seniorLabel",void 0),a([I(cc.RichText)],e.prototype,"tipsText",void 0),a([I(cc.Label)],e.prototype,"maxLabel",void 0),a([I(cc.Label)],e.prototype,"countLabel",void 0),a([I(cc.Node)],e.prototype,"dragonNode",void 0),a([I(cc.SpriteFrame)],e.prototype,"iconSpriteFrame",void 0),a([I(cc.Animation)],e.prototype,"turningAnim",void 0),a([I(cc.Sprite)],e.prototype,"awardSprite",void 0),a([w],e)}(cc.Component);o.default=M,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/OtherData":void 0,"../../../../InitScene/Script/data/TurnTableModel":void 0,"../../../../Script/base/Utils":void 0,"../../../../framework/Script/component/LoaderAssetNode":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game","../cultivate/GetCultivateNode":"GetCultivateNode","../main/GetCurrencyNode":"GetCurrencyNode","../prefabs/CoinNode":"CoinNode","./TableItem":"TableItem"}],UFONode:[function(t,e,o){"use strict";cc._RF.push(e,"b83c2VxcBNBIpEsDZCWpUmB","UFONode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/GunModel"),c=t("../../../InitScene/Script/data/MountModel"),s=t("../../../InitScene/Script/data/OtherData"),l=t("../../../InitScene/Script/data/PersonModel"),d=t("../../../Script/base/Utils"),u=t("../../GameScene/manage/GameManage"),p=t("../../Script/center/Game"),h=t("../../Script/ui/try/TryMoreNode"),f=t("../../Script/ui/try/TryNode"),m=t("./UFOPersonNode"),y=cc._decorator,g=y.ccclass,v=y.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ufoNode=null,e.badgeNode=null,e.lightNode=null,e.ETNode=null,e.PlayerNode=null,e}return n(e,t),e.prototype.start=function(){var t="hero/dragon/"+l.default.getHeroDataById(s.default.UFOHeroID).skeUrl;this.ETNode.init(t),t="hero/dragon/"+l.default.getHeroDataById(l.default.useHeroId).skeUrl,this.PlayerNode.init(t),this.lightNode.active=!1},e.prototype.showUFO=function(){var t=this;this.ufoNode.active=!0;var e=this.ufoNode.getComponent(cc.Animation);e.once(cc.Animation.EventType.FINISHED,function(){t.badgeNode.active=!0},this),e.play()},e.prototype.showSaveETAni=function(){var t=this;this.ETNode.show("\u6346\u7ed1"),this.PlayerNode.show(),this.badgeNode.active=!1,this.node.zIndex=15,this.ufoNode.setPosition(cc.v2(75,1e3)),this.ufoNode.runAction(cc.sequence(cc.spawn(cc.moveTo(1.5,75,30),cc.scaleTo(1.5,.6)),cc.callFunc(function(){t.lightNode.active=!0;var e=t.lightNode.getComponent(cc.Animation);e.once(cc.Animation.EventType.FINISHED,t.ETGoAway,t),e.play("UFO_light_show")})))},e.prototype.ETGoAway=function(){this.ETNode.node.runAction(cc.sequence(cc.spawn(cc.moveTo(1,this.ETNode.node.x,0),cc.scaleTo(1,.2),cc.rotateTo(1,750)),cc.callFunc(this.hideLight,this),cc.scaleTo(0,0)))},e.prototype.hideLight=function(){var t=this.lightNode.getComponent(cc.Animation);t.once(cc.Animation.EventType.FINISHED,this.UFOFlyAway,this),t.play("UFO_light_hide")},e.prototype.UFOFlyAway=function(){this.ufoNode.runAction(cc.sequence(cc.spawn(cc.moveTo(1,75,1e3),cc.scaleTo(1.5,.4)),cc.callFunc(this.flyWindow,this)))},e.prototype.flyWindow=function(){var t=this;this.node.zIndex=13;var e=this.ufoNode.getComponent(cc.Animation);e.once(cc.Animation.EventType.FINISHED,function(){t.playerTalk()},this),e.play().wrapMode=cc.WrapMode.Reverse},e.prototype.playerTalk=function(){var t=this;this.PlayerNode.setDescLabel("\u6211\u4eec\u5fc5\u987b\u53bb\u6551\u4ed6\uff01"),this.PlayerNode.showDialog(function(){u.default.getInstance().matchGameUFO(),r.default.checkShowGunTry()?p.default.uiCenter.showUi("TryNode").getComponent(f.default).setTryList(t.enterUFOGame.bind(t)):t.onStartGame(t.enterUFOGame.bind(t))})},e.prototype.onStartGame=function(t){var e=l.default.getNotUnlockRandomId()>=0,o=c.default.getNotUnlockRandomId()>=0;if(e&&o){var i=d.random(0,100),n=i<50?"hero":"mount";cc.log("\u8bd5\u7528",i,n),this.showTryMore(n,t)}else e&&e&&this.showTryMore("hero",t),o&&this.showTryMore("mount",t),!e&&!o&&t&&t()},e.prototype.showTryMore=function(t,e){p.default.uiCenter.showUi("TryMoreNode").getComponent(h.default).setData(t,e)},e.prototype.enterUFOGame=function(){cc.log("\u5e7d\u6d6e\u7ed1\u67b6"),p.default.sceneCenter.runScene("GameScene_UFO",{},!0)},e.prototype.onClickUFO=function(){p.default.uiCenter.showUi("GoUFONode")},a([v(cc.Node)],e.prototype,"ufoNode",void 0),a([v(cc.Node)],e.prototype,"badgeNode",void 0),a([v(cc.Node)],e.prototype,"lightNode",void 0),a([v(m.default)],e.prototype,"ETNode",void 0),a([v(m.default)],e.prototype,"PlayerNode",void 0),a([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../../InitScene/Script/data/GunModel":void 0,"../../../InitScene/Script/data/MountModel":void 0,"../../../InitScene/Script/data/OtherData":void 0,"../../../InitScene/Script/data/PersonModel":void 0,"../../../Script/base/Utils":void 0,"../../GameScene/manage/GameManage":"GameManage","../../Script/center/Game":"Game","../../Script/ui/try/TryMoreNode":"TryMoreNode","../../Script/ui/try/TryNode":"TryNode","./UFOPersonNode":"UFOPersonNode"}],UFOPersonNode:[function(t,e,o){"use strict";cc._RF.push(e,"69b99V9MxJPGKiPLazoie7j","UFOPersonNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../framework/Script/component/LoaderDragonBones"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragon=null,e.descLabel=null,e.dialog=null,e}return n(e,t),e.prototype.start=function(){this.dialog&&(this.dialog.active=!1)},e.prototype.init=function(t){var e=this;r.default.addLoaderDragonBones(this.dragon).loadArmature(t,function(){e.dragon.armatureName="armatureName"})},e.prototype.show=function(t){void 0===t&&(t="\u8ba4\u771f"),this.node.active=!0,this.dragon.playAnimation(t,0)},e.prototype.showDialog=function(t){var e=this;this.dialog&&(this.dialog.active=!0),this.dialog&&this.dialog.getComponent(cc.Animation).play(),this.dialog&&this.dialog.getComponent(cc.Animation).once(cc.Animation.EventType.FINISHED,function(){e.dialog.active=!1,t&&t()})},e.prototype.setDescLabel=function(t){this.descLabel&&(this.descLabel.node.parent.active=!0,this.descLabel.string=t)},e.prototype.hideDescBg=function(){this.descLabel&&(this.descLabel.node.parent.active=!1)},a([l(dragonBones.ArmatureDisplay)],e.prototype,"dragon",void 0),a([l(cc.Label)],e.prototype,"descLabel",void 0),a([l(cc.Node)],e.prototype,"dialog",void 0),a([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../../framework/Script/component/LoaderDragonBones":void 0}],UnlockNode:[function(t,e,o){"use strict";cc._RF.push(e,"513e6U0hfpOGqBkDOTR97rr","UnlockNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../InitScene/Script/data/GuanqiaModel"),c=t("../../../../Script/base/Utils"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text=0,e.unlockCallback=new cc.Component.EventHandler,e.lockCallback=new cc.Component.EventHandler,e.tipLabel=null,e}return n(e,t),e.prototype.start=function(){r.default.guanqiaData.id>=this.text?(c.setGary(this.node,!1),this.tipLabel.string=""):(c.setGary(this.node,!0),this.tipLabel.string="\u901a\u5173"+(this.text-r.default.guanqiaData.id)+"\u5173\u540e\u5f00\u542f")},e.prototype.onClick=function(t){r.default.guanqiaData.id>=this.text?this.unlockCallback&&this.unlockCallback.emit([t]):this.lockCallback&&this.lockCallback.emit([t])},e.prototype.showTip=function(){s.default.showToast("\u901a\u5173"+(this.text-r.default.guanqiaData.id)+"\u5173\u540e\u5f00\u542f")},a([u],e.prototype,"text",void 0),a([u({type:cc.Component.EventHandler,tooltip:"\u5df2\u89e3\u9501\u65b9\u6cd5"})],e.prototype,"unlockCallback",void 0),a([u({type:cc.Component.EventHandler,tooltip:"\u9501\u4f4f\u65f6\u65b9\u6cd5"})],e.prototype,"lockCallback",void 0),a([u(cc.Label)],e.prototype,"tipLabel",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GuanqiaModel":void 0,"../../../../Script/base/Utils":void 0,"../../center/Game":"Game"}],UpdateGunNode:[function(t,e,o){"use strict";cc._RF.push(e,"ea00eIznOZPjZp4DYAOVUhm","UpdateGunNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/data/GunModel"),s=t("../../center/Game"),l=cc._decorator,d=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nowGunSprite=null,e.nowGunNameLabel=null,e.nowGunLevelLabel=null,e.nextGunSprite=null,e.nextGunNameLabel=null,e.nextGunLevelLabel=null,e.item=null,e.nextLevel=0,e.callback=null,e}return n(e,t),e.prototype.start=function(){s.default.gameAudio.playWindow()},e.prototype.setData=function(t,e){this.callback=e,this.item=t;var o=t.rank,i=o+1,n=c.default.getGunDataById(o),a=c.default.getGunDataById(i);r.default.addLoaderSprite(this.nowGunSprite).loadSprite("gun/icon/"+o),r.default.addLoaderSprite(this.nextGunSprite).loadSprite("gun/icon/"+i),this.nowGunLevelLabel.string=""+(o+1),this.nextGunLevelLabel.string=""+(i+1),this.nowGunNameLabel.string=n.gun_name,this.nextGunNameLabel.string=a.gun_name},e.prototype.onUpdate=function(){this.item.rank++,this.item.refresh(),this.item.box.refresh(),this.cancel(),s.default.gameAudio.playCombineGunClip()},e.prototype.cancel=function(){s.default.uiCenter.closeUI(this.node),this.callback&&this.callback()},a([u(cc.Sprite)],e.prototype,"nowGunSprite",void 0),a([u(cc.Label)],e.prototype,"nowGunNameLabel",void 0),a([u(cc.Label)],e.prototype,"nowGunLevelLabel",void 0),a([u(cc.Sprite)],e.prototype,"nextGunSprite",void 0),a([u(cc.Label)],e.prototype,"nextGunNameLabel",void 0),a([u(cc.Label)],e.prototype,"nextGunLevelLabel",void 0),a([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../../InitScene/Script/data/GunModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0,"../../center/Game":"Game"}],UserAvatar:[function(t,e,o){"use strict";cc._RF.push(e,"73b097SI9JL/Jyn5KVETrBY","UserAvatar");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("./Avatar"),c=t("../../center/Game"),s=cc._decorator,l=s.ccclass,d=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){this.setAvatarUrl(c.default.userInfo.avatarUrl)},a([l],e)}(r.default));o.default=d,cc._RF.pop()},{"../../center/Game":"Game","./Avatar":"Avatar"}],UserHeroAvatar:[function(t,e,o){"use strict";cc._RF.push(e,"e5149j9WRdDc6Z71xdubQVw","UserHeroAvatar");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/component/LoaderSprite"),c=t("../../../../InitScene/Script/center/GameInit"),s=t("../../../../InitScene/Script/data/BadgeModel"),l=t("../../../../InitScene/Script/data/GameData"),d=t("../../../../InitScene/Script/data/PersonModel"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._avatarSprite=null,e}return n(e,t),e.prototype.onLoad=function(){this._avatarSprite=this.node.getComponent(cc.Sprite),c.default.event.on(l.GameDataEvent.EVENT_AVATAR_CHANGE,this.loadAvatar,this)},e.prototype.start=function(){this.loadAvatar(),s.default.updateAvatarBadge(!1)},e.prototype.loadAvatar=function(){var t="hero/avatar/"+d.default.useAvatarId;this.setAvatar(t)},e.prototype.setAvatar=function(t){r.default.addLoaderSprite(this._avatarSprite).loadSprite(t,cc.SpriteFrame)},a([p],e)}(cc.Component));o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/BadgeModel":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/component/LoaderSprite":void 0}],ZIndexNode:[function(t,e,o){"use strict";cc._RF.push(e,"8a3a3s8w4xHfap8t267ADQW","ZIndexNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=r.executeInEditMode,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._zIndex=0,e}return n(e,t),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.node.zIndex=this.zIndex},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.node.zIndex=this.zIndex},e.prototype.start=function(){},a([s],e.prototype,"_zIndex",void 0),a([s],e.prototype,"zIndex",null),a([c,l],e)}(cc.Component);o.default=d,cc._RF.pop()},{}],ZongziNode:[function(t,e,o){"use strict";cc._RF.push(e,"45fbc3V9aRN5Y2Gj2ZK6VZg","ZongziNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../InitScene/Script/data/ActivityModel"),c=t("../../../Script/base/Utils"),s=cc._decorator,l=s.ccclass,d=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.zongziNode=null,e.isMove=!1,e.position=null,e}return n(e,t),e.prototype.start=function(){var t=this;this.position=this.node.getPosition(),this.node.opacity=0;var e=(new Date).getDate();cc.log("data",e,this.zongziNode.opacity),!c.isDateUpdata(r.default.zongziShowTime)||12!=e&&13!=e&&14!=e?this.zongziNode.active=!1:this.node.runAction(cc.sequence(cc.fadeIn(1),cc.scaleTo(.3,1.2,.9),cc.scaleTo(.2,1,1),cc.callFunc(function(){t.isMove=!0,r.default.emit(r.ActivityType.SHOW_ZONGZI)})))},e.prototype.hide=function(){var t=this;this.zongziNode.opacity=255,this.zongziNode.runAction(cc.sequence(cc.spawn(cc.fadeOut(1),cc.moveBy(.5,0,30),cc.scaleTo(1,0,0)),cc.callFunc(function(){t.zongziNode.active=!1}))),this.isMove=!1},e.prototype.back=function(){this.node.runAction(cc.moveTo(.5,this.position))},a([d(cc.Node)],e.prototype,"zongziNode",void 0),a([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../../InitScene/Script/data/ActivityModel":void 0,"../../../Script/base/Utils":void 0}],btnUnlock:[function(t,e,o){"use strict";cc._RF.push(e,"2fcb6GWtVhOl7uz1Um4egUY","btnUnlock");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../../framework/Script/sdk/ChanneConfig"),c=t("../../../../InitScene/Script/data/GameData"),s=t("../../../../InitScene/Script/data/GunModel"),l=t("../../../../InitScene/Script/data/MountModel"),d=t("../../../../InitScene/Script/data/PersonModel"),u=cc._decorator,p=u.ccclass,h=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){r.default.channelId!==r.ChannelId.web_debug&&this.node.destroy()},e.prototype.unlock=function(){l.default.unlockAllMount();for(var t=d.default.getHeroTotalNum(),e=0;e<t;e++)d.default.getHeroDataById(e).onUnlock();c.default.totalDiamondNum+=15e3},e.prototype.onGunUnlock=function(){cc.log("gunNum",s.default.getGunTotalNum());for(var t=s.default.getGunTotalNum(),e=0;e<t;e++)s.default.getGunDataById(e).onUnlock();c.default.totalCoinNum+=5e8},a([p],e)}(cc.Component));o.default=h,cc._RF.pop()},{"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../InitScene/Script/data/MountModel":void 0,"../../../../InitScene/Script/data/PersonModel":void 0,"../../../../framework/Script/sdk/ChanneConfig":void 0}],moreAwardNode:[function(t,e,o){"use strict";cc._RF.push(e,"de103F5QK9KbLVbJNALa+sk","moreAwardNode");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,i){var n,a=arguments.length,r=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(a<3?n(r):a>3?n(e,o,r):n(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r,c=t("../../../../framework/Script/prefab/AwardButton"),s=t("../../../../InitScene/Script/center/GameInit"),l=t("../../../../InitScene/Script/data/GameData"),d=t("../../../../InitScene/Script/data/GunModel"),u=t("../../../../Script/base/Utils"),p=t("../../center/Game"),h=cc._decorator,f=h.ccclass,m=h.property;(function(t){t[t.Coin=0]="Coin",t[t.Diamond=1]="Diamond",t[t.DNA=2]="DNA"})(r||(r={}));var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.awardSprite=null,e.moreBtnNode=null,e.awardSpriteFrame=[],e.tipsText=null,e.moreType=r.Coin,e.awardData=null,e}return n(e,t),e.prototype.start=function(){this.setPageData(),this.setBtn()},e.prototype.setBtn=function(){switch(this.moreType){case r.Coin:l.default.moreCoinTime>=l.default.moreTimes_Max&&u.setGary(this.moreBtnNode,!0);break;case r.Diamond:l.default.moreDiamondTime>=l.default.moreTimes_Max&&u.setGary(this.moreBtnNode,!0);break;case r.DNA:l.default.moreDNATime>=l.default.moreTimes_Max&&u.setGary(this.moreBtnNode,!0)}},e.prototype.setType=function(t){this.moreType=t,this.setPageData()},e.prototype.setPageData=function(){this.awardData=s.default.gameConfig.moreAwardConfig[this.moreType],this.awardSprite.spriteFrame=this.awardSpriteFrame[this.moreType];var t=this.moreType==r.Coin?d.default.profit*this.awardData.num:this.awardData.num;this.tipsText.string=this.tipsText.string.replace("NUM",t)},e.prototype.onWatch=function(t){switch(this.setBtn(),this.moreType){case r.Coin:if(l.default.moreCoinTime>=l.default.moreTimes_Max)return p.default.showToast("\u4eca\u5929\u7684\u6b21\u6570\u7528\u5b8c\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427");break;case r.Diamond:if(l.default.moreDiamondTime>=l.default.moreTimes_Max)return p.default.showToast("\u4eca\u5929\u7684\u6b21\u6570\u7528\u5b8c\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427");break;case r.DNA:if(l.default.moreDNATime>=l.default.moreTimes_Max)return p.default.showToast("\u4eca\u5929\u7684\u6b21\u6570\u7528\u5b8c\u4e86\uff0c\u8bf7\u660e\u5929\u518d\u6765\u5427")}t.target.getComponent(c.default).onClick(t)},e.prototype.videoSuccess=function(){var t=0;switch(this.moreType){case r.Coin:t=d.default.profit*this.awardData.num,l.default.totalCoinNum+=t,l.default.moreCoinTime++,p.default.showCurrency(t);break;case r.Diamond:t=this.awardData.num,l.default.totalDiamondNum+=this.awardData.num,l.default.moreDiamondTime++,p.default.showCurrency(null,t);break;case r.DNA:t=this.awardData.num,l.default.totalBoneNum+=this.awardData.num,l.default.moreDNATime++,p.default.showCurrency(null,null,t)}this.setBtn(),this.node.emit("updateUI"),this.onClose()},e.prototype.onClose=function(){s.default.uiCenter.closeUI(this.node),this.node.emit("onClose")},a([m(cc.Sprite)],e.prototype,"awardSprite",void 0),a([m(cc.Node)],e.prototype,"moreBtnNode",void 0),a([m(cc.SpriteFrame)],e.prototype,"awardSpriteFrame",void 0),a([m(cc.Label)],e.prototype,"tipsText",void 0),a([m({type:cc.Enum(r)})],e.prototype,"moreType",void 0),a([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../../../InitScene/Script/center/GameInit":void 0,"../../../../InitScene/Script/data/GameData":void 0,"../../../../InitScene/Script/data/GunModel":void 0,"../../../../Script/base/Utils":void 0,"../../../../framework/Script/prefab/AwardButton":void 0,"../../center/Game":"Game"}]},{},["AIHeroNode","FarmView","BoyGuestNode","GoGuestNode","GrilGuestNode","RollDice","ZIndexNode","GoUFONode","UFONode","UFOPersonNode","FarmHeroNode","HomeNode","FarmDragon","FruitItemNode","FruitNode","MountAINode","MountChangeNode","SeaView","SeedItemNode","SeedNode","TreeItemNode","TreeNode","ZongziNode","BasePlayer","ButtonScaleBreathe","FollowCamare","Player","CtrlManage","JoystickCommon","GameManage","AStar","QuadTree","EditView","BaseView","PrefabView","AI","AccountView","AccountAwardNode","AccountDifficultNode","AccountLevelAwardNode","AccountLevelNode","DifficultAwardNode","AccountAwardFarmNode","AddHpCircle","AddHpView","AirBoxNode","AirSkillView","ArmView","BulletNode","CardBuffNode","CardInfoNode","CardItemNode","CardNode","CriView","DiffcultGameView","DoorCircle","ETNode","EnemyNode","EnemySkillView","FarmGameView","FillView","FireView","SkillFortNode","GameAttack","GameBlock","GameItem","GameMap","GameRank","GameRankItem","GameIOView","GameUFOView","GameView","HeadView","HpView","KillView","LoseView","MountGameView","PetBase","PetNode","SkillView","SpacialGameView","TimeView","TipsView","EnemyCountView","CombineAni","CombineNode","ArmModel","SkillModel","Game","ActivityDiamondNode","ActivityDwGunNode","ActivityGunNode","ActivityHeroMCZZNode","ActivityHeroNode","ActivityHeroWakeNode","ActivityMountJDLNode","ActivityMountNode","ActivityXzGunNode","GunEgg","GunEggDwNode","GunEggXzNode","JQQDEggBtnNode","Text51hengfu","UpdateGunNode","AvatarItem","ChangeAvatarNode","btnUnlock","ColorEggNode","EggItemNode","EggTipNode","EggWallNode","AttributeDiff","AttributeView","CultivateItem","CultivateNode","GetCultivateNode","MountUnlockNode","MountView","DifficultGameNode","DifficultNode","DifficultShowItem","DifficultShowNode","DifficultView","FarmGameItemNode","FarmGameNode","FuliNode","GameListNode","GuideNode","IllustratedItem","IllustratedNode","InfoUI","List","ListItem","BadgeButton","BoxNode","BtnListNode","ChangeBtnNode","GetCurrencyNode","MainUI","MapBtnNode","PlayManage","RareGunButton","RareHeroButton","ShareButton","UnlockNode","UserHeroAvatar","FreeGetMountItemNode","GetMapMountNode","MapMountBtn","MapMountItem","MapMountNode","MapListItem","MapListNode","moreAwardNode","NoticeNode","OfflineNode","OnlineAwardNode","PostListItem","PostListNode","PostNode","Avatar","BoneLabel","BoneNode","BuyItem","CoinLabel","CoinNode","DiamondLabel","DiamondNode","UserAvatar","GetGun","BarView","BgView","BoxView","EquipBoxView","GunView","HeroView","ItemView","LevelView","MainPersonView","PersonView","SkinView","AscendingNode","RankAwardItem","RankAwardNode","RankInfoNode","RankNode","RankPlayerItem","RankView","SeasonBeginNode","SeasonDayReport","SeasonOverNode","ShopItem","ShopNode","ShopUpgrade","SignItem","SignNode","NewBieTryMoreNode","TryItem","TryMoreNode","TryNode","AwardItem","TableItem","TurnTableNode"]);